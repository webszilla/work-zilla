function Zj(t,a){for(var s=0;s<a.length;s++){const n=a[s];if(typeof n!="string"&&!Array.isArray(n)){for(const l in n)if(l!=="default"&&!(l in t)){const r=Object.getOwnPropertyDescriptor(n,l);r&&Object.defineProperty(t,l,r.get?r:{enumerable:!0,get:()=>n[l]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(l){if(l.ep)return;l.ep=!0;const r=s(l);fetch(l.href,r)}})();function Xj(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var og={exports:{}},Ti={},cg={exports:{}},ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nr=Symbol.for("react.element"),ey=Symbol.for("react.portal"),ty=Symbol.for("react.fragment"),ay=Symbol.for("react.strict_mode"),sy=Symbol.for("react.profiler"),ny=Symbol.for("react.provider"),ly=Symbol.for("react.context"),ry=Symbol.for("react.forward_ref"),iy=Symbol.for("react.suspense"),oy=Symbol.for("react.memo"),cy=Symbol.for("react.lazy"),Bh=Symbol.iterator;function dy(t){return t===null||typeof t!="object"?null:(t=Bh&&t[Bh]||t["@@iterator"],typeof t=="function"?t:null)}var dg={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ug=Object.assign,mg={};function tl(t,a,s){this.props=t,this.context=a,this.refs=mg,this.updater=s||dg}tl.prototype.isReactComponent={};tl.prototype.setState=function(t,a){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,a,"setState")};tl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function hg(){}hg.prototype=tl.prototype;function bd(t,a,s){this.props=t,this.context=a,this.refs=mg,this.updater=s||dg}var jd=bd.prototype=new hg;jd.constructor=bd;ug(jd,tl.prototype);jd.isPureReactComponent=!0;var Wh=Array.isArray,pg=Object.prototype.hasOwnProperty,yd={current:null},fg={key:!0,ref:!0,__self:!0,__source:!0};function gg(t,a,s){var n,l={},r=null,o=null;if(a!=null)for(n in a.ref!==void 0&&(o=a.ref),a.key!==void 0&&(r=""+a.key),a)pg.call(a,n)&&!fg.hasOwnProperty(n)&&(l[n]=a[n]);var u=arguments.length-2;if(u===1)l.children=s;else if(1<u){for(var c=Array(u),d=0;d<u;d++)c[d]=arguments[d+2];l.children=c}if(t&&t.defaultProps)for(n in u=t.defaultProps,u)l[n]===void 0&&(l[n]=u[n]);return{$$typeof:nr,type:t,key:r,ref:o,props:l,_owner:yd.current}}function uy(t,a){return{$$typeof:nr,type:t.type,key:a,ref:t.ref,props:t.props,_owner:t._owner}}function vd(t){return typeof t=="object"&&t!==null&&t.$$typeof===nr}function my(t){var a={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return a[s]})}var Vh=/\/+/g;function ko(t,a){return typeof t=="object"&&t!==null&&t.key!=null?my(""+t.key):a.toString(36)}function Vr(t,a,s,n,l){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case nr:case ey:o=!0}}if(o)return o=t,l=l(o),t=n===""?"."+ko(o,0):n,Wh(l)?(s="",t!=null&&(s=t.replace(Vh,"$&/")+"/"),Vr(l,a,s,"",function(d){return d})):l!=null&&(vd(l)&&(l=uy(l,s+(!l.key||o&&o.key===l.key?"":(""+l.key).replace(Vh,"$&/")+"/")+t)),a.push(l)),1;if(o=0,n=n===""?".":n+":",Wh(t))for(var u=0;u<t.length;u++){r=t[u];var c=n+ko(r,u);o+=Vr(r,a,s,c,l)}else if(c=dy(t),typeof c=="function")for(t=c.call(t),u=0;!(r=t.next()).done;)r=r.value,c=n+ko(r,u++),o+=Vr(r,a,s,c,l);else if(r==="object")throw a=String(t),Error("Objects are not valid as a React child (found: "+(a==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":a)+"). If you meant to render a collection of children, use an array instead.");return o}function br(t,a,s){if(t==null)return t;var n=[],l=0;return Vr(t,n,"","",function(r){return a.call(s,r,l++)}),n}function hy(t){if(t._status===-1){var a=t._result;a=a(),a.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=a)}if(t._status===1)return t._result.default;throw t._result}var fa={current:null},Gr={transition:null},py={ReactCurrentDispatcher:fa,ReactCurrentBatchConfig:Gr,ReactCurrentOwner:yd};function xg(){throw Error("act(...) is not supported in production builds of React.")}ut.Children={map:br,forEach:function(t,a,s){br(t,function(){a.apply(this,arguments)},s)},count:function(t){var a=0;return br(t,function(){a++}),a},toArray:function(t){return br(t,function(a){return a})||[]},only:function(t){if(!vd(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ut.Component=tl;ut.Fragment=ty;ut.Profiler=sy;ut.PureComponent=bd;ut.StrictMode=ay;ut.Suspense=iy;ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=py;ut.act=xg;ut.cloneElement=function(t,a,s){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=ug({},t.props),l=t.key,r=t.ref,o=t._owner;if(a!=null){if(a.ref!==void 0&&(r=a.ref,o=yd.current),a.key!==void 0&&(l=""+a.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in a)pg.call(a,c)&&!fg.hasOwnProperty(c)&&(n[c]=a[c]===void 0&&u!==void 0?u[c]:a[c])}var c=arguments.length-2;if(c===1)n.children=s;else if(1<c){u=Array(c);for(var d=0;d<c;d++)u[d]=arguments[d+2];n.children=u}return{$$typeof:nr,type:t.type,key:l,ref:r,props:n,_owner:o}};ut.createContext=function(t){return t={$$typeof:ly,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ny,_context:t},t.Consumer=t};ut.createElement=gg;ut.createFactory=function(t){var a=gg.bind(null,t);return a.type=t,a};ut.createRef=function(){return{current:null}};ut.forwardRef=function(t){return{$$typeof:ry,render:t}};ut.isValidElement=vd;ut.lazy=function(t){return{$$typeof:cy,_payload:{_status:-1,_result:t},_init:hy}};ut.memo=function(t,a){return{$$typeof:oy,type:t,compare:a===void 0?null:a}};ut.startTransition=function(t){var a=Gr.transition;Gr.transition={};try{t()}finally{Gr.transition=a}};ut.unstable_act=xg;ut.useCallback=function(t,a){return fa.current.useCallback(t,a)};ut.useContext=function(t){return fa.current.useContext(t)};ut.useDebugValue=function(){};ut.useDeferredValue=function(t){return fa.current.useDeferredValue(t)};ut.useEffect=function(t,a){return fa.current.useEffect(t,a)};ut.useId=function(){return fa.current.useId()};ut.useImperativeHandle=function(t,a,s){return fa.current.useImperativeHandle(t,a,s)};ut.useInsertionEffect=function(t,a){return fa.current.useInsertionEffect(t,a)};ut.useLayoutEffect=function(t,a){return fa.current.useLayoutEffect(t,a)};ut.useMemo=function(t,a){return fa.current.useMemo(t,a)};ut.useReducer=function(t,a,s){return fa.current.useReducer(t,a,s)};ut.useRef=function(t){return fa.current.useRef(t)};ut.useState=function(t){return fa.current.useState(t)};ut.useSyncExternalStore=function(t,a,s){return fa.current.useSyncExternalStore(t,a,s)};ut.useTransition=function(){return fa.current.useTransition()};ut.version="18.3.1";cg.exports=ut;var i=cg.exports;const bg=Xj(i),fy=Zj({__proto__:null,default:bg},[i]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gy=i,xy=Symbol.for("react.element"),by=Symbol.for("react.fragment"),jy=Object.prototype.hasOwnProperty,yy=gy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vy={key:!0,ref:!0,__self:!0,__source:!0};function jg(t,a,s){var n,l={},r=null,o=null;s!==void 0&&(r=""+s),a.key!==void 0&&(r=""+a.key),a.ref!==void 0&&(o=a.ref);for(n in a)jy.call(a,n)&&!vy.hasOwnProperty(n)&&(l[n]=a[n]);if(t&&t.defaultProps)for(n in a=t.defaultProps,a)l[n]===void 0&&(l[n]=a[n]);return{$$typeof:xy,type:t,key:r,ref:o,props:l,_owner:yy.current}}Ti.Fragment=by;Ti.jsx=jg;Ti.jsxs=jg;og.exports=Ti;var e=og.exports,bc={},yg={exports:{}},Ea={},vg={exports:{}},Ng={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function a(D,te){var H=D.length;D.push(te);e:for(;0<H;){var O=H-1>>>1,V=D[O];if(0<l(V,te))D[O]=te,D[H]=V,H=O;else break e}}function s(D){return D.length===0?null:D[0]}function n(D){if(D.length===0)return null;var te=D[0],H=D.pop();if(H!==te){D[0]=H;e:for(var O=0,V=D.length,re=V>>>1;O<re;){var Y=2*(O+1)-1,ce=D[Y],ie=Y+1,ee=D[ie];if(0>l(ce,H))ie<V&&0>l(ee,ce)?(D[O]=ee,D[ie]=H,O=ie):(D[O]=ce,D[Y]=H,O=Y);else if(ie<V&&0>l(ee,H))D[O]=ee,D[ie]=H,O=ie;else break e}}return te}function l(D,te){var H=D.sortIndex-te.sortIndex;return H!==0?H:D.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var o=Date,u=o.now();t.unstable_now=function(){return o.now()-u}}var c=[],d=[],h=1,p=null,g=3,N=!1,v=!1,w=!1,A=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function f(D){for(var te=s(d);te!==null;){if(te.callback===null)n(d);else if(te.startTime<=D)n(d),te.sortIndex=te.expirationTime,a(c,te);else break;te=s(d)}}function b(D){if(w=!1,f(D),!v)if(s(c)!==null)v=!0,R(k);else{var te=s(d);te!==null&&W(b,te.startTime-D)}}function k(D,te){v=!1,w&&(w=!1,y(S),S=-1),N=!0;var H=g;try{for(f(te),p=s(c);p!==null&&(!(p.expirationTime>te)||D&&!Q());){var O=p.callback;if(typeof O=="function"){p.callback=null,g=p.priorityLevel;var V=O(p.expirationTime<=te);te=t.unstable_now(),typeof V=="function"?p.callback=V:p===s(c)&&n(c),f(te)}else n(c);p=s(c)}if(p!==null)var re=!0;else{var Y=s(d);Y!==null&&W(b,Y.startTime-te),re=!1}return re}finally{p=null,g=H,N=!1}}var _=!1,P=null,S=-1,F=5,L=-1;function Q(){return!(t.unstable_now()-L<F)}function E(){if(P!==null){var D=t.unstable_now();L=D;var te=!0;try{te=P(!0,D)}finally{te?C():(_=!1,P=null)}}else _=!1}var C;if(typeof x=="function")C=function(){x(E)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,M=z.port2;z.port1.onmessage=E,C=function(){M.postMessage(null)}}else C=function(){A(E,0)};function R(D){P=D,_||(_=!0,C())}function W(D,te){S=A(function(){D(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){v||N||(v=!0,R(k))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return s(c)},t.unstable_next=function(D){switch(g){case 1:case 2:case 3:var te=3;break;default:te=g}var H=g;g=te;try{return D()}finally{g=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,te){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var H=g;g=D;try{return te()}finally{g=H}},t.unstable_scheduleCallback=function(D,te,H){var O=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?O+H:O):H=O,D){case 1:var V=-1;break;case 2:V=250;break;case 5:V=1073741823;break;case 4:V=1e4;break;default:V=5e3}return V=H+V,D={id:h++,callback:te,priorityLevel:D,startTime:H,expirationTime:V,sortIndex:-1},H>O?(D.sortIndex=H,a(d,D),s(c)===null&&D===s(d)&&(w?(y(S),S=-1):w=!0,W(b,H-O))):(D.sortIndex=V,a(c,D),v||N||(v=!0,R(k))),D},t.unstable_shouldYield=Q,t.unstable_wrapCallback=function(D){var te=g;return function(){var H=g;g=te;try{return D.apply(this,arguments)}finally{g=H}}}})(Ng);vg.exports=Ng;var Ny=vg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _y=i,Pa=Ny;function Ee(t){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)a+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _g=new Set,Il={};function fn(t,a){Hn(t,a),Hn(t+"Capture",a)}function Hn(t,a){for(Il[t]=a,t=0;t<a.length;t++)_g.add(a[t])}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jc=Object.prototype.hasOwnProperty,Sy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gh={},Hh={};function wy(t){return jc.call(Hh,t)?!0:jc.call(Gh,t)?!1:Sy.test(t)?Hh[t]=!0:(Gh[t]=!0,!1)}function ky(t,a,s,n){if(s!==null&&s.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return n?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Cy(t,a,s,n){if(a===null||typeof a>"u"||ky(t,a,s,n))return!0;if(n)return!1;if(s!==null)switch(s.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function ga(t,a,s,n,l,r,o){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=n,this.attributeNamespace=l,this.mustUseProperty=s,this.propertyName=t,this.type=a,this.sanitizeURL=r,this.removeEmptyString=o}var na={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){na[t]=new ga(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var a=t[0];na[a]=new ga(a,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){na[t]=new ga(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){na[t]=new ga(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){na[t]=new ga(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){na[t]=new ga(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){na[t]=new ga(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){na[t]=new ga(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){na[t]=new ga(t,5,!1,t.toLowerCase(),null,!1,!1)});var Nd=/[\-:]([a-z])/g;function _d(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var a=t.replace(Nd,_d);na[a]=new ga(a,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var a=t.replace(Nd,_d);na[a]=new ga(a,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var a=t.replace(Nd,_d);na[a]=new ga(a,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){na[t]=new ga(t,1,!1,t.toLowerCase(),null,!1,!1)});na.xlinkHref=new ga("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){na[t]=new ga(t,1,!1,t.toLowerCase(),null,!0,!0)});function Sd(t,a,s,n){var l=na.hasOwnProperty(a)?na[a]:null;(l!==null?l.type!==0:n||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(Cy(a,s,l,n)&&(s=null),n||l===null?wy(a)&&(s===null?t.removeAttribute(a):t.setAttribute(a,""+s)):l.mustUseProperty?t[l.propertyName]=s===null?l.type===3?!1:"":s:(a=l.attributeName,n=l.attributeNamespace,s===null?t.removeAttribute(a):(l=l.type,s=l===3||l===4&&s===!0?"":""+s,n?t.setAttributeNS(n,a,s):t.setAttribute(a,s))))}var fs=_y.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jr=Symbol.for("react.element"),Pn=Symbol.for("react.portal"),En=Symbol.for("react.fragment"),wd=Symbol.for("react.strict_mode"),yc=Symbol.for("react.profiler"),Sg=Symbol.for("react.provider"),wg=Symbol.for("react.context"),kd=Symbol.for("react.forward_ref"),vc=Symbol.for("react.suspense"),Nc=Symbol.for("react.suspense_list"),Cd=Symbol.for("react.memo"),Cs=Symbol.for("react.lazy"),kg=Symbol.for("react.offscreen"),qh=Symbol.iterator;function dl(t){return t===null||typeof t!="object"?null:(t=qh&&t[qh]||t["@@iterator"],typeof t=="function"?t:null)}var Mt=Object.assign,Co;function _l(t){if(Co===void 0)try{throw Error()}catch(s){var a=s.stack.trim().match(/\n( *(at )?)/);Co=a&&a[1]||""}return`
`+Co+t}var Po=!1;function Eo(t,a){if(!t||Po)return"";Po=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(d){var n=d}Reflect.construct(t,[],a)}else{try{a.call()}catch(d){n=d}t.call(a.prototype)}else{try{throw Error()}catch(d){n=d}t()}}catch(d){if(d&&n&&typeof d.stack=="string"){for(var l=d.stack.split(`
`),r=n.stack.split(`
`),o=l.length-1,u=r.length-1;1<=o&&0<=u&&l[o]!==r[u];)u--;for(;1<=o&&0<=u;o--,u--)if(l[o]!==r[u]){if(o!==1||u!==1)do if(o--,u--,0>u||l[o]!==r[u]){var c=`
`+l[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=u);break}}}finally{Po=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?_l(t):""}function Py(t){switch(t.tag){case 5:return _l(t.type);case 16:return _l("Lazy");case 13:return _l("Suspense");case 19:return _l("SuspenseList");case 0:case 2:case 15:return t=Eo(t.type,!1),t;case 11:return t=Eo(t.type.render,!1),t;case 1:return t=Eo(t.type,!0),t;default:return""}}function _c(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case En:return"Fragment";case Pn:return"Portal";case yc:return"Profiler";case wd:return"StrictMode";case vc:return"Suspense";case Nc:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case wg:return(t.displayName||"Context")+".Consumer";case Sg:return(t._context.displayName||"Context")+".Provider";case kd:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Cd:return a=t.displayName||null,a!==null?a:_c(t.type)||"Memo";case Cs:a=t._payload,t=t._init;try{return _c(t(a))}catch{}}return null}function Ey(t){var a=t.type;switch(t.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=a.render,t=t.displayName||t.name||"",a.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _c(a);case 8:return a===wd?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Ws(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Cg(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Ay(t){var a=Cg(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,a),n=""+t[a];if(!t.hasOwnProperty(a)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var l=s.get,r=s.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return l.call(this)},set:function(o){n=""+o,r.call(this,o)}}),Object.defineProperty(t,a,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function yr(t){t._valueTracker||(t._valueTracker=Ay(t))}function Pg(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var s=a.getValue(),n="";return t&&(n=Cg(t)?t.checked?"true":"false":t.value),t=n,t!==s?(a.setValue(t),!0):!1}function ni(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Sc(t,a){var s=a.checked;return Mt({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??t._wrapperState.initialChecked})}function Qh(t,a){var s=a.defaultValue==null?"":a.defaultValue,n=a.checked!=null?a.checked:a.defaultChecked;s=Ws(a.value!=null?a.value:s),t._wrapperState={initialChecked:n,initialValue:s,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Eg(t,a){a=a.checked,a!=null&&Sd(t,"checked",a,!1)}function wc(t,a){Eg(t,a);var s=Ws(a.value),n=a.type;if(s!=null)n==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}a.hasOwnProperty("value")?kc(t,a.type,s):a.hasOwnProperty("defaultValue")&&kc(t,a.type,Ws(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(t.defaultChecked=!!a.defaultChecked)}function Jh(t,a,s){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var n=a.type;if(!(n!=="submit"&&n!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+t._wrapperState.initialValue,s||a===t.value||(t.value=a),t.defaultValue=a}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function kc(t,a,s){(a!=="number"||ni(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var Sl=Array.isArray;function Fn(t,a,s,n){if(t=t.options,a){a={};for(var l=0;l<s.length;l++)a["$"+s[l]]=!0;for(s=0;s<t.length;s++)l=a.hasOwnProperty("$"+t[s].value),t[s].selected!==l&&(t[s].selected=l),l&&n&&(t[s].defaultSelected=!0)}else{for(s=""+Ws(s),a=null,l=0;l<t.length;l++){if(t[l].value===s){t[l].selected=!0,n&&(t[l].defaultSelected=!0);return}a!==null||t[l].disabled||(a=t[l])}a!==null&&(a.selected=!0)}}function Cc(t,a){if(a.dangerouslySetInnerHTML!=null)throw Error(Ee(91));return Mt({},a,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Kh(t,a){var s=a.value;if(s==null){if(s=a.children,a=a.defaultValue,s!=null){if(a!=null)throw Error(Ee(92));if(Sl(s)){if(1<s.length)throw Error(Ee(93));s=s[0]}a=s}a==null&&(a=""),s=a}t._wrapperState={initialValue:Ws(s)}}function Ag(t,a){var s=Ws(a.value),n=Ws(a.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),a.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),n!=null&&(t.defaultValue=""+n)}function Yh(t){var a=t.textContent;a===t._wrapperState.initialValue&&a!==""&&a!==null&&(t.value=a)}function Tg(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pc(t,a){return t==null||t==="http://www.w3.org/1999/xhtml"?Tg(a):t==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var vr,Dg=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,s,n,l){MSApp.execUnsafeLocalFunction(function(){return t(a,s,n,l)})}:t}(function(t,a){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=a;else{for(vr=vr||document.createElement("div"),vr.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=vr.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;a.firstChild;)t.appendChild(a.firstChild)}});function Fl(t,a){if(a){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=a;return}}t.textContent=a}var Pl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ty=["Webkit","ms","Moz","O"];Object.keys(Pl).forEach(function(t){Ty.forEach(function(a){a=a+t.charAt(0).toUpperCase()+t.substring(1),Pl[a]=Pl[t]})});function Rg(t,a,s){return a==null||typeof a=="boolean"||a===""?"":s||typeof a!="number"||a===0||Pl.hasOwnProperty(t)&&Pl[t]?(""+a).trim():a+"px"}function Lg(t,a){t=t.style;for(var s in a)if(a.hasOwnProperty(s)){var n=s.indexOf("--")===0,l=Rg(s,a[s],n);s==="float"&&(s="cssFloat"),n?t.setProperty(s,l):t[s]=l}}var Dy=Mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ec(t,a){if(a){if(Dy[t]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(Ee(137,t));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(Ee(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(Ee(61))}if(a.style!=null&&typeof a.style!="object")throw Error(Ee(62))}}function Ac(t,a){if(t.indexOf("-")===-1)return typeof a.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tc=null;function Pd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Dc=null,zn=null,Bn=null;function Zh(t){if(t=ir(t)){if(typeof Dc!="function")throw Error(Ee(280));var a=t.stateNode;a&&(a=Ui(a),Dc(t.stateNode,t.type,a))}}function Mg(t){zn?Bn?Bn.push(t):Bn=[t]:zn=t}function Ug(){if(zn){var t=zn,a=Bn;if(Bn=zn=null,Zh(t),a)for(t=0;t<a.length;t++)Zh(a[t])}}function Og(t,a){return t(a)}function $g(){}var Ao=!1;function Ig(t,a,s){if(Ao)return t(a,s);Ao=!0;try{return Og(t,a,s)}finally{Ao=!1,(zn!==null||Bn!==null)&&($g(),Ug())}}function zl(t,a){var s=t.stateNode;if(s===null)return null;var n=Ui(s);if(n===null)return null;s=n[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(Ee(231,a,typeof s));return s}var Rc=!1;if(us)try{var ul={};Object.defineProperty(ul,"passive",{get:function(){Rc=!0}}),window.addEventListener("test",ul,ul),window.removeEventListener("test",ul,ul)}catch{Rc=!1}function Ry(t,a,s,n,l,r,o,u,c){var d=Array.prototype.slice.call(arguments,3);try{a.apply(s,d)}catch(h){this.onError(h)}}var El=!1,li=null,ri=!1,Lc=null,Ly={onError:function(t){El=!0,li=t}};function My(t,a,s,n,l,r,o,u,c){El=!1,li=null,Ry.apply(Ly,arguments)}function Uy(t,a,s,n,l,r,o,u,c){if(My.apply(this,arguments),El){if(El){var d=li;El=!1,li=null}else throw Error(Ee(198));ri||(ri=!0,Lc=d)}}function gn(t){var a=t,s=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,a.flags&4098&&(s=a.return),t=a.return;while(t)}return a.tag===3?s:null}function Fg(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function Xh(t){if(gn(t)!==t)throw Error(Ee(188))}function Oy(t){var a=t.alternate;if(!a){if(a=gn(t),a===null)throw Error(Ee(188));return a!==t?null:t}for(var s=t,n=a;;){var l=s.return;if(l===null)break;var r=l.alternate;if(r===null){if(n=l.return,n!==null){s=n;continue}break}if(l.child===r.child){for(r=l.child;r;){if(r===s)return Xh(l),t;if(r===n)return Xh(l),a;r=r.sibling}throw Error(Ee(188))}if(s.return!==n.return)s=l,n=r;else{for(var o=!1,u=l.child;u;){if(u===s){o=!0,s=l,n=r;break}if(u===n){o=!0,n=l,s=r;break}u=u.sibling}if(!o){for(u=r.child;u;){if(u===s){o=!0,s=r,n=l;break}if(u===n){o=!0,n=r,s=l;break}u=u.sibling}if(!o)throw Error(Ee(189))}}if(s.alternate!==n)throw Error(Ee(190))}if(s.tag!==3)throw Error(Ee(188));return s.stateNode.current===s?t:a}function zg(t){return t=Oy(t),t!==null?Bg(t):null}function Bg(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var a=Bg(t);if(a!==null)return a;t=t.sibling}return null}var Wg=Pa.unstable_scheduleCallback,ep=Pa.unstable_cancelCallback,$y=Pa.unstable_shouldYield,Iy=Pa.unstable_requestPaint,Bt=Pa.unstable_now,Fy=Pa.unstable_getCurrentPriorityLevel,Ed=Pa.unstable_ImmediatePriority,Vg=Pa.unstable_UserBlockingPriority,ii=Pa.unstable_NormalPriority,zy=Pa.unstable_LowPriority,Gg=Pa.unstable_IdlePriority,Di=null,as=null;function By(t){if(as&&typeof as.onCommitFiberRoot=="function")try{as.onCommitFiberRoot(Di,t,void 0,(t.current.flags&128)===128)}catch{}}var Ja=Math.clz32?Math.clz32:Gy,Wy=Math.log,Vy=Math.LN2;function Gy(t){return t>>>=0,t===0?32:31-(Wy(t)/Vy|0)|0}var Nr=64,_r=4194304;function wl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function oi(t,a){var s=t.pendingLanes;if(s===0)return 0;var n=0,l=t.suspendedLanes,r=t.pingedLanes,o=s&268435455;if(o!==0){var u=o&~l;u!==0?n=wl(u):(r&=o,r!==0&&(n=wl(r)))}else o=s&~l,o!==0?n=wl(o):r!==0&&(n=wl(r));if(n===0)return 0;if(a!==0&&a!==n&&!(a&l)&&(l=n&-n,r=a&-a,l>=r||l===16&&(r&4194240)!==0))return a;if(n&4&&(n|=s&16),a=t.entangledLanes,a!==0)for(t=t.entanglements,a&=n;0<a;)s=31-Ja(a),l=1<<s,n|=t[s],a&=~l;return n}function Hy(t,a){switch(t){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qy(t,a){for(var s=t.suspendedLanes,n=t.pingedLanes,l=t.expirationTimes,r=t.pendingLanes;0<r;){var o=31-Ja(r),u=1<<o,c=l[o];c===-1?(!(u&s)||u&n)&&(l[o]=Hy(u,a)):c<=a&&(t.expiredLanes|=u),r&=~u}}function Mc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Hg(){var t=Nr;return Nr<<=1,!(Nr&4194240)&&(Nr=64),t}function To(t){for(var a=[],s=0;31>s;s++)a.push(t);return a}function lr(t,a,s){t.pendingLanes|=a,a!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,a=31-Ja(a),t[a]=s}function Qy(t,a){var s=t.pendingLanes&~a;t.pendingLanes=a,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=a,t.mutableReadLanes&=a,t.entangledLanes&=a,a=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<s;){var l=31-Ja(s),r=1<<l;a[l]=0,n[l]=-1,t[l]=-1,s&=~r}}function Ad(t,a){var s=t.entangledLanes|=a;for(t=t.entanglements;s;){var n=31-Ja(s),l=1<<n;l&a|t[n]&a&&(t[n]|=a),s&=~l}}var _t=0;function qg(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Qg,Td,Jg,Kg,Yg,Uc=!1,Sr=[],Ls=null,Ms=null,Us=null,Bl=new Map,Wl=new Map,Es=[],Jy="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tp(t,a){switch(t){case"focusin":case"focusout":Ls=null;break;case"dragenter":case"dragleave":Ms=null;break;case"mouseover":case"mouseout":Us=null;break;case"pointerover":case"pointerout":Bl.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Wl.delete(a.pointerId)}}function ml(t,a,s,n,l,r){return t===null||t.nativeEvent!==r?(t={blockedOn:a,domEventName:s,eventSystemFlags:n,nativeEvent:r,targetContainers:[l]},a!==null&&(a=ir(a),a!==null&&Td(a)),t):(t.eventSystemFlags|=n,a=t.targetContainers,l!==null&&a.indexOf(l)===-1&&a.push(l),t)}function Ky(t,a,s,n,l){switch(a){case"focusin":return Ls=ml(Ls,t,a,s,n,l),!0;case"dragenter":return Ms=ml(Ms,t,a,s,n,l),!0;case"mouseover":return Us=ml(Us,t,a,s,n,l),!0;case"pointerover":var r=l.pointerId;return Bl.set(r,ml(Bl.get(r)||null,t,a,s,n,l)),!0;case"gotpointercapture":return r=l.pointerId,Wl.set(r,ml(Wl.get(r)||null,t,a,s,n,l)),!0}return!1}function Zg(t){var a=sn(t.target);if(a!==null){var s=gn(a);if(s!==null){if(a=s.tag,a===13){if(a=Fg(s),a!==null){t.blockedOn=a,Yg(t.priority,function(){Jg(s)});return}}else if(a===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hr(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var s=Oc(t.domEventName,t.eventSystemFlags,a[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var n=new s.constructor(s.type,s);Tc=n,s.target.dispatchEvent(n),Tc=null}else return a=ir(s),a!==null&&Td(a),t.blockedOn=s,!1;a.shift()}return!0}function ap(t,a,s){Hr(t)&&s.delete(a)}function Yy(){Uc=!1,Ls!==null&&Hr(Ls)&&(Ls=null),Ms!==null&&Hr(Ms)&&(Ms=null),Us!==null&&Hr(Us)&&(Us=null),Bl.forEach(ap),Wl.forEach(ap)}function hl(t,a){t.blockedOn===a&&(t.blockedOn=null,Uc||(Uc=!0,Pa.unstable_scheduleCallback(Pa.unstable_NormalPriority,Yy)))}function Vl(t){function a(l){return hl(l,t)}if(0<Sr.length){hl(Sr[0],t);for(var s=1;s<Sr.length;s++){var n=Sr[s];n.blockedOn===t&&(n.blockedOn=null)}}for(Ls!==null&&hl(Ls,t),Ms!==null&&hl(Ms,t),Us!==null&&hl(Us,t),Bl.forEach(a),Wl.forEach(a),s=0;s<Es.length;s++)n=Es[s],n.blockedOn===t&&(n.blockedOn=null);for(;0<Es.length&&(s=Es[0],s.blockedOn===null);)Zg(s),s.blockedOn===null&&Es.shift()}var Wn=fs.ReactCurrentBatchConfig,ci=!0;function Zy(t,a,s,n){var l=_t,r=Wn.transition;Wn.transition=null;try{_t=1,Dd(t,a,s,n)}finally{_t=l,Wn.transition=r}}function Xy(t,a,s,n){var l=_t,r=Wn.transition;Wn.transition=null;try{_t=4,Dd(t,a,s,n)}finally{_t=l,Wn.transition=r}}function Dd(t,a,s,n){if(ci){var l=Oc(t,a,s,n);if(l===null)zo(t,a,n,di,s),tp(t,n);else if(Ky(l,t,a,s,n))n.stopPropagation();else if(tp(t,n),a&4&&-1<Jy.indexOf(t)){for(;l!==null;){var r=ir(l);if(r!==null&&Qg(r),r=Oc(t,a,s,n),r===null&&zo(t,a,n,di,s),r===l)break;l=r}l!==null&&n.stopPropagation()}else zo(t,a,n,null,s)}}var di=null;function Oc(t,a,s,n){if(di=null,t=Pd(n),t=sn(t),t!==null)if(a=gn(t),a===null)t=null;else if(s=a.tag,s===13){if(t=Fg(a),t!==null)return t;t=null}else if(s===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null);return di=t,null}function Xg(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Fy()){case Ed:return 1;case Vg:return 4;case ii:case zy:return 16;case Gg:return 536870912;default:return 16}default:return 16}}var Ts=null,Rd=null,qr=null;function ex(){if(qr)return qr;var t,a=Rd,s=a.length,n,l="value"in Ts?Ts.value:Ts.textContent,r=l.length;for(t=0;t<s&&a[t]===l[t];t++);var o=s-t;for(n=1;n<=o&&a[s-n]===l[r-n];n++);return qr=l.slice(t,1<n?1-n:void 0)}function Qr(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function wr(){return!0}function sp(){return!1}function Aa(t){function a(s,n,l,r,o){this._reactName=s,this._targetInst=l,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(s=t[u],this[u]=s?s(r):r[u]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?wr:sp,this.isPropagationStopped=sp,this}return Mt(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=wr)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=wr)},persist:function(){},isPersistent:wr}),a}var al={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ld=Aa(al),rr=Mt({},al,{view:0,detail:0}),ev=Aa(rr),Do,Ro,pl,Ri=Mt({},rr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Md,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==pl&&(pl&&t.type==="mousemove"?(Do=t.screenX-pl.screenX,Ro=t.screenY-pl.screenY):Ro=Do=0,pl=t),Do)},movementY:function(t){return"movementY"in t?t.movementY:Ro}}),np=Aa(Ri),tv=Mt({},Ri,{dataTransfer:0}),av=Aa(tv),sv=Mt({},rr,{relatedTarget:0}),Lo=Aa(sv),nv=Mt({},al,{animationName:0,elapsedTime:0,pseudoElement:0}),lv=Aa(nv),rv=Mt({},al,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),iv=Aa(rv),ov=Mt({},al,{data:0}),lp=Aa(ov),cv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mv(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=uv[t])?!!a[t]:!1}function Md(){return mv}var hv=Mt({},rr,{key:function(t){if(t.key){var a=cv[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=Qr(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?dv[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Md,charCode:function(t){return t.type==="keypress"?Qr(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Qr(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),pv=Aa(hv),fv=Mt({},Ri,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rp=Aa(fv),gv=Mt({},rr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Md}),xv=Aa(gv),bv=Mt({},al,{propertyName:0,elapsedTime:0,pseudoElement:0}),jv=Aa(bv),yv=Mt({},Ri,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),vv=Aa(yv),Nv=[9,13,27,32],Ud=us&&"CompositionEvent"in window,Al=null;us&&"documentMode"in document&&(Al=document.documentMode);var _v=us&&"TextEvent"in window&&!Al,tx=us&&(!Ud||Al&&8<Al&&11>=Al),ip=" ",op=!1;function ax(t,a){switch(t){case"keyup":return Nv.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var An=!1;function Sv(t,a){switch(t){case"compositionend":return sx(a);case"keypress":return a.which!==32?null:(op=!0,ip);case"textInput":return t=a.data,t===ip&&op?null:t;default:return null}}function wv(t,a){if(An)return t==="compositionend"||!Ud&&ax(t,a)?(t=ex(),qr=Rd=Ts=null,An=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return tx&&a.locale!=="ko"?null:a.data;default:return null}}var kv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cp(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!kv[t.type]:a==="textarea"}function nx(t,a,s,n){Mg(n),a=ui(a,"onChange"),0<a.length&&(s=new Ld("onChange","change",null,s,n),t.push({event:s,listeners:a}))}var Tl=null,Gl=null;function Cv(t){fx(t,0)}function Li(t){var a=Rn(t);if(Pg(a))return t}function Pv(t,a){if(t==="change")return a}var lx=!1;if(us){var Mo;if(us){var Uo="oninput"in document;if(!Uo){var dp=document.createElement("div");dp.setAttribute("oninput","return;"),Uo=typeof dp.oninput=="function"}Mo=Uo}else Mo=!1;lx=Mo&&(!document.documentMode||9<document.documentMode)}function up(){Tl&&(Tl.detachEvent("onpropertychange",rx),Gl=Tl=null)}function rx(t){if(t.propertyName==="value"&&Li(Gl)){var a=[];nx(a,Gl,t,Pd(t)),Ig(Cv,a)}}function Ev(t,a,s){t==="focusin"?(up(),Tl=a,Gl=s,Tl.attachEvent("onpropertychange",rx)):t==="focusout"&&up()}function Av(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Li(Gl)}function Tv(t,a){if(t==="click")return Li(a)}function Dv(t,a){if(t==="input"||t==="change")return Li(a)}function Rv(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var Ya=typeof Object.is=="function"?Object.is:Rv;function Hl(t,a){if(Ya(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var s=Object.keys(t),n=Object.keys(a);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var l=s[n];if(!jc.call(a,l)||!Ya(t[l],a[l]))return!1}return!0}function mp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function hp(t,a){var s=mp(t);t=0;for(var n;s;){if(s.nodeType===3){if(n=t+s.textContent.length,t<=a&&n>=a)return{node:s,offset:a-t};t=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=mp(s)}}function ix(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?ix(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function ox(){for(var t=window,a=ni();a instanceof t.HTMLIFrameElement;){try{var s=typeof a.contentWindow.location.href=="string"}catch{s=!1}if(s)t=a.contentWindow;else break;a=ni(t.document)}return a}function Od(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}function Lv(t){var a=ox(),s=t.focusedElem,n=t.selectionRange;if(a!==s&&s&&s.ownerDocument&&ix(s.ownerDocument.documentElement,s)){if(n!==null&&Od(s)){if(a=n.start,t=n.end,t===void 0&&(t=a),"selectionStart"in s)s.selectionStart=a,s.selectionEnd=Math.min(t,s.value.length);else if(t=(a=s.ownerDocument||document)&&a.defaultView||window,t.getSelection){t=t.getSelection();var l=s.textContent.length,r=Math.min(n.start,l);n=n.end===void 0?r:Math.min(n.end,l),!t.extend&&r>n&&(l=n,n=r,r=l),l=hp(s,r);var o=hp(s,n);l&&o&&(t.rangeCount!==1||t.anchorNode!==l.node||t.anchorOffset!==l.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(a=a.createRange(),a.setStart(l.node,l.offset),t.removeAllRanges(),r>n?(t.addRange(a),t.extend(o.node,o.offset)):(a.setEnd(o.node,o.offset),t.addRange(a)))}}for(a=[],t=s;t=t.parentNode;)t.nodeType===1&&a.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<a.length;s++)t=a[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Mv=us&&"documentMode"in document&&11>=document.documentMode,Tn=null,$c=null,Dl=null,Ic=!1;function pp(t,a,s){var n=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Ic||Tn==null||Tn!==ni(n)||(n=Tn,"selectionStart"in n&&Od(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Dl&&Hl(Dl,n)||(Dl=n,n=ui($c,"onSelect"),0<n.length&&(a=new Ld("onSelect","select",null,a,s),t.push({event:a,listeners:n}),a.target=Tn)))}function kr(t,a){var s={};return s[t.toLowerCase()]=a.toLowerCase(),s["Webkit"+t]="webkit"+a,s["Moz"+t]="moz"+a,s}var Dn={animationend:kr("Animation","AnimationEnd"),animationiteration:kr("Animation","AnimationIteration"),animationstart:kr("Animation","AnimationStart"),transitionend:kr("Transition","TransitionEnd")},Oo={},cx={};us&&(cx=document.createElement("div").style,"AnimationEvent"in window||(delete Dn.animationend.animation,delete Dn.animationiteration.animation,delete Dn.animationstart.animation),"TransitionEvent"in window||delete Dn.transitionend.transition);function Mi(t){if(Oo[t])return Oo[t];if(!Dn[t])return t;var a=Dn[t],s;for(s in a)if(a.hasOwnProperty(s)&&s in cx)return Oo[t]=a[s];return t}var dx=Mi("animationend"),ux=Mi("animationiteration"),mx=Mi("animationstart"),hx=Mi("transitionend"),px=new Map,fp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Gs(t,a){px.set(t,a),fn(a,[t])}for(var $o=0;$o<fp.length;$o++){var Io=fp[$o],Uv=Io.toLowerCase(),Ov=Io[0].toUpperCase()+Io.slice(1);Gs(Uv,"on"+Ov)}Gs(dx,"onAnimationEnd");Gs(ux,"onAnimationIteration");Gs(mx,"onAnimationStart");Gs("dblclick","onDoubleClick");Gs("focusin","onFocus");Gs("focusout","onBlur");Gs(hx,"onTransitionEnd");Hn("onMouseEnter",["mouseout","mouseover"]);Hn("onMouseLeave",["mouseout","mouseover"]);Hn("onPointerEnter",["pointerout","pointerover"]);Hn("onPointerLeave",["pointerout","pointerover"]);fn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fn("onBeforeInput",["compositionend","keypress","textInput","paste"]);fn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$v=new Set("cancel close invalid load scroll toggle".split(" ").concat(kl));function gp(t,a,s){var n=t.type||"unknown-event";t.currentTarget=s,Uy(n,a,void 0,t),t.currentTarget=null}function fx(t,a){a=(a&4)!==0;for(var s=0;s<t.length;s++){var n=t[s],l=n.event;n=n.listeners;e:{var r=void 0;if(a)for(var o=n.length-1;0<=o;o--){var u=n[o],c=u.instance,d=u.currentTarget;if(u=u.listener,c!==r&&l.isPropagationStopped())break e;gp(l,u,d),r=c}else for(o=0;o<n.length;o++){if(u=n[o],c=u.instance,d=u.currentTarget,u=u.listener,c!==r&&l.isPropagationStopped())break e;gp(l,u,d),r=c}}}if(ri)throw t=Lc,ri=!1,Lc=null,t}function Ct(t,a){var s=a[Vc];s===void 0&&(s=a[Vc]=new Set);var n=t+"__bubble";s.has(n)||(gx(a,t,2,!1),s.add(n))}function Fo(t,a,s){var n=0;a&&(n|=4),gx(s,t,n,a)}var Cr="_reactListening"+Math.random().toString(36).slice(2);function ql(t){if(!t[Cr]){t[Cr]=!0,_g.forEach(function(s){s!=="selectionchange"&&($v.has(s)||Fo(s,!1,t),Fo(s,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[Cr]||(a[Cr]=!0,Fo("selectionchange",!1,a))}}function gx(t,a,s,n){switch(Xg(a)){case 1:var l=Zy;break;case 4:l=Xy;break;default:l=Dd}s=l.bind(null,a,s,t),l=void 0,!Rc||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(l=!0),n?l!==void 0?t.addEventListener(a,s,{capture:!0,passive:l}):t.addEventListener(a,s,!0):l!==void 0?t.addEventListener(a,s,{passive:l}):t.addEventListener(a,s,!1)}function zo(t,a,s,n,l){var r=n;if(!(a&1)&&!(a&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var u=n.stateNode.containerInfo;if(u===l||u.nodeType===8&&u.parentNode===l)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===l||c.nodeType===8&&c.parentNode===l))return;o=o.return}for(;u!==null;){if(o=sn(u),o===null)return;if(c=o.tag,c===5||c===6){n=r=o;continue e}u=u.parentNode}}n=n.return}Ig(function(){var d=r,h=Pd(s),p=[];e:{var g=px.get(t);if(g!==void 0){var N=Ld,v=t;switch(t){case"keypress":if(Qr(s)===0)break e;case"keydown":case"keyup":N=pv;break;case"focusin":v="focus",N=Lo;break;case"focusout":v="blur",N=Lo;break;case"beforeblur":case"afterblur":N=Lo;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=np;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=av;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=xv;break;case dx:case ux:case mx:N=lv;break;case hx:N=jv;break;case"scroll":N=ev;break;case"wheel":N=vv;break;case"copy":case"cut":case"paste":N=iv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=rp}var w=(a&4)!==0,A=!w&&t==="scroll",y=w?g!==null?g+"Capture":null:g;w=[];for(var x=d,f;x!==null;){f=x;var b=f.stateNode;if(f.tag===5&&b!==null&&(f=b,y!==null&&(b=zl(x,y),b!=null&&w.push(Ql(x,b,f)))),A)break;x=x.return}0<w.length&&(g=new N(g,v,null,s,h),p.push({event:g,listeners:w}))}}if(!(a&7)){e:{if(g=t==="mouseover"||t==="pointerover",N=t==="mouseout"||t==="pointerout",g&&s!==Tc&&(v=s.relatedTarget||s.fromElement)&&(sn(v)||v[ms]))break e;if((N||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,N?(v=s.relatedTarget||s.toElement,N=d,v=v?sn(v):null,v!==null&&(A=gn(v),v!==A||v.tag!==5&&v.tag!==6)&&(v=null)):(N=null,v=d),N!==v)){if(w=np,b="onMouseLeave",y="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(w=rp,b="onPointerLeave",y="onPointerEnter",x="pointer"),A=N==null?g:Rn(N),f=v==null?g:Rn(v),g=new w(b,x+"leave",N,s,h),g.target=A,g.relatedTarget=f,b=null,sn(h)===d&&(w=new w(y,x+"enter",v,s,h),w.target=f,w.relatedTarget=A,b=w),A=b,N&&v)t:{for(w=N,y=v,x=0,f=w;f;f=wn(f))x++;for(f=0,b=y;b;b=wn(b))f++;for(;0<x-f;)w=wn(w),x--;for(;0<f-x;)y=wn(y),f--;for(;x--;){if(w===y||y!==null&&w===y.alternate)break t;w=wn(w),y=wn(y)}w=null}else w=null;N!==null&&xp(p,g,N,w,!1),v!==null&&A!==null&&xp(p,A,v,w,!0)}}e:{if(g=d?Rn(d):window,N=g.nodeName&&g.nodeName.toLowerCase(),N==="select"||N==="input"&&g.type==="file")var k=Pv;else if(cp(g))if(lx)k=Dv;else{k=Av;var _=Ev}else(N=g.nodeName)&&N.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(k=Tv);if(k&&(k=k(t,d))){nx(p,k,s,h);break e}_&&_(t,g,d),t==="focusout"&&(_=g._wrapperState)&&_.controlled&&g.type==="number"&&kc(g,"number",g.value)}switch(_=d?Rn(d):window,t){case"focusin":(cp(_)||_.contentEditable==="true")&&(Tn=_,$c=d,Dl=null);break;case"focusout":Dl=$c=Tn=null;break;case"mousedown":Ic=!0;break;case"contextmenu":case"mouseup":case"dragend":Ic=!1,pp(p,s,h);break;case"selectionchange":if(Mv)break;case"keydown":case"keyup":pp(p,s,h)}var P;if(Ud)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else An?ax(t,s)&&(S="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(S="onCompositionStart");S&&(tx&&s.locale!=="ko"&&(An||S!=="onCompositionStart"?S==="onCompositionEnd"&&An&&(P=ex()):(Ts=h,Rd="value"in Ts?Ts.value:Ts.textContent,An=!0)),_=ui(d,S),0<_.length&&(S=new lp(S,t,null,s,h),p.push({event:S,listeners:_}),P?S.data=P:(P=sx(s),P!==null&&(S.data=P)))),(P=_v?Sv(t,s):wv(t,s))&&(d=ui(d,"onBeforeInput"),0<d.length&&(h=new lp("onBeforeInput","beforeinput",null,s,h),p.push({event:h,listeners:d}),h.data=P))}fx(p,a)})}function Ql(t,a,s){return{instance:t,listener:a,currentTarget:s}}function ui(t,a){for(var s=a+"Capture",n=[];t!==null;){var l=t,r=l.stateNode;l.tag===5&&r!==null&&(l=r,r=zl(t,s),r!=null&&n.unshift(Ql(t,r,l)),r=zl(t,a),r!=null&&n.push(Ql(t,r,l))),t=t.return}return n}function wn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function xp(t,a,s,n,l){for(var r=a._reactName,o=[];s!==null&&s!==n;){var u=s,c=u.alternate,d=u.stateNode;if(c!==null&&c===n)break;u.tag===5&&d!==null&&(u=d,l?(c=zl(s,r),c!=null&&o.unshift(Ql(s,c,u))):l||(c=zl(s,r),c!=null&&o.push(Ql(s,c,u)))),s=s.return}o.length!==0&&t.push({event:a,listeners:o})}var Iv=/\r\n?/g,Fv=/\u0000|\uFFFD/g;function bp(t){return(typeof t=="string"?t:""+t).replace(Iv,`
`).replace(Fv,"")}function Pr(t,a,s){if(a=bp(a),bp(t)!==a&&s)throw Error(Ee(425))}function mi(){}var Fc=null,zc=null;function Bc(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Wc=typeof setTimeout=="function"?setTimeout:void 0,zv=typeof clearTimeout=="function"?clearTimeout:void 0,jp=typeof Promise=="function"?Promise:void 0,Bv=typeof queueMicrotask=="function"?queueMicrotask:typeof jp<"u"?function(t){return jp.resolve(null).then(t).catch(Wv)}:Wc;function Wv(t){setTimeout(function(){throw t})}function Bo(t,a){var s=a,n=0;do{var l=s.nextSibling;if(t.removeChild(s),l&&l.nodeType===8)if(s=l.data,s==="/$"){if(n===0){t.removeChild(l),Vl(a);return}n--}else s!=="$"&&s!=="$?"&&s!=="$!"||n++;s=l}while(s);Vl(a)}function Os(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return t}function yp(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(a===0)return t;a--}else s==="/$"&&a++}t=t.previousSibling}return null}var sl=Math.random().toString(36).slice(2),ts="__reactFiber$"+sl,Jl="__reactProps$"+sl,ms="__reactContainer$"+sl,Vc="__reactEvents$"+sl,Vv="__reactListeners$"+sl,Gv="__reactHandles$"+sl;function sn(t){var a=t[ts];if(a)return a;for(var s=t.parentNode;s;){if(a=s[ms]||s[ts]){if(s=a.alternate,a.child!==null||s!==null&&s.child!==null)for(t=yp(t);t!==null;){if(s=t[ts])return s;t=yp(t)}return a}t=s,s=t.parentNode}return null}function ir(t){return t=t[ts]||t[ms],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Rn(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ee(33))}function Ui(t){return t[Jl]||null}var Gc=[],Ln=-1;function Hs(t){return{current:t}}function Pt(t){0>Ln||(t.current=Gc[Ln],Gc[Ln]=null,Ln--)}function wt(t,a){Ln++,Gc[Ln]=t.current,t.current=a}var Vs={},da=Hs(Vs),ya=Hs(!1),dn=Vs;function qn(t,a){var s=t.type.contextTypes;if(!s)return Vs;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===a)return n.__reactInternalMemoizedMaskedChildContext;var l={},r;for(r in s)l[r]=a[r];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=l),l}function va(t){return t=t.childContextTypes,t!=null}function hi(){Pt(ya),Pt(da)}function vp(t,a,s){if(da.current!==Vs)throw Error(Ee(168));wt(da,a),wt(ya,s)}function xx(t,a,s){var n=t.stateNode;if(a=a.childContextTypes,typeof n.getChildContext!="function")return s;n=n.getChildContext();for(var l in n)if(!(l in a))throw Error(Ee(108,Ey(t)||"Unknown",l));return Mt({},s,n)}function pi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Vs,dn=da.current,wt(da,t),wt(ya,ya.current),!0}function Np(t,a,s){var n=t.stateNode;if(!n)throw Error(Ee(169));s?(t=xx(t,a,dn),n.__reactInternalMemoizedMergedChildContext=t,Pt(ya),Pt(da),wt(da,t)):Pt(ya),wt(ya,s)}var is=null,Oi=!1,Wo=!1;function bx(t){is===null?is=[t]:is.push(t)}function Hv(t){Oi=!0,bx(t)}function qs(){if(!Wo&&is!==null){Wo=!0;var t=0,a=_t;try{var s=is;for(_t=1;t<s.length;t++){var n=s[t];do n=n(!0);while(n!==null)}is=null,Oi=!1}catch(l){throw is!==null&&(is=is.slice(t+1)),Wg(Ed,qs),l}finally{_t=a,Wo=!1}}return null}var Mn=[],Un=0,fi=null,gi=0,Ma=[],Ua=0,un=null,os=1,cs="";function tn(t,a){Mn[Un++]=gi,Mn[Un++]=fi,fi=t,gi=a}function jx(t,a,s){Ma[Ua++]=os,Ma[Ua++]=cs,Ma[Ua++]=un,un=t;var n=os;t=cs;var l=32-Ja(n)-1;n&=~(1<<l),s+=1;var r=32-Ja(a)+l;if(30<r){var o=l-l%5;r=(n&(1<<o)-1).toString(32),n>>=o,l-=o,os=1<<32-Ja(a)+l|s<<l|n,cs=r+t}else os=1<<r|s<<l|n,cs=t}function $d(t){t.return!==null&&(tn(t,1),jx(t,1,0))}function Id(t){for(;t===fi;)fi=Mn[--Un],Mn[Un]=null,gi=Mn[--Un],Mn[Un]=null;for(;t===un;)un=Ma[--Ua],Ma[Ua]=null,cs=Ma[--Ua],Ma[Ua]=null,os=Ma[--Ua],Ma[Ua]=null}var Ca=null,ka=null,Et=!1,Qa=null;function yx(t,a){var s=Oa(5,null,null,0);s.elementType="DELETED",s.stateNode=a,s.return=t,a=t.deletions,a===null?(t.deletions=[s],t.flags|=16):a.push(s)}function _p(t,a){switch(t.tag){case 5:var s=t.type;return a=a.nodeType!==1||s.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(t.stateNode=a,Ca=t,ka=Os(a.firstChild),!0):!1;case 6:return a=t.pendingProps===""||a.nodeType!==3?null:a,a!==null?(t.stateNode=a,Ca=t,ka=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(s=un!==null?{id:os,overflow:cs}:null,t.memoizedState={dehydrated:a,treeContext:s,retryLane:1073741824},s=Oa(18,null,null,0),s.stateNode=a,s.return=t,t.child=s,Ca=t,ka=null,!0):!1;default:return!1}}function Hc(t){return(t.mode&1)!==0&&(t.flags&128)===0}function qc(t){if(Et){var a=ka;if(a){var s=a;if(!_p(t,a)){if(Hc(t))throw Error(Ee(418));a=Os(s.nextSibling);var n=Ca;a&&_p(t,a)?yx(n,s):(t.flags=t.flags&-4097|2,Et=!1,Ca=t)}}else{if(Hc(t))throw Error(Ee(418));t.flags=t.flags&-4097|2,Et=!1,Ca=t}}}function Sp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ca=t}function Er(t){if(t!==Ca)return!1;if(!Et)return Sp(t),Et=!0,!1;var a;if((a=t.tag!==3)&&!(a=t.tag!==5)&&(a=t.type,a=a!=="head"&&a!=="body"&&!Bc(t.type,t.memoizedProps)),a&&(a=ka)){if(Hc(t))throw vx(),Error(Ee(418));for(;a;)yx(t,a),a=Os(a.nextSibling)}if(Sp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ee(317));e:{for(t=t.nextSibling,a=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(a===0){ka=Os(t.nextSibling);break e}a--}else s!=="$"&&s!=="$!"&&s!=="$?"||a++}t=t.nextSibling}ka=null}}else ka=Ca?Os(t.stateNode.nextSibling):null;return!0}function vx(){for(var t=ka;t;)t=Os(t.nextSibling)}function Qn(){ka=Ca=null,Et=!1}function Fd(t){Qa===null?Qa=[t]:Qa.push(t)}var qv=fs.ReactCurrentBatchConfig;function fl(t,a,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(Ee(309));var n=s.stateNode}if(!n)throw Error(Ee(147,t));var l=n,r=""+t;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===r?a.ref:(a=function(o){var u=l.refs;o===null?delete u[r]:u[r]=o},a._stringRef=r,a)}if(typeof t!="string")throw Error(Ee(284));if(!s._owner)throw Error(Ee(290,t))}return t}function Ar(t,a){throw t=Object.prototype.toString.call(a),Error(Ee(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t))}function wp(t){var a=t._init;return a(t._payload)}function Nx(t){function a(y,x){if(t){var f=y.deletions;f===null?(y.deletions=[x],y.flags|=16):f.push(x)}}function s(y,x){if(!t)return null;for(;x!==null;)a(y,x),x=x.sibling;return null}function n(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function l(y,x){return y=zs(y,x),y.index=0,y.sibling=null,y}function r(y,x,f){return y.index=f,t?(f=y.alternate,f!==null?(f=f.index,f<x?(y.flags|=2,x):f):(y.flags|=2,x)):(y.flags|=1048576,x)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function u(y,x,f,b){return x===null||x.tag!==6?(x=Ko(f,y.mode,b),x.return=y,x):(x=l(x,f),x.return=y,x)}function c(y,x,f,b){var k=f.type;return k===En?h(y,x,f.props.children,b,f.key):x!==null&&(x.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Cs&&wp(k)===x.type)?(b=l(x,f.props),b.ref=fl(y,x,f),b.return=y,b):(b=ti(f.type,f.key,f.props,null,y.mode,b),b.ref=fl(y,x,f),b.return=y,b)}function d(y,x,f,b){return x===null||x.tag!==4||x.stateNode.containerInfo!==f.containerInfo||x.stateNode.implementation!==f.implementation?(x=Yo(f,y.mode,b),x.return=y,x):(x=l(x,f.children||[]),x.return=y,x)}function h(y,x,f,b,k){return x===null||x.tag!==7?(x=cn(f,y.mode,b,k),x.return=y,x):(x=l(x,f),x.return=y,x)}function p(y,x,f){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Ko(""+x,y.mode,f),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case jr:return f=ti(x.type,x.key,x.props,null,y.mode,f),f.ref=fl(y,null,x),f.return=y,f;case Pn:return x=Yo(x,y.mode,f),x.return=y,x;case Cs:var b=x._init;return p(y,b(x._payload),f)}if(Sl(x)||dl(x))return x=cn(x,y.mode,f,null),x.return=y,x;Ar(y,x)}return null}function g(y,x,f,b){var k=x!==null?x.key:null;if(typeof f=="string"&&f!==""||typeof f=="number")return k!==null?null:u(y,x,""+f,b);if(typeof f=="object"&&f!==null){switch(f.$$typeof){case jr:return f.key===k?c(y,x,f,b):null;case Pn:return f.key===k?d(y,x,f,b):null;case Cs:return k=f._init,g(y,x,k(f._payload),b)}if(Sl(f)||dl(f))return k!==null?null:h(y,x,f,b,null);Ar(y,f)}return null}function N(y,x,f,b,k){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(f)||null,u(x,y,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case jr:return y=y.get(b.key===null?f:b.key)||null,c(x,y,b,k);case Pn:return y=y.get(b.key===null?f:b.key)||null,d(x,y,b,k);case Cs:var _=b._init;return N(y,x,f,_(b._payload),k)}if(Sl(b)||dl(b))return y=y.get(f)||null,h(x,y,b,k,null);Ar(x,b)}return null}function v(y,x,f,b){for(var k=null,_=null,P=x,S=x=0,F=null;P!==null&&S<f.length;S++){P.index>S?(F=P,P=null):F=P.sibling;var L=g(y,P,f[S],b);if(L===null){P===null&&(P=F);break}t&&P&&L.alternate===null&&a(y,P),x=r(L,x,S),_===null?k=L:_.sibling=L,_=L,P=F}if(S===f.length)return s(y,P),Et&&tn(y,S),k;if(P===null){for(;S<f.length;S++)P=p(y,f[S],b),P!==null&&(x=r(P,x,S),_===null?k=P:_.sibling=P,_=P);return Et&&tn(y,S),k}for(P=n(y,P);S<f.length;S++)F=N(P,y,S,f[S],b),F!==null&&(t&&F.alternate!==null&&P.delete(F.key===null?S:F.key),x=r(F,x,S),_===null?k=F:_.sibling=F,_=F);return t&&P.forEach(function(Q){return a(y,Q)}),Et&&tn(y,S),k}function w(y,x,f,b){var k=dl(f);if(typeof k!="function")throw Error(Ee(150));if(f=k.call(f),f==null)throw Error(Ee(151));for(var _=k=null,P=x,S=x=0,F=null,L=f.next();P!==null&&!L.done;S++,L=f.next()){P.index>S?(F=P,P=null):F=P.sibling;var Q=g(y,P,L.value,b);if(Q===null){P===null&&(P=F);break}t&&P&&Q.alternate===null&&a(y,P),x=r(Q,x,S),_===null?k=Q:_.sibling=Q,_=Q,P=F}if(L.done)return s(y,P),Et&&tn(y,S),k;if(P===null){for(;!L.done;S++,L=f.next())L=p(y,L.value,b),L!==null&&(x=r(L,x,S),_===null?k=L:_.sibling=L,_=L);return Et&&tn(y,S),k}for(P=n(y,P);!L.done;S++,L=f.next())L=N(P,y,S,L.value,b),L!==null&&(t&&L.alternate!==null&&P.delete(L.key===null?S:L.key),x=r(L,x,S),_===null?k=L:_.sibling=L,_=L);return t&&P.forEach(function(E){return a(y,E)}),Et&&tn(y,S),k}function A(y,x,f,b){if(typeof f=="object"&&f!==null&&f.type===En&&f.key===null&&(f=f.props.children),typeof f=="object"&&f!==null){switch(f.$$typeof){case jr:e:{for(var k=f.key,_=x;_!==null;){if(_.key===k){if(k=f.type,k===En){if(_.tag===7){s(y,_.sibling),x=l(_,f.props.children),x.return=y,y=x;break e}}else if(_.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Cs&&wp(k)===_.type){s(y,_.sibling),x=l(_,f.props),x.ref=fl(y,_,f),x.return=y,y=x;break e}s(y,_);break}else a(y,_);_=_.sibling}f.type===En?(x=cn(f.props.children,y.mode,b,f.key),x.return=y,y=x):(b=ti(f.type,f.key,f.props,null,y.mode,b),b.ref=fl(y,x,f),b.return=y,y=b)}return o(y);case Pn:e:{for(_=f.key;x!==null;){if(x.key===_)if(x.tag===4&&x.stateNode.containerInfo===f.containerInfo&&x.stateNode.implementation===f.implementation){s(y,x.sibling),x=l(x,f.children||[]),x.return=y,y=x;break e}else{s(y,x);break}else a(y,x);x=x.sibling}x=Yo(f,y.mode,b),x.return=y,y=x}return o(y);case Cs:return _=f._init,A(y,x,_(f._payload),b)}if(Sl(f))return v(y,x,f,b);if(dl(f))return w(y,x,f,b);Ar(y,f)}return typeof f=="string"&&f!==""||typeof f=="number"?(f=""+f,x!==null&&x.tag===6?(s(y,x.sibling),x=l(x,f),x.return=y,y=x):(s(y,x),x=Ko(f,y.mode,b),x.return=y,y=x),o(y)):s(y,x)}return A}var Jn=Nx(!0),_x=Nx(!1),xi=Hs(null),bi=null,On=null,zd=null;function Bd(){zd=On=bi=null}function Wd(t){var a=xi.current;Pt(xi),t._currentValue=a}function Qc(t,a,s){for(;t!==null;){var n=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,n!==null&&(n.childLanes|=a)):n!==null&&(n.childLanes&a)!==a&&(n.childLanes|=a),t===s)break;t=t.return}}function Vn(t,a){bi=t,zd=On=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&a&&(ja=!0),t.firstContext=null)}function Ia(t){var a=t._currentValue;if(zd!==t)if(t={context:t,memoizedValue:a,next:null},On===null){if(bi===null)throw Error(Ee(308));On=t,bi.dependencies={lanes:0,firstContext:t}}else On=On.next=t;return a}var nn=null;function Vd(t){nn===null?nn=[t]:nn.push(t)}function Sx(t,a,s,n){var l=a.interleaved;return l===null?(s.next=s,Vd(a)):(s.next=l.next,l.next=s),a.interleaved=s,hs(t,n)}function hs(t,a){t.lanes|=a;var s=t.alternate;for(s!==null&&(s.lanes|=a),s=t,t=t.return;t!==null;)t.childLanes|=a,s=t.alternate,s!==null&&(s.childLanes|=a),s=t,t=t.return;return s.tag===3?s.stateNode:null}var Ps=!1;function Gd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wx(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ds(t,a){return{eventTime:t,lane:a,tag:0,payload:null,callback:null,next:null}}function $s(t,a,s){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,xt&2){var l=n.pending;return l===null?a.next=a:(a.next=l.next,l.next=a),n.pending=a,hs(t,s)}return l=n.interleaved,l===null?(a.next=a,Vd(n)):(a.next=l.next,l.next=a),n.interleaved=a,hs(t,s)}function Jr(t,a,s){if(a=a.updateQueue,a!==null&&(a=a.shared,(s&4194240)!==0)){var n=a.lanes;n&=t.pendingLanes,s|=n,a.lanes=s,Ad(t,s)}}function kp(t,a){var s=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,s===n)){var l=null,r=null;if(s=s.firstBaseUpdate,s!==null){do{var o={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};r===null?l=r=o:r=r.next=o,s=s.next}while(s!==null);r===null?l=r=a:r=r.next=a}else l=r=a;s={baseState:n.baseState,firstBaseUpdate:l,lastBaseUpdate:r,shared:n.shared,effects:n.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=a:t.next=a,s.lastBaseUpdate=a}function ji(t,a,s,n){var l=t.updateQueue;Ps=!1;var r=l.firstBaseUpdate,o=l.lastBaseUpdate,u=l.shared.pending;if(u!==null){l.shared.pending=null;var c=u,d=c.next;c.next=null,o===null?r=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,u=h.lastBaseUpdate,u!==o&&(u===null?h.firstBaseUpdate=d:u.next=d,h.lastBaseUpdate=c))}if(r!==null){var p=l.baseState;o=0,h=d=c=null,u=r;do{var g=u.lane,N=u.eventTime;if((n&g)===g){h!==null&&(h=h.next={eventTime:N,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var v=t,w=u;switch(g=a,N=s,w.tag){case 1:if(v=w.payload,typeof v=="function"){p=v.call(N,p,g);break e}p=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=w.payload,g=typeof v=="function"?v.call(N,p,g):v,g==null)break e;p=Mt({},p,g);break e;case 2:Ps=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,g=l.effects,g===null?l.effects=[u]:g.push(u))}else N={eventTime:N,lane:g,tag:u.tag,payload:u.payload,callback:u.callback,next:null},h===null?(d=h=N,c=p):h=h.next=N,o|=g;if(u=u.next,u===null){if(u=l.shared.pending,u===null)break;g=u,u=g.next,g.next=null,l.lastBaseUpdate=g,l.shared.pending=null}}while(!0);if(h===null&&(c=p),l.baseState=c,l.firstBaseUpdate=d,l.lastBaseUpdate=h,a=l.shared.interleaved,a!==null){l=a;do o|=l.lane,l=l.next;while(l!==a)}else r===null&&(l.shared.lanes=0);hn|=o,t.lanes=o,t.memoizedState=p}}function Cp(t,a,s){if(t=a.effects,a.effects=null,t!==null)for(a=0;a<t.length;a++){var n=t[a],l=n.callback;if(l!==null){if(n.callback=null,n=s,typeof l!="function")throw Error(Ee(191,l));l.call(n)}}}var or={},ss=Hs(or),Kl=Hs(or),Yl=Hs(or);function ln(t){if(t===or)throw Error(Ee(174));return t}function Hd(t,a){switch(wt(Yl,a),wt(Kl,t),wt(ss,or),t=a.nodeType,t){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:Pc(null,"");break;default:t=t===8?a.parentNode:a,a=t.namespaceURI||null,t=t.tagName,a=Pc(a,t)}Pt(ss),wt(ss,a)}function Kn(){Pt(ss),Pt(Kl),Pt(Yl)}function kx(t){ln(Yl.current);var a=ln(ss.current),s=Pc(a,t.type);a!==s&&(wt(Kl,t),wt(ss,s))}function qd(t){Kl.current===t&&(Pt(ss),Pt(Kl))}var Dt=Hs(0);function yi(t){for(var a=t;a!==null;){if(a.tag===13){var s=a.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Vo=[];function Qd(){for(var t=0;t<Vo.length;t++)Vo[t]._workInProgressVersionPrimary=null;Vo.length=0}var Kr=fs.ReactCurrentDispatcher,Go=fs.ReactCurrentBatchConfig,mn=0,Rt=null,Jt=null,Yt=null,vi=!1,Rl=!1,Zl=0,Qv=0;function ra(){throw Error(Ee(321))}function Jd(t,a){if(a===null)return!1;for(var s=0;s<a.length&&s<t.length;s++)if(!Ya(t[s],a[s]))return!1;return!0}function Kd(t,a,s,n,l,r){if(mn=r,Rt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Kr.current=t===null||t.memoizedState===null?Zv:Xv,t=s(n,l),Rl){r=0;do{if(Rl=!1,Zl=0,25<=r)throw Error(Ee(301));r+=1,Yt=Jt=null,a.updateQueue=null,Kr.current=eN,t=s(n,l)}while(Rl)}if(Kr.current=Ni,a=Jt!==null&&Jt.next!==null,mn=0,Yt=Jt=Rt=null,vi=!1,a)throw Error(Ee(300));return t}function Yd(){var t=Zl!==0;return Zl=0,t}function es(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Yt===null?Rt.memoizedState=Yt=t:Yt=Yt.next=t,Yt}function Fa(){if(Jt===null){var t=Rt.alternate;t=t!==null?t.memoizedState:null}else t=Jt.next;var a=Yt===null?Rt.memoizedState:Yt.next;if(a!==null)Yt=a,Jt=t;else{if(t===null)throw Error(Ee(310));Jt=t,t={memoizedState:Jt.memoizedState,baseState:Jt.baseState,baseQueue:Jt.baseQueue,queue:Jt.queue,next:null},Yt===null?Rt.memoizedState=Yt=t:Yt=Yt.next=t}return Yt}function Xl(t,a){return typeof a=="function"?a(t):a}function Ho(t){var a=Fa(),s=a.queue;if(s===null)throw Error(Ee(311));s.lastRenderedReducer=t;var n=Jt,l=n.baseQueue,r=s.pending;if(r!==null){if(l!==null){var o=l.next;l.next=r.next,r.next=o}n.baseQueue=l=r,s.pending=null}if(l!==null){r=l.next,n=n.baseState;var u=o=null,c=null,d=r;do{var h=d.lane;if((mn&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),n=d.hasEagerState?d.eagerState:t(n,d.action);else{var p={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(u=c=p,o=n):c=c.next=p,Rt.lanes|=h,hn|=h}d=d.next}while(d!==null&&d!==r);c===null?o=n:c.next=u,Ya(n,a.memoizedState)||(ja=!0),a.memoizedState=n,a.baseState=o,a.baseQueue=c,s.lastRenderedState=n}if(t=s.interleaved,t!==null){l=t;do r=l.lane,Rt.lanes|=r,hn|=r,l=l.next;while(l!==t)}else l===null&&(s.lanes=0);return[a.memoizedState,s.dispatch]}function qo(t){var a=Fa(),s=a.queue;if(s===null)throw Error(Ee(311));s.lastRenderedReducer=t;var n=s.dispatch,l=s.pending,r=a.memoizedState;if(l!==null){s.pending=null;var o=l=l.next;do r=t(r,o.action),o=o.next;while(o!==l);Ya(r,a.memoizedState)||(ja=!0),a.memoizedState=r,a.baseQueue===null&&(a.baseState=r),s.lastRenderedState=r}return[r,n]}function Cx(){}function Px(t,a){var s=Rt,n=Fa(),l=a(),r=!Ya(n.memoizedState,l);if(r&&(n.memoizedState=l,ja=!0),n=n.queue,Zd(Tx.bind(null,s,n,t),[t]),n.getSnapshot!==a||r||Yt!==null&&Yt.memoizedState.tag&1){if(s.flags|=2048,er(9,Ax.bind(null,s,n,l,a),void 0,null),Zt===null)throw Error(Ee(349));mn&30||Ex(s,a,l)}return l}function Ex(t,a,s){t.flags|=16384,t={getSnapshot:a,value:s},a=Rt.updateQueue,a===null?(a={lastEffect:null,stores:null},Rt.updateQueue=a,a.stores=[t]):(s=a.stores,s===null?a.stores=[t]:s.push(t))}function Ax(t,a,s,n){a.value=s,a.getSnapshot=n,Dx(a)&&Rx(t)}function Tx(t,a,s){return s(function(){Dx(a)&&Rx(t)})}function Dx(t){var a=t.getSnapshot;t=t.value;try{var s=a();return!Ya(t,s)}catch{return!0}}function Rx(t){var a=hs(t,1);a!==null&&Ka(a,t,1,-1)}function Pp(t){var a=es();return typeof t=="function"&&(t=t()),a.memoizedState=a.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xl,lastRenderedState:t},a.queue=t,t=t.dispatch=Yv.bind(null,Rt,t),[a.memoizedState,t]}function er(t,a,s,n){return t={tag:t,create:a,destroy:s,deps:n,next:null},a=Rt.updateQueue,a===null?(a={lastEffect:null,stores:null},Rt.updateQueue=a,a.lastEffect=t.next=t):(s=a.lastEffect,s===null?a.lastEffect=t.next=t:(n=s.next,s.next=t,t.next=n,a.lastEffect=t)),t}function Lx(){return Fa().memoizedState}function Yr(t,a,s,n){var l=es();Rt.flags|=t,l.memoizedState=er(1|a,s,void 0,n===void 0?null:n)}function $i(t,a,s,n){var l=Fa();n=n===void 0?null:n;var r=void 0;if(Jt!==null){var o=Jt.memoizedState;if(r=o.destroy,n!==null&&Jd(n,o.deps)){l.memoizedState=er(a,s,r,n);return}}Rt.flags|=t,l.memoizedState=er(1|a,s,r,n)}function Ep(t,a){return Yr(8390656,8,t,a)}function Zd(t,a){return $i(2048,8,t,a)}function Mx(t,a){return $i(4,2,t,a)}function Ux(t,a){return $i(4,4,t,a)}function Ox(t,a){if(typeof a=="function")return t=t(),a(t),function(){a(null)};if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function $x(t,a,s){return s=s!=null?s.concat([t]):null,$i(4,4,Ox.bind(null,a,t),s)}function Xd(){}function Ix(t,a){var s=Fa();a=a===void 0?null:a;var n=s.memoizedState;return n!==null&&a!==null&&Jd(a,n[1])?n[0]:(s.memoizedState=[t,a],t)}function Fx(t,a){var s=Fa();a=a===void 0?null:a;var n=s.memoizedState;return n!==null&&a!==null&&Jd(a,n[1])?n[0]:(t=t(),s.memoizedState=[t,a],t)}function zx(t,a,s){return mn&21?(Ya(s,a)||(s=Hg(),Rt.lanes|=s,hn|=s,t.baseState=!0),a):(t.baseState&&(t.baseState=!1,ja=!0),t.memoizedState=s)}function Jv(t,a){var s=_t;_t=s!==0&&4>s?s:4,t(!0);var n=Go.transition;Go.transition={};try{t(!1),a()}finally{_t=s,Go.transition=n}}function Bx(){return Fa().memoizedState}function Kv(t,a,s){var n=Fs(t);if(s={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null},Wx(t))Vx(a,s);else if(s=Sx(t,a,s,n),s!==null){var l=pa();Ka(s,t,n,l),Gx(s,a,n)}}function Yv(t,a,s){var n=Fs(t),l={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null};if(Wx(t))Vx(a,l);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=a.lastRenderedReducer,r!==null))try{var o=a.lastRenderedState,u=r(o,s);if(l.hasEagerState=!0,l.eagerState=u,Ya(u,o)){var c=a.interleaved;c===null?(l.next=l,Vd(a)):(l.next=c.next,c.next=l),a.interleaved=l;return}}catch{}finally{}s=Sx(t,a,l,n),s!==null&&(l=pa(),Ka(s,t,n,l),Gx(s,a,n))}}function Wx(t){var a=t.alternate;return t===Rt||a!==null&&a===Rt}function Vx(t,a){Rl=vi=!0;var s=t.pending;s===null?a.next=a:(a.next=s.next,s.next=a),t.pending=a}function Gx(t,a,s){if(s&4194240){var n=a.lanes;n&=t.pendingLanes,s|=n,a.lanes=s,Ad(t,s)}}var Ni={readContext:Ia,useCallback:ra,useContext:ra,useEffect:ra,useImperativeHandle:ra,useInsertionEffect:ra,useLayoutEffect:ra,useMemo:ra,useReducer:ra,useRef:ra,useState:ra,useDebugValue:ra,useDeferredValue:ra,useTransition:ra,useMutableSource:ra,useSyncExternalStore:ra,useId:ra,unstable_isNewReconciler:!1},Zv={readContext:Ia,useCallback:function(t,a){return es().memoizedState=[t,a===void 0?null:a],t},useContext:Ia,useEffect:Ep,useImperativeHandle:function(t,a,s){return s=s!=null?s.concat([t]):null,Yr(4194308,4,Ox.bind(null,a,t),s)},useLayoutEffect:function(t,a){return Yr(4194308,4,t,a)},useInsertionEffect:function(t,a){return Yr(4,2,t,a)},useMemo:function(t,a){var s=es();return a=a===void 0?null:a,t=t(),s.memoizedState=[t,a],t},useReducer:function(t,a,s){var n=es();return a=s!==void 0?s(a):a,n.memoizedState=n.baseState=a,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:a},n.queue=t,t=t.dispatch=Kv.bind(null,Rt,t),[n.memoizedState,t]},useRef:function(t){var a=es();return t={current:t},a.memoizedState=t},useState:Pp,useDebugValue:Xd,useDeferredValue:function(t){return es().memoizedState=t},useTransition:function(){var t=Pp(!1),a=t[0];return t=Jv.bind(null,t[1]),es().memoizedState=t,[a,t]},useMutableSource:function(){},useSyncExternalStore:function(t,a,s){var n=Rt,l=es();if(Et){if(s===void 0)throw Error(Ee(407));s=s()}else{if(s=a(),Zt===null)throw Error(Ee(349));mn&30||Ex(n,a,s)}l.memoizedState=s;var r={value:s,getSnapshot:a};return l.queue=r,Ep(Tx.bind(null,n,r,t),[t]),n.flags|=2048,er(9,Ax.bind(null,n,r,s,a),void 0,null),s},useId:function(){var t=es(),a=Zt.identifierPrefix;if(Et){var s=cs,n=os;s=(n&~(1<<32-Ja(n)-1)).toString(32)+s,a=":"+a+"R"+s,s=Zl++,0<s&&(a+="H"+s.toString(32)),a+=":"}else s=Qv++,a=":"+a+"r"+s.toString(32)+":";return t.memoizedState=a},unstable_isNewReconciler:!1},Xv={readContext:Ia,useCallback:Ix,useContext:Ia,useEffect:Zd,useImperativeHandle:$x,useInsertionEffect:Mx,useLayoutEffect:Ux,useMemo:Fx,useReducer:Ho,useRef:Lx,useState:function(){return Ho(Xl)},useDebugValue:Xd,useDeferredValue:function(t){var a=Fa();return zx(a,Jt.memoizedState,t)},useTransition:function(){var t=Ho(Xl)[0],a=Fa().memoizedState;return[t,a]},useMutableSource:Cx,useSyncExternalStore:Px,useId:Bx,unstable_isNewReconciler:!1},eN={readContext:Ia,useCallback:Ix,useContext:Ia,useEffect:Zd,useImperativeHandle:$x,useInsertionEffect:Mx,useLayoutEffect:Ux,useMemo:Fx,useReducer:qo,useRef:Lx,useState:function(){return qo(Xl)},useDebugValue:Xd,useDeferredValue:function(t){var a=Fa();return Jt===null?a.memoizedState=t:zx(a,Jt.memoizedState,t)},useTransition:function(){var t=qo(Xl)[0],a=Fa().memoizedState;return[t,a]},useMutableSource:Cx,useSyncExternalStore:Px,useId:Bx,unstable_isNewReconciler:!1};function Ha(t,a){if(t&&t.defaultProps){a=Mt({},a),t=t.defaultProps;for(var s in t)a[s]===void 0&&(a[s]=t[s]);return a}return a}function Jc(t,a,s,n){a=t.memoizedState,s=s(n,a),s=s==null?a:Mt({},a,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var Ii={isMounted:function(t){return(t=t._reactInternals)?gn(t)===t:!1},enqueueSetState:function(t,a,s){t=t._reactInternals;var n=pa(),l=Fs(t),r=ds(n,l);r.payload=a,s!=null&&(r.callback=s),a=$s(t,r,l),a!==null&&(Ka(a,t,l,n),Jr(a,t,l))},enqueueReplaceState:function(t,a,s){t=t._reactInternals;var n=pa(),l=Fs(t),r=ds(n,l);r.tag=1,r.payload=a,s!=null&&(r.callback=s),a=$s(t,r,l),a!==null&&(Ka(a,t,l,n),Jr(a,t,l))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var s=pa(),n=Fs(t),l=ds(s,n);l.tag=2,a!=null&&(l.callback=a),a=$s(t,l,n),a!==null&&(Ka(a,t,n,s),Jr(a,t,n))}};function Ap(t,a,s,n,l,r,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,r,o):a.prototype&&a.prototype.isPureReactComponent?!Hl(s,n)||!Hl(l,r):!0}function Hx(t,a,s){var n=!1,l=Vs,r=a.contextType;return typeof r=="object"&&r!==null?r=Ia(r):(l=va(a)?dn:da.current,n=a.contextTypes,r=(n=n!=null)?qn(t,l):Vs),a=new a(s,r),t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Ii,t.stateNode=a,a._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=l,t.__reactInternalMemoizedMaskedChildContext=r),a}function Tp(t,a,s,n){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(s,n),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(s,n),a.state!==t&&Ii.enqueueReplaceState(a,a.state,null)}function Kc(t,a,s,n){var l=t.stateNode;l.props=s,l.state=t.memoizedState,l.refs={},Gd(t);var r=a.contextType;typeof r=="object"&&r!==null?l.context=Ia(r):(r=va(a)?dn:da.current,l.context=qn(t,r)),l.state=t.memoizedState,r=a.getDerivedStateFromProps,typeof r=="function"&&(Jc(t,a,r,s),l.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(a=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),a!==l.state&&Ii.enqueueReplaceState(l,l.state,null),ji(t,s,l,n),l.state=t.memoizedState),typeof l.componentDidMount=="function"&&(t.flags|=4194308)}function Yn(t,a){try{var s="",n=a;do s+=Py(n),n=n.return;while(n);var l=s}catch(r){l=`
Error generating stack: `+r.message+`
`+r.stack}return{value:t,source:a,stack:l,digest:null}}function Qo(t,a,s){return{value:t,source:null,stack:s??null,digest:a??null}}function Yc(t,a){try{console.error(a.value)}catch(s){setTimeout(function(){throw s})}}var tN=typeof WeakMap=="function"?WeakMap:Map;function qx(t,a,s){s=ds(-1,s),s.tag=3,s.payload={element:null};var n=a.value;return s.callback=function(){Si||(Si=!0,id=n),Yc(t,a)},s}function Qx(t,a,s){s=ds(-1,s),s.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var l=a.value;s.payload=function(){return n(l)},s.callback=function(){Yc(t,a)}}var r=t.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(s.callback=function(){Yc(t,a),typeof n!="function"&&(Is===null?Is=new Set([this]):Is.add(this));var o=a.stack;this.componentDidCatch(a.value,{componentStack:o!==null?o:""})}),s}function Dp(t,a,s){var n=t.pingCache;if(n===null){n=t.pingCache=new tN;var l=new Set;n.set(a,l)}else l=n.get(a),l===void 0&&(l=new Set,n.set(a,l));l.has(s)||(l.add(s),t=fN.bind(null,t,a,s),a.then(t,t))}function Rp(t){do{var a;if((a=t.tag===13)&&(a=t.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return t;t=t.return}while(t!==null);return null}function Lp(t,a,s,n,l){return t.mode&1?(t.flags|=65536,t.lanes=l,t):(t===a?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(a=ds(-1,1),a.tag=2,$s(s,a,1))),s.lanes|=1),t)}var aN=fs.ReactCurrentOwner,ja=!1;function ha(t,a,s,n){a.child=t===null?_x(a,null,s,n):Jn(a,t.child,s,n)}function Mp(t,a,s,n,l){s=s.render;var r=a.ref;return Vn(a,l),n=Kd(t,a,s,n,r,l),s=Yd(),t!==null&&!ja?(a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~l,ps(t,a,l)):(Et&&s&&$d(a),a.flags|=1,ha(t,a,n,l),a.child)}function Up(t,a,s,n,l){if(t===null){var r=s.type;return typeof r=="function"&&!iu(r)&&r.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(a.tag=15,a.type=r,Jx(t,a,r,n,l)):(t=ti(s.type,null,n,a,a.mode,l),t.ref=a.ref,t.return=a,a.child=t)}if(r=t.child,!(t.lanes&l)){var o=r.memoizedProps;if(s=s.compare,s=s!==null?s:Hl,s(o,n)&&t.ref===a.ref)return ps(t,a,l)}return a.flags|=1,t=zs(r,n),t.ref=a.ref,t.return=a,a.child=t}function Jx(t,a,s,n,l){if(t!==null){var r=t.memoizedProps;if(Hl(r,n)&&t.ref===a.ref)if(ja=!1,a.pendingProps=n=r,(t.lanes&l)!==0)t.flags&131072&&(ja=!0);else return a.lanes=t.lanes,ps(t,a,l)}return Zc(t,a,s,n,l)}function Kx(t,a,s){var n=a.pendingProps,l=n.children,r=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(a.mode&1))a.memoizedState={baseLanes:0,cachePool:null,transitions:null},wt(In,wa),wa|=s;else{if(!(s&1073741824))return t=r!==null?r.baseLanes|s:s,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:t,cachePool:null,transitions:null},a.updateQueue=null,wt(In,wa),wa|=t,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=r!==null?r.baseLanes:s,wt(In,wa),wa|=n}else r!==null?(n=r.baseLanes|s,a.memoizedState=null):n=s,wt(In,wa),wa|=n;return ha(t,a,l,s),a.child}function Yx(t,a){var s=a.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(a.flags|=512,a.flags|=2097152)}function Zc(t,a,s,n,l){var r=va(s)?dn:da.current;return r=qn(a,r),Vn(a,l),s=Kd(t,a,s,n,r,l),n=Yd(),t!==null&&!ja?(a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~l,ps(t,a,l)):(Et&&n&&$d(a),a.flags|=1,ha(t,a,s,l),a.child)}function Op(t,a,s,n,l){if(va(s)){var r=!0;pi(a)}else r=!1;if(Vn(a,l),a.stateNode===null)Zr(t,a),Hx(a,s,n),Kc(a,s,n,l),n=!0;else if(t===null){var o=a.stateNode,u=a.memoizedProps;o.props=u;var c=o.context,d=s.contextType;typeof d=="object"&&d!==null?d=Ia(d):(d=va(s)?dn:da.current,d=qn(a,d));var h=s.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==n||c!==d)&&Tp(a,o,n,d),Ps=!1;var g=a.memoizedState;o.state=g,ji(a,n,o,l),c=a.memoizedState,u!==n||g!==c||ya.current||Ps?(typeof h=="function"&&(Jc(a,s,h,n),c=a.memoizedState),(u=Ps||Ap(a,s,u,n,g,c,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(a.flags|=4194308)):(typeof o.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=n,a.memoizedState=c),o.props=n,o.state=c,o.context=d,n=u):(typeof o.componentDidMount=="function"&&(a.flags|=4194308),n=!1)}else{o=a.stateNode,wx(t,a),u=a.memoizedProps,d=a.type===a.elementType?u:Ha(a.type,u),o.props=d,p=a.pendingProps,g=o.context,c=s.contextType,typeof c=="object"&&c!==null?c=Ia(c):(c=va(s)?dn:da.current,c=qn(a,c));var N=s.getDerivedStateFromProps;(h=typeof N=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==p||g!==c)&&Tp(a,o,n,c),Ps=!1,g=a.memoizedState,o.state=g,ji(a,n,o,l);var v=a.memoizedState;u!==p||g!==v||ya.current||Ps?(typeof N=="function"&&(Jc(a,s,N,n),v=a.memoizedState),(d=Ps||Ap(a,s,d,n,g,v,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,c)),typeof o.componentDidUpdate=="function"&&(a.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof o.componentDidUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(a.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(a.flags|=1024),a.memoizedProps=n,a.memoizedState=v),o.props=n,o.state=v,o.context=c,n=d):(typeof o.componentDidUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(a.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&g===t.memoizedState||(a.flags|=1024),n=!1)}return Xc(t,a,s,n,r,l)}function Xc(t,a,s,n,l,r){Yx(t,a);var o=(a.flags&128)!==0;if(!n&&!o)return l&&Np(a,s,!1),ps(t,a,r);n=a.stateNode,aN.current=a;var u=o&&typeof s.getDerivedStateFromError!="function"?null:n.render();return a.flags|=1,t!==null&&o?(a.child=Jn(a,t.child,null,r),a.child=Jn(a,null,u,r)):ha(t,a,u,r),a.memoizedState=n.state,l&&Np(a,s,!0),a.child}function Zx(t){var a=t.stateNode;a.pendingContext?vp(t,a.pendingContext,a.pendingContext!==a.context):a.context&&vp(t,a.context,!1),Hd(t,a.containerInfo)}function $p(t,a,s,n,l){return Qn(),Fd(l),a.flags|=256,ha(t,a,s,n),a.child}var ed={dehydrated:null,treeContext:null,retryLane:0};function td(t){return{baseLanes:t,cachePool:null,transitions:null}}function Xx(t,a,s){var n=a.pendingProps,l=Dt.current,r=!1,o=(a.flags&128)!==0,u;if((u=o)||(u=t!==null&&t.memoizedState===null?!1:(l&2)!==0),u?(r=!0,a.flags&=-129):(t===null||t.memoizedState!==null)&&(l|=1),wt(Dt,l&1),t===null)return qc(a),t=a.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(a.mode&1?t.data==="$!"?a.lanes=8:a.lanes=1073741824:a.lanes=1,null):(o=n.children,t=n.fallback,r?(n=a.mode,r=a.child,o={mode:"hidden",children:o},!(n&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=Bi(o,n,0,null),t=cn(t,n,s,null),r.return=a,t.return=a,r.sibling=t,a.child=r,a.child.memoizedState=td(s),a.memoizedState=ed,t):eu(a,o));if(l=t.memoizedState,l!==null&&(u=l.dehydrated,u!==null))return sN(t,a,o,n,u,l,s);if(r){r=n.fallback,o=a.mode,l=t.child,u=l.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&a.child!==l?(n=a.child,n.childLanes=0,n.pendingProps=c,a.deletions=null):(n=zs(l,c),n.subtreeFlags=l.subtreeFlags&14680064),u!==null?r=zs(u,r):(r=cn(r,o,s,null),r.flags|=2),r.return=a,n.return=a,n.sibling=r,a.child=n,n=r,r=a.child,o=t.child.memoizedState,o=o===null?td(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=t.childLanes&~s,a.memoizedState=ed,n}return r=t.child,t=r.sibling,n=zs(r,{mode:"visible",children:n.children}),!(a.mode&1)&&(n.lanes=s),n.return=a,n.sibling=null,t!==null&&(s=a.deletions,s===null?(a.deletions=[t],a.flags|=16):s.push(t)),a.child=n,a.memoizedState=null,n}function eu(t,a){return a=Bi({mode:"visible",children:a},t.mode,0,null),a.return=t,t.child=a}function Tr(t,a,s,n){return n!==null&&Fd(n),Jn(a,t.child,null,s),t=eu(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function sN(t,a,s,n,l,r,o){if(s)return a.flags&256?(a.flags&=-257,n=Qo(Error(Ee(422))),Tr(t,a,o,n)):a.memoizedState!==null?(a.child=t.child,a.flags|=128,null):(r=n.fallback,l=a.mode,n=Bi({mode:"visible",children:n.children},l,0,null),r=cn(r,l,o,null),r.flags|=2,n.return=a,r.return=a,n.sibling=r,a.child=n,a.mode&1&&Jn(a,t.child,null,o),a.child.memoizedState=td(o),a.memoizedState=ed,r);if(!(a.mode&1))return Tr(t,a,o,null);if(l.data==="$!"){if(n=l.nextSibling&&l.nextSibling.dataset,n)var u=n.dgst;return n=u,r=Error(Ee(419)),n=Qo(r,n,void 0),Tr(t,a,o,n)}if(u=(o&t.childLanes)!==0,ja||u){if(n=Zt,n!==null){switch(o&-o){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(n.suspendedLanes|o)?0:l,l!==0&&l!==r.retryLane&&(r.retryLane=l,hs(t,l),Ka(n,t,l,-1))}return ru(),n=Qo(Error(Ee(421))),Tr(t,a,o,n)}return l.data==="$?"?(a.flags|=128,a.child=t.child,a=gN.bind(null,t),l._reactRetry=a,null):(t=r.treeContext,ka=Os(l.nextSibling),Ca=a,Et=!0,Qa=null,t!==null&&(Ma[Ua++]=os,Ma[Ua++]=cs,Ma[Ua++]=un,os=t.id,cs=t.overflow,un=a),a=eu(a,n.children),a.flags|=4096,a)}function Ip(t,a,s){t.lanes|=a;var n=t.alternate;n!==null&&(n.lanes|=a),Qc(t.return,a,s)}function Jo(t,a,s,n,l){var r=t.memoizedState;r===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:l}:(r.isBackwards=a,r.rendering=null,r.renderingStartTime=0,r.last=n,r.tail=s,r.tailMode=l)}function eb(t,a,s){var n=a.pendingProps,l=n.revealOrder,r=n.tail;if(ha(t,a,n.children,s),n=Dt.current,n&2)n=n&1|2,a.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ip(t,s,a);else if(t.tag===19)Ip(t,s,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(wt(Dt,n),!(a.mode&1))a.memoizedState=null;else switch(l){case"forwards":for(s=a.child,l=null;s!==null;)t=s.alternate,t!==null&&yi(t)===null&&(l=s),s=s.sibling;s=l,s===null?(l=a.child,a.child=null):(l=s.sibling,s.sibling=null),Jo(a,!1,l,s,r);break;case"backwards":for(s=null,l=a.child,a.child=null;l!==null;){if(t=l.alternate,t!==null&&yi(t)===null){a.child=l;break}t=l.sibling,l.sibling=s,s=l,l=t}Jo(a,!0,s,null,r);break;case"together":Jo(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Zr(t,a){!(a.mode&1)&&t!==null&&(t.alternate=null,a.alternate=null,a.flags|=2)}function ps(t,a,s){if(t!==null&&(a.dependencies=t.dependencies),hn|=a.lanes,!(s&a.childLanes))return null;if(t!==null&&a.child!==t.child)throw Error(Ee(153));if(a.child!==null){for(t=a.child,s=zs(t,t.pendingProps),a.child=s,s.return=a;t.sibling!==null;)t=t.sibling,s=s.sibling=zs(t,t.pendingProps),s.return=a;s.sibling=null}return a.child}function nN(t,a,s){switch(a.tag){case 3:Zx(a),Qn();break;case 5:kx(a);break;case 1:va(a.type)&&pi(a);break;case 4:Hd(a,a.stateNode.containerInfo);break;case 10:var n=a.type._context,l=a.memoizedProps.value;wt(xi,n._currentValue),n._currentValue=l;break;case 13:if(n=a.memoizedState,n!==null)return n.dehydrated!==null?(wt(Dt,Dt.current&1),a.flags|=128,null):s&a.child.childLanes?Xx(t,a,s):(wt(Dt,Dt.current&1),t=ps(t,a,s),t!==null?t.sibling:null);wt(Dt,Dt.current&1);break;case 19:if(n=(s&a.childLanes)!==0,t.flags&128){if(n)return eb(t,a,s);a.flags|=128}if(l=a.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),wt(Dt,Dt.current),n)break;return null;case 22:case 23:return a.lanes=0,Kx(t,a,s)}return ps(t,a,s)}var tb,ad,ab,sb;tb=function(t,a){for(var s=a.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};ad=function(){};ab=function(t,a,s,n){var l=t.memoizedProps;if(l!==n){t=a.stateNode,ln(ss.current);var r=null;switch(s){case"input":l=Sc(t,l),n=Sc(t,n),r=[];break;case"select":l=Mt({},l,{value:void 0}),n=Mt({},n,{value:void 0}),r=[];break;case"textarea":l=Cc(t,l),n=Cc(t,n),r=[];break;default:typeof l.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=mi)}Ec(s,n);var o;s=null;for(d in l)if(!n.hasOwnProperty(d)&&l.hasOwnProperty(d)&&l[d]!=null)if(d==="style"){var u=l[d];for(o in u)u.hasOwnProperty(o)&&(s||(s={}),s[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Il.hasOwnProperty(d)?r||(r=[]):(r=r||[]).push(d,null));for(d in n){var c=n[d];if(u=l!=null?l[d]:void 0,n.hasOwnProperty(d)&&c!==u&&(c!=null||u!=null))if(d==="style")if(u){for(o in u)!u.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(s||(s={}),s[o]="");for(o in c)c.hasOwnProperty(o)&&u[o]!==c[o]&&(s||(s={}),s[o]=c[o])}else s||(r||(r=[]),r.push(d,s)),s=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(r=r||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Il.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Ct("scroll",t),r||u===c||(r=[])):(r=r||[]).push(d,c))}s&&(r=r||[]).push("style",s);var d=r;(a.updateQueue=d)&&(a.flags|=4)}};sb=function(t,a,s,n){s!==n&&(a.flags|=4)};function gl(t,a){if(!Et)switch(t.tailMode){case"hidden":a=t.tail;for(var s=null;a!==null;)a.alternate!==null&&(s=a),a=a.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ia(t){var a=t.alternate!==null&&t.alternate.child===t.child,s=0,n=0;if(a)for(var l=t.child;l!==null;)s|=l.lanes|l.childLanes,n|=l.subtreeFlags&14680064,n|=l.flags&14680064,l.return=t,l=l.sibling;else for(l=t.child;l!==null;)s|=l.lanes|l.childLanes,n|=l.subtreeFlags,n|=l.flags,l.return=t,l=l.sibling;return t.subtreeFlags|=n,t.childLanes=s,a}function lN(t,a,s){var n=a.pendingProps;switch(Id(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ia(a),null;case 1:return va(a.type)&&hi(),ia(a),null;case 3:return n=a.stateNode,Kn(),Pt(ya),Pt(da),Qd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Er(a)?a.flags|=4:t===null||t.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,Qa!==null&&(dd(Qa),Qa=null))),ad(t,a),ia(a),null;case 5:qd(a);var l=ln(Yl.current);if(s=a.type,t!==null&&a.stateNode!=null)ab(t,a,s,n,l),t.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!n){if(a.stateNode===null)throw Error(Ee(166));return ia(a),null}if(t=ln(ss.current),Er(a)){n=a.stateNode,s=a.type;var r=a.memoizedProps;switch(n[ts]=a,n[Jl]=r,t=(a.mode&1)!==0,s){case"dialog":Ct("cancel",n),Ct("close",n);break;case"iframe":case"object":case"embed":Ct("load",n);break;case"video":case"audio":for(l=0;l<kl.length;l++)Ct(kl[l],n);break;case"source":Ct("error",n);break;case"img":case"image":case"link":Ct("error",n),Ct("load",n);break;case"details":Ct("toggle",n);break;case"input":Qh(n,r),Ct("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!r.multiple},Ct("invalid",n);break;case"textarea":Kh(n,r),Ct("invalid",n)}Ec(s,r),l=null;for(var o in r)if(r.hasOwnProperty(o)){var u=r[o];o==="children"?typeof u=="string"?n.textContent!==u&&(r.suppressHydrationWarning!==!0&&Pr(n.textContent,u,t),l=["children",u]):typeof u=="number"&&n.textContent!==""+u&&(r.suppressHydrationWarning!==!0&&Pr(n.textContent,u,t),l=["children",""+u]):Il.hasOwnProperty(o)&&u!=null&&o==="onScroll"&&Ct("scroll",n)}switch(s){case"input":yr(n),Jh(n,r,!0);break;case"textarea":yr(n),Yh(n);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(n.onclick=mi)}n=l,a.updateQueue=n,n!==null&&(a.flags|=4)}else{o=l.nodeType===9?l:l.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Tg(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(s,{is:n.is}):(t=o.createElement(s),s==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,s),t[ts]=a,t[Jl]=n,tb(t,a,!1,!1),a.stateNode=t;e:{switch(o=Ac(s,n),s){case"dialog":Ct("cancel",t),Ct("close",t),l=n;break;case"iframe":case"object":case"embed":Ct("load",t),l=n;break;case"video":case"audio":for(l=0;l<kl.length;l++)Ct(kl[l],t);l=n;break;case"source":Ct("error",t),l=n;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),l=n;break;case"details":Ct("toggle",t),l=n;break;case"input":Qh(t,n),l=Sc(t,n),Ct("invalid",t);break;case"option":l=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},l=Mt({},n,{value:void 0}),Ct("invalid",t);break;case"textarea":Kh(t,n),l=Cc(t,n),Ct("invalid",t);break;default:l=n}Ec(s,l),u=l;for(r in u)if(u.hasOwnProperty(r)){var c=u[r];r==="style"?Lg(t,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Dg(t,c)):r==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&Fl(t,c):typeof c=="number"&&Fl(t,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(Il.hasOwnProperty(r)?c!=null&&r==="onScroll"&&Ct("scroll",t):c!=null&&Sd(t,r,c,o))}switch(s){case"input":yr(t),Jh(t,n,!1);break;case"textarea":yr(t),Yh(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ws(n.value));break;case"select":t.multiple=!!n.multiple,r=n.value,r!=null?Fn(t,!!n.multiple,r,!1):n.defaultValue!=null&&Fn(t,!!n.multiple,n.defaultValue,!0);break;default:typeof l.onClick=="function"&&(t.onclick=mi)}switch(s){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return ia(a),null;case 6:if(t&&a.stateNode!=null)sb(t,a,t.memoizedProps,n);else{if(typeof n!="string"&&a.stateNode===null)throw Error(Ee(166));if(s=ln(Yl.current),ln(ss.current),Er(a)){if(n=a.stateNode,s=a.memoizedProps,n[ts]=a,(r=n.nodeValue!==s)&&(t=Ca,t!==null))switch(t.tag){case 3:Pr(n.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Pr(n.nodeValue,s,(t.mode&1)!==0)}r&&(a.flags|=4)}else n=(s.nodeType===9?s:s.ownerDocument).createTextNode(n),n[ts]=a,a.stateNode=n}return ia(a),null;case 13:if(Pt(Dt),n=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Et&&ka!==null&&a.mode&1&&!(a.flags&128))vx(),Qn(),a.flags|=98560,r=!1;else if(r=Er(a),n!==null&&n.dehydrated!==null){if(t===null){if(!r)throw Error(Ee(318));if(r=a.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(Ee(317));r[ts]=a}else Qn(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;ia(a),r=!1}else Qa!==null&&(dd(Qa),Qa=null),r=!0;if(!r)return a.flags&65536?a:null}return a.flags&128?(a.lanes=s,a):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(a.child.flags|=8192,a.mode&1&&(t===null||Dt.current&1?Kt===0&&(Kt=3):ru())),a.updateQueue!==null&&(a.flags|=4),ia(a),null);case 4:return Kn(),ad(t,a),t===null&&ql(a.stateNode.containerInfo),ia(a),null;case 10:return Wd(a.type._context),ia(a),null;case 17:return va(a.type)&&hi(),ia(a),null;case 19:if(Pt(Dt),r=a.memoizedState,r===null)return ia(a),null;if(n=(a.flags&128)!==0,o=r.rendering,o===null)if(n)gl(r,!1);else{if(Kt!==0||t!==null&&t.flags&128)for(t=a.child;t!==null;){if(o=yi(t),o!==null){for(a.flags|=128,gl(r,!1),n=o.updateQueue,n!==null&&(a.updateQueue=n,a.flags|=4),a.subtreeFlags=0,n=s,s=a.child;s!==null;)r=s,t=n,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,t=o.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return wt(Dt,Dt.current&1|2),a.child}t=t.sibling}r.tail!==null&&Bt()>Zn&&(a.flags|=128,n=!0,gl(r,!1),a.lanes=4194304)}else{if(!n)if(t=yi(o),t!==null){if(a.flags|=128,n=!0,s=t.updateQueue,s!==null&&(a.updateQueue=s,a.flags|=4),gl(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!Et)return ia(a),null}else 2*Bt()-r.renderingStartTime>Zn&&s!==1073741824&&(a.flags|=128,n=!0,gl(r,!1),a.lanes=4194304);r.isBackwards?(o.sibling=a.child,a.child=o):(s=r.last,s!==null?s.sibling=o:a.child=o,r.last=o)}return r.tail!==null?(a=r.tail,r.rendering=a,r.tail=a.sibling,r.renderingStartTime=Bt(),a.sibling=null,s=Dt.current,wt(Dt,n?s&1|2:s&1),a):(ia(a),null);case 22:case 23:return lu(),n=a.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(a.flags|=8192),n&&a.mode&1?wa&1073741824&&(ia(a),a.subtreeFlags&6&&(a.flags|=8192)):ia(a),null;case 24:return null;case 25:return null}throw Error(Ee(156,a.tag))}function rN(t,a){switch(Id(a),a.tag){case 1:return va(a.type)&&hi(),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return Kn(),Pt(ya),Pt(da),Qd(),t=a.flags,t&65536&&!(t&128)?(a.flags=t&-65537|128,a):null;case 5:return qd(a),null;case 13:if(Pt(Dt),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(Ee(340));Qn()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return Pt(Dt),null;case 4:return Kn(),null;case 10:return Wd(a.type._context),null;case 22:case 23:return lu(),null;case 24:return null;default:return null}}var Dr=!1,ca=!1,iN=typeof WeakSet=="function"?WeakSet:Set,He=null;function $n(t,a){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(n){Ot(t,a,n)}else s.current=null}function sd(t,a,s){try{s()}catch(n){Ot(t,a,n)}}var Fp=!1;function oN(t,a){if(Fc=ci,t=ox(),Od(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var n=s.getSelection&&s.getSelection();if(n&&n.rangeCount!==0){s=n.anchorNode;var l=n.anchorOffset,r=n.focusNode;n=n.focusOffset;try{s.nodeType,r.nodeType}catch{s=null;break e}var o=0,u=-1,c=-1,d=0,h=0,p=t,g=null;t:for(;;){for(var N;p!==s||l!==0&&p.nodeType!==3||(u=o+l),p!==r||n!==0&&p.nodeType!==3||(c=o+n),p.nodeType===3&&(o+=p.nodeValue.length),(N=p.firstChild)!==null;)g=p,p=N;for(;;){if(p===t)break t;if(g===s&&++d===l&&(u=o),g===r&&++h===n&&(c=o),(N=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=N}s=u===-1||c===-1?null:{start:u,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(zc={focusedElem:t,selectionRange:s},ci=!1,He=a;He!==null;)if(a=He,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,He=t;else for(;He!==null;){a=He;try{var v=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var w=v.memoizedProps,A=v.memoizedState,y=a.stateNode,x=y.getSnapshotBeforeUpdate(a.elementType===a.type?w:Ha(a.type,w),A);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var f=a.stateNode.containerInfo;f.nodeType===1?f.textContent="":f.nodeType===9&&f.documentElement&&f.removeChild(f.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ee(163))}}catch(b){Ot(a,a.return,b)}if(t=a.sibling,t!==null){t.return=a.return,He=t;break}He=a.return}return v=Fp,Fp=!1,v}function Ll(t,a,s){var n=a.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var l=n=n.next;do{if((l.tag&t)===t){var r=l.destroy;l.destroy=void 0,r!==void 0&&sd(a,s,r)}l=l.next}while(l!==n)}}function Fi(t,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var s=a=a.next;do{if((s.tag&t)===t){var n=s.create;s.destroy=n()}s=s.next}while(s!==a)}}function nd(t){var a=t.ref;if(a!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof a=="function"?a(t):a.current=t}}function nb(t){var a=t.alternate;a!==null&&(t.alternate=null,nb(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&(delete a[ts],delete a[Jl],delete a[Vc],delete a[Vv],delete a[Gv])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function lb(t){return t.tag===5||t.tag===3||t.tag===4}function zp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||lb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ld(t,a,s){var n=t.tag;if(n===5||n===6)t=t.stateNode,a?s.nodeType===8?s.parentNode.insertBefore(t,a):s.insertBefore(t,a):(s.nodeType===8?(a=s.parentNode,a.insertBefore(t,s)):(a=s,a.appendChild(t)),s=s._reactRootContainer,s!=null||a.onclick!==null||(a.onclick=mi));else if(n!==4&&(t=t.child,t!==null))for(ld(t,a,s),t=t.sibling;t!==null;)ld(t,a,s),t=t.sibling}function rd(t,a,s){var n=t.tag;if(n===5||n===6)t=t.stateNode,a?s.insertBefore(t,a):s.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(rd(t,a,s),t=t.sibling;t!==null;)rd(t,a,s),t=t.sibling}var aa=null,qa=!1;function Ns(t,a,s){for(s=s.child;s!==null;)rb(t,a,s),s=s.sibling}function rb(t,a,s){if(as&&typeof as.onCommitFiberUnmount=="function")try{as.onCommitFiberUnmount(Di,s)}catch{}switch(s.tag){case 5:ca||$n(s,a);case 6:var n=aa,l=qa;aa=null,Ns(t,a,s),aa=n,qa=l,aa!==null&&(qa?(t=aa,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):aa.removeChild(s.stateNode));break;case 18:aa!==null&&(qa?(t=aa,s=s.stateNode,t.nodeType===8?Bo(t.parentNode,s):t.nodeType===1&&Bo(t,s),Vl(t)):Bo(aa,s.stateNode));break;case 4:n=aa,l=qa,aa=s.stateNode.containerInfo,qa=!0,Ns(t,a,s),aa=n,qa=l;break;case 0:case 11:case 14:case 15:if(!ca&&(n=s.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){l=n=n.next;do{var r=l,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&sd(s,a,o),l=l.next}while(l!==n)}Ns(t,a,s);break;case 1:if(!ca&&($n(s,a),n=s.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=s.memoizedProps,n.state=s.memoizedState,n.componentWillUnmount()}catch(u){Ot(s,a,u)}Ns(t,a,s);break;case 21:Ns(t,a,s);break;case 22:s.mode&1?(ca=(n=ca)||s.memoizedState!==null,Ns(t,a,s),ca=n):Ns(t,a,s);break;default:Ns(t,a,s)}}function Bp(t){var a=t.updateQueue;if(a!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new iN),a.forEach(function(n){var l=xN.bind(null,t,n);s.has(n)||(s.add(n),n.then(l,l))})}}function Ba(t,a){var s=a.deletions;if(s!==null)for(var n=0;n<s.length;n++){var l=s[n];try{var r=t,o=a,u=o;e:for(;u!==null;){switch(u.tag){case 5:aa=u.stateNode,qa=!1;break e;case 3:aa=u.stateNode.containerInfo,qa=!0;break e;case 4:aa=u.stateNode.containerInfo,qa=!0;break e}u=u.return}if(aa===null)throw Error(Ee(160));rb(r,o,l),aa=null,qa=!1;var c=l.alternate;c!==null&&(c.return=null),l.return=null}catch(d){Ot(l,a,d)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)ib(a,t),a=a.sibling}function ib(t,a){var s=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ba(a,t),Za(t),n&4){try{Ll(3,t,t.return),Fi(3,t)}catch(w){Ot(t,t.return,w)}try{Ll(5,t,t.return)}catch(w){Ot(t,t.return,w)}}break;case 1:Ba(a,t),Za(t),n&512&&s!==null&&$n(s,s.return);break;case 5:if(Ba(a,t),Za(t),n&512&&s!==null&&$n(s,s.return),t.flags&32){var l=t.stateNode;try{Fl(l,"")}catch(w){Ot(t,t.return,w)}}if(n&4&&(l=t.stateNode,l!=null)){var r=t.memoizedProps,o=s!==null?s.memoizedProps:r,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&r.type==="radio"&&r.name!=null&&Eg(l,r),Ac(u,o);var d=Ac(u,r);for(o=0;o<c.length;o+=2){var h=c[o],p=c[o+1];h==="style"?Lg(l,p):h==="dangerouslySetInnerHTML"?Dg(l,p):h==="children"?Fl(l,p):Sd(l,h,p,d)}switch(u){case"input":wc(l,r);break;case"textarea":Ag(l,r);break;case"select":var g=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!r.multiple;var N=r.value;N!=null?Fn(l,!!r.multiple,N,!1):g!==!!r.multiple&&(r.defaultValue!=null?Fn(l,!!r.multiple,r.defaultValue,!0):Fn(l,!!r.multiple,r.multiple?[]:"",!1))}l[Jl]=r}catch(w){Ot(t,t.return,w)}}break;case 6:if(Ba(a,t),Za(t),n&4){if(t.stateNode===null)throw Error(Ee(162));l=t.stateNode,r=t.memoizedProps;try{l.nodeValue=r}catch(w){Ot(t,t.return,w)}}break;case 3:if(Ba(a,t),Za(t),n&4&&s!==null&&s.memoizedState.isDehydrated)try{Vl(a.containerInfo)}catch(w){Ot(t,t.return,w)}break;case 4:Ba(a,t),Za(t);break;case 13:Ba(a,t),Za(t),l=t.child,l.flags&8192&&(r=l.memoizedState!==null,l.stateNode.isHidden=r,!r||l.alternate!==null&&l.alternate.memoizedState!==null||(su=Bt())),n&4&&Bp(t);break;case 22:if(h=s!==null&&s.memoizedState!==null,t.mode&1?(ca=(d=ca)||h,Ba(a,t),ca=d):Ba(a,t),Za(t),n&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(He=t,h=t.child;h!==null;){for(p=He=h;He!==null;){switch(g=He,N=g.child,g.tag){case 0:case 11:case 14:case 15:Ll(4,g,g.return);break;case 1:$n(g,g.return);var v=g.stateNode;if(typeof v.componentWillUnmount=="function"){n=g,s=g.return;try{a=n,v.props=a.memoizedProps,v.state=a.memoizedState,v.componentWillUnmount()}catch(w){Ot(n,s,w)}}break;case 5:$n(g,g.return);break;case 22:if(g.memoizedState!==null){Vp(p);continue}}N!==null?(N.return=g,He=N):Vp(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{l=p.stateNode,d?(r=l.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(u=p.stateNode,c=p.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=Rg("display",o))}catch(w){Ot(t,t.return,w)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(w){Ot(t,t.return,w)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Ba(a,t),Za(t),n&4&&Bp(t);break;case 21:break;default:Ba(a,t),Za(t)}}function Za(t){var a=t.flags;if(a&2){try{e:{for(var s=t.return;s!==null;){if(lb(s)){var n=s;break e}s=s.return}throw Error(Ee(160))}switch(n.tag){case 5:var l=n.stateNode;n.flags&32&&(Fl(l,""),n.flags&=-33);var r=zp(t);rd(t,r,l);break;case 3:case 4:var o=n.stateNode.containerInfo,u=zp(t);ld(t,u,o);break;default:throw Error(Ee(161))}}catch(c){Ot(t,t.return,c)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function cN(t,a,s){He=t,ob(t)}function ob(t,a,s){for(var n=(t.mode&1)!==0;He!==null;){var l=He,r=l.child;if(l.tag===22&&n){var o=l.memoizedState!==null||Dr;if(!o){var u=l.alternate,c=u!==null&&u.memoizedState!==null||ca;u=Dr;var d=ca;if(Dr=o,(ca=c)&&!d)for(He=l;He!==null;)o=He,c=o.child,o.tag===22&&o.memoizedState!==null?Gp(l):c!==null?(c.return=o,He=c):Gp(l);for(;r!==null;)He=r,ob(r),r=r.sibling;He=l,Dr=u,ca=d}Wp(t)}else l.subtreeFlags&8772&&r!==null?(r.return=l,He=r):Wp(t)}}function Wp(t){for(;He!==null;){var a=He;if(a.flags&8772){var s=a.alternate;try{if(a.flags&8772)switch(a.tag){case 0:case 11:case 15:ca||Fi(5,a);break;case 1:var n=a.stateNode;if(a.flags&4&&!ca)if(s===null)n.componentDidMount();else{var l=a.elementType===a.type?s.memoizedProps:Ha(a.type,s.memoizedProps);n.componentDidUpdate(l,s.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var r=a.updateQueue;r!==null&&Cp(a,r,n);break;case 3:var o=a.updateQueue;if(o!==null){if(s=null,a.child!==null)switch(a.child.tag){case 5:s=a.child.stateNode;break;case 1:s=a.child.stateNode}Cp(a,o,s)}break;case 5:var u=a.stateNode;if(s===null&&a.flags&4){s=u;var c=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var d=a.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&Vl(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ee(163))}ca||a.flags&512&&nd(a)}catch(g){Ot(a,a.return,g)}}if(a===t){He=null;break}if(s=a.sibling,s!==null){s.return=a.return,He=s;break}He=a.return}}function Vp(t){for(;He!==null;){var a=He;if(a===t){He=null;break}var s=a.sibling;if(s!==null){s.return=a.return,He=s;break}He=a.return}}function Gp(t){for(;He!==null;){var a=He;try{switch(a.tag){case 0:case 11:case 15:var s=a.return;try{Fi(4,a)}catch(c){Ot(a,s,c)}break;case 1:var n=a.stateNode;if(typeof n.componentDidMount=="function"){var l=a.return;try{n.componentDidMount()}catch(c){Ot(a,l,c)}}var r=a.return;try{nd(a)}catch(c){Ot(a,r,c)}break;case 5:var o=a.return;try{nd(a)}catch(c){Ot(a,o,c)}}}catch(c){Ot(a,a.return,c)}if(a===t){He=null;break}var u=a.sibling;if(u!==null){u.return=a.return,He=u;break}He=a.return}}var dN=Math.ceil,_i=fs.ReactCurrentDispatcher,tu=fs.ReactCurrentOwner,$a=fs.ReactCurrentBatchConfig,xt=0,Zt=null,Gt=null,sa=0,wa=0,In=Hs(0),Kt=0,tr=null,hn=0,zi=0,au=0,Ml=null,ba=null,su=0,Zn=1/0,rs=null,Si=!1,id=null,Is=null,Rr=!1,Ds=null,wi=0,Ul=0,od=null,Xr=-1,ei=0;function pa(){return xt&6?Bt():Xr!==-1?Xr:Xr=Bt()}function Fs(t){return t.mode&1?xt&2&&sa!==0?sa&-sa:qv.transition!==null?(ei===0&&(ei=Hg()),ei):(t=_t,t!==0||(t=window.event,t=t===void 0?16:Xg(t.type)),t):1}function Ka(t,a,s,n){if(50<Ul)throw Ul=0,od=null,Error(Ee(185));lr(t,s,n),(!(xt&2)||t!==Zt)&&(t===Zt&&(!(xt&2)&&(zi|=s),Kt===4&&As(t,sa)),Na(t,n),s===1&&xt===0&&!(a.mode&1)&&(Zn=Bt()+500,Oi&&qs()))}function Na(t,a){var s=t.callbackNode;qy(t,a);var n=oi(t,t===Zt?sa:0);if(n===0)s!==null&&ep(s),t.callbackNode=null,t.callbackPriority=0;else if(a=n&-n,t.callbackPriority!==a){if(s!=null&&ep(s),a===1)t.tag===0?Hv(Hp.bind(null,t)):bx(Hp.bind(null,t)),Bv(function(){!(xt&6)&&qs()}),s=null;else{switch(qg(n)){case 1:s=Ed;break;case 4:s=Vg;break;case 16:s=ii;break;case 536870912:s=Gg;break;default:s=ii}s=gb(s,cb.bind(null,t))}t.callbackPriority=a,t.callbackNode=s}}function cb(t,a){if(Xr=-1,ei=0,xt&6)throw Error(Ee(327));var s=t.callbackNode;if(Gn()&&t.callbackNode!==s)return null;var n=oi(t,t===Zt?sa:0);if(n===0)return null;if(n&30||n&t.expiredLanes||a)a=ki(t,n);else{a=n;var l=xt;xt|=2;var r=ub();(Zt!==t||sa!==a)&&(rs=null,Zn=Bt()+500,on(t,a));do try{hN();break}catch(u){db(t,u)}while(!0);Bd(),_i.current=r,xt=l,Gt!==null?a=0:(Zt=null,sa=0,a=Kt)}if(a!==0){if(a===2&&(l=Mc(t),l!==0&&(n=l,a=cd(t,l))),a===1)throw s=tr,on(t,0),As(t,n),Na(t,Bt()),s;if(a===6)As(t,n);else{if(l=t.current.alternate,!(n&30)&&!uN(l)&&(a=ki(t,n),a===2&&(r=Mc(t),r!==0&&(n=r,a=cd(t,r))),a===1))throw s=tr,on(t,0),As(t,n),Na(t,Bt()),s;switch(t.finishedWork=l,t.finishedLanes=n,a){case 0:case 1:throw Error(Ee(345));case 2:an(t,ba,rs);break;case 3:if(As(t,n),(n&130023424)===n&&(a=su+500-Bt(),10<a)){if(oi(t,0)!==0)break;if(l=t.suspendedLanes,(l&n)!==n){pa(),t.pingedLanes|=t.suspendedLanes&l;break}t.timeoutHandle=Wc(an.bind(null,t,ba,rs),a);break}an(t,ba,rs);break;case 4:if(As(t,n),(n&4194240)===n)break;for(a=t.eventTimes,l=-1;0<n;){var o=31-Ja(n);r=1<<o,o=a[o],o>l&&(l=o),n&=~r}if(n=l,n=Bt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*dN(n/1960))-n,10<n){t.timeoutHandle=Wc(an.bind(null,t,ba,rs),n);break}an(t,ba,rs);break;case 5:an(t,ba,rs);break;default:throw Error(Ee(329))}}}return Na(t,Bt()),t.callbackNode===s?cb.bind(null,t):null}function cd(t,a){var s=Ml;return t.current.memoizedState.isDehydrated&&(on(t,a).flags|=256),t=ki(t,a),t!==2&&(a=ba,ba=s,a!==null&&dd(a)),t}function dd(t){ba===null?ba=t:ba.push.apply(ba,t)}function uN(t){for(var a=t;;){if(a.flags&16384){var s=a.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var n=0;n<s.length;n++){var l=s[n],r=l.getSnapshot;l=l.value;try{if(!Ya(r(),l))return!1}catch{return!1}}}if(s=a.child,a.subtreeFlags&16384&&s!==null)s.return=a,a=s;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function As(t,a){for(a&=~au,a&=~zi,t.suspendedLanes|=a,t.pingedLanes&=~a,t=t.expirationTimes;0<a;){var s=31-Ja(a),n=1<<s;t[s]=-1,a&=~n}}function Hp(t){if(xt&6)throw Error(Ee(327));Gn();var a=oi(t,0);if(!(a&1))return Na(t,Bt()),null;var s=ki(t,a);if(t.tag!==0&&s===2){var n=Mc(t);n!==0&&(a=n,s=cd(t,n))}if(s===1)throw s=tr,on(t,0),As(t,a),Na(t,Bt()),s;if(s===6)throw Error(Ee(345));return t.finishedWork=t.current.alternate,t.finishedLanes=a,an(t,ba,rs),Na(t,Bt()),null}function nu(t,a){var s=xt;xt|=1;try{return t(a)}finally{xt=s,xt===0&&(Zn=Bt()+500,Oi&&qs())}}function pn(t){Ds!==null&&Ds.tag===0&&!(xt&6)&&Gn();var a=xt;xt|=1;var s=$a.transition,n=_t;try{if($a.transition=null,_t=1,t)return t()}finally{_t=n,$a.transition=s,xt=a,!(xt&6)&&qs()}}function lu(){wa=In.current,Pt(In)}function on(t,a){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,zv(s)),Gt!==null)for(s=Gt.return;s!==null;){var n=s;switch(Id(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&hi();break;case 3:Kn(),Pt(ya),Pt(da),Qd();break;case 5:qd(n);break;case 4:Kn();break;case 13:Pt(Dt);break;case 19:Pt(Dt);break;case 10:Wd(n.type._context);break;case 22:case 23:lu()}s=s.return}if(Zt=t,Gt=t=zs(t.current,null),sa=wa=a,Kt=0,tr=null,au=zi=hn=0,ba=Ml=null,nn!==null){for(a=0;a<nn.length;a++)if(s=nn[a],n=s.interleaved,n!==null){s.interleaved=null;var l=n.next,r=s.pending;if(r!==null){var o=r.next;r.next=l,n.next=o}s.pending=n}nn=null}return t}function db(t,a){do{var s=Gt;try{if(Bd(),Kr.current=Ni,vi){for(var n=Rt.memoizedState;n!==null;){var l=n.queue;l!==null&&(l.pending=null),n=n.next}vi=!1}if(mn=0,Yt=Jt=Rt=null,Rl=!1,Zl=0,tu.current=null,s===null||s.return===null){Kt=1,tr=a,Gt=null;break}e:{var r=t,o=s.return,u=s,c=a;if(a=sa,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=u,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var N=Rp(o);if(N!==null){N.flags&=-257,Lp(N,o,u,r,a),N.mode&1&&Dp(r,d,a),a=N,c=d;var v=a.updateQueue;if(v===null){var w=new Set;w.add(c),a.updateQueue=w}else v.add(c);break e}else{if(!(a&1)){Dp(r,d,a),ru();break e}c=Error(Ee(426))}}else if(Et&&u.mode&1){var A=Rp(o);if(A!==null){!(A.flags&65536)&&(A.flags|=256),Lp(A,o,u,r,a),Fd(Yn(c,u));break e}}r=c=Yn(c,u),Kt!==4&&(Kt=2),Ml===null?Ml=[r]:Ml.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,a&=-a,r.lanes|=a;var y=qx(r,c,a);kp(r,y);break e;case 1:u=c;var x=r.type,f=r.stateNode;if(!(r.flags&128)&&(typeof x.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(Is===null||!Is.has(f)))){r.flags|=65536,a&=-a,r.lanes|=a;var b=Qx(r,u,a);kp(r,b);break e}}r=r.return}while(r!==null)}hb(s)}catch(k){a=k,Gt===s&&s!==null&&(Gt=s=s.return);continue}break}while(!0)}function ub(){var t=_i.current;return _i.current=Ni,t===null?Ni:t}function ru(){(Kt===0||Kt===3||Kt===2)&&(Kt=4),Zt===null||!(hn&268435455)&&!(zi&268435455)||As(Zt,sa)}function ki(t,a){var s=xt;xt|=2;var n=ub();(Zt!==t||sa!==a)&&(rs=null,on(t,a));do try{mN();break}catch(l){db(t,l)}while(!0);if(Bd(),xt=s,_i.current=n,Gt!==null)throw Error(Ee(261));return Zt=null,sa=0,Kt}function mN(){for(;Gt!==null;)mb(Gt)}function hN(){for(;Gt!==null&&!$y();)mb(Gt)}function mb(t){var a=fb(t.alternate,t,wa);t.memoizedProps=t.pendingProps,a===null?hb(t):Gt=a,tu.current=null}function hb(t){var a=t;do{var s=a.alternate;if(t=a.return,a.flags&32768){if(s=rN(s,a),s!==null){s.flags&=32767,Gt=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Kt=6,Gt=null;return}}else if(s=lN(s,a,wa),s!==null){Gt=s;return}if(a=a.sibling,a!==null){Gt=a;return}Gt=a=t}while(a!==null);Kt===0&&(Kt=5)}function an(t,a,s){var n=_t,l=$a.transition;try{$a.transition=null,_t=1,pN(t,a,s,n)}finally{$a.transition=l,_t=n}return null}function pN(t,a,s,n){do Gn();while(Ds!==null);if(xt&6)throw Error(Ee(327));s=t.finishedWork;var l=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(Ee(177));t.callbackNode=null,t.callbackPriority=0;var r=s.lanes|s.childLanes;if(Qy(t,r),t===Zt&&(Gt=Zt=null,sa=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||Rr||(Rr=!0,gb(ii,function(){return Gn(),null})),r=(s.flags&15990)!==0,s.subtreeFlags&15990||r){r=$a.transition,$a.transition=null;var o=_t;_t=1;var u=xt;xt|=4,tu.current=null,oN(t,s),ib(s,t),Lv(zc),ci=!!Fc,zc=Fc=null,t.current=s,cN(s),Iy(),xt=u,_t=o,$a.transition=r}else t.current=s;if(Rr&&(Rr=!1,Ds=t,wi=l),r=t.pendingLanes,r===0&&(Is=null),By(s.stateNode),Na(t,Bt()),a!==null)for(n=t.onRecoverableError,s=0;s<a.length;s++)l=a[s],n(l.value,{componentStack:l.stack,digest:l.digest});if(Si)throw Si=!1,t=id,id=null,t;return wi&1&&t.tag!==0&&Gn(),r=t.pendingLanes,r&1?t===od?Ul++:(Ul=0,od=t):Ul=0,qs(),null}function Gn(){if(Ds!==null){var t=qg(wi),a=$a.transition,s=_t;try{if($a.transition=null,_t=16>t?16:t,Ds===null)var n=!1;else{if(t=Ds,Ds=null,wi=0,xt&6)throw Error(Ee(331));var l=xt;for(xt|=4,He=t.current;He!==null;){var r=He,o=r.child;if(He.flags&16){var u=r.deletions;if(u!==null){for(var c=0;c<u.length;c++){var d=u[c];for(He=d;He!==null;){var h=He;switch(h.tag){case 0:case 11:case 15:Ll(8,h,r)}var p=h.child;if(p!==null)p.return=h,He=p;else for(;He!==null;){h=He;var g=h.sibling,N=h.return;if(nb(h),h===d){He=null;break}if(g!==null){g.return=N,He=g;break}He=N}}}var v=r.alternate;if(v!==null){var w=v.child;if(w!==null){v.child=null;do{var A=w.sibling;w.sibling=null,w=A}while(w!==null)}}He=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,He=o;else e:for(;He!==null;){if(r=He,r.flags&2048)switch(r.tag){case 0:case 11:case 15:Ll(9,r,r.return)}var y=r.sibling;if(y!==null){y.return=r.return,He=y;break e}He=r.return}}var x=t.current;for(He=x;He!==null;){o=He;var f=o.child;if(o.subtreeFlags&2064&&f!==null)f.return=o,He=f;else e:for(o=x;He!==null;){if(u=He,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Fi(9,u)}}catch(k){Ot(u,u.return,k)}if(u===o){He=null;break e}var b=u.sibling;if(b!==null){b.return=u.return,He=b;break e}He=u.return}}if(xt=l,qs(),as&&typeof as.onPostCommitFiberRoot=="function")try{as.onPostCommitFiberRoot(Di,t)}catch{}n=!0}return n}finally{_t=s,$a.transition=a}}return!1}function qp(t,a,s){a=Yn(s,a),a=qx(t,a,1),t=$s(t,a,1),a=pa(),t!==null&&(lr(t,1,a),Na(t,a))}function Ot(t,a,s){if(t.tag===3)qp(t,t,s);else for(;a!==null;){if(a.tag===3){qp(a,t,s);break}else if(a.tag===1){var n=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Is===null||!Is.has(n))){t=Yn(s,t),t=Qx(a,t,1),a=$s(a,t,1),t=pa(),a!==null&&(lr(a,1,t),Na(a,t));break}}a=a.return}}function fN(t,a,s){var n=t.pingCache;n!==null&&n.delete(a),a=pa(),t.pingedLanes|=t.suspendedLanes&s,Zt===t&&(sa&s)===s&&(Kt===4||Kt===3&&(sa&130023424)===sa&&500>Bt()-su?on(t,0):au|=s),Na(t,a)}function pb(t,a){a===0&&(t.mode&1?(a=_r,_r<<=1,!(_r&130023424)&&(_r=4194304)):a=1);var s=pa();t=hs(t,a),t!==null&&(lr(t,a,s),Na(t,s))}function gN(t){var a=t.memoizedState,s=0;a!==null&&(s=a.retryLane),pb(t,s)}function xN(t,a){var s=0;switch(t.tag){case 13:var n=t.stateNode,l=t.memoizedState;l!==null&&(s=l.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(Ee(314))}n!==null&&n.delete(a),pb(t,s)}var fb;fb=function(t,a,s){if(t!==null)if(t.memoizedProps!==a.pendingProps||ya.current)ja=!0;else{if(!(t.lanes&s)&&!(a.flags&128))return ja=!1,nN(t,a,s);ja=!!(t.flags&131072)}else ja=!1,Et&&a.flags&1048576&&jx(a,gi,a.index);switch(a.lanes=0,a.tag){case 2:var n=a.type;Zr(t,a),t=a.pendingProps;var l=qn(a,da.current);Vn(a,s),l=Kd(null,a,n,t,l,s);var r=Yd();return a.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,va(n)?(r=!0,pi(a)):r=!1,a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,Gd(a),l.updater=Ii,a.stateNode=l,l._reactInternals=a,Kc(a,n,t,s),a=Xc(null,a,n,!0,r,s)):(a.tag=0,Et&&r&&$d(a),ha(null,a,l,s),a=a.child),a;case 16:n=a.elementType;e:{switch(Zr(t,a),t=a.pendingProps,l=n._init,n=l(n._payload),a.type=n,l=a.tag=jN(n),t=Ha(n,t),l){case 0:a=Zc(null,a,n,t,s);break e;case 1:a=Op(null,a,n,t,s);break e;case 11:a=Mp(null,a,n,t,s);break e;case 14:a=Up(null,a,n,Ha(n.type,t),s);break e}throw Error(Ee(306,n,""))}return a;case 0:return n=a.type,l=a.pendingProps,l=a.elementType===n?l:Ha(n,l),Zc(t,a,n,l,s);case 1:return n=a.type,l=a.pendingProps,l=a.elementType===n?l:Ha(n,l),Op(t,a,n,l,s);case 3:e:{if(Zx(a),t===null)throw Error(Ee(387));n=a.pendingProps,r=a.memoizedState,l=r.element,wx(t,a),ji(a,n,null,s);var o=a.memoizedState;if(n=o.element,r.isDehydrated)if(r={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},a.updateQueue.baseState=r,a.memoizedState=r,a.flags&256){l=Yn(Error(Ee(423)),a),a=$p(t,a,n,s,l);break e}else if(n!==l){l=Yn(Error(Ee(424)),a),a=$p(t,a,n,s,l);break e}else for(ka=Os(a.stateNode.containerInfo.firstChild),Ca=a,Et=!0,Qa=null,s=_x(a,null,n,s),a.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Qn(),n===l){a=ps(t,a,s);break e}ha(t,a,n,s)}a=a.child}return a;case 5:return kx(a),t===null&&qc(a),n=a.type,l=a.pendingProps,r=t!==null?t.memoizedProps:null,o=l.children,Bc(n,l)?o=null:r!==null&&Bc(n,r)&&(a.flags|=32),Yx(t,a),ha(t,a,o,s),a.child;case 6:return t===null&&qc(a),null;case 13:return Xx(t,a,s);case 4:return Hd(a,a.stateNode.containerInfo),n=a.pendingProps,t===null?a.child=Jn(a,null,n,s):ha(t,a,n,s),a.child;case 11:return n=a.type,l=a.pendingProps,l=a.elementType===n?l:Ha(n,l),Mp(t,a,n,l,s);case 7:return ha(t,a,a.pendingProps,s),a.child;case 8:return ha(t,a,a.pendingProps.children,s),a.child;case 12:return ha(t,a,a.pendingProps.children,s),a.child;case 10:e:{if(n=a.type._context,l=a.pendingProps,r=a.memoizedProps,o=l.value,wt(xi,n._currentValue),n._currentValue=o,r!==null)if(Ya(r.value,o)){if(r.children===l.children&&!ya.current){a=ps(t,a,s);break e}}else for(r=a.child,r!==null&&(r.return=a);r!==null;){var u=r.dependencies;if(u!==null){o=r.child;for(var c=u.firstContext;c!==null;){if(c.context===n){if(r.tag===1){c=ds(-1,s&-s),c.tag=2;var d=r.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}r.lanes|=s,c=r.alternate,c!==null&&(c.lanes|=s),Qc(r.return,s,a),u.lanes|=s;break}c=c.next}}else if(r.tag===10)o=r.type===a.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(Ee(341));o.lanes|=s,u=o.alternate,u!==null&&(u.lanes|=s),Qc(o,s,a),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===a){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}ha(t,a,l.children,s),a=a.child}return a;case 9:return l=a.type,n=a.pendingProps.children,Vn(a,s),l=Ia(l),n=n(l),a.flags|=1,ha(t,a,n,s),a.child;case 14:return n=a.type,l=Ha(n,a.pendingProps),l=Ha(n.type,l),Up(t,a,n,l,s);case 15:return Jx(t,a,a.type,a.pendingProps,s);case 17:return n=a.type,l=a.pendingProps,l=a.elementType===n?l:Ha(n,l),Zr(t,a),a.tag=1,va(n)?(t=!0,pi(a)):t=!1,Vn(a,s),Hx(a,n,l),Kc(a,n,l,s),Xc(null,a,n,!0,t,s);case 19:return eb(t,a,s);case 22:return Kx(t,a,s)}throw Error(Ee(156,a.tag))};function gb(t,a){return Wg(t,a)}function bN(t,a,s,n){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Oa(t,a,s,n){return new bN(t,a,s,n)}function iu(t){return t=t.prototype,!(!t||!t.isReactComponent)}function jN(t){if(typeof t=="function")return iu(t)?1:0;if(t!=null){if(t=t.$$typeof,t===kd)return 11;if(t===Cd)return 14}return 2}function zs(t,a){var s=t.alternate;return s===null?(s=Oa(t.tag,a,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=a,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,a=t.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function ti(t,a,s,n,l,r){var o=2;if(n=t,typeof t=="function")iu(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case En:return cn(s.children,l,r,a);case wd:o=8,l|=8;break;case yc:return t=Oa(12,s,a,l|2),t.elementType=yc,t.lanes=r,t;case vc:return t=Oa(13,s,a,l),t.elementType=vc,t.lanes=r,t;case Nc:return t=Oa(19,s,a,l),t.elementType=Nc,t.lanes=r,t;case kg:return Bi(s,l,r,a);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Sg:o=10;break e;case wg:o=9;break e;case kd:o=11;break e;case Cd:o=14;break e;case Cs:o=16,n=null;break e}throw Error(Ee(130,t==null?t:typeof t,""))}return a=Oa(o,s,a,l),a.elementType=t,a.type=n,a.lanes=r,a}function cn(t,a,s,n){return t=Oa(7,t,n,a),t.lanes=s,t}function Bi(t,a,s,n){return t=Oa(22,t,n,a),t.elementType=kg,t.lanes=s,t.stateNode={isHidden:!1},t}function Ko(t,a,s){return t=Oa(6,t,null,a),t.lanes=s,t}function Yo(t,a,s){return a=Oa(4,t.children!==null?t.children:[],t.key,a),a.lanes=s,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}function yN(t,a,s,n,l){this.tag=a,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=To(0),this.expirationTimes=To(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=To(0),this.identifierPrefix=n,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function ou(t,a,s,n,l,r,o,u,c){return t=new yN(t,a,s,u,c),a===1?(a=1,r===!0&&(a|=8)):a=0,r=Oa(3,null,null,a),t.current=r,r.stateNode=t,r.memoizedState={element:n,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gd(r),t}function vN(t,a,s){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pn,key:n==null?null:""+n,children:t,containerInfo:a,implementation:s}}function xb(t){if(!t)return Vs;t=t._reactInternals;e:{if(gn(t)!==t||t.tag!==1)throw Error(Ee(170));var a=t;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(va(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(Ee(171))}if(t.tag===1){var s=t.type;if(va(s))return xx(t,s,a)}return a}function bb(t,a,s,n,l,r,o,u,c){return t=ou(s,n,!0,t,l,r,o,u,c),t.context=xb(null),s=t.current,n=pa(),l=Fs(s),r=ds(n,l),r.callback=a??null,$s(s,r,l),t.current.lanes=l,lr(t,l,n),Na(t,n),t}function Wi(t,a,s,n){var l=a.current,r=pa(),o=Fs(l);return s=xb(s),a.context===null?a.context=s:a.pendingContext=s,a=ds(r,o),a.payload={element:t},n=n===void 0?null:n,n!==null&&(a.callback=n),t=$s(l,a,o),t!==null&&(Ka(t,l,o,r),Jr(t,l,o)),o}function Ci(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Qp(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<a?s:a}}function cu(t,a){Qp(t,a),(t=t.alternate)&&Qp(t,a)}function NN(){return null}var jb=typeof reportError=="function"?reportError:function(t){console.error(t)};function du(t){this._internalRoot=t}Vi.prototype.render=du.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(Ee(409));Wi(t,a,null,null)};Vi.prototype.unmount=du.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;pn(function(){Wi(null,t,null,null)}),a[ms]=null}};function Vi(t){this._internalRoot=t}Vi.prototype.unstable_scheduleHydration=function(t){if(t){var a=Kg();t={blockedOn:null,target:t,priority:a};for(var s=0;s<Es.length&&a!==0&&a<Es[s].priority;s++);Es.splice(s,0,t),s===0&&Zg(t)}};function uu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Gi(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Jp(){}function _N(t,a,s,n,l){if(l){if(typeof n=="function"){var r=n;n=function(){var d=Ci(o);r.call(d)}}var o=bb(a,n,t,0,null,!1,!1,"",Jp);return t._reactRootContainer=o,t[ms]=o.current,ql(t.nodeType===8?t.parentNode:t),pn(),o}for(;l=t.lastChild;)t.removeChild(l);if(typeof n=="function"){var u=n;n=function(){var d=Ci(c);u.call(d)}}var c=ou(t,0,!1,null,null,!1,!1,"",Jp);return t._reactRootContainer=c,t[ms]=c.current,ql(t.nodeType===8?t.parentNode:t),pn(function(){Wi(a,c,s,n)}),c}function Hi(t,a,s,n,l){var r=s._reactRootContainer;if(r){var o=r;if(typeof l=="function"){var u=l;l=function(){var c=Ci(o);u.call(c)}}Wi(a,o,t,l)}else o=_N(s,a,t,l,n);return Ci(o)}Qg=function(t){switch(t.tag){case 3:var a=t.stateNode;if(a.current.memoizedState.isDehydrated){var s=wl(a.pendingLanes);s!==0&&(Ad(a,s|1),Na(a,Bt()),!(xt&6)&&(Zn=Bt()+500,qs()))}break;case 13:pn(function(){var n=hs(t,1);if(n!==null){var l=pa();Ka(n,t,1,l)}}),cu(t,1)}};Td=function(t){if(t.tag===13){var a=hs(t,134217728);if(a!==null){var s=pa();Ka(a,t,134217728,s)}cu(t,134217728)}};Jg=function(t){if(t.tag===13){var a=Fs(t),s=hs(t,a);if(s!==null){var n=pa();Ka(s,t,a,n)}cu(t,a)}};Kg=function(){return _t};Yg=function(t,a){var s=_t;try{return _t=t,a()}finally{_t=s}};Dc=function(t,a,s){switch(a){case"input":if(wc(t,s),a=s.name,s.type==="radio"&&a!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<s.length;a++){var n=s[a];if(n!==t&&n.form===t.form){var l=Ui(n);if(!l)throw Error(Ee(90));Pg(n),wc(n,l)}}}break;case"textarea":Ag(t,s);break;case"select":a=s.value,a!=null&&Fn(t,!!s.multiple,a,!1)}};Og=nu;$g=pn;var SN={usingClientEntryPoint:!1,Events:[ir,Rn,Ui,Mg,Ug,nu]},xl={findFiberByHostInstance:sn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wN={bundleType:xl.bundleType,version:xl.version,rendererPackageName:xl.rendererPackageName,rendererConfig:xl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=zg(t),t===null?null:t.stateNode},findFiberByHostInstance:xl.findFiberByHostInstance||NN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lr.isDisabled&&Lr.supportsFiber)try{Di=Lr.inject(wN),as=Lr}catch{}}Ea.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SN;Ea.createPortal=function(t,a){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uu(a))throw Error(Ee(200));return vN(t,a,null,s)};Ea.createRoot=function(t,a){if(!uu(t))throw Error(Ee(299));var s=!1,n="",l=jb;return a!=null&&(a.unstable_strictMode===!0&&(s=!0),a.identifierPrefix!==void 0&&(n=a.identifierPrefix),a.onRecoverableError!==void 0&&(l=a.onRecoverableError)),a=ou(t,1,!1,null,null,s,!1,n,l),t[ms]=a.current,ql(t.nodeType===8?t.parentNode:t),new du(a)};Ea.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(Ee(188)):(t=Object.keys(t).join(","),Error(Ee(268,t)));return t=zg(a),t=t===null?null:t.stateNode,t};Ea.flushSync=function(t){return pn(t)};Ea.hydrate=function(t,a,s){if(!Gi(a))throw Error(Ee(200));return Hi(null,t,a,!0,s)};Ea.hydrateRoot=function(t,a,s){if(!uu(t))throw Error(Ee(405));var n=s!=null&&s.hydratedSources||null,l=!1,r="",o=jb;if(s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(r=s.identifierPrefix),s.onRecoverableError!==void 0&&(o=s.onRecoverableError)),a=bb(a,null,t,1,s??null,l,!1,r,o),t[ms]=a.current,ql(t),n)for(t=0;t<n.length;t++)s=n[t],l=s._getVersion,l=l(s._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[s,l]:a.mutableSourceEagerHydrationData.push(s,l);return new Vi(a)};Ea.render=function(t,a,s){if(!Gi(a))throw Error(Ee(200));return Hi(null,t,a,!1,s)};Ea.unmountComponentAtNode=function(t){if(!Gi(t))throw Error(Ee(40));return t._reactRootContainer?(pn(function(){Hi(null,null,t,!1,function(){t._reactRootContainer=null,t[ms]=null})}),!0):!1};Ea.unstable_batchedUpdates=nu;Ea.unstable_renderSubtreeIntoContainer=function(t,a,s,n){if(!Gi(s))throw Error(Ee(200));if(t==null||t._reactInternals===void 0)throw Error(Ee(38));return Hi(t,a,s,!1,n)};Ea.version="18.3.1-next-f1338f8080-20240426";function yb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(yb)}catch(t){console.error(t)}}yb(),yg.exports=Ea;var kN=yg.exports,Kp=kN;bc.createRoot=Kp.createRoot,bc.hydrateRoot=Kp.hydrateRoot;const CN="modulepreload",PN=function(t){return"/app/"+t},Yp={},vb=function(a,s,n){let l=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));l=Promise.allSettled(s.map(c=>{if(c=PN(c),c in Yp)return;Yp[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":CN,d||(p.as="script"),p.crossOrigin="",p.href=c,u&&p.setAttribute("nonce",u),document.head.appendChild(p),d)return new Promise((g,N)=>{p.addEventListener("load",g),p.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${c}`)))})}))}function r(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return l.then(o=>{for(const u of o||[])u.status==="rejected"&&r(u.reason);return a().catch(r)})};/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ar(){return ar=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},ar.apply(this,arguments)}var Rs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Rs||(Rs={}));const Zp="popstate";function EN(t){t===void 0&&(t={});function a(n,l){let{pathname:r,search:o,hash:u}=n.location;return ud("",{pathname:r,search:o,hash:u},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function s(n,l){return typeof l=="string"?l:Pi(l)}return TN(a,s,null,t)}function Lt(t,a){if(t===!1||t===null||typeof t>"u")throw new Error(a)}function mu(t,a){if(!t){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function AN(){return Math.random().toString(36).substr(2,8)}function Xp(t,a){return{usr:t.state,key:t.key,idx:a}}function ud(t,a,s,n){return s===void 0&&(s=null),ar({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof a=="string"?nl(a):a,{state:s,key:a&&a.key||n||AN()})}function Pi(t){let{pathname:a="/",search:s="",hash:n=""}=t;return s&&s!=="?"&&(a+=s.charAt(0)==="?"?s:"?"+s),n&&n!=="#"&&(a+=n.charAt(0)==="#"?n:"#"+n),a}function nl(t){let a={};if(t){let s=t.indexOf("#");s>=0&&(a.hash=t.substr(s),t=t.substr(0,s));let n=t.indexOf("?");n>=0&&(a.search=t.substr(n),t=t.substr(0,n)),t&&(a.pathname=t)}return a}function TN(t,a,s,n){n===void 0&&(n={});let{window:l=document.defaultView,v5Compat:r=!1}=n,o=l.history,u=Rs.Pop,c=null,d=h();d==null&&(d=0,o.replaceState(ar({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function p(){u=Rs.Pop;let A=h(),y=A==null?null:A-d;d=A,c&&c({action:u,location:w.location,delta:y})}function g(A,y){u=Rs.Push;let x=ud(w.location,A,y);d=h()+1;let f=Xp(x,d),b=w.createHref(x);try{o.pushState(f,"",b)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;l.location.assign(b)}r&&c&&c({action:u,location:w.location,delta:1})}function N(A,y){u=Rs.Replace;let x=ud(w.location,A,y);d=h();let f=Xp(x,d),b=w.createHref(x);o.replaceState(f,"",b),r&&c&&c({action:u,location:w.location,delta:0})}function v(A){let y=l.location.origin!=="null"?l.location.origin:l.location.href,x=typeof A=="string"?A:Pi(A);return x=x.replace(/ $/,"%20"),Lt(y,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,y)}let w={get action(){return u},get location(){return t(l,o)},listen(A){if(c)throw new Error("A history only accepts one active listener");return l.addEventListener(Zp,p),c=A,()=>{l.removeEventListener(Zp,p),c=null}},createHref(A){return a(l,A)},createURL:v,encodeLocation(A){let y=v(A);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:g,replace:N,go(A){return o.go(A)}};return w}var ef;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ef||(ef={}));function DN(t,a,s){return s===void 0&&(s="/"),RN(t,a,s)}function RN(t,a,s,n){let l=typeof a=="string"?nl(a):a,r=Xn(l.pathname||"/",s);if(r==null)return null;let o=Nb(t);LN(o);let u=null;for(let c=0;u==null&&c<o.length;++c){let d=GN(r);u=WN(o[c],d)}return u}function Nb(t,a,s,n){a===void 0&&(a=[]),s===void 0&&(s=[]),n===void 0&&(n="");let l=(r,o,u)=>{let c={relativePath:u===void 0?r.path||"":u,caseSensitive:r.caseSensitive===!0,childrenIndex:o,route:r};c.relativePath.startsWith("/")&&(Lt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Bs([n,c.relativePath]),h=s.concat(c);r.children&&r.children.length>0&&(Lt(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),Nb(r.children,a,h,d)),!(r.path==null&&!r.index)&&a.push({path:d,score:zN(d,r.index),routesMeta:h})};return t.forEach((r,o)=>{var u;if(r.path===""||!((u=r.path)!=null&&u.includes("?")))l(r,o);else for(let c of _b(r.path))l(r,o,c)}),a}function _b(t){let a=t.split("/");if(a.length===0)return[];let[s,...n]=a,l=s.endsWith("?"),r=s.replace(/\?$/,"");if(n.length===0)return l?[r,""]:[r];let o=_b(n.join("/")),u=[];return u.push(...o.map(c=>c===""?r:[r,c].join("/"))),l&&u.push(...o),u.map(c=>t.startsWith("/")&&c===""?"/":c)}function LN(t){t.sort((a,s)=>a.score!==s.score?s.score-a.score:BN(a.routesMeta.map(n=>n.childrenIndex),s.routesMeta.map(n=>n.childrenIndex)))}const MN=/^:[\w-]+$/,UN=3,ON=2,$N=1,IN=10,FN=-2,tf=t=>t==="*";function zN(t,a){let s=t.split("/"),n=s.length;return s.some(tf)&&(n+=FN),a&&(n+=ON),s.filter(l=>!tf(l)).reduce((l,r)=>l+(MN.test(r)?UN:r===""?$N:IN),n)}function BN(t,a){return t.length===a.length&&t.slice(0,-1).every((n,l)=>n===a[l])?t[t.length-1]-a[a.length-1]:0}function WN(t,a,s){let{routesMeta:n}=t,l={},r="/",o=[];for(let u=0;u<n.length;++u){let c=n[u],d=u===n.length-1,h=r==="/"?a:a.slice(r.length)||"/",p=md({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),g=c.route;if(!p)return null;Object.assign(l,p.params),o.push({params:l,pathname:Bs([r,p.pathname]),pathnameBase:KN(Bs([r,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(r=Bs([r,p.pathnameBase]))}return o}function md(t,a){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,n]=VN(t.path,t.caseSensitive,t.end),l=a.match(s);if(!l)return null;let r=l[0],o=r.replace(/(.)\/+$/,"$1"),u=l.slice(1);return{params:n.reduce((d,h,p)=>{let{paramName:g,isOptional:N}=h;if(g==="*"){let w=u[p]||"";o=r.slice(0,r.length-w.length).replace(/(.)\/+$/,"$1")}const v=u[p];return N&&!v?d[g]=void 0:d[g]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:r,pathnameBase:o,pattern:t}}function VN(t,a,s){a===void 0&&(a=!1),s===void 0&&(s=!0),mu(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],l="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,c)=>(n.push({paramName:u,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),l+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?l+="\\/*$":t!==""&&t!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,a?void 0:"i"),n]}function GN(t){try{return t.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return mu(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+a+").")),t}}function Xn(t,a){if(a==="/")return t;if(!t.toLowerCase().startsWith(a.toLowerCase()))return null;let s=a.endsWith("/")?a.length-1:a.length,n=t.charAt(s);return n&&n!=="/"?null:t.slice(s)||"/"}const HN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,qN=t=>HN.test(t);function QN(t,a){a===void 0&&(a="/");let{pathname:s,search:n="",hash:l=""}=typeof t=="string"?nl(t):t,r;if(s)if(qN(s))r=s;else{if(s.includes("//")){let o=s;s=s.replace(/\/\/+/g,"/"),mu(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+s))}s.startsWith("/")?r=af(s.substring(1),"/"):r=af(s,a)}else r=a;return{pathname:r,search:YN(n),hash:ZN(l)}}function af(t,a){let s=a.replace(/\/+$/,"").split("/");return t.split("/").forEach(l=>{l===".."?s.length>1&&s.pop():l!=="."&&s.push(l)}),s.length>1?s.join("/"):"/"}function Zo(t,a,s,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+a+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function JN(t){return t.filter((a,s)=>s===0||a.route.path&&a.route.path.length>0)}function hu(t,a){let s=JN(t);return a?s.map((n,l)=>l===s.length-1?n.pathname:n.pathnameBase):s.map(n=>n.pathnameBase)}function pu(t,a,s,n){n===void 0&&(n=!1);let l;typeof t=="string"?l=nl(t):(l=ar({},t),Lt(!l.pathname||!l.pathname.includes("?"),Zo("?","pathname","search",l)),Lt(!l.pathname||!l.pathname.includes("#"),Zo("#","pathname","hash",l)),Lt(!l.search||!l.search.includes("#"),Zo("#","search","hash",l)));let r=t===""||l.pathname==="",o=r?"/":l.pathname,u;if(o==null)u=s;else{let p=a.length-1;if(!n&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),p-=1;l.pathname=g.join("/")}u=p>=0?a[p]:"/"}let c=QN(l,u),d=o&&o!=="/"&&o.endsWith("/"),h=(r||o===".")&&s.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const Bs=t=>t.join("/").replace(/\/\/+/g,"/"),KN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),YN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,ZN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function XN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Sb=["post","put","patch","delete"];new Set(Sb);const e_=["get",...Sb];new Set(e_);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sr(){return sr=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},sr.apply(this,arguments)}const qi=i.createContext(null),wb=i.createContext(null),gs=i.createContext(null),Qi=i.createContext(null),xs=i.createContext({outlet:null,matches:[],isDataRoute:!1}),kb=i.createContext(null);function t_(t,a){let{relative:s}=a===void 0?{}:a;ll()||Lt(!1);let{basename:n,navigator:l}=i.useContext(gs),{hash:r,pathname:o,search:u}=Ji(t,{relative:s}),c=o;return n!=="/"&&(c=o==="/"?n:Bs([n,o])),l.createHref({pathname:c,search:u,hash:r})}function ll(){return i.useContext(Qi)!=null}function ua(){return ll()||Lt(!1),i.useContext(Qi).location}function Cb(t){i.useContext(gs).static||i.useLayoutEffect(t)}function bs(){let{isDataRoute:t}=i.useContext(xs);return t?p_():a_()}function a_(){ll()||Lt(!1);let t=i.useContext(qi),{basename:a,future:s,navigator:n}=i.useContext(gs),{matches:l}=i.useContext(xs),{pathname:r}=ua(),o=JSON.stringify(hu(l,s.v7_relativeSplatPath)),u=i.useRef(!1);return Cb(()=>{u.current=!0}),i.useCallback(function(d,h){if(h===void 0&&(h={}),!u.current)return;if(typeof d=="number"){n.go(d);return}let p=pu(d,JSON.parse(o),r,h.relative==="path");t==null&&a!=="/"&&(p.pathname=p.pathname==="/"?a:Bs([a,p.pathname])),(h.replace?n.replace:n.push)(p,h.state,h)},[a,n,o,r,t])}function js(){let{matches:t}=i.useContext(xs),a=t[t.length-1];return a?a.params:{}}function Ji(t,a){let{relative:s}=a===void 0?{}:a,{future:n}=i.useContext(gs),{matches:l}=i.useContext(xs),{pathname:r}=ua(),o=JSON.stringify(hu(l,n.v7_relativeSplatPath));return i.useMemo(()=>pu(t,JSON.parse(o),r,s==="path"),[t,o,r,s])}function s_(t,a){return n_(t,a)}function n_(t,a,s,n){ll()||Lt(!1);let{navigator:l}=i.useContext(gs),{matches:r}=i.useContext(xs),o=r[r.length-1],u=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=ua(),h;if(a){var p;let A=typeof a=="string"?nl(a):a;c==="/"||(p=A.pathname)!=null&&p.startsWith(c)||Lt(!1),h=A}else h=d;let g=h.pathname||"/",N=g;if(c!=="/"){let A=c.replace(/^\//,"").split("/");N="/"+g.replace(/^\//,"").split("/").slice(A.length).join("/")}let v=DN(t,{pathname:N}),w=c_(v&&v.map(A=>Object.assign({},A,{params:Object.assign({},u,A.params),pathname:Bs([c,l.encodeLocation?l.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?c:Bs([c,l.encodeLocation?l.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),r,s,n);return a&&w?i.createElement(Qi.Provider,{value:{location:sr({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Rs.Pop}},w):w}function l_(){let t=h_(),a=XN(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,l={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},a),s?i.createElement("pre",{style:l},s):null,null)}const r_=i.createElement(l_,null);class i_ extends i.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,s){return s.location!==a.location||s.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:s.error,location:s.location,revalidation:a.revalidation||s.revalidation}}componentDidCatch(a,s){console.error("React Router caught the following error during render",a,s)}render(){return this.state.error!==void 0?i.createElement(xs.Provider,{value:this.props.routeContext},i.createElement(kb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function o_(t){let{routeContext:a,match:s,children:n}=t,l=i.useContext(qi);return l&&l.static&&l.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=s.route.id),i.createElement(xs.Provider,{value:a},n)}function c_(t,a,s,n){var l;if(a===void 0&&(a=[]),s===void 0&&(s=null),n===void 0&&(n=null),t==null){var r;if(!s)return null;if(s.errors)t=s.matches;else if((r=n)!=null&&r.v7_partialHydration&&a.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let o=t,u=(l=s)==null?void 0:l.errors;if(u!=null){let h=o.findIndex(p=>p.route.id&&(u==null?void 0:u[p.route.id])!==void 0);h>=0||Lt(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,d=-1;if(s&&n&&n.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:g,errors:N}=s,v=p.route.loader&&g[p.route.id]===void 0&&(!N||N[p.route.id]===void 0);if(p.route.lazy||v){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,p,g)=>{let N,v=!1,w=null,A=null;s&&(N=u&&p.route.id?u[p.route.id]:void 0,w=p.route.errorElement||r_,c&&(d<0&&g===0?(f_("route-fallback"),v=!0,A=null):d===g&&(v=!0,A=p.route.hydrateFallbackElement||null)));let y=a.concat(o.slice(0,g+1)),x=()=>{let f;return N?f=w:v?f=A:p.route.Component?f=i.createElement(p.route.Component,null):p.route.element?f=p.route.element:f=h,i.createElement(o_,{match:p,routeContext:{outlet:h,matches:y,isDataRoute:s!=null},children:f})};return s&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?i.createElement(i_,{location:s.location,revalidation:s.revalidation,component:w,error:N,children:x(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):x()},null)}var Pb=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Pb||{}),Eb=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Eb||{});function d_(t){let a=i.useContext(qi);return a||Lt(!1),a}function u_(t){let a=i.useContext(wb);return a||Lt(!1),a}function m_(t){let a=i.useContext(xs);return a||Lt(!1),a}function Ab(t){let a=m_(),s=a.matches[a.matches.length-1];return s.route.id||Lt(!1),s.route.id}function h_(){var t;let a=i.useContext(kb),s=u_(),n=Ab();return a!==void 0?a:(t=s.errors)==null?void 0:t[n]}function p_(){let{router:t}=d_(Pb.UseNavigateStable),a=Ab(Eb.UseNavigateStable),s=i.useRef(!1);return Cb(()=>{s.current=!0}),i.useCallback(function(l,r){r===void 0&&(r={}),s.current&&(typeof l=="number"?t.navigate(l):t.navigate(l,sr({fromRouteId:a},r)))},[t,a])}const sf={};function f_(t,a,s){sf[t]||(sf[t]=!0)}function g_(t,a){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function ze(t){let{to:a,replace:s,state:n,relative:l}=t;ll()||Lt(!1);let{future:r,static:o}=i.useContext(gs),{matches:u}=i.useContext(xs),{pathname:c}=ua(),d=bs(),h=pu(a,hu(u,r.v7_relativeSplatPath),c,l==="path"),p=JSON.stringify(h);return i.useEffect(()=>d(JSON.parse(p),{replace:s,state:n,relative:l}),[d,p,l,s,n]),null}function Ve(t){Lt(!1)}function x_(t){let{basename:a="/",children:s=null,location:n,navigationType:l=Rs.Pop,navigator:r,static:o=!1,future:u}=t;ll()&&Lt(!1);let c=a.replace(/^\/*/,"/"),d=i.useMemo(()=>({basename:c,navigator:r,static:o,future:sr({v7_relativeSplatPath:!1},u)}),[c,u,r,o]);typeof n=="string"&&(n=nl(n));let{pathname:h="/",search:p="",hash:g="",state:N=null,key:v="default"}=n,w=i.useMemo(()=>{let A=Xn(h,c);return A==null?null:{location:{pathname:A,search:p,hash:g,state:N,key:v},navigationType:l}},[c,h,p,g,N,v,l]);return w==null?null:i.createElement(gs.Provider,{value:d},i.createElement(Qi.Provider,{children:s,value:w}))}function b_(t){let{children:a,location:s}=t;return s_(hd(a),s)}new Promise(()=>{});function hd(t,a){a===void 0&&(a=[]);let s=[];return i.Children.forEach(t,(n,l)=>{if(!i.isValidElement(n))return;let r=[...a,l];if(n.type===i.Fragment){s.push.apply(s,hd(n.props.children,r));return}n.type!==Ve&&Lt(!1),!n.props.index||!n.props.children||Lt(!1);let o={id:n.props.id||r.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=hd(n.props.children,r)),s.push(o)}),s}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ei(){return Ei=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Ei.apply(this,arguments)}function Tb(t,a){if(t==null)return{};var s={},n=Object.keys(t),l,r;for(r=0;r<n.length;r++)l=n[r],!(a.indexOf(l)>=0)&&(s[l]=t[l]);return s}function j_(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function y_(t,a){return t.button===0&&(!a||a==="_self")&&!j_(t)}const v_=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],N_=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],__="6";try{window.__reactRouterVersion=__}catch{}const S_=i.createContext({isTransitioning:!1}),w_="startTransition",nf=fy[w_];function k_(t){let{basename:a,children:s,future:n,window:l}=t,r=i.useRef();r.current==null&&(r.current=EN({window:l,v5Compat:!0}));let o=r.current,[u,c]=i.useState({action:o.action,location:o.location}),{v7_startTransition:d}=n||{},h=i.useCallback(p=>{d&&nf?nf(()=>c(p)):c(p)},[c,d]);return i.useLayoutEffect(()=>o.listen(h),[o,h]),i.useEffect(()=>g_(n),[n]),i.createElement(x_,{basename:a,children:s,location:u.location,navigationType:u.action,navigator:o,future:n})}const C_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",P_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dt=i.forwardRef(function(a,s){let{onClick:n,relative:l,reloadDocument:r,replace:o,state:u,target:c,to:d,preventScrollReset:h,viewTransition:p}=a,g=Tb(a,v_),{basename:N}=i.useContext(gs),v,w=!1;if(typeof d=="string"&&P_.test(d)&&(v=d,C_))try{let f=new URL(window.location.href),b=d.startsWith("//")?new URL(f.protocol+d):new URL(d),k=Xn(b.pathname,N);b.origin===f.origin&&k!=null?d=k+b.search+b.hash:w=!0}catch{}let A=t_(d,{relative:l}),y=A_(d,{replace:o,state:u,target:c,preventScrollReset:h,relative:l,viewTransition:p});function x(f){n&&n(f),f.defaultPrevented||y(f)}return i.createElement("a",Ei({},g,{href:v||A,onClick:w||r?n:x,ref:s,target:c}))}),Xo=i.forwardRef(function(a,s){let{"aria-current":n="page",caseSensitive:l=!1,className:r="",end:o=!1,style:u,to:c,viewTransition:d,children:h}=a,p=Tb(a,N_),g=Ji(c,{relative:p.relative}),N=ua(),v=i.useContext(wb),{navigator:w,basename:A}=i.useContext(gs),y=v!=null&&T_(g)&&d===!0,x=w.encodeLocation?w.encodeLocation(g).pathname:g.pathname,f=N.pathname,b=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;l||(f=f.toLowerCase(),b=b?b.toLowerCase():null,x=x.toLowerCase()),b&&A&&(b=Xn(b,A)||b);const k=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let _=f===x||!o&&f.startsWith(x)&&f.charAt(k)==="/",P=b!=null&&(b===x||!o&&b.startsWith(x)&&b.charAt(x.length)==="/"),S={isActive:_,isPending:P,isTransitioning:y},F=_?n:void 0,L;typeof r=="function"?L=r(S):L=[r,_?"active":null,P?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let Q=typeof u=="function"?u(S):u;return i.createElement(dt,Ei({},p,{"aria-current":F,className:L,ref:s,style:Q,to:c,viewTransition:d}),typeof h=="function"?h(S):h)});var pd;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(pd||(pd={}));var lf;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(lf||(lf={}));function E_(t){let a=i.useContext(qi);return a||Lt(!1),a}function A_(t,a){let{target:s,replace:n,state:l,preventScrollReset:r,relative:o,viewTransition:u}=a===void 0?{}:a,c=bs(),d=ua(),h=Ji(t,{relative:o});return i.useCallback(p=>{if(y_(p,s)){p.preventDefault();let g=n!==void 0?n:Pi(d)===Pi(h);c(t,{replace:g,state:l,preventScrollReset:r,relative:o,viewTransition:u})}},[d,c,h,n,l,s,t,r,o,u])}function T_(t,a){a===void 0&&(a={});let s=i.useContext(S_);s==null&&Lt(!1);let{basename:n}=E_(pd.useViewTransitionState),l=Ji(t,{relative:a.relative});if(!s.isTransitioning)return!1;let r=Xn(s.currentLocation.pathname,n)||s.currentLocation.pathname,o=Xn(s.nextLocation.pathname,n)||s.nextLocation.pathname;return md(l.pathname,o)!=null||md(l.pathname,r)!=null}const D_="http://127.0.0.1:8000";function R_(t){return String(t).trim().replace(/\/+$/,"")}function Db(t){return t==="localhost"||t==="127.0.0.1"}function L_(t){try{const a=new URL(t);return Db(a.hostname)}catch{return!1}}function rf(t){try{const a=new URL(t),s=String(a.hostname||"").toLowerCase();return s==="example.com"||s==="api.example.com"||s.endsWith(".example.com")}catch{return!1}}function M_(){const t=R_("http://127.0.0.1:8000");if(typeof window<"u"){const a=window.location.hostname,s=Db(a);return t&&!(L_(t)&&!s)&&!rf(t)?t:window.location.origin}return t&&!rf(t)?t:D_}const ec=M_();function of(t){return t.startsWith("http://")||t.startsWith("https://")?t:ec?t.startsWith("/api")?`${ec}${t}`:`${ec}/api${t.startsWith("/")?"":"/"}${t}`:t.startsWith("/api")?t:`/api${t.startsWith("/")?"":"/"}${t}`}function U_(t){if(typeof document>"u")return"";const a=document.cookie?document.cookie.split(";"):[];for(const s of a){const n=s.trim();if(n.startsWith(`${t}=`))return decodeURIComponent(n.substring(t.length+1))}return""}function O_(){if(typeof Intl>"u"||typeof Intl.DateTimeFormat!="function")return"";try{return Intl.DateTimeFormat().resolvedOptions().timeZone||""}catch{return""}}function ns(){return U_("csrftoken")}async function U(t,a={}){const s=of(t),n=O_(),l={credentials:"include",headers:{...n?{"X-Browser-Timezone":n}:{},...a.headers||{}},...a},r=(l.method||"GET").toUpperCase();if(typeof window<"u"&&window.__WZ_READ_ONLY__&&r!=="GET"&&r!=="HEAD"){const d=new Error("read_only");throw d.status=403,d.data={error:"read_only"},d}r!=="GET"&&r!=="HEAD"&&(ns()||await fetch(of("/api/auth/csrf"),{credentials:"include"}),l.headers={"Content-Type":"application/json","X-CSRFToken":ns(),...l.headers});const o=await fetch(s,l),u=await o.text();let c=null;if(u)try{c=JSON.parse(u)}catch{c=null}if(!o.ok){const d=(c==null?void 0:c.error)||(c==null?void 0:c.detail)||`Request failed (${o.status})`,h=new Error(d);throw h.status=o.status,h.data=c,h}return c}function st({page:t,totalPages:a,onPageChange:s,showPageLinks:n=!1,showPageLabel:l=!0,maxPageLinks:r=7}){if(a<=1)return null;const o=()=>{const d=window.prompt(`Go to page (1-${a})`,String(t));if(!d)return;const h=Number(d);if(!Number.isFinite(h))return;const p=Math.min(Math.max(Math.trunc(h),1),a);p!==t&&s(p)},c=(()=>{if(!n)return[];if(a<=r)return Array.from({length:a},(N,v)=>({type:"page",number:v+1}));const d=Math.max(r-2,1);let h=t-Math.floor(d/2),p=t+Math.floor(d/2);h<2&&(h=2,p=h+d-1),p>a-1&&(p=a-1,h=p-d+1);const g=[{type:"page",number:1}];h>2&&g.push({type:"ellipsis",key:"start-ellipsis"});for(let N=h;N<=p;N+=1)g.push({type:"page",number:N});return p<a-1&&g.push({type:"ellipsis",key:"end-ellipsis"}),g.push({type:"page",number:a}),g})();return e.jsxs("div",{className:"table-pagination",children:[e.jsx("button",{type:"button",className:"shot-btn",onClick:()=>s(Math.max(t-1,1)),disabled:t<=1,children:"Previous"}),l?e.jsxs("button",{type:"button",className:"table-page-label table-page-label-button",onClick:o,title:"Jump to page",children:["Page ",t," of ",a]}):null,n?e.jsx("div",{className:"table-page-links",children:c.map((d,h)=>d.type==="ellipsis"?e.jsx("span",{className:"table-page-ellipsis",children:"..."},d.key||`ellipsis-${h}`):e.jsx("button",{type:"button",className:`table-page-link ${d.number===t?"active":""}`,onClick:()=>{d.number!==t&&s(d.number)},"aria-current":d.number===t?"page":void 0,children:d.number},d.number))}):null,e.jsx("button",{type:"button",className:"shot-btn",onClick:()=>s(Math.min(t+1,a)),disabled:t>=a,children:"Next"})]})}const Rb=i.createContext({loading:!0,error:"",branding:null});function cf(t){const a=t||"worksuite",s=a==="worksuite"?"Work Suite":a==="ai-chatbot"?"AI Chatbot":a==="storage"?"Online Storage":a==="saas-admin"?"SaaS Admin":"Work Zilla";return{key:a,displayName:s,tagline:"",description:"",logoUrl:"",primaryColor:"",publicSlug:a,legacySlugs:[],aliases:{ui:{monitorLabel:a==="worksuite"?s:"Work Suite"},marketing:{},email:{}}}}function $_({productKey:t,children:a}){const[s,n]=i.useState(()=>({loading:!0,error:"",branding:cf(t)})),l=i.useRef(new Map);i.useEffect(()=>{let o=!0;const u=t||"worksuite",c=l.current.get(u);c!=null&&c.data?n({loading:!1,error:"",branding:c.data}):n(h=>({...h,loading:!0,branding:cf(u)}));async function d(){try{const h={};c!=null&&c.etag&&(h["If-None-Match"]=c.etag);const p=await fetch(`/api/public/branding/?product=${encodeURIComponent(u)}`,{credentials:"include",headers:h});if(!o)return;if(p.status===304&&(c!=null&&c.data)){n({loading:!1,error:"",branding:c.data});return}if(!p.ok)throw new Error("Unable to load branding");const g=await p.json(),N=p.headers.get("ETag");l.current.set(u,{data:g,etag:N}),n({loading:!1,error:"",branding:g})}catch(h){o&&n(p=>({...p,loading:!1,error:(h==null?void 0:h.message)||"Unable to load branding"}))}}return d(),()=>{o=!1}},[t]);const r=i.useMemo(()=>s,[s]);return e.jsx(Rb.Provider,{value:r,children:a})}function el(){return i.useContext(Rb)}function Ki({products:t=[],subscriptions:a=[],isReadOnly:s=!1,currentProductKey:n=""}){var N,v;const{branding:l}=el(),r=((v=(N=l==null?void 0:l.aliases)==null?void 0:N.ui)==null?void 0:v.monitorLabel)||(l==null?void 0:l.displayName)||"Work Suite",o=(l==null?void 0:l.description)||(l==null?void 0:l.tagline)||"Workforce monitoring and productivity insights.",u=w=>{const A=String(w||"").trim().toLowerCase();return A?A==="worksuite"?"monitor":A==="online-storage"?"storage":A==="business-autopilot"?"business-autopilot-erp":A:""},c={monitor:"/app/work-suite",worksuite:"/app/work-suite","ai-chatbot":"/app/ai-chatbot",storage:"/app/storage","online-storage":"/app/storage","business-autopilot-erp":"/app/business-autopilot","whatsapp-automation":"/app/whatsapp-automation","ai-chat-widget":"/app/ai-chat-widget","digital-card":"/app/digital-card"},d={monitor:{name:r,icon:"bi-display",description:o,features:["Live activity","Screenshots","App usage"]},"ai-chatbot":{name:"AI Chatbot",icon:"bi-robot",description:"Website chatbot and live agent support in one inbox.",features:["Live chat","Agent inbox","Leads"]},storage:{name:"Online Storage",icon:"bi-cloud",description:"Secure online cloud file storage with org-based controls.",features:["Online Access","Admin Controls","Free System Sync"]},"business-autopilot-erp":{name:"Business Autopilot ERP",icon:"bi-building-gear",description:"Modular ERP suite for CRM, HR, projects, accounts, ticketing, and stocks.",features:["CRM","HR","Projects","Accounts / ERP","Ticketing","Stocks"]},"whatsapp-automation":{name:"Whatsapp Automation",icon:"bi-whatsapp",description:"WhatsApp business automation tools with inbox, campaign, and digital card modules.",features:["Inbox","Automation","Digital Card","Catalogue"]},"digital-card":{name:"Digital Card",icon:"bi-person-vcard",description:"Shareable digital business card with profile, links, and contact actions.",features:["Public card","Theme","Contact links"]}},h=i.useMemo(()=>{const w=Date.now(),A=new Set;return(a||[]).forEach(y=>{const x=String(y.status||"").toLowerCase(),f=u(y.product_slug);if(f){if(x==="active"){A.add(f);return}if(x==="trialing"){if(!y.trial_end){A.add(f);return}const b=Date.parse(y.trial_end);(Number.isNaN(b)||b>=w)&&A.add(f)}}}),A},[a]),p=u(n),g=i.useMemo(()=>{let w=t&&t.length?t:[];if(!w.length){const A=["monitor","ai-chatbot","storage","business-autopilot-erp","whatsapp-automation"],y=new Set(A),x=new Set(A);h.forEach(f=>{y.has(f)&&x.add(f)}),p&&y.has(p)&&x.add(p),w=Array.from(x).map(f=>{var b,k,_,P;return{slug:f,name:((b=d[f])==null?void 0:b.name)||(f==="monitor"?r:f),icon:((k=d[f])==null?void 0:k.icon)||"bi-box",description:((_=d[f])==null?void 0:_.description)||"",features:((P=d[f])==null?void 0:P.features)||[],status:"active"}})}return Array.from(w.reduce((A,y)=>{const x=u(y.slug||y.key);if(!x)return A;const f=d[x]||{},b={key:x,name:y.name||(x==="monitor"?r:void 0)||f.name||"Product",icon:y.icon||f.icon||"bi-box",description:y.description||f.description||"",features:y.features&&y.features.length?y.features:f.features||[],status:y.status||"active"},k=A.get(x);if(!k)return A.set(x,b),A;const _=(b.description?1:0)+(b.features.length?1:0)+(b.status==="active"?1:0),P=(k.description?1:0)+(k.features.length?1:0)+(k.status==="active"?1:0);return _>=P&&A.set(x,b),A},new Map).values())},[t,r,h,p]);return s?null:e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{children:"Products"}),e.jsx("div",{className:"row g-3 mt-1",children:g.map(w=>{const A=w.key===p,y=h.has(w.key),x=w.status==="active",f=c[w.key]||`/app/${w.key}`,b=A?"Current":y?"Open Dashboard":"Take a Plan",k=A?"":x?y?f:`/pricing/?product=${w.key}`:"";return e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column text-center",children:[e.jsxs("div",{className:"d-flex flex-column align-items-center mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",style:{marginTop:"5px",marginBottom:"8px",width:"32px",height:"32px",display:"flex",alignItems:"center",justifyContent:"center",lineHeight:1,fontSize:"25px"},children:e.jsx("i",{className:`bi ${w.icon}`,"aria-hidden":"true",style:{fontSize:"25px",lineHeight:1}})}),e.jsx("h5",{className:"mb-0 lh-sm",children:w.name})]}),e.jsx("p",{className:"text-secondary small mb-2",children:w.description||"Product details coming soon."}),w.features.length?e.jsx("div",{className:"text-secondary small mb-3",children:w.features.join(" / ")}):null,A?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm mt-auto w-100",disabled:!0,children:b}):k?e.jsx("a",{href:k,className:"btn btn-primary btn-sm mt-auto w-100",children:b}):e.jsx("span",{className:"badge-coming-soon mt-auto align-self-center",children:"Coming soon"})]})},w.key)})})]})}const I_={loading:!0,error:"",data:null};function F_(){try{const a=`usageAlertLastShown:${new Date().toISOString().slice(0,10)}`,s=Number(localStorage.getItem(a)||0),n=Date.now(),l=3*60*60*1e3;return!s||n-s>=l?(localStorage.setItem(a,String(n)),!0):!1}catch{return!1}}function z_({productSlug:t="",subscriptions:a=[]}){const[s,n]=i.useState(I_),[l,r]=i.useState(!1),o=typeof window<"u"&&window.__WZ_READ_ONLY__===!0,[u,c]=i.useState(1),[d,h]=i.useState(1),[p,g]=i.useState(""),[N,v]=i.useState(""),[w,A]=i.useState(""),[y,x]=i.useState(""),f=5;i.useEffect(()=>{let ee=!0;async function T(){var Z,se;try{const be=await U("/api/dashboard/summary");if(!ee)return;n({loading:!1,error:"",data:be}),(Z=be==null?void 0:be.usage_alerts)!=null&&Z.length&&F_()&&r(!0)}catch(be){if((se=be==null?void 0:be.data)!=null&&se.redirect){window.location.href=be.data.redirect;return}ee&&n({loading:!1,error:(be==null?void 0:be.message)||"Unable to load dashboard.",data:null})}}return T(),()=>{ee=!1}},[]),i.useEffect(()=>{const ee=setTimeout(()=>{v(p.trim()),c(1)},300);return()=>clearTimeout(ee)},[p]),i.useEffect(()=>{const ee=setTimeout(()=>{x(w.trim()),h(1)},300);return()=>clearTimeout(ee)},[w]);const b=s.data||{},k=b.stats||{},_=b.org||{},P=b.subscription||null,S=b.settings||{},F=b.top_apps||[],L=b.recent_admin_actions||[],Q=b.usage_alerts||[],E=[{label:"Total Employees",value:k.employees??0,icon:"bi-people",color:"#4dabff"},{label:"Online Now",value:k.online??0,icon:"bi-broadcast",color:"#3ef58a"},{label:"Total Activities",value:k.activities??0,icon:"bi-activity",color:"#ffdd57"},{label:"Screenshots",value:k.screenshots??0,icon:"bi-camera",color:"#ff6b6b"}],C=Date.now(),z=(a||[]).filter(ee=>{if(!(ee!=null&&ee.product_slug))return!1;const T=String(ee.status||"").toLowerCase();if(T==="active")return!0;if(T==="trialing"){if(!ee.trial_end)return!0;const Z=Date.parse(ee.trial_end);return Number.isNaN(Z)?!0:Z>=C}return!1});new Set(z.map(ee=>ee.product_slug));const M=i.useMemo(()=>{if(!N)return L;const ee=N.toLowerCase();return L.filter(T=>[T.time,T.action,T.details].some(se=>String(se||"").toLowerCase().includes(ee)))},[L,N]),R=i.useMemo(()=>{if(!y)return F;const ee=y.toLowerCase();return F.filter(T=>[T.app_name,T.count].some(se=>String(se||"").toLowerCase().includes(ee)))},[F,y]),W=M.length,D=R.length,te=Math.max(Math.ceil(W/f),1),H=Math.max(Math.ceil(D/f),1),O=i.useMemo(()=>M.slice((u-1)*f,u*f),[M,u]),V=i.useMemo(()=>R.slice((d-1)*f,d*f),[R,d]),re=W?(u-1)*f+1:0,Y=W?Math.min(u*f,W):0,ce=D?(d-1)*f+1:0,ie=D?Math.min(d*f,D):0;return i.useEffect(()=>{u>te&&c(te)},[u,te]),i.useEffect(()=>{d>H&&h(H)},[d,H]),s.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading dashboard..."})]}):s.error?e.jsx("div",{className:"alert alert-danger",children:s.error}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Dashboard Analytics"}),e.jsx("hr",{className:"section-divider"}),e.jsxs("div",{id:"monitor-analytics",className:"card p-3 mb-3 notice-card",children:[e.jsx("h5",{className:"mb-1",children:"Monitoring Policy Notice"}),e.jsx("p",{className:"mb-0 text-secondary",children:"Employee activity is monitored for productivity and security purposes. Screenshots may be captured when required. Sensitive / personal screens are excluded from monitoring."})]}),e.jsx("div",{className:"row g-3",children:E.map(ee=>e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 text-center h-100",children:[e.jsx("div",{className:"stat-icon",style:{color:ee.color},children:e.jsx("i",{className:`bi ${ee.icon}`,"aria-hidden":"true"})}),e.jsx("h5",{children:ee.label}),e.jsx("div",{className:"stat-value",style:{color:ee.color},children:ee.value})]})},ee.label))}),o?null:e.jsxs("div",{className:"card p-4 mt-4",children:[e.jsx("h4",{children:"Admin Activity (Last 100)"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",f," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dashboard-admin-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dashboard-admin-search",type:"text",value:p,onChange:ee=>g(ee.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:O.length?O.map((ee,T)=>e.jsxs("tr",{children:[e.jsx("td",{children:ee.time}),e.jsx("td",{children:ee.action}),e.jsx("td",{children:ee.details||"-"})]},`${ee.time}-${T}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",children:"No admin activity yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",re," to ",Y," of ",W," entries"]}),e.jsx(st,{page:u,totalPages:te,onPageChange:c,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h5",{children:"Company Details"}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Name"}),e.jsx("strong",{children:_.name||"-"})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Company Key"}),e.jsx("strong",{children:_.company_key||"-"})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Created"}),e.jsx("strong",{children:_.created_at||"-"})]})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h5",{children:"Subscription"}),P?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Plan"}),e.jsx("strong",{children:P.plan})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Employees Allowed"}),e.jsx("strong",{children:P.employee_limit===0?"Unlimited":P.employee_limit})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Valid Till"}),e.jsx("strong",{children:P.end_date||"-"})]})]}):e.jsx("div",{className:"monitor-summary-note",children:"No active plan."})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h5",{children:"Screenshot Interval"}),e.jsxs("div",{className:"monitor-summary-row monitor-summary-row--accent",children:[e.jsx("span",{children:"Current Interval"}),e.jsxs("strong",{children:[S.screenshot_interval_minutes??"-"," minutes"]})]})]})})]}),e.jsxs("div",{className:"card p-4 mt-4",children:[e.jsx("h4",{children:"Top Applications Used"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",f," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dashboard-apps-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dashboard-apps-search",type:"text",value:w,onChange:ee=>A(ee.target.value),placeholder:"Search apps"})]})]}),R.length?e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Application"}),e.jsx("th",{children:"Usage Count"})]})}),e.jsx("tbody",{children:V.map((ee,T)=>e.jsxs("tr",{children:[e.jsx("td",{children:ee.app_name}),e.jsx("td",{children:ee.count})]},`${ee.app_name}-${T}`))})]})}):e.jsx("p",{className:"mb-0",children:"No data available."}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",ce," to ",ie," of ",D," entries"]}),e.jsx(st,{page:d,totalPages:H,onPageChange:h,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsx(Ki,{products:b.products||[],subscriptions:a,isReadOnly:o,currentProductKey:"monitor"}),l&&Q.length?e.jsx("div",{className:"modal-overlay",onClick:()=>r(!1),children:e.jsxs("div",{className:"modal-panel",onClick:ee=>ee.stopPropagation(),children:[e.jsx("h5",{children:"Automation Alert: Gaming/OTT Usage"}),e.jsxs("div",{className:"text-secondary mb-2",children:["Work hours: ",b.work_hours_label||"09:00 - 18:00"]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"App / URL"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:Q.map((ee,T)=>e.jsxs("tr",{children:[e.jsx("td",{children:ee.employee}),e.jsx("td",{className:"text-truncate",style:{maxWidth:"320px"},children:ee.app}),e.jsx("td",{children:ee.time})]},`${ee.employee}-${T}`))})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{className:"modal-close",type:"button",onClick:()=>r(!1),children:"Close"})})]})}):null]})}const Lb=/^(\d{4})-(\d{2})-(\d{2})$/,B_=/^(\d{4})-(\d{2})-(\d{2})[ T](\d{2}):(\d{2})(?::(\d{2}))?$/,df=/^(\d{2}):(\d{2})(?::(\d{2}))?$/,fu="wz_org_timezone",Mb="UTC",uf="__wzOrgTimezoneDateLocalePatched__";function W_(t){const a=String(t||"").trim();if(!a)return!1;try{return Intl.DateTimeFormat(void 0,{timeZone:a}),!0}catch{return!1}}function Ub(t){return W_(t)?String(t).trim():Mb}function V_(){if(typeof window>"u")return Mb;const t=window.localStorage.getItem(fu);return Ub(t)}let Ol=V_();function $l(t){return Ol=Ub(t),typeof window<"u"&&window.localStorage.setItem(fu,Ol),Ol}function Yi(){return typeof window>"u"?Ol:$l(window.localStorage.getItem(fu)||Ol)}function G_(t){const a=Array.from(t),s=a[0],n=a[1],l=n&&typeof n=="object"&&!Array.isArray(n)?n:void 0;return l!=null&&l.timeZone?[s,l]:[s,{...l||{},timeZone:Yi()}]}function tc(t){var l;if(typeof Date>"u")return;const a=(l=Date.prototype)==null?void 0:l[t];if(typeof a!="function"||a[uf])return;const s=a,n=function(...o){return s.apply(this,G_(o))};Object.defineProperty(n,uf,{value:!0,configurable:!1,enumerable:!1,writable:!1}),Date.prototype[t]=n}function H_(){tc("toLocaleString"),tc("toLocaleDateString"),tc("toLocaleTimeString")}function q_(t){const a=Lb.exec(String(t||"").trim());if(!a)return null;const[,s,n,l]=a;return new Date(Date.UTC(Number(s),Number(n)-1,Number(l),0,0,0))}function Ob(t){const a=String(t||"").trim();if(!a)return null;if(a.endsWith("Z")||/[+-]\d{2}:?\d{2}$/.test(a)){const d=new Date(a);return Number.isNaN(d.getTime())?null:d}const s=B_.exec(a);if(!s)return null;const[,n,l,r,o,u,c="00"]=s;return new Date(Date.UTC(Number(n),Number(l)-1,Number(r),Number(o),Number(u),Number(c)))}function Ai(t,a="-"){if(!t)return a;const s=q_(t)||Ob(t);return s?s.toLocaleDateString(void 0,{timeZone:Yi()}):t}function Qs(t,a="-"){if(!t)return a;const s=Ob(t);return s?s.toLocaleString(void 0,{timeZone:Yi()}):t}function Mr(t,a,s="-"){if(!t)return s;const n=String(t||"").trim();if(!df.test(n))return n||s;const l=Lb.exec(String(a||"").trim());if(!l)return n;const[,r,o,u]=l,[,c,d,h="00"]=df.exec(n)||[],p=new Date(Date.UTC(Number(r),Number(o)-1,Number(u),Number(c),Number(d),Number(h)));return Number.isNaN(p.getTime())?n:p.toLocaleTimeString(void 0,{timeZone:Yi()})}H_();const $b=i.createContext(null),mf={open:!1,title:"",message:"",confirmText:"Confirm",cancelText:"Cancel",confirmVariant:"primary",resolve:null};function Ib({children:t}){const[a,s]=i.useState(mf),n=i.useMemo(()=>r=>new Promise(o=>{s({open:!0,title:(r==null?void 0:r.title)||"Please Confirm",message:(r==null?void 0:r.message)||"",confirmText:(r==null?void 0:r.confirmText)||"Confirm",cancelText:(r==null?void 0:r.cancelText)||"Cancel",confirmVariant:(r==null?void 0:r.confirmVariant)||"primary",resolve:o})}),[]),l=r=>{a.resolve&&a.resolve(r),s(mf)};return e.jsxs($b.Provider,{value:n,children:[t,a.open?e.jsx("div",{className:"modal-overlay",onClick:()=>l(!1),children:e.jsxs("div",{className:"modal-panel",onClick:r=>r.stopPropagation(),children:[e.jsx("h5",{children:a.title}),a.message?e.jsx("div",{className:"text-secondary mb-2",children:a.message}):null,e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>l(!1),children:a.cancelText}),e.jsx("button",{type:"button",className:`btn btn-${a.confirmVariant}`,onClick:()=>l(!0),children:a.confirmText})]})]})}):null]})}function ys(){const t=i.useContext($b);if(!t)throw new Error("useConfirm must be used inside ConfirmProvider");return t}const Q_={loading:!0,error:"",data:null};function J_(t){const a=String(t||"").trim();return a&&(/^https?:\/\//i.test(a)||a.startsWith("/"))?a:"/hr-login/"}function K_(){var te,H,O,V,re,Y;const[t,a]=i.useState(Q_),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState(0),[c,d]=i.useState(""),[h,p]=i.useState(""),[g,N]=i.useState(1),[v,w]=i.useState(0),A=ys(),y=20;i.useEffect(()=>{const ce=setInterval(()=>{w(ie=>ie+1)},15e3);return()=>clearInterval(ce)},[]);function x(ce){const ie=new URLSearchParams;return ce&&ie.set("q",ce),ie.toString()?`/api/dashboard/employees?${ie.toString()}`:"/api/dashboard/employees"}async function f(ce=l){var T;const ie=x(ce),ee=await U(ie);a({loading:!1,error:"",data:ee}),u(0),d(((T=ee.meta)==null?void 0:T.screenshot_interval_minutes)??"")}i.useEffect(()=>{let ce=!0;async function ie(){var ee,T;p("");try{const Z=await U(x(l));if(!ce)return;a({loading:!1,error:"",data:Z}),u(0),d(((ee=Z.meta)==null?void 0:ee.screenshot_interval_minutes)??"")}catch(Z){if((T=Z==null?void 0:Z.data)!=null&&T.redirect){window.location.href=Z.data.redirect;return}ce&&a({loading:!1,error:(Z==null?void 0:Z.message)||"Unable to load employees.",data:null})}}return ie(),()=>{ce=!1}},[l,v]),i.useEffect(()=>{const ce=setTimeout(()=>{r(s.trim()),N(1)},300);return()=>clearTimeout(ce)},[s]);const b=((te=t.data)==null?void 0:te.employees)||[],k=((H=t.data)==null?void 0:H.meta)||{},_=((O=t.data)==null?void 0:O.subscription)||null,P=((re=(V=t.data)==null?void 0:V.org)==null?void 0:re.company_key)||"-",S=((Y=t.data)==null?void 0:Y.hr_access)||{},F=J_(S.login_url),L=i.useMemo(()=>{if(!s)return b;const ce=s.toLowerCase();return b.filter(ie=>ie.name.toLowerCase().includes(ce))},[b,s]),Q=Math.max(Math.ceil(L.length/y),1),E=i.useMemo(()=>L.slice((g-1)*y,g*y),[L,g]),C=L.length,z=C?(g-1)*y+1:0,M=C?Math.min(g*y,C):0;i.useEffect(()=>{g>Q&&N(Q)},[g,Q]);async function R(ce){var T;const ie=(ce==null?void 0:ce.name)||"this employee";if(await A({title:"Delete Employee",message:`If you delete ${ie}, all related screenshots, Live Activity, Work Activity Log, App Usage, and Gaming / OTT Usage data will be permanently removed. Do you want to continue?`,confirmText:"Delete Account",confirmVariant:"danger"}))try{const Z=await U(`/api/dashboard/employees/${ce.id}/delete`,{method:"DELETE"});p(`${(Z==null?void 0:Z.employee_name)||ie} deleted successfully.`),await f()}catch(Z){if((T=Z==null?void 0:Z.data)!=null&&T.redirect){window.location.href=Z.data.redirect;return}p(""),a(se=>({...se,error:(Z==null?void 0:Z.message)||"Unable to delete employee."}))}}async function W(ce){var ie;ce.preventDefault(),p("");try{const ee=await U("/api/dashboard/employees/screenshot-interval",{method:"POST",body:JSON.stringify({interval:c})});p(`Screenshot interval updated to ${ee.screenshot_interval_minutes} minutes.`),await f()}catch(ee){if((ie=ee==null?void 0:ee.data)!=null&&ie.redirect){window.location.href=ee.data.redirect;return}p(""),a(T=>({...T,error:(ee==null?void 0:ee.message)||"Unable to update interval."}))}}async function D(ce){var ie;ce.preventDefault(),p("");try{const ee=await U("/api/dashboard/employees/addons",{method:"POST",body:JSON.stringify({addon_count:o})});if(ee!=null&&ee.redirect){window.location.href=ee.redirect;return}p("Add-ons updated."),u(0),await f()}catch(ee){if((ie=ee==null?void 0:ee.data)!=null&&ie.redirect){window.location.href=ee.data.redirect;return}p(""),a(T=>({...T,error:(ee==null?void 0:ee.message)||"Unable to update add-ons."}))}}return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading employees..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"page-title",children:"Employees"}),e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsxs("div",{className:"col-12 col-lg-10",children:[e.jsx("div",{className:"d-flex flex-wrap gap-2 align-items-center justify-content-between",children:e.jsxs("div",{className:"d-flex gap-2 align-items-center flex-wrap",children:[e.jsx("a",{href:"/dashboard/export/csv/",className:"btn btn-success btn-sm",children:"Export CSV"}),e.jsx("a",{href:"/dashboard/export/pdf/",className:"btn btn-danger btn-sm",children:"Export PDF"})]})}),e.jsx("p",{className:"text-secondary mt-2 mb-0",children:k.employee_limit===0?e.jsxs(e.Fragment,{children:["Employees: ",k.employee_count??0," / Add-ons:"," ",k.addon_count??0]}):e.jsxs(e.Fragment,{children:["Employees: ",k.employee_count??0," / ",k.employee_limit??0,_?e.jsxs("span",{className:"ms-2",children:["Add-ons: ",k.addon_count??0]}):null]})}),h?e.jsx("div",{className:"alert alert-success mt-3 mb-0",children:h}):null,t.error?e.jsx("div",{className:"alert alert-danger mt-3 mb-0",children:t.error}):null,e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",y," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"employees-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"employees-search",type:"text",value:s,onChange:ce=>n(ce.target.value),placeholder:"Search employees"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"employee-col-id",children:"ID"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"PC Name"}),e.jsx("th",{children:"Company Key"}),e.jsx("th",{children:"Device"}),e.jsx("th",{className:"employee-col-status",children:"Status"}),e.jsx("th",{children:"Last Seen"}),e.jsx("th",{className:"table-actions employee-col-action",children:"Action"})]})}),e.jsx("tbody",{children:E.length?E.map(ce=>{const ie=ce.status||(ce.is_online?"Online":"Offline");let ee="bg-secondary";return ie==="Online"?ee="bg-success":ie==="Ideal"&&(ee="bg-warning text-dark"),e.jsxs("tr",{children:[e.jsx("td",{className:"employee-col-id",children:ce.id}),e.jsx("td",{children:ce.name}),e.jsx("td",{children:ce.pc_name||"-"}),e.jsx("td",{children:P}),e.jsx("td",{children:ce.device_id}),e.jsx("td",{className:"employee-col-status",children:e.jsx("span",{className:`badge ${ee}`,children:ie})}),e.jsx("td",{children:Qs(ce.last_seen)}),e.jsx("td",{className:"table-actions employee-col-action",children:e.jsxs("div",{className:"d-flex gap-2 employee-actions-row",children:[e.jsx(dt,{to:`/employees/${ce.id}`,className:"btn btn-primary btn-sm",children:"View"}),e.jsx(dt,{to:`/employees/${ce.id}/edit`,className:"btn btn-outline-light btn-sm",children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>R(ce),children:"Delete"})]})})]},ce.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No employees found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",z," to ",M," of ",C," entries"]}),e.jsx(st,{page:g,totalPages:Q,onPageChange:N,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]}),e.jsxs("div",{className:"col-12 col-lg-2",children:[_?e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-2",children:"Add Employee Add-ons"}),_.allow_addons?e.jsxs("form",{onSubmit:D,children:[e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[e.jsx("label",{className:"form-label mb-0",children:"Addon Count"}),e.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",style:{maxWidth:"120px"},value:o,onChange:ce=>u(ce.target.value)}),e.jsx("button",{className:"btn btn-primary btn-sm",type:"submit",children:"Update"})]}),e.jsx("small",{className:"text-secondary",children:"Proration applies based on remaining days in the current cycle."})]}):e.jsx("p",{className:"text-warning mb-0",children:"Add-ons disabled for this plan."})]}):null,e.jsxs("div",{className:`card p-3 ${_?"mt-3":""}`,children:[e.jsx("h6",{className:"mb-2",children:"Screenshot Interval"}),e.jsx("form",{onSubmit:W,children:e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[e.jsx("select",{className:"form-select form-select-sm",style:{maxWidth:"200px"},value:c,onChange:ce=>d(ce.target.value),disabled:!k.allowed_intervals||k.allowed_intervals.length===0,children:k.allowed_intervals&&k.allowed_intervals.length?k.allowed_intervals.map(ce=>e.jsxs("option",{value:ce,children:[ce," minutes"]},ce)):e.jsx("option",{value:"",children:"No intervals"})}),e.jsx("button",{className:"btn btn-primary btn-sm",type:"submit",disabled:!k.allowed_intervals||k.allowed_intervals.length===0,children:"Save"})]})})]}),S.enabled?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h6",{className:"mb-2",children:"HR User Details"}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("span",{className:"text-secondary",children:"Login URL"}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:F,target:"_blank",rel:"noreferrer",children:"Click Here"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-secondary",children:"User Name: "}),e.jsx("strong",{children:S.username||P})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-secondary",children:"Password: "}),e.jsx("strong",{children:S.default_password||`${P}hrlog`})]}),e.jsx("div",{className:"text-secondary small",children:"Default password format: Company Key + hrlog."})]}):null]})]})]})}const Y_={loading:!0,error:"",data:null};function Z_(){var N,v,w;const{employeeId:t}=js(),[a,s]=i.useState(Y_),[n,l]=i.useState(1),r=5;i.useEffect(()=>{let A=!0;async function y(){var x;try{const f=await U(`/api/dashboard/employees/${t}`);A&&s({loading:!1,error:"",data:f})}catch(f){if((x=f==null?void 0:f.data)!=null&&x.redirect){window.location.href=f.data.redirect;return}A&&s({loading:!1,error:(f==null?void 0:f.message)||"Unable to load employee.",data:null})}}return y(),()=>{A=!1}},[t]);const o=((N=a.data)==null?void 0:N.employee)||{},u=((v=a.data)==null?void 0:v.recent_activities)||[],c=((w=a.data)==null?void 0:w.recent_screenshots)||[],d=o.status||"Offline";let h="bg-danger";d==="Online"?h="bg-success":d==="Ideal"&&(h="bg-warning text-dark");const p=Math.max(Math.ceil(u.length/r),1),g=i.useMemo(()=>u.slice((n-1)*r,n*r),[u,n]);return i.useEffect(()=>{n>p&&l(p)},[n,p]),a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading employee..."})]}):a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center justify-content-between",children:[e.jsxs("h3",{className:"page-title",children:[o.name," (",o.device_id,")"]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(dt,{to:`/employees/${t}/edit`,className:"btn btn-outline-light btn-sm",children:"Edit"}),e.jsx(dt,{to:"/employees",className:"btn btn-secondary btn-sm",children:"Back"})]})]}),e.jsxs("p",{className:"mb-1",children:["PC Name: ",o.pc_name||"-"]}),e.jsxs("p",{className:"mb-1",children:["Status: ",e.jsx("span",{className:`badge ${h}`,children:d})]}),e.jsxs("p",{children:["Last Seen: ",o.last_seen||"-"]}),e.jsx("hr",{className:"section-divider"}),e.jsx("h4",{children:"Recent Activity"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"App"}),e.jsx("th",{children:"Window"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"})]})}),e.jsx("tbody",{children:g.length?g.map((A,y)=>e.jsxs("tr",{children:[e.jsx("td",{children:A.app}),e.jsx("td",{children:A.window||"-"}),e.jsx("td",{children:A.start||"-"}),e.jsx("td",{children:A.end||"-"})]},`${A.app}-${y}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No activity yet."})})})]})}),e.jsx(st,{page:n,totalPages:p,onPageChange:l}),e.jsx("hr",{className:"section-divider"}),e.jsx("h4",{children:"Screenshots"}),c.length?e.jsx("div",{className:"row g-3",children:c.map(A=>e.jsxs("div",{className:"col-12 col-md-4 col-lg-3",children:[e.jsx("img",{src:A.image_url,alt:A.captured_at,className:"img-fluid rounded"}),e.jsx("div",{className:"text-secondary mt-1",style:{fontSize:"12px"},children:A.captured_at})]},A.id))}):e.jsx("p",{children:"No screenshots found."})]})}const X_={name:"",email:"",device_id:""};function hf(){const{employeeId:t}=js(),a=bs(),s=!!t,[n,l]=i.useState(X_),[r,o]=i.useState(s),[u,c]=i.useState("");i.useEffect(()=>{if(!s)return;let p=!0;async function g(){var N;try{const v=await U(`/api/dashboard/employees/${t}`);if(!p)return;const w=v.employee||{};l({name:w.name||"",email:w.email||"",device_id:w.device_id||""}),o(!1)}catch(v){if((N=v==null?void 0:v.data)!=null&&N.redirect){window.location.href=v.data.redirect;return}p&&(c((v==null?void 0:v.message)||"Unable to load employee."),o(!1))}}return g(),()=>{p=!1}},[t,s]);function d(p){const{name:g,value:N}=p.target;l(v=>({...v,[g]:N}))}async function h(p){var g;p.preventDefault(),c("");try{const N=s?`/api/dashboard/employees/${t}/update`:"/api/dashboard/employees/create";await U(N,{method:s?"PUT":"POST",body:JSON.stringify(n)}),a("/employees")}catch(N){if((g=N==null?void 0:N.data)!=null&&g.redirect){window.location.href=N.data.redirect;return}c((N==null?void 0:N.message)||"Unable to save employee.")}}return r?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading employee..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"page-title",children:s?"Edit Employee":"Add Employee"}),u?e.jsx("div",{className:"alert alert-danger",children:u}):null,e.jsx("div",{className:"card p-3 mt-3",children:e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",name:"name",className:"form-control",value:n.name,onChange:d,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Email (optional)"}),e.jsx("input",{type:"email",name:"email",className:"form-control",value:n.email,onChange:d})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Device ID"}),e.jsx("input",{type:"text",name:"device_id",className:"form-control",value:n.device_id,onChange:d,required:!0})]}),e.jsx("button",{className:"btn btn-primary",type:"submit",children:s?"Save Changes":"Create Employee"}),e.jsx(dt,{to:"/employees",className:"btn btn-outline-light ms-2",children:"Cancel"})]})})]})}const eS={loading:!0,error:"",data:null};function Ur(t){const a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${a}-${s}-${n}`}function tS(){const t=Ur(new Date),a=typeof window<"u"&&!!window.__WZ_READ_ONLY__,[s,n]=i.useState({employeeId:"",preset:"today",nickname:"",dateFrom:"",dateTo:""}),[l,r]=i.useState({dateFrom:t,dateTo:t}),[o,u]=i.useState(1),[c,d]=i.useState(eS),[h,p]=i.useState(""),[g,N]=i.useState(-1),[v,w]=i.useState(0),[A,y]=i.useState(()=>new Set),[x,f]=i.useState(null),b=ys(),k=30,_=120,P=i.useRef(null),S=i.useRef(null),F=i.useRef(null),L=i.useRef(null),[Q,E]=i.useState([]);i.useEffect(()=>{let le=!0;async function xe(){var ge;d(B=>({...B,loading:!0,error:""}));try{const B=new URLSearchParams;s.employeeId&&B.set("employee_id",s.employeeId),s.nickname&&B.set("nickname",s.nickname),s.preset?B.set("preset",s.preset):(s.dateFrom&&B.set("date_from",s.dateFrom),s.dateTo&&B.set("date_to",s.dateTo)),o&&B.set("page",String(o));const he=B.toString()?`/api/dashboard/screenshots?${B.toString()}`:"/api/dashboard/screenshots",we=await U(he);le&&d({loading:!1,error:"",data:we})}catch(B){if((ge=B==null?void 0:B.data)!=null&&ge.redirect){window.location.href=B.data.redirect;return}le&&d({loading:!1,error:(B==null?void 0:B.message)||"Unable to load screenshots.",data:null})}}return xe(),()=>{le=!1}},[s,o,v]),i.useEffect(()=>{y(new Set)},[s,o]);const C=c.data||{},z=C.employees||[],M=C.server_now||"",R=C.available_dates||[],W=Q.length>0?Q:C.nicknames||[],D=C.selected_employee_id?String(C.selected_employee_id):s.employeeId,te=s.nickname||"";i.useEffect(()=>{!Array.isArray(C.nicknames)||!C.nicknames.length||E(le=>{const xe=new Set(le),ge=[...le];return C.nicknames.forEach(B=>{B&&!xe.has(B)&&(xe.add(B),ge.push(B))}),ge})},[C.nicknames]);const H=i.useMemo(()=>{if(!h)return z;const le=h.toLowerCase();return z.filter(xe=>xe.name.toLowerCase().includes(le))},[z,h]),O=z.find(le=>String(le.id)===String(D));function V(le){if(le==null)return"";const xe=Math.max(0,Math.round(le)),ge=Math.floor(xe/60),B=xe%60;return ge>0?`${ge}h ${B}m`:`${B}m`}function re(le){if(!le)return null;const xe=M?Date.parse(M):Date.now(),ge=Date.parse(le);return Number.isFinite(ge)?Math.max(0,(xe-ge)/6e4):null}function Y(le){if(!le)return"";const xe=new Date(le);if(!Number.isFinite(xe.getTime()))return"";const ge=xe.getHours(),B=String(xe.getMinutes()).padStart(2,"0"),he=ge>=12?"PM":"AM";return`${ge%12||12}:${B} ${he}`}const ce=(O==null?void 0:O.last_screenshot_uploaded_at)||"",ie=(O==null?void 0:O.last_screenshot_captured_at)||"",ee=re(ce),T=ee===null?"":ee>=_?"danger":ee>=k?"warning":"",Z=C.shots||[],se=Z.length>0&&Z.every(le=>A.has(le.id)),be=C.pagination||{},ne=be.page||o,ae=be.total_pages||1,X=be.page_size||Z.length||20,ke=typeof be.total_items=="number"?be.total_items:Z.length,Ne=ke?(ne-1)*X+1:0,Ye=ke?Math.min(ne*X,ke):0,Ke=g>=0?Z[g]:null,mt=(Ke==null?void 0:Ke.image_url)||"";i.useEffect(()=>{g>=Z.length&&N(-1)},[Z,g]);const Ie=ee===null?"No screenshots received yet for this user.":`No screenshots received for ${V(ee)}.`,Xe=Y(ie),nt=Y(ce),Ae=Y(M),ue=ee!==null&&nt&&Ae?`No screenshots received between ${nt} to ${Ae} due to PC Screen Lock or PC Signout.`:Ie;function je(le){n(xe=>({...xe,employeeId:le||"",nickname:""})),u(1)}function Ce(le){n(xe=>({...xe,nickname:le||"",employeeId:""})),u(1)}i.useEffect(()=>{if(!window.flatpickr)return;const le=R.length?R:[],xe={wrap:!0,altInput:!0,altFormat:"d-m-Y",dateFormat:"Y-m-d",altInputClass:"date-input flatpickr-input",enable:le,allowInput:!1,disableMobile:!0};P.current&&!F.current&&(F.current=window.flatpickr(P.current,{...xe,onChange:(ge,B)=>{r(he=>({...he,dateFrom:B}))}})),S.current&&!L.current&&(L.current=window.flatpickr(S.current,{...xe,onChange:(ge,B)=>{r(he=>({...he,dateTo:B}))}})),F.current&&(F.current.set("enable",le),l.dateFrom?F.current.setDate(l.dateFrom,!1):F.current.clear()),L.current&&(L.current.set("enable",le),l.dateTo?L.current.setDate(l.dateTo,!1):L.current.clear())},[R,l.dateFrom,l.dateTo]),i.useEffect(()=>{F.current&&(F.current.destroy(),F.current=null),L.current&&(L.current.destroy(),L.current=null)},[s.preset]),i.useEffect(()=>()=>{F.current&&F.current.destroy(),L.current&&L.current.destroy()},[]);function Le(le){const xe=new Date;if(le==="today"){const ge=Ur(xe);n(B=>({...B,preset:"today",dateFrom:"",dateTo:""})),r({dateFrom:ge,dateTo:ge})}else if(le==="yesterday"){const ge=new Date(xe);ge.setDate(xe.getDate()-1);const B=Ur(ge);n(he=>({...he,preset:"yesterday",dateFrom:"",dateTo:""})),r({dateFrom:B,dateTo:B})}else n(ge=>({...ge,preset:"all",dateFrom:"",dateTo:""})),r({dateFrom:"",dateTo:""});u(1)}function Fe(le){if(le.preventDefault(),!l.dateFrom&&!l.dateTo){const ge=Ur(new Date);n(B=>({...B,preset:"today",dateFrom:"",dateTo:""})),r({dateFrom:ge,dateTo:ge}),u(1);return}n(xe=>({...xe,preset:"",dateFrom:l.dateFrom,dateTo:l.dateTo})),u(1)}function ye(le){if(!le)return"";const xe=new Date(le);if(!Number.isFinite(xe.getTime()))return"";const ge=String(xe.getDate()).padStart(2,"0"),B=String(xe.getMonth()+1).padStart(2,"0"),he=xe.getFullYear(),we=String(xe.getHours()).padStart(2,"0"),I=String(xe.getMinutes()).padStart(2,"0"),me=String(xe.getSeconds()).padStart(2,"0");return`${ge}/${B}/${he}, ${we}:${I}:${me}`}function Ze(le,xe=null){f({open:!0,status:"pending",label:le,total:xe,deleted:0,startedAt:new Date().toISOString(),finishedAt:"",error:""})}function pt(le){f(xe=>({...xe||{},status:"completed",deleted:typeof le=="number"?le:(xe==null?void 0:xe.deleted)||0,finishedAt:new Date().toISOString()}))}function ht(le){f(xe=>({...xe||{},status:"failed",error:(le==null?void 0:le.message)||"Unable to delete screenshots."}))}async function Ge(){var xe;if(await b({title:"Delete All Screenshots",message:"Are you sure? All screenshots will be deleted.",confirmText:"Delete All",confirmVariant:"danger"}))try{Ze("Deleting all screenshots");const ge=await U("/api/dashboard/screenshots/delete-all",{method:"POST"});pt(ge==null?void 0:ge.count),w(B=>B+1)}catch(ge){ht(ge),(xe=ge==null?void 0:ge.data)!=null&&xe.redirect&&(window.location.href=ge.data.redirect)}}async function gt(){var xe;if(!(!O||!await b({title:"Delete Employee Screenshots",message:`Delete all screenshots for ${O.name}?`,confirmText:"Delete All",confirmVariant:"danger"})))try{Ze(`Deleting screenshots for ${O.name||"employee"}`);const ge=await U("/api/dashboard/screenshots/delete-employee",{method:"POST",body:JSON.stringify({employee_id:O.id})});pt(ge==null?void 0:ge.count),w(B=>B+1)}catch(ge){ht(ge),(xe=ge==null?void 0:ge.data)!=null&&xe.redirect&&(window.location.href=ge.data.redirect)}}async function ft(le){var ge;if(await b({title:"Delete Screenshot",message:"Delete this screenshot?",confirmText:"Delete",confirmVariant:"danger"}))try{await U(`/api/dashboard/screenshots/${le}/delete`,{method:"DELETE"}),w(B=>B+1)}catch(B){(ge=B==null?void 0:B.data)!=null&&ge.redirect&&(window.location.href=B.data.redirect)}}async function G(){var xe;if(!(!A.size||!await b({title:"Delete Selected Screenshots",message:`Delete ${A.size} selected screenshot(s)?`,confirmText:"Delete Selected",confirmVariant:"danger"})))try{Ze("Deleting selected screenshots",A.size);const ge=await U("/api/dashboard/screenshots/delete-selected",{method:"POST",body:JSON.stringify({ids:Array.from(A)})});pt((ge==null?void 0:ge.count)??A.size),y(new Set),w(B=>B+1)}catch(ge){ht(ge),(xe=ge==null?void 0:ge.data)!=null&&xe.redirect&&(window.location.href=ge.data.redirect)}}function Se(le){y(xe=>{const ge=new Set(xe);return ge.has(le)?ge.delete(le):ge.add(le),ge})}function ve(){const le=C.shots||[];y(xe=>{const ge=new Set(xe);return le.every(he=>ge.has(he.id))?le.forEach(he=>ge.delete(he.id)):le.forEach(he=>ge.add(he.id)),ge})}return c.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading screenshots..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"gallery-header",children:[e.jsx("h2",{children:"Screenshot Gallery"}),e.jsxs("div",{className:"gallery-actions",children:[e.jsx("div",{className:"gallery-select-wrap",children:e.jsxs("select",{className:"gallery-select",value:te,onChange:le=>Ce(le.target.value),children:[e.jsx("option",{value:"",children:"Nick Name"}),W.map(le=>e.jsx("option",{value:le,children:le},le))]})}),a?null:e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"shot-danger",onClick:Ge,children:"Delete all User data"}),e.jsx("button",{type:"button",className:"shot-danger outline",onClick:G,disabled:!A.size,children:"Delete Selected"}),O?e.jsxs("button",{type:"button",className:"shot-danger outline",onClick:gt,children:["Delete All Screenshots - ",O.name]}):null]})]})]}),c.error?e.jsx("div",{className:"alert alert-danger",children:c.error}):null,e.jsxs("div",{className:"screen-layout",children:[e.jsx("div",{className:"screen-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{className:"user-panel-title",children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:h,onChange:le=>p(le.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${D?"":"active"}`,onClick:()=>je(""),children:"All Users"}),H.map(le=>{const xe=le.status||"Offline",ge=xe.toLowerCase(),B=re(le.last_screenshot_uploaded_at),he=B===null?"muted":B>=_?"danger":B>=k?"warning":"ok";return e.jsxs("button",{type:"button",className:`user-chip ${String(le.id)===String(D)?"active":""}`,onClick:()=>je(String(le.id)),children:[e.jsx("span",{className:`status-dot status-${ge}`}),e.jsx("span",{className:"user-name",children:le.name}),e.jsxs("span",{className:"user-status",children:["(",xe,")"]}),e.jsx("span",{className:`gap-badge gap-${he}`,children:B===null?"No shots":`Last: ${V(B)}`})]},le.id)})]})]})}),e.jsxs("div",{className:"screen-right",children:[O&&T?e.jsxs("div",{className:`alert alert-${T}`,children:[O?`${O.name}: `:"",ue,Xe?` Last captured at ${Xe}.`:""]}):O&&ee===null?e.jsxs("div",{className:"alert alert-warning",children:[O?`${O.name}: `:"",Ie]}):null,x!=null&&x.open?e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:x.label||"Deleting screenshots"}),e.jsx("div",{className:"text-secondary",children:x.status==="failed"?"Delete failed.":x.status==="completed"?"Delete completed.":"Delete in progress..."}),x.finishedAt?e.jsxs("div",{className:"text-secondary small mt-1",children:["Completed at: ",ye(x.finishedAt)]}):null]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>f(le=>le&&{...le,open:!1}),children:"Close"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"mb-2",children:x.total?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:x.deleted||0})," /"," ",e.jsx("strong",{children:x.total})," items deleted"]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:x.deleted||0})," items deleted"]})}),e.jsx("div",{className:"progress mb-2",style:{height:"8px"},children:e.jsx("div",{className:`progress-bar ${x.status==="failed"?"bg-danger":"bg-success"}`,style:{width:x.total?`${Math.min(100,Math.round((x.deleted||0)/x.total*100))}%`:x.status==="completed"?"100%":"35%"}})}),x.startedAt?e.jsxs("div",{className:"text-secondary small",children:["Started at: ",ye(x.startedAt)]}):null,x.error?e.jsx("div",{className:"alert alert-danger mt-2",children:x.error}):null]})]}):null,e.jsxs("div",{className:"shot-toolbar",children:[e.jsxs("div",{className:"shot-info",style:{marginTop:"5px"},children:["Showing: ",te||(O?O.name:"All Users")]}),e.jsxs("form",{className:"shot-filter",onSubmit:Fe,children:[e.jsxs("div",{className:"preset-buttons",children:[e.jsx("button",{type:"button",className:`shot-btn ${s.preset==="today"?"active":""}`,onClick:()=>Le("today"),children:"Today"}),e.jsx("button",{type:"button",className:`shot-btn ${s.preset==="yesterday"?"active":""}`,onClick:()=>Le("yesterday"),children:"Yesterday"}),e.jsx("button",{type:"button",className:`shot-btn ${s.preset==="all"?"active":""}`,onClick:()=>Le("all"),children:"All Images"})]}),e.jsxs("label",{children:[e.jsx("span",{children:"From"}),e.jsxs("div",{className:"date-picker-wrap",ref:P,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"To"}),e.jsxs("div",{className:"date-picker-wrap",ref:S,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsx("button",{type:"submit",className:"shot-btn primary",children:"Apply"}),e.jsx("button",{type:"button",className:`shot-btn ${s.preset==="all"?"active":""}`,onClick:()=>Le("all"),children:"Reset"})]}),a?null:e.jsx("div",{className:"toolbar-actions",children:e.jsx("button",{type:"button",className:"shot-btn",onClick:ve,disabled:Z.length===0,children:se?"Unselect All":"Select All"})})]}),e.jsx("div",{className:"gallery",children:Z.length?Z.map((le,xe)=>e.jsxs("div",{className:"shot-card",children:[e.jsxs("div",{className:"shot-meta",children:[e.jsx("span",{className:"shot-name",children:le.employee}),e.jsxs("span",{className:"shot-time",children:["Captured: ",ye(le.captured_at_iso,le.captured_at_display||le.captured_at||"-")]})]}),e.jsxs("div",{className:"shot-image-wrap",children:[a?null:e.jsxs("label",{className:"shot-select",children:[e.jsx("input",{type:"checkbox",checked:A.has(le.id),onChange:()=>Se(le.id)}),e.jsx("span",{children:"Select"})]}),e.jsx("img",{src:le.image_url,alt:le.employee,onClick:()=>N(xe)}),e.jsxs("span",{className:"shot-uploaded",children:["Uploaded: ",le.uploaded_at_display||"-"]})]}),a?null:e.jsx("div",{className:"shot-actions",children:e.jsx("button",{type:"button",className:"link-danger",onClick:()=>ft(le.id),children:"Delete"})})]},le.id)):e.jsx("p",{children:"No screenshots yet."})}),e.jsxs("div",{className:"table-footer mt-4",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Ne," to ",Ye," of ",ke," entries"]}),e.jsx(st,{page:ne,totalPages:ae,onPageChange:u,showPageLinks:!0,showPageLabel:!0,maxPageLinks:7})]})]})]}),mt?e.jsx("div",{className:"modal-overlay",onClick:()=>N(-1),children:e.jsxs("div",{className:"preview-modal",onClick:le=>le.stopPropagation(),children:[e.jsx("button",{type:"button",className:"preview-nav preview-nav-prev",onClick:()=>N(le=>Math.max(0,le-1)),disabled:g<=0,children:e.jsx("span",{className:"preview-nav-icon",children:""})}),e.jsx("img",{src:mt,alt:(Ke==null?void 0:Ke.employee)||"Screenshot preview",className:"preview-image"}),e.jsx("button",{type:"button",className:"preview-nav preview-nav-next",onClick:()=>N(le=>Math.min(Z.length-1,le+1)),disabled:g>=Z.length-1,children:e.jsx("span",{className:"preview-nav-icon",children:""})})]})}):null]})}const pf=80,aS=24,sS=60;function ff(t,a){const s=String(t||"");return s?s.length<=a?s:`${s.slice(0,Math.max(a-3,0))}...`:""}function nS(t){const a=String(t||"").trim();return a?/^https?:\/\//i.test(a)?a:/^\/\//.test(a)?`https:${a}`:/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(a)?"":a.toLowerCase().startsWith("localhost")||/^[0-9.]+(?::\d+)?(\/|$)/.test(a)?`http://${a}`:`https://${a}`:""}function lS(t){if(!t)return{text:"-",href:"",full:""};const a=String(t);return{text:a.length>pf?`${a.slice(0,pf-3)}...`:a,href:nS(a),full:a}}function rS(t){const a=String(t||"Offline").trim().toLowerCase();return a==="online"?{key:"online",label:"Online"}:a==="ideal"||a==="idle"?{key:"idle",label:"Idle"}:{key:"offline",label:"Offline"}}function iS(){const[t,a]=i.useState([]),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState([]),[c,d]=i.useState(!0),[h,p]=i.useState(!1),[g,N]=i.useState(""),[v,w]=i.useState(1),[A,y]=i.useState(1),[x,f]=i.useState(0),[b,k]=i.useState(20),[_,P]=i.useState(""),[S,F]=i.useState(""),[L,Q]=i.useState({key:"start",direction:"desc"}),[E,C]=i.useState(0),z=20;i.useEffect(()=>{const H=setInterval(()=>{C(O=>O+1)},15e3);return()=>clearInterval(H)},[]),i.useEffect(()=>{let H=!0;async function O(){var V;try{const re=await U("/api/dashboard/employees");if(!H)return;const Y=(re.employees||[]).slice().sort((ce,ie)=>ce.name.localeCompare(ie.name));a(Y),d(!1)}catch(re){if((V=re==null?void 0:re.data)!=null&&V.redirect){window.location.href=re.data.redirect;return}H&&(N((re==null?void 0:re.message)||"Unable to load users."),d(!1))}}return O(),()=>{H=!1}},[E]),i.useEffect(()=>{w(1)},[s]),i.useEffect(()=>{const H=setTimeout(()=>{F(_.trim()),w(1)},300);return()=>clearTimeout(H)},[_]),i.useEffect(()=>{let H=!0;async function O(){var re;p(!0);try{const Y=new URLSearchParams;s&&Y.set("employee_id",s),S&&Y.set("q",S),L!=null&&L.key&&(Y.set("sort",L.key),Y.set("dir",L.direction)),Y.set("page",v),Y.set("page_size",z);const ce=`/api/dashboard/activity/live?${Y.toString()}`,ie=await U(ce);if(H){u(ie.logs||[]);const ee=ie.pagination||{},T=ee.total_pages||1,Z=ee.page||v,se=ee.page_size||z,be=typeof ee.total_items=="number"?ee.total_items:(ie.logs||[]).length;y(T),f(be),k(se),Z!==v&&w(Z),p(!1)}}catch(Y){if((re=Y==null?void 0:Y.data)!=null&&re.redirect){window.location.href=Y.data.redirect;return}H&&(N((Y==null?void 0:Y.message)||"Unable to load activity."),p(!1))}}O();const V=setInterval(O,5e3);return()=>{H=!1,clearInterval(V)}},[v,s,L,S]);const M=i.useMemo(()=>{if(!l)return t;const H=l.toLowerCase().trim();return t.filter(O=>O.name.toLowerCase().includes(H))},[t,l]),R=x?(v-1)*b+1:0,W=x?Math.min(v*b,x):0,D=H=>{Q(O=>O.key===H?{key:H,direction:O.direction==="asc"?"desc":"asc"}:{key:H,direction:"asc"}),w(1)},te=(H,O)=>{(H.key==="Enter"||H.key===" ")&&(H.preventDefault(),D(O))};return c?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading users..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx("h2",{className:"page-title",children:"Live Activity"})}),g?e.jsx("div",{className:"alert alert-danger",children:g}):null,e.jsxs("div",{className:"activity-layout",children:[e.jsx("div",{className:"activity-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:l,onChange:H=>r(H.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${s?"":"active"}`,onClick:()=>n(""),children:"All Users"}),M.map(H=>{const O=rS(H.status);return e.jsxs("button",{type:"button",className:`user-chip ${String(H.id)===String(s)?"active":""}`,onClick:()=>n(String(H.id)),children:[e.jsx("span",{className:`status-dot status-${O.key}`}),e.jsx("span",{className:"user-name",children:H.name}),e.jsxs("span",{className:"user-status",children:["(",O.label,")"]})]},H.id)})]})]})}),e.jsxs("div",{className:"activity-right",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",b," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"activity-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"activity-search",type:"text",value:_,onChange:H=>P(H.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle activity-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:`sortable ${L.key==="employee"?`sorted-${L.direction}`:""}`,role:"button",tabIndex:0,onClick:()=>D("employee"),onKeyDown:H=>te(H,"employee"),children:"Employee"}),e.jsx("th",{className:`sortable ${L.key==="app"?`sorted-${L.direction}`:""}`,role:"button",tabIndex:0,onClick:()=>D("app"),onKeyDown:H=>te(H,"app"),children:"Application"}),e.jsx("th",{className:`sortable ${L.key==="window"?`sorted-${L.direction}`:""}`,role:"button",tabIndex:0,onClick:()=>D("window"),onKeyDown:H=>te(H,"window"),children:"Window"}),e.jsx("th",{className:`sortable ${L.key==="url"?`sorted-${L.direction}`:""}`,role:"button",tabIndex:0,onClick:()=>D("url"),onKeyDown:H=>te(H,"url"),children:"URL"}),e.jsx("th",{className:`sortable ${L.key==="start"?`sorted-${L.direction}`:""}`,role:"button",tabIndex:0,onClick:()=>D("start"),onKeyDown:H=>te(H,"start"),children:"Time"})]})}),e.jsx("tbody",{children:o.length?o.map((H,O)=>{const V=lS(H.url);return e.jsxs("tr",{children:[e.jsx("td",{children:H.employee||"-"}),e.jsx("td",{title:H.app||"-",children:ff(H.app||"-",aS)}),e.jsx("td",{title:H.window||"-",children:ff(H.window||"-",sS)}),e.jsx("td",{className:"activity-url-cell",children:V.href?e.jsx("a",{className:"activity-url",href:V.href,target:"_blank",rel:"noopener noreferrer",title:V.full,children:V.text}):e.jsx("span",{className:"activity-url",title:V.full,children:V.text})}),e.jsx("td",{children:Qs(H.start)})]},`${H.employee}-${H.start}-${O}`)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:h?"Loading...":"No activity data yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",R," to ",W," of ",x," entries"]}),e.jsx(st,{page:v,totalPages:A,onPageChange:w,showPageLinks:!0,showPageLabel:!0,maxPageLinks:7})]})]})]})]})}const oS={loading:!0,error:"",data:null};function cS(t){const a=String(t||"Offline").trim().toLowerCase();return a==="online"?{key:"online",label:"Online"}:a==="ideal"||a==="idle"?{key:"idle",label:"Idle"}:{key:"offline",label:"Offline"}}function dS(){const[t,a]=i.useState({employeeId:"",preset:"today"}),[s,n]=i.useState(oS),[l,r]=i.useState(""),[o,u]=i.useState(""),[c,d]=i.useState(""),[h,p]=i.useState({open:!1,rows:[],meta:"",baseDate:""}),[g,N]=i.useState(0),[v,w]=i.useState(1),A=20;i.useEffect(()=>{const R=setInterval(()=>{N(W=>W+1)},15e3);return()=>clearInterval(R)},[]),i.useEffect(()=>{let R=!0;async function W(){var D;n(te=>({...te,loading:!0,error:""}));try{const te=new URLSearchParams;t.employeeId&&te.set("employee_id",t.employeeId),te.set("preset",t.preset||"today");const H=te.toString()?`/api/dashboard/work-activity?${te.toString()}`:"/api/dashboard/work-activity",O=await U(H);if(!R)return;n({loading:!1,error:"",data:O})}catch(te){if((D=te==null?void 0:te.data)!=null&&D.redirect){window.location.href=te.data.redirect;return}R&&n({loading:!1,error:(te==null?void 0:te.message)||"Unable to load activity log.",data:null})}}return W(),()=>{R=!1}},[t,g]),i.useEffect(()=>{w(1)},[t]),i.useEffect(()=>{const R=setTimeout(()=>{d(o.trim()),w(1)},300);return()=>clearTimeout(R)},[o]);const y=s.data||{},x=y.employees||[],f=y.rows||[],b=y.selected_employee_id?String(y.selected_employee_id):t.employeeId,k=i.useMemo(()=>{if(!l)return x;const R=l.toLowerCase();return x.filter(W=>W.name.toLowerCase().includes(R))},[x,l]),_=x.find(R=>String(R.id)===String(b)),P=i.useMemo(()=>{if(!c)return f;const R=c.toLowerCase();return f.filter(W=>[W.employee,W.date,W.on_time,W.off_time,W.event,W.duration,W.history_label,W.stop_reason].some(te=>String(te||"").toLowerCase().includes(R)))},[f,c]),S=P.length,F=Math.max(Math.ceil(S/A),1),L=i.useMemo(()=>P.slice((v-1)*A,v*A),[P,v]),Q=S?(v-1)*A+1:0,E=S?Math.min(v*A,S):0;i.useEffect(()=>{v>F&&w(F)},[v,F]);function C(R){a(W=>({...W,employeeId:R||""}))}function z(R){a(W=>({...W,preset:R}))}function M(R){const W=R.history||[];p({open:!0,rows:W,meta:`${R.employee} - ${Ai(R.date)}`,baseDate:R.date||""})}return s.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading activity log..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"gallery-header",children:e.jsx("h2",{children:"Work Activity Log"})}),s.error?e.jsx("div",{className:"alert alert-danger",children:s.error}):null,e.jsxs("div",{className:"screen-layout",children:[e.jsx("div",{className:"screen-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{className:"user-panel-title",children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:l,onChange:R=>r(R.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${b?"":"active"}`,onClick:()=>C(""),children:"All Users"}),k.map(R=>{const W=cS(R.status);return e.jsxs("button",{type:"button",className:`user-chip ${String(R.id)===String(b)?"active":""}`,onClick:()=>C(String(R.id)),children:[e.jsx("span",{className:`status-dot status-${W.key}`}),e.jsx("span",{className:"user-name",children:R.name}),e.jsxs("span",{className:"user-status",children:["(",W.label,")"]})]},R.id)})]})]})}),e.jsxs("div",{className:"screen-right",children:[e.jsxs("div",{className:"shot-toolbar",children:[e.jsxs("div",{className:"shot-info",children:["Showing: ",_?_.name:"All Users"]}),e.jsx("div",{className:"shot-filter",children:e.jsxs("div",{className:"preset-buttons",children:[e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="today"?"active":""}`,onClick:()=>z("today"),children:"Today"}),e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="yesterday"?"active":""}`,onClick:()=>z("yesterday"),children:"Yesterday"}),e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="one_week"?"active":""}`,onClick:()=>z("one_week"),children:"One Week"}),e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="one_month"?"active":""}`,onClick:()=>z("one_month"),children:"One Month"})]})})]}),e.jsxs("div",{className:"card p-3 usage-card",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",A," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"work-activity-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"work-activity-search",type:"text",value:o,onChange:R=>u(R.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee Name"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"PC On Time"}),e.jsx("th",{children:"PC Off / Signout / Sleeping"}),e.jsx("th",{children:"Stop Reason"}),e.jsx("th",{children:"Event"}),e.jsx("th",{children:"History"}),e.jsx("th",{children:"Duration"})]})}),e.jsx("tbody",{children:L.length?L.map((R,W)=>e.jsxs("tr",{children:[e.jsx("td",{children:R.employee}),e.jsx("td",{children:Ai(R.date)}),e.jsx("td",{children:Mr(R.on_time,R.date)}),e.jsx("td",{children:Mr(R.off_time,R.date)}),e.jsx("td",{children:R.stop_reason||"-"}),e.jsx("td",{children:R.event||"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-link text-info p-0 history-trigger",onClick:()=>M(R),children:R.history_label})}),e.jsx("td",{children:R.duration})]},`${R.employee}-${R.date}-${W}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No activity data yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Q," to ",E," of ",S," entries"]}),e.jsx(st,{page:v,totalPages:F,onPageChange:w,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})]}),h.open?e.jsx("div",{className:"modal-overlay",onClick:()=>p({open:!1,rows:[],meta:"",baseDate:""}),children:e.jsxs("div",{className:"modal-panel work-activity-history-modal",onClick:R=>R.stopPropagation(),children:[e.jsx("h5",{children:"On/Off History"}),e.jsx("div",{className:"text-secondary mb-2",children:h.meta}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"On Time"}),e.jsx("th",{children:"PC Off / Signout / Sleeping"}),e.jsx("th",{children:"Stop Reason"}),e.jsx("th",{children:"Event"}),e.jsx("th",{children:"Duration"})]})}),e.jsx("tbody",{children:h.rows.length?h.rows.map((R,W)=>e.jsxs("tr",{children:[e.jsx("td",{children:W+1}),e.jsx("td",{children:Mr(R.on,h.baseDate)}),e.jsx("td",{children:Mr(R.off,h.baseDate)}),e.jsx("td",{children:R.stop_reason||"-"}),e.jsx("td",{children:R.event||"-"}),e.jsx("td",{children:R.duration})]},`${R.on}-${W}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No history available."})})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"modal-close",onClick:()=>p({open:!1,rows:[],meta:"",baseDate:""}),children:"Close"})})]})}):null]})}const uS={loading:!0,error:"",errorStatus:0,data:null};function mS(t){const a=String(t||"").trim();return a?/^https?:\/\//i.test(a)?a:/^\/\//.test(a)?`https:${a}`:/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(a)?"":a.toLowerCase().startsWith("localhost")||/^[0-9.]+(?::\d+)?(\/|$)/.test(a)?`http://${a}`:`https://${a}`:""}function hS(t,a){if(!t||t==="-")return a||"-";const s=mS(t);return s?e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-info text-decoration-none",children:t}):a||t}function pS(t){const a=String(t||"Offline").trim().toLowerCase();return a==="online"?{key:"online",label:"Online"}:a==="ideal"||a==="idle"?{key:"idle",label:"Idle"}:{key:"offline",label:"Offline"}}function fS(){const[t,a]=i.useState({employeeId:"",preset:"today"}),[s,n]=i.useState(uS),[l,r]=i.useState(""),[o,u]=i.useState(""),[c,d]=i.useState(""),[h,p]=i.useState(0),[g,N]=i.useState(1),v=20;i.useEffect(()=>{const z=setInterval(()=>{p(M=>M+1)},15e3);return()=>clearInterval(z)},[]),i.useEffect(()=>{let z=!0;async function M(){var R;n(W=>({...W,loading:!0,error:"",errorStatus:0}));try{const W=new URLSearchParams;t.employeeId&&W.set("employee_id",t.employeeId),W.set("preset",t.preset||"today");const D=W.toString()?`/api/dashboard/app-usage?${W.toString()}`:"/api/dashboard/app-usage",te=await U(D);if(!z)return;n({loading:!1,error:"",errorStatus:0,data:te})}catch(W){if((R=W==null?void 0:W.data)!=null&&R.redirect){window.location.href=W.data.redirect;return}z&&n({loading:!1,error:(W==null?void 0:W.message)||"Unable to load app usage.",errorStatus:(W==null?void 0:W.status)||0,data:null})}}return M(),()=>{z=!1}},[t,h]),i.useEffect(()=>{const z=setTimeout(()=>{d(o.trim()),N(1)},300);return()=>clearTimeout(z)},[o]);const w=s.data||{},A=w.employees||[],y=w.app_rows||[],x=w.selected_employee_id?String(w.selected_employee_id):t.employeeId,f=i.useMemo(()=>{if(!l)return A;const z=l.toLowerCase();return A.filter(M=>M.name.toLowerCase().includes(z))},[A,l]),b=A.find(z=>String(z.id)===String(x)),k=i.useMemo(()=>{if(!c)return y;const z=c.toLowerCase();return y.filter(M=>[M.name,M.url,M.duration,M.percent].some(W=>String(W||"").toLowerCase().includes(z)))},[y,c]),_=k.length,P=Math.max(Math.ceil(_/v),1),S=i.useMemo(()=>k.slice((g-1)*v,g*v),[k,g]),F=_?(g-1)*v+1:0,L=_?Math.min(g*v,_):0;i.useEffect(()=>{g>P&&N(P)},[g,P]),i.useEffect(()=>{N(1)},[t]);function Q(z){a(M=>({...M,employeeId:z||""}))}function E(z){a(M=>({...M,preset:z}))}function C(z,M){const R=new URLSearchParams;return R.set("app",z),M&&R.set("app_key",M),x&&R.set("employee_id",x),R.set("preset",t.preset||"today"),`/app-urls?${R.toString()}`}return s.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading app usage..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"gallery-header",children:e.jsx("h2",{children:"App Usage"})}),s.error?e.jsx("div",{className:`alert ${s.errorStatus===403?"alert-warning":"alert-danger"}`,children:s.error}):null,e.jsxs("div",{className:"screen-layout",children:[e.jsx("div",{className:"screen-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{className:"user-panel-title",children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:l,onChange:z=>r(z.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${x?"":"active"}`,onClick:()=>Q(""),children:"All Users"}),f.map(z=>{const M=pS(z.status);return e.jsxs("button",{type:"button",className:`user-chip ${String(z.id)===String(x)?"active":""}`,onClick:()=>Q(String(z.id)),children:[e.jsx("span",{className:`status-dot status-${M.key}`}),e.jsx("span",{className:"user-name",children:z.name}),e.jsxs("span",{className:"user-status",children:["(",M.label,")"]})]},z.id)})]})]})}),e.jsxs("div",{className:"screen-right",children:[e.jsxs("div",{className:"shot-toolbar",children:[e.jsxs("div",{className:"shot-info",children:["Showing: ",b?b.name:"All Users"]}),e.jsx("div",{className:"shot-filter",children:e.jsxs("div",{className:"preset-buttons",children:[e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="today"?"active":""}`,onClick:()=>E("today"),children:"Today"}),e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="yesterday"?"active":""}`,onClick:()=>E("yesterday"),children:"Yesterday"}),e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="one_week"?"active":""}`,onClick:()=>E("one_week"),children:"One Week"}),e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="one_month"?"active":""}`,onClick:()=>E("one_month"),children:"One Month"})]})}),e.jsxs("div",{className:"usage-total",children:["Total Time: ",w.total_time||"0s"]})]}),e.jsxs("div",{className:"card p-3 usage-card",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",v," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"app-usage-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"app-usage-search",type:"text",value:o,onChange:z=>u(z.target.value),placeholder:"Search apps"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Application"}),e.jsx("th",{children:"Top URL"}),e.jsx("th",{style:{width:"120px",whiteSpace:"nowrap"},children:"Total Time"}),e.jsx("th",{style:{width:"90px",whiteSpace:"nowrap"},children:"Share"})]})}),e.jsx("tbody",{children:S.length?S.map(z=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("a",{className:"text-info text-decoration-none",href:C(z.name,z.app_key),children:z.name})}),e.jsx("td",{className:"text-truncate",style:{maxWidth:"280px"},children:hS(z.url)}),e.jsx("td",{style:{width:"120px",whiteSpace:"nowrap"},children:z.duration}),e.jsxs("td",{style:{width:"90px",whiteSpace:"nowrap"},children:[z.percent,"%"]})]},z.name)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No activity data yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",F," to ",L," of ",_," entries"]}),e.jsx(st,{page:g,totalPages:P,onPageChange:N,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})]})]})}const gS={loading:!0,error:"",errorStatus:0,data:null};function Or(t){const a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${a}-${s}-${n}`}function xS(t){const a=String(t||"").trim();return a?/^https?:\/\//i.test(a)?a:/^\/\//.test(a)?`https:${a}`:/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(a)?"":a.toLowerCase().startsWith("localhost")||/^[0-9.]+(?::\d+)?(\/|$)/.test(a)?`http://${a}`:`https://${a}`:""}function bS(){const t=ua();return i.useMemo(()=>new URLSearchParams(t.search),[t.search])}function jS(){const t=Or(new Date),a=bS(),s=a.get("app")||"",n=a.get("app_key")||"",l=a.get("employee_id")||"",r=a.get("preset")||"today",o=a.get("date_from")||"",u=a.get("date_to")||"",[c,d]=i.useState(s),[h,p]=i.useState(n),[g,N]=i.useState({employeeId:l,preset:r,dateFrom:o,dateTo:u}),[v,w]=i.useState({dateFrom:o||t,dateTo:u||t}),[A,y]=i.useState(gS),[x,f]=i.useState(""),[b,k]=i.useState(""),[_,P]=i.useState(""),[S,F]=i.useState(1),L=20,Q=i.useRef(null),E=i.useRef(null),C=i.useRef(null),z=i.useRef(null);i.useEffect(()=>{d(s),p(n),N(se=>({...se,employeeId:l,preset:r,dateFrom:o,dateTo:u})),w({dateFrom:o||t,dateTo:u||t}),F(1)},[s,n,l,r,o,u,t]),i.useEffect(()=>{let se=!0;async function be(){var ne;y(ae=>({...ae,loading:!0,error:"",errorStatus:0}));try{const ae=new URLSearchParams;c&&ae.set("app",c),h&&ae.set("app_key",h),g.employeeId&&ae.set("employee_id",g.employeeId),g.preset?ae.set("preset",g.preset):(g.dateFrom&&ae.set("date_from",g.dateFrom),g.dateTo&&ae.set("date_to",g.dateTo));const X=ae.toString()?`/api/dashboard/app-urls?${ae.toString()}`:"/api/dashboard/app-urls",ke=await U(X);if(!se)return;y({loading:!1,error:"",errorStatus:0,data:ke})}catch(ae){if((ne=ae==null?void 0:ae.data)!=null&&ne.redirect){window.location.href=ae.data.redirect;return}se&&y({loading:!1,error:(ae==null?void 0:ae.message)||"Unable to load app URLs.",errorStatus:(ae==null?void 0:ae.status)||0,data:null})}}return be(),()=>{se=!1}},[h,c,g]),i.useEffect(()=>{const se=setTimeout(()=>{P(b.trim()),F(1)},300);return()=>clearTimeout(se)},[b]);const M=A.data||{},R=M.employees||[],W=M.available_dates||[],D=M.url_rows||[],te=M.selected_employee_id?String(M.selected_employee_id):g.employeeId,H=i.useMemo(()=>{if(!x)return R;const se=x.toLowerCase();return R.filter(be=>be.name.toLowerCase().includes(se))},[R,x]);R.find(se=>String(se.id)===String(te));const O=i.useMemo(()=>{if(!_)return D;const se=_.toLowerCase();return D.filter(be=>String(be.url||"").toLowerCase().includes(se))},[D,_]),V=O.length,re=Math.max(Math.ceil(V/L),1),Y=i.useMemo(()=>O.slice((S-1)*L,S*L),[O,S]),ce=V?(S-1)*L+1:0,ie=V?Math.min(S*L,V):0;i.useEffect(()=>{S>re&&F(re)},[S,re]),i.useEffect(()=>{F(1)},[g,c]),i.useEffect(()=>{if(!window.flatpickr)return;const se=W.length?W:[],be={wrap:!0,altInput:!0,altFormat:"d-m-Y",dateFormat:"Y-m-d",altInputClass:"date-input flatpickr-input",enable:se,allowInput:!1,disableMobile:!0};Q.current&&!C.current&&(C.current=window.flatpickr(Q.current,{...be,onChange:(ne,ae)=>{w(X=>({...X,dateFrom:ae}))}})),E.current&&!z.current&&(z.current=window.flatpickr(E.current,{...be,onChange:(ne,ae)=>{w(X=>({...X,dateTo:ae}))}})),C.current&&(C.current.set("enable",se),v.dateFrom?C.current.setDate(v.dateFrom,!1):C.current.clear()),z.current&&(z.current.set("enable",se),v.dateTo?z.current.setDate(v.dateTo,!1):z.current.clear())},[W,v.dateFrom,v.dateTo]),i.useEffect(()=>()=>{C.current&&C.current.destroy(),z.current&&z.current.destroy()},[]);function ee(se){N(be=>({...be,employeeId:se||""}))}function T(se){const be=new Date;if(se==="today"){const ne=Or(be);N(ae=>({...ae,preset:"today",dateFrom:"",dateTo:""})),w({dateFrom:ne,dateTo:ne})}else if(se==="yesterday"){const ne=new Date(be);ne.setDate(be.getDate()-1);const ae=Or(ne);N(X=>({...X,preset:"yesterday",dateFrom:"",dateTo:""})),w({dateFrom:ae,dateTo:ae})}else N(ne=>({...ne,preset:"all",dateFrom:"",dateTo:""})),w({dateFrom:"",dateTo:""})}function Z(se){if(se.preventDefault(),!v.dateFrom&&!v.dateTo){const ne=Or(new Date);N(ae=>({...ae,preset:"today",dateFrom:"",dateTo:""})),w({dateFrom:ne,dateTo:ne});return}N(be=>({...be,preset:"",dateFrom:v.dateFrom,dateTo:v.dateTo}))}return A.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading app URLs..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"gallery-header",children:[e.jsx("h2",{children:"App URLs"}),e.jsx("div",{className:"gallery-actions",children:e.jsx(dt,{to:"/app-usage",className:"shot-btn",children:"Back to App Usage"})})]}),A.error?e.jsx("div",{className:`alert ${A.errorStatus===403?"alert-warning":"alert-danger"}`,children:A.error}):null,e.jsxs("div",{className:"screen-layout",children:[e.jsx("div",{className:"screen-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{className:"user-panel-title",children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:x,onChange:se=>f(se.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${te?"":"active"}`,onClick:()=>ee(""),children:"All Users"}),H.map(se=>{const be=se.status||"Offline",ne=be.toLowerCase();return e.jsxs("button",{type:"button",className:`user-chip ${String(se.id)===String(te)?"active":""}`,onClick:()=>ee(String(se.id)),children:[e.jsx("span",{className:`status-dot status-${ne}`}),e.jsx("span",{className:"user-name",children:se.name}),e.jsxs("span",{className:"user-status",children:["(",be,")"]})]},se.id)})]})]})}),e.jsxs("div",{className:"screen-right",children:[e.jsxs("div",{className:"shot-toolbar",children:[e.jsx("div",{className:"shot-info",children:c?e.jsxs(e.Fragment,{children:["Application: ",e.jsx("strong",{children:c})]}):"Choose an application from App Usage."}),e.jsxs("form",{className:"shot-filter",onSubmit:Z,children:[e.jsxs("div",{className:"preset-buttons",children:[e.jsx("button",{type:"button",className:`shot-btn ${g.preset==="today"?"active":""}`,onClick:()=>T("today"),children:"Today"}),e.jsx("button",{type:"button",className:`shot-btn ${g.preset==="yesterday"?"active":""}`,onClick:()=>T("yesterday"),children:"Yesterday"})]}),e.jsxs("label",{children:[e.jsx("span",{children:"From"}),e.jsxs("div",{className:"date-picker-wrap",ref:Q,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"To"}),e.jsxs("div",{className:"date-picker-wrap",ref:E,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsx("button",{type:"submit",className:"shot-btn primary",children:"Apply"}),e.jsx("button",{type:"button",className:`shot-btn ${g.preset==="all"?"active":""}`,onClick:()=>T("all"),children:"Reset"})]}),e.jsxs("div",{className:"usage-total",children:["Total Time: ",M.total_time||"0s"]})]}),e.jsxs("div",{className:"card p-3 usage-card",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",L," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"app-url-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"app-url-search",type:"text",value:b,onChange:se=>k(se.target.value),placeholder:"Search URLs"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"URL"}),e.jsx("th",{children:"Total Time"}),e.jsx("th",{children:"Share"})]})}),e.jsx("tbody",{children:Y.length?Y.map(se=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-truncate",style:{maxWidth:"380px"},children:se.url?(()=>{const be=xS(se.url);return be?e.jsx("a",{href:be,target:"_blank",rel:"noopener noreferrer",className:"text-info text-decoration-none",children:se.url}):se.url})():"-"}),e.jsx("td",{children:se.duration}),e.jsxs("td",{children:[se.percent,"%"]})]},se.url)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",children:"No URL data yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",ce," to ",ie," of ",V," entries"]}),e.jsx(st,{page:S,totalPages:re,onPageChange:F,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})]})]})}const yS={loading:!0,error:"",errorStatus:0,data:null};function vS(t){const a=String(t||"").trim();return a?/^https?:\/\//i.test(a)?a:/^\/\//.test(a)?`https:${a}`:/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(a)?"":a.toLowerCase().startsWith("localhost")||/^[0-9.]+(?::\d+)?(\/|$)/.test(a)?`http://${a}`:`https://${a}`:""}function NS(){const[t,a]=i.useState({employeeId:"",preset:"today"}),[s,n]=i.useState(yS),[l,r]=i.useState(""),[o,u]=i.useState(""),[c,d]=i.useState(""),[h,p]=i.useState(0),[g,N]=i.useState(1),v=20;i.useEffect(()=>{const C=setInterval(()=>{p(z=>z+1)},15e3);return()=>clearInterval(C)},[]),i.useEffect(()=>{let C=!0;async function z(){var M;n(R=>({...R,loading:!0,error:"",errorStatus:0}));try{const R=new URLSearchParams;t.employeeId&&R.set("employee_id",t.employeeId),R.set("preset",t.preset||"today");const W=R.toString()?`/api/dashboard/gaming-ott?${R.toString()}`:"/api/dashboard/gaming-ott",D=await U(W);if(!C)return;n({loading:!1,error:"",errorStatus:0,data:D})}catch(R){if((M=R==null?void 0:R.data)!=null&&M.redirect){window.location.href=R.data.redirect;return}C&&n({loading:!1,error:(R==null?void 0:R.message)||"Unable to load gaming/OTT usage.",errorStatus:(R==null?void 0:R.status)||0,data:null})}}return z(),()=>{C=!1}},[t,h]),i.useEffect(()=>{const C=setTimeout(()=>{d(o.trim()),N(1)},300);return()=>clearTimeout(C)},[o]);const w=s.data||{},A=w.employees||[],y=w.rows||[],x=w.selected_employee_id?String(w.selected_employee_id):t.employeeId,f=i.useMemo(()=>{if(!l)return A;const C=l.toLowerCase();return A.filter(z=>z.name.toLowerCase().includes(C))},[A,l]),b=A.find(C=>String(C.id)===String(x)),k=i.useMemo(()=>{if(!c)return y;const C=c.toLowerCase();return y.filter(z=>[z.employee,z.date,z.app,z.detail,z.start,z.end,z.duration].some(R=>String(R||"").toLowerCase().includes(C)))},[y,c]),_=k.length,P=Math.max(Math.ceil(_/v),1),S=i.useMemo(()=>k.slice((g-1)*v,g*v),[k,g]),F=_?(g-1)*v+1:0,L=_?Math.min(g*v,_):0;i.useEffect(()=>{g>P&&N(P)},[g,P]),i.useEffect(()=>{N(1)},[t]);function Q(C){a(z=>({...z,employeeId:C||""}))}function E(C){a(z=>({...z,preset:C}))}return s.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading gaming/OTT usage..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"gallery-header",children:e.jsx("h2",{children:"Gaming / OTT Usage"})}),s.error?e.jsx("div",{className:`alert ${s.errorStatus===403?"alert-warning":"alert-danger"}`,children:s.error}):null,e.jsxs("div",{className:"screen-layout",children:[e.jsx("div",{className:"screen-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{className:"user-panel-title",children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:l,onChange:C=>r(C.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${x?"":"active"}`,onClick:()=>Q(""),children:"All Users"}),f.map(C=>{const z=C.status||"Offline",M=z.toLowerCase();return e.jsxs("button",{type:"button",className:`user-chip ${String(C.id)===String(x)?"active":""}`,onClick:()=>Q(String(C.id)),children:[e.jsx("span",{className:`status-dot status-${M}`}),e.jsx("span",{className:"user-name",children:C.name}),e.jsxs("span",{className:"user-status",children:["(",z,")"]})]},C.id)})]})]})}),e.jsxs("div",{className:"screen-right",children:[e.jsxs("div",{className:"shot-toolbar",children:[e.jsxs("div",{className:"shot-info",children:["Showing: ",b?b.name:"All Users"]}),e.jsx("div",{className:"shot-filter",children:e.jsxs("div",{className:"preset-buttons",children:[e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="today"?"active":""}`,onClick:()=>E("today"),children:"Today"}),e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="yesterday"?"active":""}`,onClick:()=>E("yesterday"),children:"Yesterday"}),e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="one_week"?"active":""}`,onClick:()=>E("one_week"),children:"One Week"}),e.jsx("button",{type:"button",className:`shot-btn ${t.preset==="one_month"?"active":""}`,onClick:()=>E("one_month"),children:"One Month"})]})})]}),e.jsxs("div",{className:"card p-3 usage-card",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",v," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"gaming-ott-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"gaming-ott-search",type:"text",value:o,onChange:C=>u(C.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Application"}),e.jsx("th",{children:"Title / URL"}),e.jsx("th",{children:"Start Time"}),e.jsx("th",{children:"End Time"}),e.jsx("th",{children:"Duration"})]})}),e.jsx("tbody",{children:S.length?S.map((C,z)=>e.jsxs("tr",{children:[e.jsx("td",{children:C.employee}),e.jsx("td",{children:C.date}),e.jsx("td",{children:C.app}),e.jsx("td",{className:"text-truncate",style:{maxWidth:"320px"},title:C.detail,children:C.detail?(()=>{const M=vS(C.detail_url||C.detail);return M?e.jsx("a",{href:M,target:"_blank",rel:"noopener noreferrer",className:"text-info text-decoration-none",children:C.detail}):C.detail})():"-"}),e.jsx("td",{children:C.start}),e.jsx("td",{children:C.end}),e.jsx("td",{children:C.duration})]},`${C.employee}-${C.date}-${z}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No activity data yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",F," to ",L," of ",_," entries"]}),e.jsx(st,{page:g,totalPages:P,onPageChange:N,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})]})]})}const ls=[{code:"+93",label:"Afghanistan"},{code:"+355",label:"Albania"},{code:"+213",label:"Algeria"},{code:"+1",label:"American Samoa"},{code:"+376",label:"Andorra"},{code:"+244",label:"Angola"},{code:"+1",label:"Anguilla"},{code:"+672",label:"Antarctica"},{code:"+1",label:"Antigua and Barbuda"},{code:"+54",label:"Argentina"},{code:"+374",label:"Armenia"},{code:"+297",label:"Aruba"},{code:"+61",label:"Australia"},{code:"+43",label:"Austria"},{code:"+994",label:"Azerbaijan"},{code:"+1",label:"Bahamas"},{code:"+973",label:"Bahrain"},{code:"+880",label:"Bangladesh"},{code:"+1",label:"Barbados"},{code:"+375",label:"Belarus"},{code:"+32",label:"Belgium"},{code:"+501",label:"Belize"},{code:"+229",label:"Benin"},{code:"+1",label:"Bermuda"},{code:"+975",label:"Bhutan"},{code:"+591",label:"Bolivia"},{code:"+387",label:"Bosnia and Herzegovina"},{code:"+267",label:"Botswana"},{code:"+55",label:"Brazil"},{code:"+246",label:"British Indian Ocean Territory"},{code:"+1",label:"British Virgin Islands"},{code:"+673",label:"Brunei"},{code:"+359",label:"Bulgaria"},{code:"+226",label:"Burkina Faso"},{code:"+257",label:"Burundi"},{code:"+855",label:"Cambodia"},{code:"+237",label:"Cameroon"},{code:"+1",label:"Canada"},{code:"+238",label:"Cape Verde"},{code:"+1",label:"Cayman Islands"},{code:"+236",label:"Central African Republic"},{code:"+235",label:"Chad"},{code:"+56",label:"Chile"},{code:"+86",label:"China"},{code:"+61",label:"Christmas Island"},{code:"+61",label:"Cocos (Keeling) Islands"},{code:"+57",label:"Colombia"},{code:"+269",label:"Comoros"},{code:"+242",label:"Congo (Republic)"},{code:"+243",label:"Congo (DRC)"},{code:"+682",label:"Cook Islands"},{code:"+506",label:"Costa Rica"},{code:"+225",label:"Cote d'Ivoire"},{code:"+385",label:"Croatia"},{code:"+53",label:"Cuba"},{code:"+599",label:"Curacao"},{code:"+357",label:"Cyprus"},{code:"+420",label:"Czech Republic"},{code:"+45",label:"Denmark"},{code:"+253",label:"Djibouti"},{code:"+1",label:"Dominica"},{code:"+1",label:"Dominican Republic"},{code:"+593",label:"Ecuador"},{code:"+20",label:"Egypt"},{code:"+503",label:"El Salvador"},{code:"+240",label:"Equatorial Guinea"},{code:"+291",label:"Eritrea"},{code:"+372",label:"Estonia"},{code:"+268",label:"Eswatini"},{code:"+251",label:"Ethiopia"},{code:"+500",label:"Falkland Islands"},{code:"+298",label:"Faroe Islands"},{code:"+679",label:"Fiji"},{code:"+358",label:"Finland"},{code:"+33",label:"France"},{code:"+594",label:"French Guiana"},{code:"+689",label:"French Polynesia"},{code:"+241",label:"Gabon"},{code:"+220",label:"Gambia"},{code:"+995",label:"Georgia"},{code:"+49",label:"Germany"},{code:"+233",label:"Ghana"},{code:"+350",label:"Gibraltar"},{code:"+30",label:"Greece"},{code:"+299",label:"Greenland"},{code:"+1",label:"Grenada"},{code:"+590",label:"Guadeloupe"},{code:"+1",label:"Guam"},{code:"+502",label:"Guatemala"},{code:"+44",label:"Guernsey"},{code:"+224",label:"Guinea"},{code:"+245",label:"Guinea-Bissau"},{code:"+592",label:"Guyana"},{code:"+509",label:"Haiti"},{code:"+504",label:"Honduras"},{code:"+852",label:"Hong Kong"},{code:"+36",label:"Hungary"},{code:"+354",label:"Iceland"},{code:"+91",label:"India"},{code:"+62",label:"Indonesia"},{code:"+98",label:"Iran"},{code:"+964",label:"Iraq"},{code:"+353",label:"Ireland"},{code:"+44",label:"Isle of Man"},{code:"+972",label:"Israel"},{code:"+39",label:"Italy"},{code:"+1",label:"Jamaica"},{code:"+81",label:"Japan"},{code:"+44",label:"Jersey"},{code:"+962",label:"Jordan"},{code:"+7",label:"Kazakhstan"},{code:"+254",label:"Kenya"},{code:"+686",label:"Kiribati"},{code:"+965",label:"Kuwait"},{code:"+996",label:"Kyrgyzstan"},{code:"+856",label:"Laos"},{code:"+371",label:"Latvia"},{code:"+961",label:"Lebanon"},{code:"+266",label:"Lesotho"},{code:"+231",label:"Liberia"},{code:"+218",label:"Libya"},{code:"+423",label:"Liechtenstein"},{code:"+370",label:"Lithuania"},{code:"+352",label:"Luxembourg"},{code:"+853",label:"Macao"},{code:"+261",label:"Madagascar"},{code:"+265",label:"Malawi"},{code:"+60",label:"Malaysia"},{code:"+960",label:"Maldives"},{code:"+223",label:"Mali"},{code:"+356",label:"Malta"},{code:"+692",label:"Marshall Islands"},{code:"+596",label:"Martinique"},{code:"+222",label:"Mauritania"},{code:"+230",label:"Mauritius"},{code:"+262",label:"Mayotte"},{code:"+52",label:"Mexico"},{code:"+691",label:"Micronesia"},{code:"+373",label:"Moldova"},{code:"+377",label:"Monaco"},{code:"+976",label:"Mongolia"},{code:"+382",label:"Montenegro"},{code:"+1",label:"Montserrat"},{code:"+212",label:"Morocco"},{code:"+258",label:"Mozambique"},{code:"+95",label:"Myanmar"},{code:"+264",label:"Namibia"},{code:"+674",label:"Nauru"},{code:"+977",label:"Nepal"},{code:"+31",label:"Netherlands"},{code:"+687",label:"New Caledonia"},{code:"+64",label:"New Zealand"},{code:"+505",label:"Nicaragua"},{code:"+227",label:"Niger"},{code:"+234",label:"Nigeria"},{code:"+683",label:"Niue"},{code:"+850",label:"North Korea"},{code:"+389",label:"North Macedonia"},{code:"+1",label:"Northern Mariana Islands"},{code:"+47",label:"Norway"},{code:"+968",label:"Oman"},{code:"+92",label:"Pakistan"},{code:"+680",label:"Palau"},{code:"+970",label:"Palestine"},{code:"+507",label:"Panama"},{code:"+675",label:"Papua New Guinea"},{code:"+595",label:"Paraguay"},{code:"+51",label:"Peru"},{code:"+63",label:"Philippines"},{code:"+48",label:"Poland"},{code:"+351",label:"Portugal"},{code:"+1",label:"Puerto Rico"},{code:"+974",label:"Qatar"},{code:"+262",label:"Reunion"},{code:"+40",label:"Romania"},{code:"+7",label:"Russia"},{code:"+250",label:"Rwanda"},{code:"+590",label:"Saint Barthelemy"},{code:"+290",label:"Saint Helena"},{code:"+1",label:"Saint Kitts and Nevis"},{code:"+1",label:"Saint Lucia"},{code:"+590",label:"Saint Martin"},{code:"+508",label:"Saint Pierre and Miquelon"},{code:"+1",label:"Saint Vincent and the Grenadines"},{code:"+685",label:"Samoa"},{code:"+378",label:"San Marino"},{code:"+239",label:"Sao Tome and Principe"},{code:"+966",label:"Saudi Arabia"},{code:"+221",label:"Senegal"},{code:"+381",label:"Serbia"},{code:"+248",label:"Seychelles"},{code:"+232",label:"Sierra Leone"},{code:"+65",label:"Singapore"},{code:"+421",label:"Slovakia"},{code:"+386",label:"Slovenia"},{code:"+677",label:"Solomon Islands"},{code:"+252",label:"Somalia"},{code:"+27",label:"South Africa"},{code:"+82",label:"South Korea"},{code:"+211",label:"South Sudan"},{code:"+34",label:"Spain"},{code:"+94",label:"Sri Lanka"},{code:"+249",label:"Sudan"},{code:"+597",label:"Suriname"},{code:"+46",label:"Sweden"},{code:"+41",label:"Switzerland"},{code:"+963",label:"Syria"},{code:"+886",label:"Taiwan"},{code:"+992",label:"Tajikistan"},{code:"+255",label:"Tanzania"},{code:"+66",label:"Thailand"},{code:"+670",label:"Timor-Leste"},{code:"+228",label:"Togo"},{code:"+690",label:"Tokelau"},{code:"+676",label:"Tonga"},{code:"+1",label:"Trinidad and Tobago"},{code:"+216",label:"Tunisia"},{code:"+90",label:"Turkey"},{code:"+993",label:"Turkmenistan"},{code:"+1",label:"Turks and Caicos Islands"},{code:"+688",label:"Tuvalu"},{code:"+256",label:"Uganda"},{code:"+380",label:"Ukraine"},{code:"+971",label:"United Arab Emirates"},{code:"+44",label:"United Kingdom"},{code:"+1",label:"United States"},{code:"+598",label:"Uruguay"},{code:"+998",label:"Uzbekistan"},{code:"+678",label:"Vanuatu"},{code:"+379",label:"Vatican City"},{code:"+58",label:"Venezuela"},{code:"+84",label:"Vietnam"},{code:"+681",label:"Wallis and Futuna"},{code:"+212",label:"Western Sahara"},{code:"+967",label:"Yemen"},{code:"+260",label:"Zambia"},{code:"+263",label:"Zimbabwe"},{code:"+358",label:"Aland Islands"},{code:"+383",label:"Kosovo"}],Fb=Array.from(new Set(ls.map(t=>t.label)));Fb.sort((t,a)=>t.localeCompare(a));const Zi=Fb,_S={loading:!0,error:"",data:null},ac={contact_name:"",company_name:"",email:"",phone:"",address_line1:"",address_line2:"",city:"",state:"",postal_code:"",country:"India",gstin:""},SS=["contact_name","company_name","email","address_line1","city","state","postal_code","country","gstin"],wS={india:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"]};function kS(t){return String(t||"").trim().toLowerCase()}function CS(t){return wS[kS(t)]||[]}function PS(t){return SS.filter(a=>!String((t==null?void 0:t[a])||"").trim())}function ES(){const[t,a]=i.useState(_S),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState(ac),[c,d]=i.useState(!1),[h,p]=i.useState(!1),[g,N]=i.useState(""),[v,w]=i.useState(""),[A,y]=i.useState([]);async function x(){var R;const M=await U("/api/dashboard/company");a({loading:!1,error:"",data:M}),r(((R=M.settings)==null?void 0:R.screenshot_interval_minutes)??"")}i.useEffect(()=>{const M={current:!0};async function R(){var W,D;n("");try{const te=await U("/api/dashboard/company");if(M&&!M.current)return;a({loading:!1,error:"",data:te}),r(((W=te.settings)==null?void 0:W.screenshot_interval_minutes)??"")}catch(te){if((D=te==null?void 0:te.data)!=null&&D.redirect){window.location.href=te.data.redirect;return}(!M||M.current)&&a({loading:!1,error:(te==null?void 0:te.message)||"Unable to load company settings.",data:null})}}return R(),f(M),()=>{M.current=!1}},[]);async function f(M){var R;N(""),w("");try{const W=await U("/api/dashboard/billing-profile");if(M&&!M.current)return;u(W.profile||ac),y(W.missing_fields||[]),d(!0)}catch(W){if((R=W==null?void 0:W.data)!=null&&R.redirect){window.location.href=W.data.redirect;return}(!M||M.current)&&(w((W==null?void 0:W.message)||"Unable to load billing details."),d(!0))}}async function b(M){M.preventDefault(),n("");try{const R=await U("/api/dashboard/company/interval",{method:"POST",body:JSON.stringify({interval:l})});n(`Screenshot interval updated to ${R.screenshot_interval_minutes} minutes.`),await x()}catch(R){n(""),a(W=>({...W,error:(R==null?void 0:R.message)||"Unable to update interval."}))}}function k(M){const{name:R,value:W}=M.target;u(D=>R==="country"?{...D,country:W,state:D.state&&D.state.trim()?D.state:""}:{...D,[R]:W})}async function _(M){var R,W;M.preventDefault(),N(""),w(""),p(!0);try{const D=await U("/api/dashboard/billing-profile",{method:"POST",body:JSON.stringify(o)});u(D.profile||ac),y(D.missing_fields||[]),N("Billing details saved.")}catch(D){if((R=D==null?void 0:D.data)!=null&&R.redirect){window.location.href=D.data.redirect;return}(W=D==null?void 0:D.data)!=null&&W.missing_fields&&y(D.data.missing_fields),(D==null?void 0:D.message)==="invalid_gstin"?w("Please enter a valid GSTIN."):w((D==null?void 0:D.message)||"Unable to save billing details.")}finally{p(!1)}}if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading company settings..."})]});const P=t.data||{},S=P.org||{},F=P.subscription||null,L=P.counts||{},Q=P.allowed_intervals||[],E=PS(o),C=A.length?A:E,z=E.length===0;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:S.name||"Company Settings"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-lg-3",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h4",{children:"Company Details"}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Name"}),e.jsx("strong",{children:S.name||"-"})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Company Key"}),e.jsx("strong",{children:S.company_key||"-"})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Created"}),e.jsx("strong",{children:S.created_at||"-"})]}),e.jsx(dt,{to:"/company/edit",className:"btn btn-primary mt-3",children:"Edit Company"})]})}),e.jsx("div",{className:"col-12 col-lg-3",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h4",{children:"Subscription"}),F?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Plan"}),e.jsx("strong",{children:F.plan})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Employees Allowed"}),e.jsx("strong",{children:F.employee_limit===0?"Unlimited":F.employee_limit})]}),F.end_date?e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Valid Till"}),e.jsx("strong",{children:F.end_date})]}):null]}):e.jsx("div",{className:"monitor-summary-note",children:"No Active Subscription"}),e.jsx(dt,{to:"/plans",className:"btn btn-outline-primary mt-2 manage-plan-btn",children:"Manage Plan"})]})}),e.jsx("div",{className:"col-12 col-lg-2",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h4",{children:"Plan Limits"}),F?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Employee Limit"}),e.jsx("strong",{children:F.employee_limit===0?"Unlimited":F.employee_limit})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Retention Days"}),e.jsx("strong",{children:F.plan_retention_days??"-"})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Min Screenshot"}),e.jsxs("strong",{children:[F.screenshot_min_minutes," minutes"]})]})]}):e.jsx("div",{className:"monitor-summary-note",children:"No active plan details."})]})}),e.jsx("div",{className:"col-12 col-lg-2",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h4",{children:"Usage Summary"}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Total Employees"}),e.jsx("strong",{children:L.employees??0})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Total Activities"}),e.jsx("strong",{children:L.activities??0})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Total Screenshots"}),e.jsx("strong",{children:L.screenshots??0})]})]})}),e.jsx("div",{className:"col-12 col-lg-2",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h4",{children:"Screenshot Interval"}),e.jsx("form",{className:"mt-2",onSubmit:b,children:e.jsxs("div",{className:"d-flex gap-2 align-items-center monitor-summary-row monitor-summary-row--accent",children:[e.jsx("select",{className:"form-select",style:{maxWidth:"140px"},value:l,onChange:M=>r(M.target.value),children:Q.map(M=>e.jsxs("option",{value:M,children:[M," minutes"]},M))}),e.jsx("button",{className:"btn btn-primary",type:"submit",children:"Save"})]})})]})})]}),e.jsx("hr",{className:"section-divider"}),e.jsxs("div",{className:"card p-3 mt-3",id:"billing-details",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:"Billing Information & GST"}),e.jsx("p",{className:"text-secondary mb-0",children:"Required before paid plans and used for invoice generation."})]}),e.jsx("span",{className:`badge ${z?"bg-success":"bg-warning text-dark"}`,children:z?"Complete":"Incomplete"})]}),g?e.jsx("div",{className:"alert alert-success mt-2",children:g}):null,v?e.jsx("div",{className:"alert alert-danger mt-2",children:v}):null,c?e.jsxs("form",{onSubmit:_,children:[e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Contact Name"}),e.jsx("input",{type:"text",name:"contact_name",className:`form-control ${C.includes("contact_name")?"is-invalid":""}`,value:o.contact_name,onChange:k,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Company Name"}),e.jsx("input",{type:"text",name:"company_name",className:`form-control ${C.includes("company_name")?"is-invalid":""}`,value:o.company_name,onChange:k,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",name:"email",className:`form-control ${C.includes("email")?"is-invalid":""}`,value:o.email,onChange:k,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Phone (optional)"}),e.jsx("input",{type:"tel",name:"phone",className:"form-control",value:o.phone,onChange:k})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Address Line 1"}),e.jsx("input",{type:"text",name:"address_line1",className:`form-control ${C.includes("address_line1")?"is-invalid":""}`,value:o.address_line1,onChange:k,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Address Line 2 (optional)"}),e.jsx("input",{type:"text",name:"address_line2",className:"form-control",value:o.address_line2,onChange:k})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",name:"city",className:`form-control ${C.includes("city")?"is-invalid":""}`,value:o.city,onChange:k,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{type:"text",name:"country",className:`form-control ${C.includes("country")?"is-invalid":""}`,value:o.country,onChange:k,list:"country-options",required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"State"}),e.jsx("input",{type:"text",name:"state",className:`form-control ${C.includes("state")?"is-invalid":""}`,value:o.state,onChange:k,list:"state-options",disabled:!String(o.country||"").trim(),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Postal Code"}),e.jsx("input",{type:"text",name:"postal_code",className:`form-control ${C.includes("postal_code")?"is-invalid":""}`,value:o.postal_code,onChange:k,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"GSTIN"}),e.jsx("input",{type:"text",name:"gstin",className:`form-control ${C.includes("gstin")?"is-invalid":""}`,value:o.gstin,onChange:M=>k({target:{name:"gstin",value:M.target.value.toUpperCase()}}),maxLength:15,placeholder:"15-character GSTIN",required:!0})]})]}),e.jsx("datalist",{id:"country-options",children:Zi.map(M=>e.jsx("option",{value:M},M))}),e.jsx("datalist",{id:"state-options",children:CS(o.country).map(M=>e.jsx("option",{value:M},M))}),e.jsx("button",{className:"btn btn-primary btn-sm mt-3",type:"submit",disabled:h,children:h?"Saving...":"Save Billing Details"})]}):e.jsx("div",{className:"text-secondary mt-2",children:"Loading billing details..."})]})]})}const AS={loading:!0,error:"",data:null};function TS(){const[t,a]=i.useState(AS),[s,n]=i.useState(""),[l,r]=i.useState(2),[o,u]=i.useState(!1),[c,d]=i.useState(""),[h,p]=i.useState(""),[g,N]=i.useState(!0),[v,w]=i.useState(!0),[A,y]=i.useState(!0),[x,f]=i.useState(!0),[b,k]=i.useState(""),[_,P]=i.useState({open:!1,message:""}),[S,F]=i.useState(!1);async function L(){var te,H,O,V,re,Y,ce,ie;const D=await U("/api/dashboard/company");a({loading:!1,error:"",data:D}),r(((te=D.privacy)==null?void 0:te.support_duration_selected)||2),u(!!((H=D.privacy)!=null&&H.support_access_enabled)),d(((O=D.settings)==null?void 0:O.screenshot_ignore_patterns)??""),p(((V=D.settings)==null?void 0:V.privacy_keyword_rules)??""),N(((re=D.settings)==null?void 0:re.auto_blur_password_fields)??!0),w(((Y=D.settings)==null?void 0:Y.auto_blur_otp_fields)??!0),y(((ce=D.settings)==null?void 0:ce.auto_blur_card_fields)??!0),f(((ie=D.settings)==null?void 0:ie.auto_blur_email_inbox)??!0)}i.useEffect(()=>{let D=!0;async function te(){var H,O,V,re,Y,ce,ie,ee,T;n("");try{const Z=await U("/api/dashboard/company");if(!D)return;a({loading:!1,error:"",data:Z}),r(((H=Z.privacy)==null?void 0:H.support_duration_selected)||2),u(!!((O=Z.privacy)!=null&&O.support_access_enabled)),d(((V=Z.settings)==null?void 0:V.screenshot_ignore_patterns)??""),p(((re=Z.settings)==null?void 0:re.privacy_keyword_rules)??""),N(((Y=Z.settings)==null?void 0:Y.auto_blur_password_fields)??!0),w(((ce=Z.settings)==null?void 0:ce.auto_blur_otp_fields)??!0),y(((ie=Z.settings)==null?void 0:ie.auto_blur_card_fields)??!0),f(((ee=Z.settings)==null?void 0:ee.auto_blur_email_inbox)??!0)}catch(Z){if((T=Z==null?void 0:Z.data)!=null&&T.redirect){window.location.href=Z.data.redirect;return}D&&a({loading:!1,error:(Z==null?void 0:Z.message)||"Unable to load privacy settings.",data:null})}}return te(),()=>{D=!1}},[]);async function Q(D){D.preventDefault(),n("");try{await U("/api/dashboard/company/support-access",{method:"POST",body:JSON.stringify({support_access_enabled:o,support_access_hours:l})}),n("Support access settings updated."),await L()}catch(te){n(""),a(H=>({...H,error:(te==null?void 0:te.message)||"Unable to update support access."}))}}async function E(D){D.preventDefault(),n("");try{await U("/api/dashboard/company/screenshot-privacy",{method:"POST",body:JSON.stringify({ignore_patterns:c,privacy_keyword_rules:h,auto_blur_password_fields:g,auto_blur_otp_fields:v,auto_blur_card_fields:A,auto_blur_email_inbox:x})}),n("Screenshot privacy list updated."),await L()}catch(te){n(""),a(H=>({...H,error:(te==null?void 0:te.message)||"Unable to update screenshot privacy list."}))}}function C(D){const te=(D||"").trim();if(!te)return"";const H=te.toLowerCase();return H.startsWith("url:")||H.startsWith("app:")||H.startsWith("title:")||H.startsWith("window:")?te:`*${te.replace(/^https?:\/\//i,"").replace(/^www\./i,"")}*`}function z(){const D=C(b);if(!D){P({open:!0,message:"Please enter a website URL."});return}d(te=>te.trim()?`${te.trim()}
${D}`:D),P({open:!0,message:`Added to privacy list: ${D}`}),k("")}if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading privacy settings..."})]});const M=t.data||{},R=M.org||{},W=M.privacy||{};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Privacy Settings"}),e.jsxs("p",{className:"text-secondary mb-1",children:["Organization: ",e.jsx("strong",{children:R.name||"-"})]}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,W.show?e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Monitoring Mode"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"badge bg-primary",children:"Privacy Lock - Enabled"}),e.jsx("div",{className:"text-secondary mt-2",children:"Only org admins can access employee activity and screenshot data. Even super admins do not have access in this mode."})]}),e.jsx("hr",{className:"section-divider my-3"}),e.jsx("h5",{children:"Support Access Duration (hours)"}),e.jsxs("form",{className:"mt-2",onSubmit:Q,children:[e.jsx("select",{className:"form-select",value:l,onChange:D=>r(Number(D.target.value)),children:(W.support_duration_options||[]).map(D=>e.jsxs("option",{value:D,children:[D," hour",D!==1?"s":""]},D))}),e.jsx("div",{className:"form-text text-secondary",children:"Applies only when support access is enabled."}),e.jsx("div",{className:"form-text text-secondary",children:"Support access is available only in Privacy Lock mode."}),e.jsxs("div",{className:"form-check mt-2",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"supportAccessEnabled",checked:o,onChange:D=>u(D.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"supportAccessEnabled",children:"Enable Temporary Support Access"})]}),e.jsx("div",{className:"mt-3",children:W.support_active?e.jsxs("span",{className:"badge bg-success",children:["Active until ",W.support_access_until,W.support_remaining?` (${W.support_remaining} left)`:""]}):W.support_access_until?e.jsx("span",{className:"badge bg-danger",children:"Support access expired"}):e.jsx("span",{className:"text-secondary",children:"Support access is disabled."})}),e.jsx("button",{className:"btn btn-primary mt-3",type:"submit",children:"Save Support Access"})]})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Screenshot Privacy List"}),e.jsx("p",{className:"text-secondary mb-2",children:"Add URL or app patterns to blur screenshots on sensitive screens."}),e.jsxs("div",{className:"alert alert-info py-2",children:["Default blur rules apply for user privacy purpose.",e.jsx("button",{type:"button",className:"btn btn-link p-0 ms-2",onClick:()=>F(!0),children:"Click to View"})]}),e.jsxs("form",{onSubmit:E,children:[e.jsx("textarea",{className:"form-control",rows:"6",value:c,onChange:D=>d(D.target.value),placeholder:`https://netbanking*
https://admin.company.com/*
outlook.office.com/*`}),e.jsx("div",{className:"form-text text-secondary",children:"One pattern per line. Use * wildcards. Matches URL, app name, or window title. Prefix with url:, app:, or title: to target one field."}),e.jsxs("div",{className:"d-flex flex-wrap gap-2 mt-3",children:[e.jsx("input",{type:"text",className:"form-control",style:{maxWidth:"260px"},placeholder:"Add website URL",value:b,onChange:D=>k(D.target.value)}),e.jsx("button",{className:"btn btn-outline-primary",type:"button",onClick:z,children:"Add Website URL"})]}),e.jsx("hr",{className:"section-divider my-3"}),e.jsx("h6",{children:"Additional Keyword Rules"}),e.jsx("p",{className:"text-secondary mb-2",children:"Add extra keywords for your company. Default rules stay active and cannot be removed."}),e.jsx("textarea",{className:"form-control",rows:"5",value:h,onChange:D=>p(D.target.value),placeholder:`netbank
internet banking
payment gateway
upi`}),e.jsx("div",{className:"form-text text-secondary",children:"One keyword per line. Matching happens on URL or window title."}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Auto-Blur Switches"}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"autoBlurPasswordFields",checked:g,onChange:D=>N(D.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"autoBlurPasswordFields",children:"Blur when password fields are detected"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"autoBlurOtpFields",checked:v,onChange:D=>w(D.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"autoBlurOtpFields",children:"Blur when OTP fields are detected"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"autoBlurCardFields",checked:A,onChange:D=>y(D.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"autoBlurCardFields",children:"Blur on card or payment forms"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"autoBlurEmailInbox",checked:x,onChange:D=>f(D.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"autoBlurEmailInbox",children:"Blur email inbox views"})]})]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:e.jsx("button",{className:"btn btn-primary",type:"submit",children:"Save Privacy List"})})]})]})})]}):e.jsx("div",{className:"alert alert-warning",children:"Privacy settings are managed by super admin for this account."}),_.open?e.jsx("div",{className:"modal-overlay",onClick:()=>P({open:!1,message:""}),children:e.jsxs("div",{className:"modal-panel",onClick:D=>D.stopPropagation(),children:[e.jsx("h5",{children:"Privacy List Updated"}),e.jsx("div",{className:"text-secondary mb-2",children:_.message}),e.jsx("div",{className:"d-flex justify-content-end gap-2 mt-3",children:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>P({open:!1,message:""}),children:"OK"})})]})}):null,S?e.jsx("div",{className:"modal-overlay",onClick:()=>F(!1),children:e.jsxs("div",{className:"modal-panel",onClick:D=>D.stopPropagation(),children:[e.jsx("h5",{children:"Blur Action Lists"}),e.jsx("div",{className:"text-secondary mb-3",children:"These are the privacy rules applied to blur sensitive screens."}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Phase 1: Domain / URL Match (optional)"}),e.jsx("div",{className:"text-secondary",children:"Examples: admin.company.com/*, myhr.internal/*"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Phase 2: Keyword-Based Rules"}),e.jsx("div",{className:"text-secondary",children:"Blur if URL or title contains keywords like: netbank, netbanking, internet banking, payment gateway, upi, card payment, account login, sign in, mail inbox, webmail, roundcube."})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Phase 3: Page Type Detection Rules"}),e.jsx("div",{className:"text-secondary",children:"Blur when we detect password fields, credit card fields, OTP fields, or netbanking forms."})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Phase 4: Sensitive Page Auto-Detection (Toggle)"}),e.jsx("div",{className:"text-secondary",children:"Admin can enable: blur when password fields exist, blur when OTP field exists, blur on card or payment forms, blur email inbox view."})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Global Keyword Privacy Rules"}),e.jsx("div",{className:"text-secondary",children:"Examples: netbank, internet banking, loan account, credit card payment, beneficiary transfer, income tax portal, payslip, salary slip, confidential."})]}),e.jsx("div",{className:"d-flex justify-content-end gap-2 mt-3",children:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>F(!1),children:"Close"})})]})}):null]})}const DS={loading:!0,error:"",name:""};function RS(){const t=bs(),[a,s]=i.useState(DS),[n,l]=i.useState("");i.useEffect(()=>{let o=!0;async function u(){var c,d;try{const h=await U("/api/dashboard/company");if(!o)return;const p=((c=h.org)==null?void 0:c.name)||"";l(p),s({loading:!1,error:"",name:p})}catch(h){if((d=h==null?void 0:h.data)!=null&&d.redirect){window.location.href=h.data.redirect;return}o&&s({loading:!1,error:(h==null?void 0:h.message)||"Unable to load company details.",name:""})}}return u(),()=>{o=!1}},[]);async function r(o){o.preventDefault();try{await U("/api/dashboard/company/name",{method:"POST",body:JSON.stringify({name:n})}),t("/company")}catch(u){s(c=>({...c,error:(u==null?void 0:u.message)||"Unable to update company."}))}}return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading company..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Edit Company"}),e.jsx("hr",{className:"section-divider"}),a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):null,e.jsxs("form",{onSubmit:r,children:[e.jsx("label",{className:"form-label",children:"Company Name"}),e.jsx("input",{type:"text",className:"form-control",value:n,onChange:o=>l(o.target.value),required:!0}),e.jsxs("div",{className:"mt-3 d-flex gap-2",children:[e.jsx("button",{className:"btn btn-success",type:"submit",children:"Save"}),e.jsx(dt,{to:"/company",className:"btn btn-outline-light",children:"Cancel"})]})]})]})}const LS={loading:!0,error:"",data:null};function It(t){return t==null||t===""?"-":t}function Ga(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}function sc(t){return t?t==="online"?"Online":Ga(t):"Bank Transfer"}function Ys(t,a){return a==null||a===""?"-":t?`${t} ${a}`:a}function MS(t,a){const s=Number(t||0),n=Number(a||0);if(!s||!n)return{base:s,tax:0,total:s};const l=Math.round(s/(1+n/100)*100)/100,r=Math.round((s-l)*100)/100;return{base:l,tax:r,total:s}}function US(t,a,s){return t?s==="USD"?a==="yearly"?t.usd_yearly_price:t.usd_monthly_price:a==="yearly"?t.yearly_price:t.monthly_price:0}function OS(t,a,s){return t?s==="USD"?a==="yearly"?t.addon_usd_yearly_price:t.addon_usd_monthly_price:a==="yearly"?t.addon_yearly_price:t.addon_monthly_price:0}function $S(t){const a=(t==null?void 0:t.limits)||{},s=a.storage_gb??a.storage_limit_gb??0;return Number(s||0)}function IS(t){const a=(t==null?void 0:t.limits)||{},s=a.bandwidth_limit_gb_monthly??a.bandwidth_limit_gb??0;return Number(s||0)}function FS(t){return((t==null?void 0:t.limits)||{}).is_bandwidth_limited!==!1}function zS(t){const a=(t==null?void 0:t.limits)||{},s=a.max_users??a.user_limit??0;return Number(s||0)}function BS(t){return t?`${t} GB`:"-"}function WS(t,a){return a?t?`${t} GB / month`:"-":"Unlimited"}function VS(t){return t||"Unlimited"}function GS(t,a,s){const n=t||{};return s==="USD"?a==="yearly"?n.user_price_usdt_year??n.user_price_usd_year??"-":n.user_price_usdt_month??n.user_price_usd_month??"-":a==="yearly"?n.user_price_inr_year??"-":n.user_price_inr_month??"-"}function HS(t){var u,c;const a=Array.isArray((u=t==null?void 0:t.features)==null?void 0:u.erp_enabled_modules)?t.features.erp_enabled_modules.map(d=>String(d||"").trim().toLowerCase()).filter(Boolean):[],s={crm:"CRM Module",hrm:"HR Management",projects:"Projects",accounts:"Accounts / ERP",ticketing:"Ticketing",stocks:"Stocks"},n=a.map(d=>s[d]).filter(Boolean),l=((c=t==null?void 0:t.features)==null?void 0:c.role_based_access)!==!1,r=String((t==null?void 0:t.name)||"").toLowerCase();if(r.includes("starter")){const d=["Basic Accounting","Invoice & Billing","Expense Tracking","GST Ready (India)","Basic Reports","1 Organization"];return l&&d.push("Role Based Access"),n.length&&d.push(...n),d}if(r.includes("growth")){const d=["Everything in Starter","Inventory Management","Purchase Orders","Vendor Management","Project Accounting","CRM + HR Modules"];return l&&d.push("Role Based Access"),n.length&&d.push(...n),d}if(r.includes("pro")){const d=["Everything in Growth","Advanced Role Permissions","Automation Workflows","Custom Dashboards","Audit Logs","Priority Support"];return l&&!d.includes("Role Based Access")&&d.push("Role Based Access"),n.length&&d.push(...n),d}const o=n.length?n:["CRM Module","HR Management","Projects","Accounts / ERP","Ticketing","Stocks"];return l&&o.push("Role Based Access"),Array.from(new Set(o))}function qS(t){const a=String(t||"").trim();return a?a.replace(/\s+ERP$/i,""):"-"}function QS(){var K,We,Be,ct,lt,St,$t,q,pe,Re,vt,xa,de,Pe,Te,Je;const t=fe=>String(fe||"").toLowerCase()==="trialing"?"status-pill status-pill--trialing":"status-pill",a=typeof window<"u"?window.location.pathname:"",n=(typeof window<"u"?window.__WZ_PRODUCT_SLUG__:"")||(a.includes("/ai-chatbot")?"ai-chatbot":a.includes("/storage")?"storage":a.includes("/business-autopilot")?"business-autopilot-erp":a.includes("/whatsapp-automation")?"whatsapp-automation":"worksuite"),l=n==="ai-chatbot",r=n==="storage"||n==="online-storage",o=n==="business-autopilot-erp",u=n,c=u==="worksuite"?"monitor":u,[d,h]=i.useState(LS),[p,g]=i.useState(""),[N,v]=i.useState(0),[w,A]=i.useState({loading:!0,plans:[],taxRate:0,taxCurrency:"INR"}),[y,x]=i.useState({open:!1,entry:null,addonCount:0}),[f,b]=i.useState(1),[k,_]=i.useState(1),[P,S]=i.useState(1),[F,L]=i.useState(""),[Q,E]=i.useState(""),[C,z]=i.useState(""),[M,R]=i.useState(""),[W,D]=i.useState(""),[te,H]=i.useState(""),O=5,[V,re]=i.useState({open:!1,entry:null});async function Y(){const fe=await U(`/api/dashboard/billing?product=${c}`);h({loading:!1,error:"",data:fe}),v(0)}async function ce(fe){try{const Ue=await U(`/api/dashboard/plans?product=${c}`);if(fe&&!fe.current)return;A({loading:!1,plans:(Ue==null?void 0:Ue.plans)||[],taxRate:Number((Ue==null?void 0:Ue.tax_rate)||0),taxCurrency:(Ue==null?void 0:Ue.tax_currency)||"INR"})}catch{(!fe||fe.current)&&A(at=>({...at,loading:!1}))}}i.useEffect(()=>{let fe=!0;async function Ue(){var at;g("");try{const qe=await U(`/api/dashboard/billing?product=${c}`);if(!fe)return;h({loading:!1,error:"",data:qe}),v(0)}catch(qe){if((at=qe==null?void 0:qe.data)!=null&&at.redirect){window.location.href=qe.data.redirect;return}fe&&h({loading:!1,error:(qe==null?void 0:qe.message)||"Unable to load billing details.",data:null})}}return Ue(),()=>{fe=!1}},[]),i.useEffect(()=>{const fe={current:!0};return ce(fe),()=>{fe.current=!1}},[]),i.useEffect(()=>{const fe=setTimeout(()=>{E(F.trim()),b(1)},300);return()=>clearTimeout(fe)},[F]),i.useEffect(()=>{const fe=setTimeout(()=>{R(C.trim()),_(1)},300);return()=>clearTimeout(fe)},[C]),i.useEffect(()=>{const fe=setTimeout(()=>{H(W.trim()),S(1)},300);return()=>clearTimeout(fe)},[W]);async function ie(fe){var Ue;fe.preventDefault(),g("");try{const at=await U("/api/dashboard/employees/addons",{method:"POST",body:JSON.stringify({addon_count:N})});if(at!=null&&at.redirect){window.location.href=at.redirect;return}g("Add-ons updated."),v(0),await Y()}catch(at){if((Ue=at==null?void 0:at.data)!=null&&Ue.redirect){window.location.href=at.data.redirect;return}g(""),h(qe=>({...qe,error:(at==null?void 0:at.message)||"Unable to update add-ons."}))}}function ee(fe){const Ue=fe?Xe==null?void 0:Xe[fe.plan_id]:null,at=Ue!=null&&Ue.allow_addons?(ae==null?void 0:ae.addon_count)??1:0;x({open:!0,entry:fe,addonCount:Math.max(0,Number(at||0))})}function T(){x(fe=>({...fe,open:!1}))}function Z(fe){x(Ue=>{const at=Math.max(0,Number(Ue.addonCount||0)+fe);return{...Ue,addonCount:at}})}function se(fe){const Ue=Number(fe.target.value||0);x(at=>({...at,addonCount:Number.isNaN(Ue)?0:Math.max(0,Ue)}))}async function be(fe,Ue){var at;if(fe!=null&&fe.plan_id){g("");try{const qe=await U(`/api/dashboard/plans/subscribe/${fe.plan_id}`,{method:"POST",body:JSON.stringify({billing_cycle:fe.billing_cycle||"monthly",addon_count:Ue,product:c})});if(qe!=null&&qe.redirect){window.location.href=qe.redirect;return}qe!=null&&qe.message?g(qe.message):g("Renewal request submitted."),await Y()}catch(qe){if((at=qe==null?void 0:qe.data)!=null&&at.redirect){window.location.href=qe.data.redirect;return}h(rl=>({...rl,error:(qe==null?void 0:qe.message)||"Unable to renew plan."}))}}}const ne=d.data||{},ae=ne.subscription||null,X=ne.show_currency||(ae==null?void 0:ae.currency)||"INR",ke=(ae==null?void 0:ae.prices)||{},Ne=ne.history_entries||[],Ye=ne.approved_transfers||[],Ke=ne.pending_transfers||[],mt=w.taxRate||0,Ie=w.taxCurrency||"INR",Xe=i.useMemo(()=>{const fe={};return(w.plans||[]).forEach(Ue=>{fe[Ue.id]=Ue}),fe},[w.plans]),nt=i.useMemo(()=>{if(!Q)return Ne;const fe=Q.toLowerCase();return Ne.filter(Ue=>[Ue.plan,Ue.status,Ue.status_label,Ue.start_date,Ue.end_date].some(qe=>String(qe||"").toLowerCase().includes(fe)))},[Ne,Q]),Ae=i.useMemo(()=>{if(!M)return Ye;const fe=M.toLowerCase();return Ye.filter(Ue=>[Ue.request_type,Ue.payment_type,Ue.plan,Ue.amount,Ue.status,Ue.updated_at,Ue.currency].some(qe=>String(qe||"").toLowerCase().includes(fe)))},[Ye,M]),ue=i.useMemo(()=>{if(!te)return Ke;const fe=te.toLowerCase();return Ke.filter(Ue=>[Ue.request_type,Ue.payment_type,Ue.plan,Ue.amount,Ue.status_label,Ue.status,Ue.created_at,Ue.currency].some(qe=>String(qe||"").toLowerCase().includes(fe)))},[Ke,te]),je=nt.length,Ce=Ae.length,Le=ue.length,Fe=Math.max(Math.ceil(je/O),1),ye=Math.max(Math.ceil(Ce/O),1),Ze=Math.max(Math.ceil(Le/O),1),pt=i.useMemo(()=>nt.slice((f-1)*O,f*O),[nt,f]),ht=i.useMemo(()=>Ae.slice((k-1)*O,k*O),[Ae,k]),Ge=i.useMemo(()=>ue.slice((P-1)*O,P*O),[ue,P]),gt=je?(f-1)*O+1:0,ft=je?Math.min(f*O,je):0,G=Ce?(k-1)*O+1:0,Se=Ce?Math.min(k*O,Ce):0,ve=Le?(P-1)*O+1:0,le=Le?Math.min(P*O,Le):0;function xe(fe){re({open:!0,entry:fe})}function ge(){re({open:!1,entry:null})}if(i.useEffect(()=>{f>Fe&&b(Fe)},[f,Fe]),i.useEffect(()=>{k>ye&&_(ye)},[k,ye]),i.useEffect(()=>{P>Ze&&S(Ze)},[P,Ze]),d.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading billing..."})]});const B=y.entry,he=B?Xe[B.plan_id]:null,we=(B==null?void 0:B.billing_cycle)||"monthly",I=Number(y.addonCount||0),me=he?Number(US(he,we,X)||0):0,Me=he&&he.allow_addons?Number(OS(he,we,X)||0):0,De=Math.round(Me*I*100)/100,et=Math.round((me+De)*100)/100,Qe=X===Ie&&mt>0,bt=Qe?Math.round(et*(mt/100)*100)/100:0,ot=Math.round((et+bt)*100)/100,Xt=he&&he.employee_limit===0?"Unlimited":(he==null?void 0:he.employee_limit)??"-",Wt=he&&he.employee_limit===0?"Unlimited":Number((he==null?void 0:he.employee_limit)||0)+I,Vt=Number((ae==null?void 0:ae.addon_count)||0),kt=he&&he.employee_limit===0?"Unlimited":(he==null?void 0:he.employee_limit)??"-",J=kt==="Unlimited"?1:kt,_e=V.entry?MS(V.entry.amount,V.entry.tax_rate):{base:0,tax:0,total:0};return e.jsxs(e.Fragment,{children:[p?e.jsx("div",{className:"alert alert-success",children:p}):null,d.error?e.jsx("div",{className:"alert alert-danger",children:d.error}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-lg-2",children:e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsx("div",{className:"card p-3",children:ae?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"billing-current-plan__header",children:[e.jsxs("div",{children:[e.jsx("div",{className:"billing-current-plan__title",children:"Current Plan"}),e.jsx("div",{className:"billing-current-plan__plan",children:o?qS(ae.plan):ae.plan||"-"})]}),e.jsx("span",{className:"badge bg-success text-white text-uppercase",children:It(ae.status)})]}),e.jsxs("div",{className:"billing-current-plan__section",children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:X==="USD"?"USD Monthly":"Monthly"}),e.jsx("span",{children:It(ke.monthly)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:X==="USD"?"USD Yearly":"Yearly"}),e.jsx("span",{children:It(ke.yearly)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:X==="USD"?"Add-on USD Monthly":"Add-on Monthly"}),e.jsx("span",{children:It(ke.addon_monthly)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:X==="USD"?"Add-on USD Yearly":"Add-on Yearly"}),e.jsx("span",{children:It(ke.addon_yearly)})]})]}),e.jsx("div",{className:"billing-current-plan__section",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Website Chat Widgets"}),e.jsx("span",{children:It((K=ae.limits)==null?void 0:K.widgets)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Agents Included"}),e.jsx("span",{children:It((We=ae.limits)==null?void 0:We.included_agents)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Conversations / Month"}),e.jsx("span",{children:It((Be=ae.limits)==null?void 0:Be.conversations_per_month)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"AI Replies / Month"}),e.jsx("span",{children:It((ct=ae.limits)==null?void 0:ct.ai_replies_per_month)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Chat History"}),e.jsxs("span",{children:[It((lt=ae.limits)==null?void 0:lt.chat_history_days)," day(s)"]})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Max Messages / Conversation"}),e.jsx("span",{children:It((St=ae.limits)==null?void 0:St.max_messages_per_conversation)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Max Chars / Message"}),e.jsx("span",{children:It(($t=ae.limits)==null?void 0:$t.max_chars_per_message)})]}),e.jsx("div",{className:"plan-feature-divider"}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:"bi bi-check-circle-fill plan-feature-icon text-success","aria-hidden":"true"}),e.jsx("span",{children:"Quick enquiry form"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${ae.allow_addons?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Allow Agent Add-Ons"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(q=ae.features)!=null&&q.remove_branding?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Remove branding"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(pe=ae.features)!=null&&pe.analytics_basic?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Analytics (basic)"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(Re=ae.features)!=null&&Re.csv_export?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"CSV export"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(vt=ae.features)!=null&&vt.agent_inbox?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Agent inbox"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(xa=ae.features)!=null&&xa.ai_enabled?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"AI replies enabled"})]})]}):r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Storage Limit"}),e.jsx("span",{children:BS($S(ae))})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Bandwidth Limit"}),e.jsx("span",{children:WS(IS(ae),FS(ae))})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Users Allowed"}),e.jsx("span",{children:VS(zS(ae))})]})]}):o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsxs("span",{children:["Base Platform (",X,")"]}),e.jsx("span",{children:It(ke[ae.billing_cycle==="yearly"?"yearly":"monthly"])})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsxs("span",{children:["Per User (",X,")"]}),e.jsx("span",{children:It(GS(ae.limits,ae.billing_cycle,X))})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Employees Allowed"}),e.jsx("span",{children:ae.employee_limit===0?"Unlimited":It(ae.employee_limit)})]}),e.jsx("div",{className:"plan-feature-divider"}),HS(ae).map(fe=>e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:"bi bi-check-circle-fill plan-feature-icon text-success","aria-hidden":"true"}),e.jsx("span",{children:fe})]},`erp-feature-${fe}`))]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Employees Allowed"}),e.jsx("span",{children:ae.employee_limit===0?"Unlimited":ae.employee_limit})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Screenshot Interval"}),e.jsxs("span",{children:[It(((de=ae.limits)==null?void 0:de.screenshot_min_minutes)||ae.screenshot_min_minutes)," min"]})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Screenshot Retention"}),e.jsxs("span",{children:[It(ae.retention_days)," day(s)"]})]}),e.jsx("div",{className:"plan-feature-divider"}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${ae.allow_addons?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Employee add-ons"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${ae.allow_app_usage?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"App usage tracking"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${ae.allow_gaming_ott_usage?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"OTT/Gaming usage"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${ae.allow_hr_view?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"HR view"})]})]})}),e.jsxs("div",{className:"billing-current-plan__section",children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Start Date"}),e.jsx("span",{children:It(ae.start_date)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"End Date"}),e.jsx("span",{children:It(ae.end_date)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Billing Cycle"}),e.jsx("span",{children:Ga(ae.billing_cycle)})]}),!l&&!r&&!o?e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Screenshot Storage"}),e.jsxs("span",{children:[It(ae.retention_days)," day(s)"]})]}):null,e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Add-ons"}),e.jsx("span",{children:It(ae.addon_count)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Proration Due Now"}),e.jsx("span",{children:Ys(X,ae.addon_proration_amount)})]})]}),e.jsx(dt,{to:"/plans",className:"btn btn-primary btn-sm w-100 billing-current-plan__cta",children:"Change Plan"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"No active plan found."}),e.jsx(dt,{to:"/plans",className:"btn btn-primary btn-sm",children:"Choose Plan"})]})}),ae&&!l&&!r?e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{children:"Add Employee Add-ons"}),ae.allow_addons?e.jsxs("form",{onSubmit:ie,children:[e.jsx("label",{className:"form-label mb-1",children:"Addon Count"}),e.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",value:N,onChange:fe=>v(fe.target.value)}),e.jsx("button",{className:"btn btn-primary btn-sm w-100 mt-2",type:"submit",children:"Update"}),e.jsx("small",{className:"text-secondary d-block mt-2",children:"Proration applies based on remaining days in the current cycle."})]}):e.jsx("p",{className:"text-warning mb-0",children:"Add-ons disabled for this plan."})]}):null]})}),e.jsx("div",{className:"col-12 col-lg-10",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Billing History"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",O," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"billing-history-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"billing-history-search",type:"text",value:F,onChange:fe=>L(fe.target.value),placeholder:"Search history"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Renew"})]})}),e.jsx("tbody",{children:nt.length?pt.map((fe,Ue)=>e.jsxs("tr",{children:[e.jsx("td",{children:fe.plan||"-"}),e.jsx("td",{children:e.jsx("span",{className:t(fe.status),children:fe.status_label||Ga(fe.status)})}),e.jsx("td",{children:fe.start_date||"-"}),e.jsx("td",{children:fe.end_date||"-"}),e.jsx("td",{children:fe.action_label||"-"}),e.jsx("td",{children:fe.renew_pending?e.jsx("span",{className:"text-warning",children:"Waiting for approval"}):fe.renew_available?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>ee(fe),children:"Renew"}):e.jsx("span",{className:"text-secondary",children:"-"})})]},`${fe.plan}-${fe.start_date}-${Ue}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No billing history available."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",gt," to ",ft," of ",je," entries"]}),e.jsx(st,{page:f,totalPages:Fe,onPageChange:b,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Approved Transfers"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",O," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"billing-approved-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"billing-approved-search",type:"text",value:C,onChange:fe=>z(fe.target.value),placeholder:"Search approved"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Payment Type"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Approved"}),e.jsx("th",{children:"Invoice"}),e.jsx("th",{children:"View"})]})}),e.jsx("tbody",{children:Ae.length?ht.map((fe,Ue)=>e.jsxs("tr",{children:[e.jsx("td",{children:Ga(fe.request_type)}),e.jsx("td",{children:sc(fe.payment_type)}),e.jsx("td",{children:fe.plan||"-"}),e.jsx("td",{children:Ys(fe.currency,fe.amount)}),e.jsx("td",{children:e.jsx("span",{className:t(fe.status),children:fe.status_label||Ga(fe.status)||"Approved"})}),e.jsx("td",{children:fe.updated_at||"-"}),e.jsx("td",{children:fe.invoice_available&&fe.id?e.jsx("a",{className:"text-info text-decoration-none",href:`/api/dashboard/billing/invoice/${fe.id}`,target:"_blank",rel:"noopener noreferrer",children:"Download"}):"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>xe(fe),children:"View"})})]},`${fe.plan}-${fe.updated_at}-${Ue}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No approved transfers yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",G," to ",Se," of ",Ce," entries"]}),e.jsx(st,{page:k,totalPages:ye,onPageChange:_,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Billing Activity"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",O," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"billing-pending-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"billing-pending-search",type:"text",value:W,onChange:fe=>D(fe.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Payment Type"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Submitted"}),e.jsx("th",{children:"Invoice"})]})}),e.jsx("tbody",{children:ue.length?Ge.map((fe,Ue)=>e.jsxs("tr",{children:[e.jsx("td",{children:Ga(fe.request_type)}),e.jsx("td",{children:sc(fe.payment_type)}),e.jsx("td",{children:fe.plan||"-"}),e.jsx("td",{children:Ys(fe.currency,fe.amount)}),e.jsx("td",{children:e.jsx("span",{className:t(fe.status),children:fe.status_label||Ga(fe.status)})}),e.jsx("td",{children:fe.created_at||"-"}),e.jsx("td",{children:"-"})]},`${fe.plan}-${fe.created_at}-${Ue}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No pending payments."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",ve," to ",le," of ",Le," entries"]}),e.jsx(st,{page:P,totalPages:Ze,onPageChange:S,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})})]}),y.open&&he?e.jsx("div",{className:"modal-overlay",onClick:T,children:e.jsxs("div",{className:"modal-panel",onClick:fe=>fe.stopPropagation(),children:[e.jsx("h5",{children:l?"Update Agent Add-ons":"Update User Count"}),e.jsxs("div",{className:"text-secondary mb-2",children:["Plan: ",he.name," (",Ga(we),")"]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("strong",{children:[l?"Base Agents Included":"Base Employees User Limit",":"]})," ",l?((Pe=he.limits)==null?void 0:Pe.included_agents)??"-":Xt]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("strong",{children:[l?"Current Existing Agents":"Current Existing Users",":"]})," ",l?((Te=he.limits)==null?void 0:Te.included_agents)??"-":J," + ",Vt," Addons"]}),he.allow_addons?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:l?"Additional Agents (Add-ons)":"Additional Users (Add-ons)"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Z(-1),disabled:I<=0,children:"-"}),e.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",style:{maxWidth:"120px"},value:I,onChange:se}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Z(1),children:"+"})]}),e.jsxs("div",{className:"text-secondary mt-2",children:["Add-on price: ",X," ",Me||"-"]})]}):e.jsx("p",{className:"text-warning mb-3",children:"Add-ons disabled for this plan."}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("strong",{children:[l?"Total Agents":"Total Employees",":"]})," ",l?Vt+Number(((Je=he.limits)==null?void 0:Je.included_agents)||0):Wt]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"text-secondary",children:["Base: ",X," ",me||"-"]}),he.allow_addons?e.jsxs("div",{className:"text-secondary",children:["Add-ons: ",X," ",De||0]}):null,Qe?e.jsxs("div",{className:"text-secondary",children:["GST (",mt,"%): ",X," ",bt||0]}):null,e.jsxs("div",{className:"fw-semibold",children:["Total: ",X," ",ot||0]})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:T,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:async()=>{await be(B,I),T()},children:"Continue"})]})]})}):null,V.open&&V.entry?e.jsx("div",{className:"modal-overlay",onClick:ge,children:e.jsxs("div",{className:"modal-panel",onClick:fe=>fe.stopPropagation(),children:[e.jsx("h5",{children:"Payment Details"}),e.jsxs("div",{className:"text-secondary mb-2",children:[Ga(V.entry.request_type)," -"," ",sc(V.entry.payment_type)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Plan:"})," ",V.entry.plan||"-"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Billing Cycle:"})," ",Ga(V.entry.billing_cycle)||"-"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Add-ons:"})," ",V.entry.addon_count??0]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Amount:"})," ",Ys(V.entry.currency,V.entry.amount)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Base:"})," ",Ys(V.entry.currency,_e.base)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"GST:"})," ",Ys(V.entry.currency,_e.tax)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total:"})," ",Ys(V.entry.currency,_e.total)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Status:"})," ",V.entry.status_label||Ga(V.entry.status)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Approved:"})," ",V.entry.updated_at||"-"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Reference / UTR:"})," ",V.entry.reference_no||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Receipt:"})," ",V.entry.receipt_url?e.jsx("a",{href:V.entry.receipt_url,target:"_blank",rel:"noopener noreferrer",className:"text-info text-decoration-none",children:"View Receipt"}):"-"]}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:ge,children:"Close"})})]})}):null]})}const JS={loading:!0,error:"",data:null},zb={contact_name:"",company_name:"",email:"",phone:"",phone_country:"+91",address_line1:"",address_line2:"",city:"",state:"",postal_code:"",country:"India",gstin:""},KS=["contact_name","company_name","email","phone","address_line1","city","state","postal_code","country"],YS={india:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"]};function ZS(t){return String(t||"").trim().toLowerCase()}function XS(t){return YS[ZS(t)]||[]}function ew(t){return KS.filter(a=>!String((t==null?void 0:t[a])||"").trim())}function Xa(t){return!!(t.monthly_price||t.yearly_price||t.usd_monthly_price||t.usd_yearly_price)}function Ft(t){return t==="USD"?"USD":"INR"}function gf(t){const a=(t==null?void 0:t.limits)||{},s=a.storage_gb??a.storage_limit_gb??0;return Number(s||0)}function xf(t){const a=(t==null?void 0:t.limits)||{},s=a.bandwidth_limit_gb_monthly??a.bandwidth_limit_gb??0;return Number(s||0)}function fd(t){return((t==null?void 0:t.limits)||{}).is_bandwidth_limited!==!1}function bf(t){const s=((t==null?void 0:t.limits)||{}).device_limit_per_user??(t==null?void 0:t.device_limit_per_user)??0;return Number(s||0)}function tw(t){return t?`${t} GB`:"-"}function aw(t,a){return t?`${t} GB / month`:"-"}function sw(t){return t?`Up to ${t} devices per user`:"-"}function nc(t){return{...zb,...t||{},phone_country:(t==null?void 0:t.phone_country)||(t==null?void 0:t.phone_code)||"+91"}}function nw(t){return String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}function Zs(t,a,s){return s==="USD"?a==="yearly"?t.usd_yearly_price:t.usd_monthly_price:a==="yearly"?t.yearly_price:t.monthly_price}function lc(t,a,s){return s==="USD"?a==="yearly"?t.addon_usd_yearly_price:t.addon_usd_monthly_price:a==="yearly"?t.addon_yearly_price:t.addon_monthly_price}function lw(t,a,s){const n=(t==null?void 0:t.limits)||{};return s==="USD"?a==="yearly"?n.user_price_usdt_year??n.user_price_usd_year??null:n.user_price_usdt_month??n.user_price_usd_month??null:a==="yearly"?n.user_price_inr_year??null:n.user_price_inr_month??null}function rw(t){const a=(t==null?void 0:t.features)||{},s=(t==null?void 0:t.flags)||{},n=(t==null?void 0:t.limits)||{},l=String((t==null?void 0:t.name)||"").trim().toLowerCase(),r=l.includes("starter")?"starter":l.includes("growth")?"growth":l.includes("pro")?"pro":"free",o=r==="free"&&String(a.trial_features||"").toLowerCase()==="pro",u={free:{crm:!0,hrm:!0,projects:!0,accounts:!0,ticketing:!1,stocks:!1,invoice:!1,expense:!1,gst:!1,reports:!1,purchase:!1,vendor:!1,api:!1,dashboards:!1,audit:!1,priority:!1},starter:{crm:!0,hrm:!0,projects:!0,accounts:!0,ticketing:!0,stocks:!1,invoice:!0,expense:!0,gst:!0,reports:!0,purchase:!1,vendor:!1,api:!1,dashboards:!1,audit:!1,priority:!1},growth:{crm:!0,hrm:!0,projects:!0,accounts:!0,ticketing:!0,stocks:!0,invoice:!0,expense:!0,gst:!0,reports:!0,purchase:!0,vendor:!0,api:!0,dashboards:!1,audit:!1,priority:!1},pro:{crm:!0,hrm:!0,projects:!0,accounts:!0,ticketing:!0,stocks:!0,invoice:!0,expense:!0,gst:!0,reports:!0,purchase:!0,vendor:!0,api:!0,dashboards:!0,audit:!0,priority:!0}},c=u[o?"pro":r]||u.free,d=Array.isArray(a.erp_enabled_modules)?a.erp_enabled_modules.map(N=>String(N||"").trim().toLowerCase()).filter(Boolean):null,h=(N,v)=>d?d.includes(N):v,p=(N,v)=>{for(const w of N){if(typeof a[w]=="boolean")return a[w];if(typeof s[w]=="boolean")return s[w];if(typeof n[w]=="boolean")return n[w]}return v},g=[{text:"CRM Module",ok:h("crm",c.crm)},{text:"HR Management",ok:h("hrm",c.hrm)},{text:"Project Management",ok:h("projects",c.projects)},{text:"Accounts / ERP",ok:h("accounts",c.accounts)},{text:"Role Based Access",ok:p(["role_based_access"],!0)},{text:"Ticketing System",ok:h("ticketing",c.ticketing)},{text:"Invoice & Billing",ok:p(["invoice_billing","invoice_and_billing"],c.invoice)},{text:"Expense Tracking",ok:p(["expense_tracking"],c.expense)},{text:"GST Ready (India)",ok:p(["gst_ready_india","gst_ready"],c.gst)},{text:"Reports",ok:p(["reports","basic_reports","advanced_reports"],c.reports)},{text:"Inventory Management",ok:h("stocks",c.stocks)},{text:"Purchase Orders",ok:p(["purchase_orders"],c.purchase)},{text:"Vendor Management",ok:p(["vendor_management"],c.vendor)},{text:"API Access",ok:p(["api_access"],c.api)},{text:"Custom Dashboards",ok:p(["custom_dashboards"],c.dashboards)},{text:"Audit Logs",ok:p(["audit_logs"],c.audit)},{text:"Priority Support",ok:p(["priority_support"],c.priority)}];return o&&g.push({text:"2 Add-on Users Included (Trial)"}),g}function iw(t){const a=(t==null?void 0:t.limits)||{},s=(t==null?void 0:t.flags)||{},n=(t==null?void 0:t.features)||{},l=String((t==null?void 0:t.name)||"").trim().toLowerCase(),o={free:{live:!0,app:!0,hr:!0,ott:!0},basic:{live:!0,app:!1,hr:!0,ott:!1},plus:{live:!0,app:!0,hr:!1,ott:!1},professional:{live:!0,app:!0,hr:!0,ott:!0}}[l]||{},u=(h,p,g,N)=>typeof s[h]=="boolean"?s[h]:typeof n[p]=="boolean"?n[p]:typeof o[g]=="boolean"?o[g]:N,c=a.employee_limit;return[{text:`Employee limit: ${!Number.isFinite(Number(c))||Number(c)===0?"Unlimited*":c}`},{text:`Retention: ${a.retention_days??"-"} days`},{text:`Screenshot interval: ${a.screenshot_min_minutes??"-"} mins`},{text:"Live activity report",ok:u("allow_live_activity","allow_live_activity","live",!0)},{text:"App usage tracking",ok:u("allow_app_usage","allow_app_usage","app",!1)},{text:"HR view",ok:u("allow_hr_view","allow_hr_view","hr",!1)},{text:"OTT/Gaming usage",ok:u("allow_gaming_ott_usage","allow_gaming_ott_usage","ott",!1)}]}function ow(t){const a=(t==null?void 0:t.limits)||{},s=String((t==null?void 0:t.name)||"").trim().toLowerCase(),n=Number(a.max_users),l=!Number.isFinite(n)||n<=0?"Unlimited Users":`${n} Users`,r=tw(a.storage_gb),o=fd(t)?`Up to ${aw(a.bandwidth_limit_gb_monthly)} monthly download bandwidth`:"Unlimited monthly download bandwidth",u=sw(a.device_limit_per_user),c=s==="basic",d=s==="standard",h=s==="pro";return[{text:l},{text:`${r} Storage`},{text:o},{text:u},{text:"Real-time smart sync included",ok:!0},{text:"Online Access",ok:c||!d&&!h},{text:"Admin Controls",ok:d||h},{text:"Full Admin Visibility",ok:h},{text:"Free System Sync",ok:!0}]}function cw(t){const a=(t==null?void 0:t.features)||{},s=(t==null?void 0:t.flags)||{},n=(t==null?void 0:t.limits)||{},l=String((t==null?void 0:t.name)||"").trim().toLowerCase(),r=l.includes("starter")||l.includes("basic")?"starter":l.includes("growth")||l.includes("plus")?"growth":l.includes("pro")?"pro":"free",o={free:{card:!0,catalogue:!0,basicAuto:!0,advancedAuto:!1,team:!1,addons:!1,priority:!1},starter:{card:!0,catalogue:!0,basicAuto:!0,advancedAuto:!1,team:!0,addons:!1,priority:!1},growth:{card:!0,catalogue:!0,basicAuto:!0,advancedAuto:!0,team:!0,addons:!0,priority:!1},pro:{card:!0,catalogue:!0,basicAuto:!0,advancedAuto:!0,team:!0,addons:!0,priority:!0}},u=o[r]||o.free,c=(d,h)=>{for(const p of d){if(typeof a[p]=="boolean")return a[p];if(typeof s[p]=="boolean")return s[p];if(typeof n[p]=="boolean")return n[p]}return h};return[{text:"Company Digital Card",ok:c(["digital_card","digital_card_enabled"],u.card)},{text:"WhatsApp Catalogue",ok:c(["catalogue","catalogue_enabled"],u.catalogue)},{text:"Basic Automation",ok:c(["basic_automation","automation"],u.basicAuto)},{text:"Add-on Users (Digital Card)",ok:t.allow_addons===!0||c(["allow_addons"],u.addons)},{text:"Team Management",ok:c(["team_management"],u.team)},{text:"Advanced Automation Flows",ok:c(["advanced_automation","automation_flows"],u.advancedAuto)},{text:"Priority Support",ok:c(["priority_support"],u.priority)}]}function jf(t){const a=String(t||"").trim();return a?a.replace(/\s+ERP$/i,""):"-"}function dw(t,a,s){if(!s||!s.end_ts||!s.start_ts||Number(s.plan_id)===Number(t.id))return"";if(s.billing_cycle&&s.billing_cycle!==a)return"Billing cycle change applies at full price.";const n=Date.now()/1e3,l=Math.max((s.end_ts-s.start_ts)/86400,0),r=Math.max((s.end_ts-n)/86400,0);if(!l||!r)return"";const o=a==="yearly"?t.yearly_price:t.monthly_price,u=a==="yearly"?s.current_yearly:s.current_monthly;if(!o||!u)return"";const c=Number(o)-Number(u);return c>0?`Prorated upgrade: INR ${Math.round(c*(r/l)*100)/100} (based on remaining days).`:c<0?"Downgrade: no refund will be issued.":"Plan change at no additional charge."}function yf(t){const a=Array.isArray(t)?t:[],s=new Set;return a.filter(n=>{const l=[String((n==null?void 0:n.name)||"").trim().toLowerCase(),String((n==null?void 0:n.monthly_price)??""),String((n==null?void 0:n.yearly_price)??""),String((n==null?void 0:n.usd_monthly_price)??""),String((n==null?void 0:n.usd_yearly_price)??""),String((n==null?void 0:n.employee_limit)??""),String((n==null?void 0:n.retention_days)??""),String((n==null?void 0:n.allow_addons)??"")].join("|");return s.has(l)?!1:(s.add(l),!0)})}function uw(){var ft,G,Se,ve,le,xe,ge;const t=typeof window<"u"?window.location.pathname:"",s=(typeof window<"u"?window.__WZ_PRODUCT_SLUG__:"")||(t.includes("/ai-chatbot")?"ai-chatbot":t.includes("/storage")?"storage":t.includes("/business-autopilot")?"business-autopilot-erp":t.includes("/whatsapp-automation")?"whatsapp-automation":"worksuite"),n=s==="ai-chatbot",l=s==="storage"||s==="online-storage",r=s==="business-autopilot-erp",o=s==="whatsapp-automation",u=s,c=u==="worksuite"?"monitor":u,[d,h]=i.useState(JS),[p,g]=i.useState("INR"),[N,v]=i.useState({}),[w,A]=i.useState(""),[y,x]=i.useState(zb),[f,b]=i.useState(!1),[k,_]=i.useState(!1),[P,S]=i.useState(""),[F,L]=i.useState(""),[Q,E]=i.useState([]),[C,z]=i.useState({open:!1,plan:null,cycle:"monthly",addonCount:1}),M=ys();async function R(B){var he;A("");try{const we=await U(`/api/dashboard/plans?product=${c}`);if(B&&!B.current)return;h({loading:!1,error:"",data:we})}catch(we){if((he=we==null?void 0:we.data)!=null&&he.redirect){window.location.href=we.data.redirect;return}(!B||B.current)&&h({loading:!1,error:(we==null?void 0:we.message)||"Unable to load plans.",data:null})}}async function W(B){var he;S(""),L("");try{const we=await U("/api/dashboard/billing-profile");if(B&&!B.current)return;x(nc(we.profile)),E(we.missing_fields||[]),b(!0)}catch(we){if((he=we==null?void 0:we.data)!=null&&he.redirect){window.location.href=we.data.redirect;return}(!B||B.current)&&(L((we==null?void 0:we.message)||"Unable to load billing details."),b(!0))}}i.useEffect(()=>{const B={current:!0};return R(B),W(B),()=>{B.current=!1}},[]);const D=i.useMemo(()=>{var B;return yf(((B=d.data)==null?void 0:B.plans)||[])},[(ft=d.data)==null?void 0:ft.plans]),te=((G=d.data)==null?void 0:G.free_eligible)!==!1,H=((Se=d.data)==null?void 0:Se.active_sub)||null,O=H&&String(H.status||"").toLowerCase()==="trialing"?Number(H.plan_id):null,V=i.useMemo(()=>{var B;return!H||!((B=d.data)!=null&&B.plans)?null:yf(d.data.plans).find(he=>Number(he.id)===Number(H.plan_id))||null},[H,(ve=d.data)==null?void 0:ve.plans]),re=((le=d.data)==null?void 0:le.rollback)||null,Y=Number(((xe=d.data)==null?void 0:xe.tax_rate)||0),ce=((ge=d.data)==null?void 0:ge.tax_currency)||"INR",ie=ew(y),ee=Q.length?Q:ie,T=ie.length===0,Z=i.useMemo(()=>{if(u!=="storage")return D;const B=D.find(I=>!Xa(I)),he=D.filter(I=>Xa(I));return(te||B&&Number(B.id)===O)&&B?[B,...he.filter(I=>Number(I.id)!==Number(B.id))]:he},[D,te,u,O]),se=i.useMemo(()=>{const B={};return Z.forEach(he=>{B[he.id]=N[he.id]||"monthly"}),B},[Z,N]);async function be(B,he){var De,et,Qe,bt;A(""),L(""),S("");const we=se[B.id]||"monthly",I=we==="yearly"?H==null?void 0:H.current_yearly:H==null?void 0:H.current_monthly,me=we==="yearly"?B.yearly_price:B.monthly_price;if(Xa(B)){if(!f){L("Billing details are still loading. Please try again.");return}if(!T){E(ie),L("Please complete billing details before proceeding."),(De=document.getElementById("billing-details"))==null||De.scrollIntoView({behavior:"smooth"});return}}if(!(H&&Number(H.plan_id)!==Number(B.id)&&(!Xa(B)||Number(me||0)<Number(I||0))&&!await M({title:"Confirm Downgrade",message:"You are downgrading your plan. Existing benefits will be replaced. Continue?",confirmText:"Continue",confirmVariant:"warning"})))try{const ot=await U(`/api/dashboard/plans/subscribe/${B.id}`,{method:"POST",body:JSON.stringify({billing_cycle:we,addon_count:he,product:c})});if(ot!=null&&ot.redirect){window.location.href=ot.redirect;return}ot!=null&&ot.message&&A(ot.message)}catch(ot){if((et=ot==null?void 0:ot.data)!=null&&et.redirect){window.location.href=ot.data.redirect;return}if((Qe=ot==null?void 0:ot.data)!=null&&Qe.missing_fields){E(ot.data.missing_fields),L("Please complete billing details before proceeding."),(bt=document.getElementById("billing-details"))==null||bt.scrollIntoView({behavior:"smooth"});return}h(Xt=>({...Xt,error:(ot==null?void 0:ot.message)||"Unable to update plan."}))}}function ne(B){if(!Xa(B)){be(B,0);return}if(n){be(B,0);return}const he=se[B.id]||"monthly",we=B.allow_addons?1:0;z({open:!0,plan:B,cycle:he,addonCount:we})}async function ae(){var he;if(!(!re||!await M({title:"Rollback Plan",message:`Rollback to ${re.plan} (valid till ${re.end_date})?`,confirmText:"Rollback",confirmVariant:"warning"})))try{const we=await U("/api/dashboard/plans/rollback",{method:"POST"});we!=null&&we.message&&A(we.message),await R()}catch(we){if((he=we==null?void 0:we.data)!=null&&he.redirect){window.location.href=we.data.redirect;return}h(I=>({...I,error:(we==null?void 0:we.message)||"Unable to rollback plan."}))}}function X(B){const{name:he,value:we}=B.target;x(I=>he==="country"?{...I,country:we,state:I.state&&I.state.trim()?I.state:""}:{...I,[he]:we})}async function ke(B){var he,we;B.preventDefault(),S(""),L(""),_(!0);try{const I=await U("/api/dashboard/billing-profile",{method:"POST",body:JSON.stringify(nc(y))});x(nc(I.profile)),E(I.missing_fields||[]),S("Billing details saved.")}catch(I){if((he=I==null?void 0:I.data)!=null&&he.redirect){window.location.href=I.data.redirect;return}(we=I==null?void 0:I.data)!=null&&we.missing_fields&&E(I.data.missing_fields),(I==null?void 0:I.message)==="invalid_gstin"?L("Please enter a valid GSTIN."):(I==null?void 0:I.message)==="billing_profile_incomplete"?L("Please complete billing details."):L((I==null?void 0:I.message)||"Unable to save billing details.")}finally{_(!1)}}function Ne(){z(B=>({...B,open:!1}))}function Ye(B){z(he=>{const we=Math.max(0,Number(he.addonCount||0)+B);return{...he,addonCount:we}})}function Ke(B){const he=Number(B.target.value||0);z(we=>({...we,addonCount:Number.isNaN(he)?0:Math.max(0,he)}))}async function mt(){C.plan&&(await be(C.plan,C.addonCount),Ne())}if(d.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading plans..."})]});const Ie=C.plan,Xe=C.cycle||"monthly",nt=Number(C.addonCount||0),Ae=Ie?Number(Zs(Ie,Xe,p)||0):0,ue=Ie&&Ie.allow_addons?Number(lc(Ie,Xe,p)||0):0,je=Math.round(ue*nt*100)/100,Ce=Math.round((Ae+je)*100)/100,Le=p===ce&&Y>0,Fe=Le?Math.round(Ce*(Y/100)*100)/100:0,ye=Math.round((Ce+Fe)*100)/100,Ze=Ie&&Ie.employee_limit===0?"Unlimited":(Ie==null?void 0:Ie.employee_limit)??"-",pt=Ie&&Ie.employee_limit===0?"Unlimited":Number((Ie==null?void 0:Ie.employee_limit)||0)+nt,ht=H&&Ie&&Number(H.plan_id)===Number(Ie.id)?Number(H.addon_count||0):0,Ge=Ie&&Ie.employee_limit===0?"Unlimited":(Ie==null?void 0:Ie.employee_limit)??"-",gt=Ge==="Unlimited"?1:Ge;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Choose a Plan"}),e.jsx("hr",{className:"section-divider"}),H?e.jsxs("p",{className:"text-secondary",children:["Current Plan: ",e.jsx("strong",{children:r?jf(H.plan):H.plan}),H.end_date?` (Valid till ${H.end_date})`:""]}):null,e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"currency-toggle",role:"group","aria-label":"Currency toggle",children:[e.jsx("button",{type:"button",className:p==="USD"?"active":"",onClick:()=>g("USD"),children:"USD Payment"}),e.jsx("button",{type:"button",className:p==="INR"?"active":"",onClick:()=>g("INR"),children:"INR Payment"})]})}),w?e.jsx("div",{className:"alert alert-success mt-3",children:w}):null,d.error?e.jsx("div",{className:"alert alert-danger mt-3",children:d.error}):null,re?e.jsxs("div",{className:"alert alert-warning mt-3 d-flex flex-wrap align-items-center justify-content-between gap-2",children:[e.jsxs("span",{children:["Rollback available: ",e.jsx("strong",{children:re.plan}),re.end_date?` (Valid till ${re.end_date})`:""]}),e.jsx("button",{type:"button",className:"btn btn-warning btn-sm",onClick:ae,children:"Rollback Plan"})]}):null,e.jsxs("div",{className:"card p-3 mt-3",id:"billing-details",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:"Billing Information & GST"}),e.jsx("p",{className:"text-secondary mb-0",children:"Required before paid plans and used for invoice generation."})]}),e.jsx("span",{className:`badge ${T?"bg-success":"bg-warning text-dark"}`,children:T?"Complete":"Incomplete"})]}),P?e.jsx("div",{className:"alert alert-success mt-2",children:P}):null,F?e.jsx("div",{className:"alert alert-danger mt-2",children:F}):null,e.jsxs("form",{onSubmit:ke,children:[e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Contact Name"}),e.jsx("input",{type:"text",name:"contact_name",className:`form-control ${ee.includes("contact_name")?"is-invalid":""}`,value:y.contact_name,onChange:X,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Company Name"}),e.jsx("input",{type:"text",name:"company_name",className:`form-control ${ee.includes("company_name")?"is-invalid":""}`,value:y.company_name,onChange:X,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",name:"email",className:`form-control ${ee.includes("email")?"is-invalid":""}`,value:y.email,onChange:X,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",style:{maxWidth:"140px"},value:y.phone_country||"+91",onChange:B=>x(he=>({...he,phone_country:B.target.value})),children:ls.map(B=>e.jsxs("option",{value:B.code,children:[B.code," (",B.label,")"]},`${B.code}-${B.label}`))}),e.jsx("input",{type:"tel",name:"phone",className:`form-control ${ee.includes("phone")?"is-invalid":""}`,value:y.phone,onChange:X,required:!0,placeholder:"Phone number"})]})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Address Line 1"}),e.jsx("input",{type:"text",name:"address_line1",className:`form-control ${ee.includes("address_line1")?"is-invalid":""}`,value:y.address_line1,onChange:X,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Address Line 2 (optional)"}),e.jsx("input",{type:"text",name:"address_line2",className:"form-control",value:y.address_line2,onChange:X})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",name:"city",className:`form-control ${ee.includes("city")?"is-invalid":""}`,value:y.city,onChange:X,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{type:"text",name:"country",className:`form-control plans-billing-datalist-field ${ee.includes("country")?"is-invalid":""}`,value:y.country,onChange:X,list:"country-options",required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"State"}),e.jsx("input",{type:"text",name:"state",className:`form-control plans-billing-datalist-field ${ee.includes("state")?"is-invalid":""}`,value:y.state,onChange:X,list:"state-options",disabled:!String(y.country||"").trim(),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Postal Code"}),e.jsx("input",{type:"text",name:"postal_code",className:`form-control ${ee.includes("postal_code")?"is-invalid":""}`,value:y.postal_code,onChange:X,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"GSTIN (optional)"}),e.jsx("input",{type:"text",name:"gstin",className:"form-control",value:y.gstin,onChange:B=>X({target:{name:"gstin",value:B.target.value.toUpperCase()}}),maxLength:15,placeholder:"15-character GSTIN"})]}),e.jsx("div",{className:"col-12 col-md-3 d-flex align-items-end",children:e.jsx("button",{className:"btn btn-primary btn-sm w-100",type:"submit",disabled:k,children:k?"Saving...":"Save Billing Details"})})]}),e.jsx("datalist",{id:"country-options",children:Zi.map(B=>e.jsx("option",{value:B},B))}),e.jsx("datalist",{id:"state-options",children:XS(y.country).map(B=>e.jsx("option",{value:B},B))})]})]}),e.jsx("div",{className:"row mt-4 g-3",children:Z.length?Z.map(B=>{var ct,lt,St,$t,q,pe,Re,vt,xa,de,Pe;const he=se[B.id]||"monthly",we=Zs(B,"monthly",p),I=Zs(B,"yearly",p),me=lc(B,"monthly",p),Me=lc(B,"yearly",p),De=H&&Number(H.plan_id)===Number(B.id),et=De&&String((H==null?void 0:H.status)||"").toLowerCase()==="trialing"&&!Xa(B),Qe=!Xa(B),bt=!!(V&&!De),ot=bt?Number(we||0)!==Number(Zs(V,"monthly",p)||0):!1,Xt=bt?Number(I||0)!==Number(Zs(V,"yearly",p)||0):!1,Wt=bt?gf(B)!==gf(V):!1,Vt=bt?xf(B)!==xf(V)||fd(B)!==fd(V):!1,kt=bt?bf(B)!==bf(V):!1,J=dw(B,he,H),_e=p===ce&&Y>0,K=Number(Zs(B,he,p)||0),We=_e?Math.round(K*(Y/100)*100)/100:0,Be=_e?Math.round((K+We)*100)/100:K;return e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 plan-card h-100",children:[e.jsx("h4",{className:"mb-2",children:r?jf(B.name):B.name}),e.jsxs("p",{className:"price-monthly",children:["Monthly: ",Ft(p)," ",e.jsx("span",{className:ot?"highlight-text":"",children:we||"-"})]}),e.jsxs("p",{className:"price-yearly",children:["Yearly: ",Ft(p)," ",e.jsx("span",{className:Xt?"highlight-text":"",children:I||"-"})]}),n?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"plan-feature-list",children:[e.jsxs("div",{className:"plan-metric",children:["Website Chat Widgets: ",((ct=B.limits)==null?void 0:ct.widgets)??"-"]}),e.jsxs("div",{className:"plan-metric",children:["Agents included: ",((lt=B.limits)==null?void 0:lt.included_agents)??"-"]}),e.jsxs("div",{className:"plan-metric",children:["Conversations/month: ",((St=B.limits)==null?void 0:St.conversations_per_month)??"-"]}),e.jsxs("div",{className:"plan-metric",children:["AI replies/month: ",(($t=B.limits)==null?void 0:$t.ai_replies_per_month)??"-"]}),e.jsxs("div",{className:"plan-metric",children:["Chat history: ",((q=B.limits)==null?void 0:q.chat_history_days)??"-"," days"]}),e.jsxs("div",{className:"plan-metric",children:["Max messages/conversation: ",((pe=B.limits)==null?void 0:pe.max_messages_per_conversation)??"-"]}),e.jsxs("div",{className:"plan-metric",children:["Max chars/message: ",((Re=B.limits)==null?void 0:Re.max_chars_per_message)??"-"]}),e.jsx("div",{className:"plan-feature-divider"}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:"bi bi-check-circle-fill plan-feature-icon text-success","aria-hidden":"true"}),e.jsx("span",{children:"Quick enquiry form"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${B.allow_addons?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Allow Agent Add-Ons"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(vt=B.features)!=null&&vt.remove_branding?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Remove branding"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(xa=B.features)!=null&&xa.analytics_basic?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Analytics (basic)"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(de=B.features)!=null&&de.csv_export?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"CSV export"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(Pe=B.features)!=null&&Pe.agent_inbox?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Agent inbox"})]})]})}):l?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"plan-feature-list",children:[ow(B).map(Te=>{const Je=typeof(Te==null?void 0:Te.ok)=="boolean",fe=!!(Te!=null&&Te.ok),Ue=String((Te==null?void 0:Te.text)||"-"),at=Ue.toLowerCase().includes("storage")?Wt:Ue.toLowerCase().includes("bandwidth")?Vt:Ue.toLowerCase().includes("device")?kt:!1;return e.jsxs("div",{className:"plan-feature",children:[Je?e.jsx("i",{className:`bi ${fe?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}):null,e.jsx("span",{className:at?"highlight-text":"",children:Ue})]},`${B.id}-storage-${Ue}`)}),B.allow_addons?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"plan-metric",children:["Add-on Monthly: ",Ft(p)," ",me||"-"]}),e.jsxs("div",{className:"plan-metric",children:["Add-on Yearly: ",Ft(p)," ",Me||"-"]})]}):e.jsx("div",{className:"plan-metric",children:"Add-ons disabled"})]})}):r?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"plan-feature-list",children:[e.jsxs("div",{className:"plan-metric",children:["Base platform (",p,"): ",Ft(p)," ",Zs(B,he,p)||"-"," / ",he==="yearly"?"year":"month"]}),e.jsxs("div",{className:"plan-metric",children:["Per user (",p,"): ",Ft(p)," ",lw(B,he,p)||"-"," / ",he==="yearly"?"year":"month"]}),e.jsxs("div",{className:"plan-metric",children:["Employees allowed: ",B.employee_limit===0?"Unlimited":B.employee_limit]}),B.allow_addons?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"plan-metric",children:["Add-on Monthly: ",Ft(p)," ",me||"-"]}),e.jsxs("div",{className:"plan-metric",children:["Add-on Yearly: ",Ft(p)," ",Me||"-"]})]}):e.jsx("div",{className:"plan-metric",children:"Add-ons disabled"}),e.jsx("div",{className:"plan-feature-divider"}),rw(B).map(Te=>{const Je=typeof(Te==null?void 0:Te.ok)=="boolean",fe=!!(Te!=null&&Te.ok);return e.jsxs("div",{className:"plan-feature",children:[Je?e.jsx("i",{className:`bi ${fe?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}):null,e.jsx("span",{children:(Te==null?void 0:Te.text)||"-"})]},`${B.id}-${(Te==null?void 0:Te.text)||"feature"}`)})]})}):o?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"plan-feature-list",children:[cw(B).map(Te=>e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${Te.ok?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:Te.text})]},`${B.id}-wa-${Te.text}`)),B.allow_addons?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"plan-metric",children:["Add-on Monthly: ",Ft(p)," ",me||"-"]}),e.jsxs("div",{className:"plan-metric",children:["Add-on Yearly: ",Ft(p)," ",Me||"-"]})]}):e.jsx("div",{className:"plan-metric",children:"Add-ons disabled"})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"plan-feature-list",children:[iw(B).map(Te=>{const Je=typeof(Te==null?void 0:Te.ok)=="boolean",fe=!!(Te!=null&&Te.ok);return e.jsxs("div",{className:"plan-feature",children:[Je?e.jsx("i",{className:`bi ${fe?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}):null,e.jsx("span",{children:Te.text})]},`${B.id}-monitor-${Te.text}`)}),B.allow_addons?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"plan-metric",children:["Add-on Monthly: ",Ft(p)," ",me||"-"]}),e.jsxs("div",{className:"plan-metric",children:["Add-on Yearly: ",Ft(p)," ",Me||"-"]})]}):e.jsx("div",{className:"plan-metric",children:"Add-ons disabled"})]})}),De?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"form-label",children:"Billing Cycle"}),e.jsx("div",{className:"text-secondary",children:he==="yearly"?"Yearly":"Monthly"})]}),!n&&!l&&!r?e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"form-label",children:"Screenshot Storage History"}),e.jsxs("div",{className:"retention-text",children:["Screenshot Retention:"," ",e.jsxs("span",{className:"highlight-text",children:[B.retention_days," Days"]})]})]}):null,_e&&K?e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"text-secondary",children:["GST (",Y,"%): ",Ft(p)," ",We]}),e.jsxs("div",{className:"fw-semibold",children:["Total: ",Ft(p)," ",Be]})]}):null,e.jsx("button",{type:"button",className:"btn btn-success btn-sm mt-2",disabled:et,children:et?"Activated":"Active"}),et?e.jsx("div",{className:"text-success small mt-2",children:"Free trial active."}):null]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"form-label",children:"Billing Cycle"}),Xa(B)?e.jsxs("select",{className:"form-select form-select-sm",value:he,onChange:Te=>v(Je=>({...Je,[B.id]:Te.target.value})),children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-secondary",children:"Monthly (1 month)"}),e.jsx("input",{type:"hidden",value:"monthly"})]})]}),!n&&!l&&!r?e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"form-label",children:"Screenshot Storage History"}),e.jsxs("div",{className:"retention-text",children:["Screenshot Retention:"," ",e.jsxs("span",{className:"highlight-text",children:[B.retention_days," Days"]})]})]}):null,e.jsx("button",{type:"button",className:`btn ${Xa(B)?"btn-primary":"btn-outline-light"} btn-sm mt-2`,onClick:()=>ne(B),disabled:Qe?!te:!1,children:Xa(B)?"Proceed to Bank Transfer":te?"Activate":"Free Trial Used"}),Qe&&!te?e.jsx("div",{className:"text-warning small mt-2",children:"Free trial is only available once. Please choose a paid plan."}):null,_e&&K?e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"text-secondary",children:["GST (",Y,"%): ",Ft(p)," ",We]}),e.jsxs("div",{className:"fw-semibold",children:["Total: ",Ft(p)," ",Be]})]}):null,J?e.jsx("small",{className:"text-secondary d-block mt-2 proration-note",children:J}):e.jsx("small",{className:"text-secondary d-block mt-2 proration-note"})]})]})},B.id)}):e.jsx("div",{className:"col-12",children:e.jsx("p",{children:"No plans available."})})}),C.open&&Ie?e.jsx("div",{className:"modal-overlay",onClick:Ne,children:e.jsxs("div",{className:"modal-panel",onClick:B=>B.stopPropagation(),children:[e.jsx("h5",{children:"Update User Count"}),e.jsxs("div",{className:"text-secondary mb-2",children:["Plan: ",Ie.name," (",nw(Xe),")"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Base Employees User Limit:"})," ",Ze]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Current Existing Users:"})," ",gt," + ",ht," Addons"]}),Ie.allow_addons?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Additional Users (Add-ons)"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Ye(-1),disabled:nt<=0,children:"-"}),e.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",style:{maxWidth:"120px"},value:nt,onChange:Ke}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Ye(1),children:"+"})]}),e.jsxs("div",{className:"text-secondary mt-2",children:["Add-on price: ",Ft(p)," ",ue||"-"]})]}):e.jsx("p",{className:"text-warning mb-3",children:"Add-ons disabled for this plan."}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total Employees:"})," ",pt]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"text-secondary",children:["Base: ",Ft(p)," ",Ae||"-"]}),Ie.allow_addons?e.jsxs("div",{className:"text-secondary",children:["Add-ons: ",Ft(p)," ",je||0]}):null,Le?e.jsxs("div",{className:"text-secondary",children:["GST (",Y,"%): ",Ft(p)," ",Fe||0]}):null,e.jsxs("div",{className:"fw-semibold",children:["Total: ",Ft(p)," ",ye||0]})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:Ne,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:mt,children:"Continue"})]})]})}):null]})}const mw=[{value:"UTC",label:"(GMT+00:00) UTC"},{value:"Europe/London",label:"(GMT+00:00) UK - London"},{value:"Europe/Paris",label:"(GMT+01:00) Europe - Paris"},{value:"Europe/Berlin",label:"(GMT+01:00) Europe - Berlin"},{value:"Europe/Moscow",label:"(GMT+03:00) Europe - Moscow"},{value:"Asia/Dubai",label:"(GMT+04:00) UAE - Dubai"},{value:"Asia/Karachi",label:"(GMT+05:00) Pakistan - Karachi"},{value:"Asia/Kolkata",label:"(GMT+05:30) India - Chennai (Asia/Kolkata)"},{value:"Asia/Kathmandu",label:"(GMT+05:45) Nepal - Kathmandu"},{value:"Asia/Dhaka",label:"(GMT+06:00) Bangladesh - Dhaka"},{value:"Asia/Bangkok",label:"(GMT+07:00) Thailand - Bangkok"},{value:"Asia/Singapore",label:"(GMT+08:00) Singapore"},{value:"Asia/Shanghai",label:"(GMT+08:00) China - Shanghai"},{value:"Asia/Tokyo",label:"(GMT+09:00) Japan - Tokyo"},{value:"Australia/Sydney",label:"(GMT+10:00) Australia - Sydney"},{value:"Pacific/Auckland",label:"(GMT+12:00) New Zealand - Auckland"},{value:"America/New_York",label:"(GMT-05:00) USA - New York"},{value:"America/Chicago",label:"(GMT-06:00) USA - Chicago"},{value:"America/Denver",label:"(GMT-07:00) USA - Denver"},{value:"America/Los_Angeles",label:"(GMT-08:00) USA - Los Angeles"},{value:"America/Toronto",label:"(GMT-05:00) Canada - Toronto"},{value:"America/Sao_Paulo",label:"(GMT-03:00) Brazil - Sao Paulo"},{value:"Africa/Johannesburg",label:"(GMT+02:00) South Africa - Johannesburg"}],rc=mw;function Bb(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone||""}catch{return""}}const hw={loading:!0,error:"",data:null},vf="wz_profile_whatsapp_api_config",Nf="wz_profile_whatsapp_event_rules",pw=["HR","Sales","Accounts","Support","Projects","Operations","Client"],fw=["New Lead Assigned","Payment Pending","Invoice Generated","Support Ticket Created","Attendance Alert","Low Stock Alert","Leave Request"],gw=["Welcome Message","Invoice Shared","Payment Reminder","Payment Received Confirmation","Order / Service Status Update","Appointment Reminder","Support Response Update","Delivery / Dispatch Update","Custom Client Notification"],_f="wz_brand_theme_override";function oa(t,a=""){const s=String(t||"").trim();return/^#([0-9a-f]{3}|[0-9a-f]{6})$/i.test(s)?s.toLowerCase():a}function Sf(t){if(typeof document>"u")return;const a=document.documentElement,s=["--color-primary","--color-primary-hover","--color-accent","--color-highlight","--color-accent-rgb","--color-primary-rgb"];if(!(t!=null&&t.primary)){s.forEach(c=>a.style.removeProperty(c));return}const n=c=>{const d=String(c||"").replace("#","").trim();return d.length===3?`${parseInt(d[0]+d[0],16)}, ${parseInt(d[1]+d[1],16)}, ${parseInt(d[2]+d[2],16)}`:d.length===6?`${parseInt(d.slice(0,2),16)}, ${parseInt(d.slice(2,4),16)}, ${parseInt(d.slice(4,6),16)}`:""},l=oa(t.primary),r=oa(t.secondary,l)||l;if(!l){s.forEach(c=>a.style.removeProperty(c));return}a.style.setProperty("--color-primary",l),a.style.setProperty("--color-primary-hover",l),a.style.setProperty("--color-accent",r),a.style.setProperty("--color-highlight",r);const o=n(l),u=n(r);o&&a.style.setProperty("--color-primary-rgb",o),u&&a.style.setProperty("--color-accent-rgb",u)}function wf(){return{providerName:"Meta WhatsApp Cloud API",apiBaseUrl:"",phoneNumberId:"",accessToken:"",webhookVerifyToken:"",status:"Disconnected"}}function kf(t=""){return{eventName:"",department:"HR",assignedOrgAdmin:t||"",priority:"High",triggerStatus:"Active",clientMessageTemplate:"",internalNotes:""}}const xw=ls;function bw(){var kt;const[t,a]=i.useState(hw),[s,n]=i.useState(""),[l,r]=i.useState(1),[o,u]=i.useState(""),[c,d]=i.useState(""),[h,p]=i.useState({open:!1,users:[]}),[g,N]=i.useState(""),[v,w]=i.useState("+91"),[A,y]=i.useState(""),[x,f]=i.useState("UTC"),[b,k]=i.useState("#e11d48"),[_,P]=i.useState("#f59e0b"),[S,F]=i.useState({primary:"#e11d48",secondary:"#f59e0b"}),[L,Q]=i.useState("default"),[E,C]=i.useState(""),[z,M]=i.useState(""),[R,W]=i.useState(""),[D,te]=i.useState("profile"),[H,O]=i.useState(!0),[V,re]=i.useState(""),[Y,ce]=i.useState([]),[ie,ee]=i.useState([]),[T,Z]=i.useState(""),[se,be]=i.useState(!1),[ne,ae]=i.useState(""),[X,ke]=i.useState(wf()),[Ne,Ye]=i.useState(""),[Ke,mt]=i.useState([]),[Ie,Xe]=i.useState(kf("")),[nt,Ae]=i.useState(""),[ue,je]=i.useState(null),[Ce,Le]=i.useState("company"),Fe=typeof window<"u"?window.location.pathname:"",Ze=(typeof window<"u"?window.__WZ_PRODUCT_SLUG__:"")||(Fe.includes("/ai-chatbot")?"ai-chatbot":Fe.includes("/storage")?"storage":Fe.includes("/business-autopilot")?"business-autopilot-erp":Fe.includes("/whatsapp-automation")?"whatsapp-automation":Fe.includes("/work-suite")||Fe.includes("/worksuite")||Fe.includes("/monitor")?"worksuite":"");i.useEffect(()=>{let J=!0;async function _e(){var K,We,Be,ct;n("");try{const lt=new URLSearchParams;l&&lt.set("admin_page",String(l)),c&&lt.set("q",c),Ze&&lt.set("product",Ze);const St=Bb();St&&lt.set("browser_timezone",St);const $t=lt.toString()?`/api/dashboard/profile?${lt.toString()}`:"/api/dashboard/profile",q=await U($t);if(!J)return;a({loading:!1,error:"",data:q}),N(((K=q.user)==null?void 0:K.email)||""),w(q.phone_country||"+91"),y(q.phone_number||"");const pe=q.org_timezone||"UTC";f(pe),$l(pe);const Re={primary:oa((We=q.theme_defaults)==null?void 0:We.primary,"#e11d48"),secondary:oa((Be=q.theme_defaults)==null?void 0:Be.secondary,"#f59e0b")};F(Re),k(oa(q.theme_primary,Re.primary)),P(oa(q.theme_secondary,Re.secondary)),Q(q.sidebar_menu_style==="compact"?"compact":"default")}catch(lt){if((ct=lt==null?void 0:lt.data)!=null&&ct.redirect){window.location.href=lt.data.redirect;return}J&&a({loading:!1,error:(lt==null?void 0:lt.message)||"Unable to load profile.",data:null})}}return _e(),()=>{J=!1}},[l,c,Ze]),i.useEffect(()=>{const J=setTimeout(()=>{d(o.trim()),r(1)},300);return()=>clearTimeout(J)},[o]),i.useEffect(()=>{let J=!0;async function _e(){try{const K=await U("/api/auth/subscriptions");if(!J)return;const We=(K.subscriptions||[]).map(Be=>({slug:Be.product_slug,name:Be.product_name||Be.product_slug}));ee(We),!T&&We.length&&Z(We[0].slug)}catch(K){if(!J)return;re((K==null?void 0:K.message)||"Unable to load products for backups.")}}return _e(),()=>{J=!1}},[]),i.useEffect(()=>{let J=!0;async function _e(){if(!T){O(!1);return}O(!0),re("");try{const K=new URLSearchParams;K.set("limit","10"),K.set("product_slug",T);const We=await U(`/api/backup/list?${K.toString()}`);if(!J)return;ce(Array.isArray(We.items)?We.items:[]),O(!1)}catch(K){if(!J)return;re((K==null?void 0:K.message)||"Unable to load backups."),O(!1)}}return _e(),()=>{J=!1}},[T]),i.useEffect(()=>{try{const J=window.localStorage.getItem(vf);if(!J)return;const _e=JSON.parse(J);_e&&typeof _e=="object"&&ke(K=>({...K,..._e}))}catch{}},[]),i.useEffect(()=>{try{const J=window.localStorage.getItem(Nf);if(!J)return;const _e=JSON.parse(J);Array.isArray(_e)&&mt(_e)}catch{}},[]),i.useEffect(()=>{window.localStorage.setItem(vf,JSON.stringify(X))},[X]),i.useEffect(()=>{window.localStorage.setItem(Nf,JSON.stringify(Ke))},[Ke]);async function pt(J){J.preventDefault(),n("");try{await U("/api/dashboard/profile/email",{method:"POST",body:JSON.stringify({email:g,phone_country:v,phone_number:A,org_timezone:x,theme_primary:oa(b,S.primary),theme_secondary:oa(_,S.secondary),sidebar_menu_style:L==="compact"?"compact":"default"})}),$l(x||"UTC"),typeof window<"u"&&window.localStorage.removeItem(_f),Sf({primary:oa(b,S.primary),secondary:oa(_,S.secondary)}),typeof window<"u"&&window.dispatchEvent(new CustomEvent("wz:sidebar-menu-style-change",{detail:{style:L==="compact"?"compact":"default"}})),n("Profile and UI theme updated successfully.")}catch(_e){a(K=>({...K,error:(_e==null?void 0:_e.message)||"Unable to update email."}))}}async function ht(J){J.preventDefault(),n("");try{await U("/api/dashboard/profile/email",{method:"POST",body:JSON.stringify({email:g,phone_country:v,phone_number:A,org_timezone:x,theme_primary:oa(b,S.primary),theme_secondary:oa(_,S.secondary),sidebar_menu_style:L==="compact"?"compact":"default"})}),$l(x||"UTC"),typeof window<"u"&&window.localStorage.removeItem(_f),Sf({primary:oa(b,S.primary),secondary:oa(_,S.secondary)}),typeof window<"u"&&window.dispatchEvent(new CustomEvent("wz:sidebar-menu-style-change",{detail:{style:L==="compact"?"compact":"default"}})),n("UI theme settings updated successfully.")}catch(_e){a(K=>({...K,error:(_e==null?void 0:_e.message)||"Unable to update UI theme."}))}}async function Ge(J){J.preventDefault(),n("");try{await U("/api/dashboard/profile/password",{method:"POST",body:JSON.stringify({current_password:E,new_password:z,confirm_password:R})}),n("Password updated successfully."),C(""),M(""),W("")}catch(_e){a(K=>({...K,error:(_e==null?void 0:_e.message)||"Unable to update password."}))}}async function gt(){var J;if(!((J=ft.org)!=null&&J.id)||!T){re("Organization or product missing.");return}ae(""),re(""),be(!0);try{await U("/api/backup/request",{method:"POST",body:JSON.stringify({organization_id:ft.org.id,product_slug:T})}),ae("Backup request queued. It will appear here once ready."),be(!1)}catch(_e){re((_e==null?void 0:_e.message)||"Unable to request backup."),be(!1)}}const ft=t.data||{},G=ft.user||{},Se=ft.recent_actions||[],ve=ft.referral||{},le=Array.isArray(ve.earnings)?ve.earnings:[],xe=rc.some(J=>J.value===x)?rc:[{value:x||"UTC",label:`${x||"UTC"}`},...rc],ge=!!((kt=ft.org)!=null&&kt.id),B=ft.pagination||{},he=B.page||l,we=B.page_size||50,I=typeof B.total_items=="number"?B.total_items:Se.length,me=I?(he-1)*we+1:0,Me=I?Math.min(he*we,I):0,De=i.useMemo(()=>{var _e,K;const J=[G.username,G.email,(_e=ft.org)==null?void 0:_e.owner_name,(K=ft.org)==null?void 0:K.admin_name,"Org Admin"].map(We=>String(We||"").trim()).filter(Boolean);return Array.from(new Set(J))},[ft.org,G.email,G.username]),et=i.useMemo(()=>{const J=Array.isArray(Ke)?Ke:[];return Ce==="client"?J.filter(_e=>String((_e==null?void 0:_e.department)||"").trim().toLowerCase()==="client"):J.filter(_e=>String((_e==null?void 0:_e.department)||"").trim().toLowerCase()!=="client")},[Ke,Ce]);if(i.useEffect(()=>{Xe(J=>J.assignedOrgAdmin?J:{...J,assignedOrgAdmin:De[0]||"Org Admin"})},[De]),t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading profile..."})]});function Qe(J){p({open:!0,users:J})}function bt(J){J.preventDefault(),Ye("WhatsApp API connection settings saved."),ke(_e=>({..._e,status:_e.apiBaseUrl&&_e.phoneNumberId&&_e.accessToken?"Connected":"Disconnected"}))}function ot(){Ae(""),Xe(kf(De[0]||"Org Admin"))}function Xt(J){J.preventDefault();const _e={...Ie,eventName:String(Ie.eventName||"").trim(),department:String(Ie.department||"").trim(),assignedOrgAdmin:String(Ie.assignedOrgAdmin||"").trim(),priority:String(Ie.priority||"High").trim(),triggerStatus:String(Ie.triggerStatus||"Active").trim(),clientMessageTemplate:String(Ie.clientMessageTemplate||"").trim(),internalNotes:String(Ie.internalNotes||"").trim()};if(!_e.eventName||!_e.department||!_e.assignedOrgAdmin){a(K=>({...K,error:"Event, department, and assigned org admin are required."}));return}if(_e.department==="Client"&&!_e.clientMessageTemplate){a(K=>({...K,error:"Client WhatsApp message is required when department is Client."}));return}a(K=>({...K,error:""})),mt(K=>nt?K.map(We=>We.id===nt?{...We,..._e,updatedAt:new Date().toISOString()}:We):[{id:`wa_rule_${Date.now()}`,..._e,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},...K]),ot()}function Wt(J){Ae(J.id),Xe({eventName:J.eventName||"",department:J.department||"HR",assignedOrgAdmin:J.assignedOrgAdmin||De[0]||"Org Admin",priority:J.priority||"High",triggerStatus:J.triggerStatus||"Active",clientMessageTemplate:J.clientMessageTemplate||"",internalNotes:J.internalNotes||""})}function Vt(J){mt(_e=>_e.filter(K=>K.id!==J)),nt===J&&ot(),(ue==null?void 0:ue.id)===J&&je(null)}return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Profile"}),e.jsx("hr",{className:"section-divider"}),e.jsxs("div",{className:"d-flex flex-wrap gap-2 mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${D==="profile"?"btn-primary":"btn-outline-light"}`,onClick:()=>te("profile"),children:"Profile"}),e.jsx("button",{type:"button",className:`btn btn-sm ${D==="uiTheme"?"btn-primary":"btn-outline-light"}`,onClick:()=>te("uiTheme"),children:"UI Theme"}),e.jsx("button",{type:"button",className:`btn btn-sm ${D==="backup"?"btn-primary":"btn-outline-light"}`,onClick:()=>te("backup"),children:"Backup"}),e.jsx("button",{type:"button",className:`btn btn-sm ${D==="referral"?"btn-primary":"btn-outline-light"}`,onClick:()=>te("referral"),children:"Referral Program"}),e.jsx("button",{type:"button",className:`btn btn-sm ${D==="whatsappApi"?"btn-primary":"btn-outline-light"}`,onClick:()=>te("whatsappApi"),children:"WhatsApp API"})]}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,D==="profile"?e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Account"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",G.username||"-"]}),e.jsxs("form",{className:"mt-3",onSubmit:pt,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:g,onChange:J=>N(J.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Mobile Number"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",value:v,onChange:J=>w(J.target.value),style:{maxWidth:"170px"},children:xw.map(J=>e.jsxs("option",{value:J.code,children:[J.label," ",J.code]},`${J.code}-${J.label}`))}),e.jsx("input",{type:"tel",className:"form-control",value:A,onChange:J=>y(J.target.value),placeholder:"Phone number"})]})]}),ge?e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Organization Timezone"}),e.jsx("select",{className:"form-select",value:x,onChange:J=>f(J.target.value),children:xe.map(J=>e.jsx("option",{value:J.value,children:J.label},J.value))})]}):null,e.jsx("button",{className:"btn btn-primary btn-sm",children:"Update Details"})]})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Update Password"}),e.jsxs("form",{onSubmit:Ge,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Current Password"}),e.jsx("input",{type:"password",className:"form-control",value:E,onChange:J=>C(J.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsx("input",{type:"password",className:"form-control",value:z,onChange:J=>M(J.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Confirm New Password"}),e.jsx("input",{type:"password",className:"form-control",value:R,onChange:J=>W(J.target.value),required:!0})]}),e.jsx("button",{className:"btn btn-warning btn-sm",children:"Update Password"})]})]})})]}):null,D==="uiTheme"?e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{className:"mb-2",children:"UI Theme"}),e.jsx("p",{className:"text-secondary mb-3",children:"Manage theme colors and sidebar menu selection globally for your organization."}),e.jsxs("form",{onSubmit:ht,children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 mb-2",children:[e.jsx("label",{className:"form-label mb-0",children:"UI Theme Colors (All Products)"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>{k(S.primary),P(S.secondary)},children:"Use Defaults"})]}),e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label small mb-1",children:"Primary Color"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"color",className:"form-control form-control-color",value:oa(b,S.primary),onChange:J=>k(J.target.value),title:"Primary color"}),e.jsx("input",{type:"text",className:"form-control",value:b,onChange:J=>k(J.target.value),placeholder:"#e11d48"})]})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label small mb-1",children:"Secondary Color"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"color",className:"form-control form-control-color",value:oa(_,S.secondary),onChange:J=>P(J.target.value),title:"Secondary color"}),e.jsx("input",{type:"text",className:"form-control",value:_,onChange:J=>P(J.target.value),placeholder:"#f59e0b"})]})]})]}),e.jsx("div",{className:"form-text text-secondary mt-2",children:"Org admin-selected colors apply globally across your organization dashboards in all products."}),e.jsxs("div",{className:"mt-3 pt-2 border-top",children:[e.jsx("label",{className:"form-label mb-2",children:"React UI Side Menu Style"}),e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${L==="default"?"btn-primary":"btn-outline-light"}`,onClick:()=>Q("default"),children:"Default Menu"}),e.jsx("button",{type:"button",className:`btn btn-sm ${L==="compact"?"btn-primary":"btn-outline-light"}`,onClick:()=>Q("compact"),children:"Compact Center Menu"})]}),e.jsx("div",{className:"form-text text-secondary mt-2 mb-3",children:"Option 2 uses reduced sidebar width, bigger centered icons/text, and icon-only light/dark toggle buttons."})]}),e.jsx("button",{className:"btn btn-primary btn-sm",type:"submit",children:"Save UI Theme"})]})]})}):null,D==="whatsappApi"?e.jsxs("div",{className:"mt-3",children:[e.jsx("h5",{children:"WhatsApp API Connection & Event Notifications"}),e.jsx("p",{className:"text-secondary mb-3",children:"Configure WhatsApp API connection and create important event notifications for departments (including Client)."}),Ne?e.jsx("div",{className:"alert alert-success py-2",children:Ne}):null,e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-xl-5",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 mb-2",children:[e.jsx("h6",{className:"mb-0",children:"WhatsApp API Connection"}),e.jsx("span",{className:`badge ${X.status==="Connected"?"bg-success":"bg-secondary"}`,children:X.status})]}),e.jsxs("form",{className:"d-flex flex-column gap-2",onSubmit:bt,children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label small mb-1",children:"Provider"}),e.jsx("input",{className:"form-control",value:X.providerName,onChange:J=>ke(_e=>({..._e,providerName:J.target.value})),placeholder:"Meta WhatsApp Cloud API"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label small mb-1",children:"API Base URL"}),e.jsx("input",{className:"form-control",value:X.apiBaseUrl,onChange:J=>ke(_e=>({..._e,apiBaseUrl:J.target.value})),placeholder:"https://graph.facebook.com/vXX.X"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label small mb-1",children:"Phone Number ID"}),e.jsx("input",{className:"form-control",value:X.phoneNumberId,onChange:J=>ke(_e=>({..._e,phoneNumberId:J.target.value})),placeholder:"Enter phone number id"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label small mb-1",children:"Access Token"}),e.jsx("input",{className:"form-control",value:X.accessToken,onChange:J=>ke(_e=>({..._e,accessToken:J.target.value})),placeholder:"Permanent access token"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label small mb-1",children:"Webhook Verify Token"}),e.jsx("input",{className:"form-control",value:X.webhookVerifyToken,onChange:J=>ke(_e=>({..._e,webhookVerifyToken:J.target.value})),placeholder:"Webhook verify token"})]}),e.jsxs("div",{className:"d-flex gap-2 pt-1",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:"Save Connection"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>{ke(wf()),Ye("")},children:"Reset"})]})]})]})}),e.jsx("div",{className:"col-12 col-xl-7",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsx("h6",{className:"mb-2",children:nt?"Edit Event Notification Rule":"Create Event Notification Rule"}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:Xt,children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label small mb-1",children:"Important Event"}),e.jsxs("select",{className:"form-select",value:Ie.eventName,onChange:J=>Xe(_e=>({..._e,eventName:J.target.value})),children:[e.jsx("option",{value:"",children:"Select Event"}),e.jsx("optgroup",{label:"Company",children:fw.map(J=>e.jsx("option",{value:J,children:J},`company-${J}`))}),e.jsx("optgroup",{label:"Client",children:gw.map(J=>e.jsx("option",{value:J,children:J},`client-${J}`))})]})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label small mb-1",children:"Department"}),e.jsx("select",{className:"form-select",value:Ie.department,onChange:J=>Xe(_e=>({..._e,department:J.target.value})),children:pw.map(J=>e.jsx("option",{value:J,children:J},J))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label small mb-1",children:"Assign Org Admin"}),e.jsx("input",{className:"form-control datalist-readable-input",list:"profile-whatsapp-admin-options",value:Ie.assignedOrgAdmin,onChange:J=>Xe(_e=>({..._e,assignedOrgAdmin:J.target.value})),placeholder:"Assign org admin"}),e.jsx("datalist",{id:"profile-whatsapp-admin-options",children:De.map(J=>e.jsx("option",{value:J},J))})]}),e.jsxs("div",{className:"col-6 col-md-3",children:[e.jsx("label",{className:"form-label small mb-1",children:"Priority"}),e.jsxs("select",{className:"form-select",value:Ie.priority,onChange:J=>Xe(_e=>({..._e,priority:J.target.value})),children:[e.jsx("option",{value:"High",children:"High"}),e.jsx("option",{value:"Medium",children:"Medium"}),e.jsx("option",{value:"Low",children:"Low"})]})]}),e.jsxs("div",{className:"col-6 col-md-3",children:[e.jsx("label",{className:"form-label small mb-1",children:"Status"}),e.jsxs("select",{className:"form-select",value:Ie.triggerStatus,onChange:J=>Xe(_e=>({..._e,triggerStatus:J.target.value})),children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label small mb-1",children:"Client WhatsApp Message"}),e.jsx("textarea",{className:"form-control",rows:3,value:Ie.clientMessageTemplate,onChange:J=>Xe(_e=>({..._e,clientMessageTemplate:J.target.value})),placeholder:Ie.department==="Client"?"Required for Client notifications":"Optional client-facing message template"})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label small mb-1",children:"Internal Notes"}),e.jsx("input",{className:"form-control",value:Ie.internalNotes,onChange:J=>Xe(_e=>({..._e,internalNotes:J.target.value})),placeholder:"Optional notes for admin team"})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",children:nt?"Update Rule":"Create Rule"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:ot,children:"Clear"})]})]})]})})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2 mt-3 mb-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${Ce==="company"?"btn-primary":"btn-outline-light"}`,onClick:()=>Le("company"),children:"Company"}),e.jsx("button",{type:"button",className:`btn btn-sm ${Ce==="client"?"btn-primary":"btn-outline-light"}`,onClick:()=>Le("client"),children:"Client"})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Event"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Assigned Org Admin"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:"Client Message"}),e.jsx("th",{className:"text-end",children:"Action"})]})}),e.jsx("tbody",{children:et.length?et.map(J=>e.jsxs("tr",{children:[e.jsx("td",{children:J.eventName||"-"}),e.jsx("td",{children:J.department||"-"}),e.jsx("td",{children:J.assignedOrgAdmin||"-"}),e.jsx("td",{children:J.triggerStatus||"-"}),e.jsx("td",{children:J.priority||"-"}),e.jsx("td",{children:J.clientMessageTemplate?`${String(J.clientMessageTemplate).slice(0,40)}${String(J.clientMessageTemplate).length>40?"...":""}`:"-"}),e.jsx("td",{className:"text-end",children:e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>je(J),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",onClick:()=>Wt(J),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>Vt(J.id),children:"Delete"})]})})]},J.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:Ce==="client"?"No Client WhatsApp event notification rules yet.":"No Company WhatsApp event notification rules yet."})})})]})})]}):null,D==="backup"?e.jsxs("div",{className:"mt-3",children:[e.jsx("h5",{children:"Downloads & Backups"}),e.jsx("p",{className:"text-secondary",children:"Generate a downloadable backup of your organization's data."}),e.jsx("div",{className:"mb-2",children:e.jsx("a",{className:"btn btn-outline-light btn-sm",href:"/app/backup-history",children:"View Full History"})}),ne?e.jsx("div",{className:"alert alert-success",children:ne}):null,V?e.jsx("div",{className:"alert alert-danger",children:V}):null,e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Product"}),e.jsx("select",{className:"form-select",value:T,onChange:J=>Z(J.target.value),children:ie.length?ie.map(J=>e.jsx("option",{value:J.slug,children:J.name},J.slug)):e.jsx("option",{value:"",children:"No products"})})]}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:gt,disabled:se||!T,children:se?"Generating...":"Generate Backup"})})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Expires"}),e.jsx("th",{children:"Download"})]})}),e.jsx("tbody",{children:H?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"Loading backups..."})}):Y.length?Y.map(J=>e.jsxs("tr",{children:[e.jsx("td",{children:J.product_name||"-"}),e.jsx("td",{children:J.status||"-"}),e.jsx("td",{children:J.size_bytes?`${(J.size_bytes/(1024*1024)).toFixed(2)} MB`:"-"}),e.jsx("td",{children:J.completed_at||J.requested_at||"-"}),e.jsx("td",{children:J.expires_at||"-"}),e.jsx("td",{children:J.can_download&&J.download_url?e.jsx("a",{className:"btn btn-sm btn-outline-light",href:J.download_url,children:"Download"}):"-"})]},J.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No backups yet."})})})]})})]}):null,D==="referral"?e.jsxs("div",{className:"mt-3",children:[e.jsx("h5",{children:"Referral Program"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Commission Rate:"})," ",ve.commission_rate??0,"%"]}),ve.subscription_amount?e.jsxs("p",{children:[e.jsx("strong",{children:"Subscription Amount:"})," ",ve.subscription_amount]}):null,e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Referral Code"}),e.jsx("input",{type:"text",className:"form-control",value:ve.code||"",readOnly:!0})]}),e.jsxs("div",{className:"col-12 col-md-8",children:[e.jsx("label",{className:"form-label",children:"Referral Link"}),e.jsx("input",{type:"text",className:"form-control",value:ve.link||"",readOnly:!0})]})]})]}):null,D==="referral"?e.jsxs("div",{className:"mt-3",children:[e.jsx("h5",{children:"Referral Income"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Company / Dealer"}),e.jsx("th",{children:"Transfer"}),e.jsx("th",{children:"Base Amount"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Flat Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]})}),e.jsx("tbody",{children:le.length?le.map(J=>e.jsxs("tr",{children:[e.jsx("td",{children:J.referred_org||J.referred_dealer||"-"}),e.jsx("td",{children:J.transfer_id||"-"}),e.jsx("td",{children:J.base_amount??"-"}),e.jsxs("td",{children:[J.commission_rate??0,"%"]}),e.jsx("td",{children:J.commission_amount??"-"}),e.jsx("td",{children:J.flat_amount??"-"}),e.jsx("td",{children:J.status||"-"}),e.jsx("td",{children:J.payout_reference||"-"}),e.jsx("td",{children:J.payout_date||"-"})]},J.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",children:"No referral income yet."})})})]})})]}):null,D==="profile"?e.jsxs("div",{className:"mt-3",children:[e.jsx("h5",{children:"Admin Activity"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",we," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"profile-admin-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"profile-admin-search",type:"text",value:o,onChange:J=>u(J.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Users"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:Se.length?Se.map((J,_e)=>{const K=Array.isArray(J.employees)?J.employees:[];return e.jsxs("tr",{children:[e.jsx("td",{children:J.time}),e.jsx("td",{children:J.action}),e.jsx("td",{children:K.length===1?K[0]:K.length>1?e.jsx("button",{type:"button",className:"btn btn-link text-info p-0 history-trigger",onClick:()=>Qe(K),children:"View Users Details"}):"-"}),e.jsx("td",{children:J.details||"-"})]},`${J.time}-${_e}`)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No recent activity."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",me," to ",Me," of ",I," entries"]}),e.jsx(st,{page:he,totalPages:B.total_pages||1,onPageChange:r,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):null,h.open?e.jsx("div",{className:"modal-overlay",onClick:()=>p({open:!1,users:[]}),children:e.jsxs("div",{className:"modal-panel",onClick:J=>J.stopPropagation(),children:[e.jsx("h5",{children:"Users Details"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Employee"})]})}),e.jsx("tbody",{children:h.users.map((J,_e)=>e.jsxs("tr",{children:[e.jsx("td",{children:_e+1}),e.jsx("td",{children:J})]},`${J}-${_e}`))})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{className:"modal-close",type:"button",onClick:()=>p({open:!1,users:[]}),children:"Close"})})]})}):null,ue?e.jsx("div",{className:"modal-overlay",onClick:()=>je(null),children:e.jsxs("div",{className:"modal-panel",onClick:J=>J.stopPropagation(),children:[e.jsx("h5",{children:"WhatsApp Event Rule Details"}),e.jsx("div",{className:"table-responsive",children:e.jsx("table",{className:"table table-dark table-striped align-middle mb-0",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("th",{style:{width:220},children:"Event"}),e.jsx("td",{children:ue.eventName||"-"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Department"}),e.jsx("td",{children:ue.department||"-"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Assigned Org Admin"}),e.jsx("td",{children:ue.assignedOrgAdmin||"-"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("td",{children:ue.triggerStatus||"-"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Priority"}),e.jsx("td",{children:ue.priority||"-"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Client WhatsApp Message"}),e.jsx("td",{style:{whiteSpace:"pre-wrap"},children:ue.clientMessageTemplate||"-"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Internal Notes"}),e.jsx("td",{children:ue.internalNotes||"-"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Created"}),e.jsx("td",{children:ue.createdAt||"-"})]}),e.jsxs("tr",{children:[e.jsx("th",{children:"Updated"}),e.jsx("td",{children:ue.updatedAt||"-"})]})]})})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{className:"modal-close",type:"button",onClick:()=>je(null),children:"Close"})})]})}):null]})}const jw={loading:!0,error:"",data:null};function Ra(t,a="-"){if(t==null||t==="")return a;if(typeof t=="object")try{return JSON.stringify(t)}catch{return a}return String(t)}function Cf(){var y;const{transferId:t}=js(),[a,s]=i.useState(jw),[n,l]=i.useState(""),[r,o]=i.useState(""),[u,c]=i.useState(null),[d,h]=i.useState(!1);async function p(x){var f;l("");try{const b=t?`/api/dashboard/bank-transfer/${t}`:"/api/dashboard/bank-transfer",k=await U(b);if(k!=null&&k.redirect){window.location.href=k.redirect;return}if(x&&!x.current)return;s({loading:!1,error:"",data:k})}catch(b){if((f=b==null?void 0:b.data)!=null&&f.redirect){window.location.href=b.data.redirect;return}(!x||x.current)&&s({loading:!1,error:(b==null?void 0:b.message)||"Unable to load bank transfer details.",data:null})}}i.useEffect(()=>{const x={current:!0};return p(x),()=>{x.current=!1}},[t]);const g=((y=a.data)==null?void 0:y.transfer)||null,N=!a.loading&&!a.error&&!g&&!t,v=Ra(n,""),w=Ra(a.error,"");i.useEffect(()=>{N&&(window.location.href="/plans")},[N]);async function A(x){if(x.preventDefault(),!r.trim()){l("Please enter the reference / UTR number.");return}l(""),h(!0);try{const f=t?`/api/dashboard/bank-transfer/${t}/submit`:"/api/dashboard/bank-transfer/submit",b=new FormData;b.append("reference_no",r.trim()),u&&b.append("receipt",u);const k=await fetch(f,{method:"POST",credentials:"include",headers:{"X-CSRFToken":ns()},body:b}),_=await k.json().catch(()=>null);if(!k.ok){l((_==null?void 0:_.error)||"Unable to submit payment."),h(!1);return}_!=null&&_.message&&l(_.message),_!=null&&_.redirect?window.location.href=_.redirect:await p()}catch{l("Unable to submit payment.")}finally{h(!1)}}return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading bank transfer..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Bank Transfer"}),e.jsx("p",{className:"text-secondary mb-1",children:"Submit your payment details. We will verify and activate your plan."}),e.jsx("hr",{className:"section-divider"}),v?e.jsx("div",{className:"alert alert-info",children:v}):null,w?e.jsx("div",{className:"alert alert-danger",children:w}):null,g?e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{className:"mb-3",children:"Plan Summary"}),e.jsx("table",{className:"table table-borderless mb-0",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Company"}),e.jsx("td",{children:Ra(g.org_name)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Plan"}),e.jsx("td",{children:Ra(g.plan_name)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Billing Cycle"}),e.jsx("td",{children:Ra(g.billing_cycle,"monthly")})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Amount"}),e.jsxs("td",{children:[Ra(g.currency,"INR")," ",Ra(g.base_amount??g.amount,"0")]})]}),g.tax_amount?e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"GST"}),e.jsxs("td",{children:[Ra(g.currency,"INR")," ",Ra(g.tax_amount,"0")]})]}):null,g.tax_amount?e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Total Payable"}),e.jsxs("td",{children:[Ra(g.currency,"INR")," ",Ra(g.total_amount,"0")]})]}):null,g.addon_count?e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Add-ons"}),e.jsx("td",{children:Ra(g.addon_count)})]}):null]})})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{className:"mb-3",children:"Payment Details"}),e.jsxs("form",{onSubmit:A,children:[g.bank_account_details?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Bank Account Details"}),e.jsx("div",{className:"form-control",style:{whiteSpace:"pre-wrap"},children:g.bank_account_details})]}):null,e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Reference / UTR Number"}),e.jsx("input",{type:"text",className:"form-control",value:r,onChange:x=>o(x.target.value),placeholder:"Enter reference or UTR number",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Transaction Screenshot"}),e.jsx("input",{type:"file",className:"form-control",required:!0,onChange:x=>{var f;return c(((f=x.target.files)==null?void 0:f[0])||null)}})]}),e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:d,children:d?"Submitting...":"Submit for Approval"}),e.jsx("p",{className:"text-secondary mt-3 mb-0",children:"Your account will be activated after verification."})]})]})})]}):t?e.jsx("div",{className:"alert alert-warning",children:"No pending payment request found."}):N?e.jsx("div",{className:"alert alert-info",children:"No pending payment request found. Redirecting to Plans..."}):null]})}const yw={loading:!0,error:"",data:null};function vw(){var o,u,c,d,h;const[t,a]=i.useState(yw);if(i.useEffect(()=>{let p=!0;async function g(){try{const N=await U("/api/dashboard/dealer/summary");if(!p)return;a({loading:!1,error:"",data:N})}catch(N){p&&a({loading:!1,error:(N==null?void 0:N.message)||"Unable to load dealer summary.",data:null})}}return g(),()=>{p=!1}},[]),t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading dashboard..."})]});const s=((o=t.data)==null?void 0:o.dealer)||{},n=((u=t.data)==null?void 0:u.referral_amounts)||{},l=((c=t.data)==null?void 0:c.referral)||{},r=((d=t.data)==null?void 0:d.products_count)??0;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Dealer Dashboard"}),e.jsx("hr",{className:"section-divider"}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-cash-stack","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"My Total Earnings"})]}),e.jsx("div",{className:"stat-value",children:n.total??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-calendar-check","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"This Month Earnings"})]}),e.jsx("div",{className:"stat-value",children:n.month_total??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-building","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"Total ORG Refered"})]}),e.jsx("div",{className:"stat-value",children:n.org_count??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-people","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"Total Agent Refered"})]}),e.jsx("div",{className:"stat-value",children:n.dealer_count??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-calendar-event","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"My Plan Expire Date"})]}),e.jsx("div",{className:"stat-value",children:s.subscription_end||"-"})]})}),e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-boxes","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"Work Zilla Products"})]}),e.jsx("div",{className:"stat-value",children:r})]})})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"My Subscription"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Agent Name"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Commission %"}),e.jsx("th",{children:"Plan Amount (Yearly)"}),e.jsx("th",{children:"Total Earned"}),e.jsx("th",{children:"Paid Earned"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:s.name||"-"}),e.jsx("td",{children:s.email||"-"}),e.jsx("td",{children:s.subscription_start||"-"}),e.jsx("td",{children:s.subscription_end||"-"}),e.jsxs("td",{children:[((h=t.data)==null?void 0:h.commission_rate)??0,"%"]}),e.jsx("td",{children:s.subscription_amount??"-"}),e.jsx("td",{children:n.total??0}),e.jsx("td",{children:n.paid??0})]})})]})})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"Referral Details"}),e.jsx("div",{className:"row g-3 mt-1",children:e.jsxs("div",{className:"col-3",children:[e.jsx("label",{className:"form-label",children:"Referral Code"}),e.jsx("input",{className:"form-control",type:"text",value:l.code||"",readOnly:!0})]})})]})]})}const Nw={loading:!0,error:"",data:null};function _w(){var F,L;const[t,a]=i.useState(Nw),[s,n]=i.useState("org"),[l,r]=i.useState(""),[o,u]=i.useState(""),[c,d]=i.useState(1),[h,p]=i.useState(""),[g,N]=i.useState(""),[v,w]=i.useState(1),A=20;i.useEffect(()=>{let Q=!0;async function E(){try{const C=await U("/api/dashboard/dealer/referrals");if(!Q)return;a({loading:!1,error:"",data:C})}catch(C){Q&&a({loading:!1,error:(C==null?void 0:C.message)||"Unable to load referrals.",data:null})}}return E(),()=>{Q=!1}},[]),i.useEffect(()=>{const Q=setTimeout(()=>{u(l.trim()),d(1)},300);return()=>clearTimeout(Q)},[l]),i.useEffect(()=>{const Q=setTimeout(()=>{N(h.trim()),w(1)},300);return()=>clearTimeout(Q)},[h]);const y=((F=t.data)==null?void 0:F.org_referrals)||[],x=((L=t.data)==null?void 0:L.dealer_referrals)||[],f=i.useMemo(()=>{if(!o)return y;const Q=o.toLowerCase();return y.filter(E=>[E.referred_org,E.transfer_id,E.base_amount,E.commission_rate,E.commission_amount,E.status,E.payout_reference,E.payout_date].some(C=>String(C||"").toLowerCase().includes(Q)))},[y,o]),b=Math.max(Math.ceil(f.length/A),1),k=i.useMemo(()=>f.slice((c-1)*A,c*A),[f,c]),_=i.useMemo(()=>{if(!g)return x;const Q=g.toLowerCase();return x.filter(E=>[E.referred_dealer,E.flat_amount,E.status,E.payout_reference,E.payout_date].some(C=>String(C||"").toLowerCase().includes(Q)))},[x,g]),P=Math.max(Math.ceil(_.length/A),1),S=i.useMemo(()=>_.slice((v-1)*A,v*A),[_,v]);return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading referrals..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Referrals"}),e.jsx("hr",{className:"section-divider"}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"d-flex gap-2 flex-wrap mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${s==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>n("org"),children:"ORG Referrals"}),e.jsx("button",{type:"button",className:`btn btn-sm ${s==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>n("dealer"),children:"Agent Referrals"})]}),s==="org"?e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{children:"Organization Referrals"}),e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",A," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dealer-org-referrals-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dealer-org-referrals-search",type:"text",value:l,onChange:Q=>r(Q.target.value),placeholder:"Search referrals"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Transfer"}),e.jsx("th",{children:"Base Amount"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]})}),e.jsx("tbody",{children:k.length?k.map(Q=>e.jsxs("tr",{children:[e.jsx("td",{children:Q.referred_org||"-"}),e.jsx("td",{children:Q.transfer_id||"-"}),e.jsx("td",{children:Q.base_amount??"-"}),e.jsxs("td",{children:[Q.commission_rate??0,"%"]}),e.jsx("td",{children:Q.commission_amount??"-"}),e.jsx("td",{children:Q.status||"-"}),e.jsx("td",{children:Q.payout_reference||"-"}),e.jsx("td",{children:Q.payout_date||"-"})]},Q.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No organization referrals yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",k.length?(c-1)*A+1:0," to"," ",Math.min(c*A,f.length)," of ",f.length," entries"]}),e.jsx(st,{page:c,totalPages:b,onPageChange:d,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{children:"Agent Referrals"}),e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",A," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dealer-agent-referrals-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dealer-agent-referrals-search",type:"text",value:h,onChange:Q=>p(Q.target.value),placeholder:"Search referrals"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Agent"}),e.jsx("th",{children:"Flat Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]})}),e.jsx("tbody",{children:S.length?S.map(Q=>e.jsxs("tr",{children:[e.jsx("td",{children:Q.referred_dealer||"-"}),e.jsx("td",{children:Q.flat_amount??"-"}),e.jsx("td",{children:Q.status||"-"}),e.jsx("td",{children:Q.payout_reference||"-"}),e.jsx("td",{children:Q.payout_date||"-"})]},Q.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No agent referrals yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",S.length?(v-1)*A+1:0," to"," ",Math.min(v*A,_.length)," of"," ",_.length," entries"]}),e.jsx(st,{page:v,totalPages:P,onPageChange:w,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})}const Sw={loading:!0,error:"",data:null},ww=ls,kw={india:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"]};function Cw(t){return String(t||"").trim().toLowerCase()}function ic(t){return kw[Cw(t)]||[]}function Pw(t){const a=String(t||"").trim();if(!a)return{country:"+91",number:""};if(a.startsWith("+")){const s=a.split(" ");return s.length>1?{country:s[0],number:s.slice(1).join(" ").trim()}:{country:a,number:""}}return{country:"+91",number:a}}function Ew(){const[t,a]=i.useState(Sw),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState(""),[c,d]=i.useState("+91"),[h,p]=i.useState(""),[g,N]=i.useState(""),[v,w]=i.useState(""),[A,y]=i.useState(""),[x,f]=i.useState(""),[b,k]=i.useState(""),[_,P]=i.useState(""),[S,F]=i.useState(""),[L,Q]=i.useState(""),[E,C]=i.useState(""),[z,M]=i.useState(""),[R,W]=i.useState(""),[D,te]=i.useState(""),[H,O]=i.useState("");i.useEffect(()=>{let Y=!0;async function ce(){n("");try{const ie=await U("/api/dashboard/dealer/profile");if(!Y)return;a({loading:!1,error:"",data:ie});const ee=ie.user||{},T=ie.dealer||{};r(ee.name||""),u(ee.email||"");const Z=Pw(ie.phone_number||"");d(Z.country),p(Z.number),N(T.address_line1||""),w(T.address_line2||""),y(T.city||""),f(T.state||""),k(T.country||"India"),P(T.postal_code||""),F(T.bank_name||""),Q(T.bank_account_number||""),C(T.bank_ifsc||""),M(T.upi_id||"")}catch(ie){Y&&a({loading:!1,error:(ie==null?void 0:ie.message)||"Unable to load profile.",data:null})}}return ce(),()=>{Y=!1}},[]);async function V(Y){Y.preventDefault(),n("");try{await U("/api/dashboard/dealer/profile",{method:"POST",body:JSON.stringify({name:l,email:o,phone_country:c,phone_number:h,address_line1:g,address_line2:v,city:A,state:x,country:b,postal_code:_,bank_name:S,bank_account_number:L,bank_ifsc:E,upi_id:z})}),n("Profile updated successfully.")}catch(ce){a(ie=>({...ie,error:(ce==null?void 0:ce.message)||"Unable to update profile."}))}}async function re(Y){Y.preventDefault(),n("");try{await U("/api/dashboard/dealer/profile/password",{method:"POST",body:JSON.stringify({current_password:R,new_password:D,confirm_password:H})}),n("Password updated successfully."),W(""),te(""),O("")}catch(ce){a(ie=>({...ie,error:(ce==null?void 0:ce.message)||"Unable to update password."}))}}return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading profile..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"My Profile"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsx("form",{id:"dealer-profile-form",onSubmit:V}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Profile Details"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:l,onChange:Y=>r(Y.target.value),form:"dealer-profile-form",required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Email ID"}),e.jsx("input",{type:"email",className:"form-control",value:o,onChange:Y=>u(Y.target.value),form:"dealer-profile-form",required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Phone Number"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",value:c,onChange:Y=>d(Y.target.value),style:{maxWidth:"170px"},form:"dealer-profile-form",children:ww.map(Y=>e.jsxs("option",{value:Y.code,children:[Y.label," ",Y.code]},`${Y.code}-${Y.label}`))}),e.jsx("input",{type:"tel",className:"form-control",value:h,onChange:Y=>p(Y.target.value),placeholder:"Phone number",form:"dealer-profile-form"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Address Line 1"}),e.jsx("input",{type:"text",className:"form-control",value:g,onChange:Y=>N(Y.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Address Line 2"}),e.jsx("input",{type:"text",className:"form-control",value:v,onChange:Y=>w(Y.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",className:"form-control",value:A,onChange:Y=>y(Y.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{type:"text",className:"form-control",value:b,onChange:Y=>{const ce=Y.target.value,ie=ic(ce);k(ce),ie.length&&!ie.includes(x)&&f("")},list:"country-options",form:"dealer-profile-form"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"State"}),ic(b).length?e.jsxs("select",{className:"form-select",value:x,onChange:Y=>f(Y.target.value),form:"dealer-profile-form",children:[e.jsx("option",{value:"",children:"Select state"}),ic(b).map(Y=>e.jsx("option",{value:Y,children:Y},Y))]}):e.jsx("input",{type:"text",className:"form-control",value:x,onChange:Y=>f(Y.target.value),placeholder:"State",form:"dealer-profile-form"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Pincode"}),e.jsx("input",{type:"text",className:"form-control",value:_,onChange:Y=>P(Y.target.value),form:"dealer-profile-form"})]})]})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Bank Details"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Bank Name"}),e.jsx("input",{type:"text",className:"form-control",value:S,onChange:Y=>F(Y.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Account Number"}),e.jsx("input",{type:"text",className:"form-control",value:L,onChange:Y=>Q(Y.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"IFSC"}),e.jsx("input",{type:"text",className:"form-control",value:E,onChange:Y=>C(Y.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"UPI ID"}),e.jsx("input",{type:"text",className:"form-control",value:z,onChange:Y=>M(Y.target.value),form:"dealer-profile-form"})]}),e.jsx("button",{className:"btn btn-primary btn-sm",type:"submit",form:"dealer-profile-form",children:"Save Profile"})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Update Password"}),e.jsxs("form",{onSubmit:re,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Current Password"}),e.jsx("input",{type:"password",className:"form-control",value:R,onChange:Y=>W(Y.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsx("input",{type:"password",className:"form-control",value:D,onChange:Y=>te(Y.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Confirm New Password"}),e.jsx("input",{type:"password",className:"form-control",value:H,onChange:Y=>O(Y.target.value),required:!0})]}),e.jsx("button",{className:"btn btn-warning btn-sm",type:"submit",children:"Update Password"})]})]})})]}),e.jsx("datalist",{id:"country-options",children:Zi.map(Y=>e.jsx("option",{value:Y},Y))})]})}const Aw={loading:!0,error:"",data:null};function Tw(){const[t,a]=i.useState(Aw),[s,n]=i.useState("");i.useEffect(()=>{let u=!0;async function c(){try{const d=await U("/api/dashboard/dealer/plan");if(!u)return;a({loading:!1,error:"",data:d})}catch(d){u&&a({loading:!1,error:(d==null?void 0:d.message)||"Unable to load plan details.",data:null})}}return c(),()=>{u=!1}},[]);async function l(){n("");try{const u=await U("/api/dashboard/dealer/subscribe",{method:"POST",body:JSON.stringify({})});if(u!=null&&u.redirect){window.location.href=u.redirect;return}n((u==null?void 0:u.message)||"Subscription created.")}catch(u){n(""),a(c=>({...c,error:(u==null?void 0:u.message)||"Unable to create subscription."}))}}if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading plan..."})]});const r=t.data||{},o=r.dealer_name||"Agent";return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Plan"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Dealer Subscription"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Yearly Amount:"})," ",r.subscription_amount??"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Commission Rate:"})," ",r.commission_rate??0,"%"]}),e.jsx("button",{className:"btn btn-primary",type:"button",onClick:l,children:"Proceed to Bank Transfer"})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("h5",{children:["Welcome ",o]}),e.jsxs("p",{className:"text-secondary mb-0",children:["You earn ",r.commission_rate??0,"% commission on the first invoice payment from the companies you bring to our products. Please complete your subscription payment to enable your account."]})]})})]})]})}const Dw={loading:!0,error:"",data:null};function Rw(){var N;const[t,a]=i.useState(Dw),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState(1),c=20;i.useEffect(()=>{let v=!0;async function w(){try{const A=await U("/api/dashboard/dealer/billing");if(!v)return;a({loading:!1,error:"",data:A})}catch(A){v&&a({loading:!1,error:(A==null?void 0:A.message)||"Unable to load billing history.",data:null})}}return w(),()=>{v=!1}},[]),i.useEffect(()=>{const v=setTimeout(()=>{r(s.trim()),u(1)},300);return()=>clearTimeout(v)},[s]);const d=((N=t.data)==null?void 0:N.transfers)||[],h=i.useMemo(()=>{if(!l)return d;const v=l.toLowerCase();return d.filter(w=>[w.amount,w.currency,w.status_label,w.status,w.created_at,w.updated_at].some(A=>String(A||"").toLowerCase().includes(v)))},[d,l]),p=Math.max(Math.ceil(h.length/c),1),g=i.useMemo(()=>h.slice((o-1)*c,o*c),[h,o]);return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading billing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Billing"}),e.jsx("hr",{className:"section-divider"}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{children:"Subscription Billing History"}),e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",c," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dealer-billing-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dealer-billing-search",type:"text",value:s,onChange:v=>n(v.target.value),placeholder:"Search billing"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Updated"})]})}),e.jsx("tbody",{children:g.length?g.map(v=>e.jsxs("tr",{children:[e.jsxs("td",{children:[v.currency," ",v.amount]}),e.jsx("td",{children:v.status_label||v.status}),e.jsx("td",{children:v.created_at||"-"}),e.jsx("td",{children:v.updated_at||"-"})]},v.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No billing history yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",g.length?(o-1)*c+1:0," to"," ",Math.min(o*c,h.length)," of ",h.length," entries"]}),e.jsx(st,{page:o,totalPages:p,onPageChange:u,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})}const Lw={loading:!0,error:"",data:null},ai=8;function Mw(t){const a=((t==null?void 0:t.org_referrals)||[]).map(n=>({id:`org-${n.id}`,type:"ORG",referred:n.referred_org||"-",base_amount:n.base_amount??"-",commission_rate:n.commission_rate??0,commission_amount:n.commission_amount??"-",flat_amount:"-",payout_reference:n.payout_reference||"-",payout_date:n.payout_date||"-",status:String(n.status||"pending").toLowerCase()})),s=((t==null?void 0:t.dealer_referrals)||[]).map(n=>({id:`dealer-${n.id}`,type:"Agent",referred:n.referred_dealer||"-",base_amount:n.base_amount??"-",commission_rate:n.commission_rate??0,commission_amount:n.commission_amount??"-",flat_amount:n.flat_amount??"-",payout_reference:n.payout_reference||"-",payout_date:n.payout_date||"-",status:String(n.status||"pending").toLowerCase()}));return[...a,...s]}function Uw(t,a){if(!a)return t;const s=a.toLowerCase();return t.filter(n=>[n.type,n.referred,n.base_amount,n.commission_rate,n.commission_amount,n.flat_amount,n.payout_reference,n.payout_date,n.status].some(l=>String(l||"").toLowerCase().includes(s)))}function Ow(t,a,s){const n=Uw(t,a),l=Math.max(Math.ceil(n.length/ai),1),r=Math.min(s,l),o=(r-1)*ai,u=n.slice(o,o+ai);return{filtered:n,paged:u,totalPages:l,currentPage:r,startIndex:o}}function oc({title:t,rows:a,tableState:s,onStateChange:n,idKey:l}){const{filtered:r,paged:o,totalPages:u,currentPage:c,startIndex:d}=Ow(a,s.term,s.page),h=`payout-${l}-search`;return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:t}),e.jsxs("label",{className:"table-search",htmlFor:h,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:h,type:"text",value:s.term,onChange:p=>n({term:p.target.value,page:1}),placeholder:"Search payouts"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Referred"}),e.jsx("th",{children:"Base Amount"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Flat"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]})}),e.jsx("tbody",{children:o.length?o.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.type}),e.jsx("td",{children:p.referred}),e.jsx("td",{children:p.base_amount}),e.jsxs("td",{children:[p.commission_rate,"%"]}),e.jsx("td",{children:p.commission_amount}),e.jsx("td",{children:p.flat_amount}),e.jsx("td",{children:p.payout_reference}),e.jsx("td",{children:p.payout_date})]},p.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No payouts found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",r.length?d+1:0," to ",Math.min(d+ai,r.length)," of"," ",r.length," entries"]}),e.jsx(st,{page:c,totalPages:u,onPageChange:p=>n({page:p}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function $w(){const[t,a]=i.useState(Lw),[s,n]=i.useState({pending:{term:"",page:1},paid:{term:"",page:1},rejected:{term:"",page:1}});i.useEffect(()=>{let c=!0;async function d(){try{const h=await U("/api/dashboard/dealer/referrals");if(!c)return;a({loading:!1,error:"",data:h})}catch(h){c&&a({loading:!1,error:(h==null?void 0:h.message)||"Unable to load payouts.",data:null})}}return d(),()=>{c=!1}},[]);const l=i.useMemo(()=>Mw(t.data),[t.data]),r=l.filter(c=>c.status==="pending"),o=l.filter(c=>c.status==="paid"),u=l.filter(c=>c.status==="rejected");return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading payouts..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Payouts"}),e.jsx("hr",{className:"section-divider"}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsx(oc,{title:"Pending Payout Payments",rows:r,tableState:s.pending,idKey:"pending",onStateChange:c=>n(d=>({...d,pending:{...d.pending,...c}}))}),e.jsx(oc,{title:"Paid Payments",rows:o,tableState:s.paid,idKey:"paid",onStateChange:c=>n(d=>({...d,paid:{...d.paid,...c}}))}),e.jsx(oc,{title:"Payment Rejections",rows:u,tableState:s.rejected,idKey:"rejected",onStateChange:c=>n(d=>({...d,rejected:{...d.rejected,...c}}))})]})}const Iw={loading:!0,error:"",data:null};function Wa(t,a="-"){if(t==null||t==="")return a;if(typeof t=="object")try{return JSON.stringify(t)}catch{return a}return String(t)}function Fw(){var A;const{transferId:t}=js(),[a,s]=i.useState(Iw),[n,l]=i.useState(""),[r,o]=i.useState(""),[u,c]=i.useState(null),[d,h]=i.useState(!1);async function p(y){l("");try{const x=await U(`/api/dashboard/dealer/bank-transfer/${t}`);if(y&&!y.current)return;s({loading:!1,error:"",data:x})}catch(x){(!y||y.current)&&s({loading:!1,error:(x==null?void 0:x.message)||"Unable to load bank transfer details.",data:null})}}i.useEffect(()=>{const y={current:!0};return p(y),()=>{y.current=!1}},[t]);const g=((A=a.data)==null?void 0:A.transfer)||null,N=Wa(n,""),v=Wa(a.error,"");async function w(y){if(y.preventDefault(),!r.trim()){l("Please enter the reference / UTR number.");return}l(""),h(!0);try{const x=`/api/dashboard/dealer/bank-transfer/${t}/submit`,f=new FormData;f.append("reference_no",r.trim()),u&&f.append("receipt",u);const b=await fetch(x,{method:"POST",credentials:"include",headers:{"X-CSRFToken":ns()},body:f}),k=await b.json().catch(()=>null);if(!b.ok){l((k==null?void 0:k.error)||"Unable to submit payment."),h(!1);return}k!=null&&k.message&&l(k.message),k!=null&&k.redirect?window.location.href=k.redirect:await p()}catch{l("Unable to submit payment.")}finally{h(!1)}}return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading bank transfer..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Bank Transfer"}),e.jsx("p",{className:"text-secondary mb-1",children:"Submit your payment details. We will verify and activate your dealer subscription."}),e.jsx("hr",{className:"section-divider"}),N?e.jsx("div",{className:"alert alert-info",children:N}):null,v?e.jsx("div",{className:"alert alert-danger",children:v}):null,g?e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{className:"mb-3",children:"Subscription Summary"}),e.jsx("table",{className:"table table-borderless mb-0",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Agent"}),e.jsx("td",{children:Wa(g.org_name)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Plan"}),e.jsx("td",{children:Wa(g.plan_name)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Billing Cycle"}),e.jsx("td",{children:Wa(g.billing_cycle,"yearly")})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Amount"}),e.jsxs("td",{children:[Wa(g.currency,"INR")," ",Wa(g.base_amount??g.amount,"0")]})]}),g.tax_amount?e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"GST"}),e.jsxs("td",{children:[Wa(g.currency,"INR")," ",Wa(g.tax_amount,"0")]})]}):null,g.tax_amount?e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Total Payable"}),e.jsxs("td",{children:[Wa(g.currency,"INR")," ",Wa(g.total_amount,"0")]})]}):null]})})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{className:"mb-3",children:"Payment Details"}),e.jsxs("form",{onSubmit:w,children:[g.bank_account_details?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Bank Account Details"}),e.jsx("div",{className:"form-control",style:{whiteSpace:"pre-wrap"},children:g.bank_account_details})]}):null,e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Reference / UTR Number"}),e.jsx("input",{type:"text",className:"form-control",value:r,onChange:y=>o(y.target.value),placeholder:"Enter reference or UTR number",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Transaction Screenshot"}),e.jsx("input",{type:"file",className:"form-control",onChange:y=>{var x;return c(((x=y.target.files)==null?void 0:x[0])||null)}})]}),e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:d,children:d?"Submitting...":"Submit for Approval"}),e.jsx("p",{className:"text-secondary mt-3 mb-0",children:"Your account will be activated after verification."})]})]})})]}):e.jsx("div",{className:"alert alert-warning",children:"No pending transfer found."})]})}const zw={loading:!0,error:"",data:null};function Bw(){var f;const[t,a]=i.useState(zw),[s,n]=i.useState({loading:!1,loaded:!1,saving:!1,error:"",success:"",data:null,form:{is_active:!1,phone_number_id:"",access_token:"",admin_phone:"",admin_template_name:"new_user_admin_alert",user_welcome_template_name:"welcome_user_signup",template_language:"en_US",graph_api_version:"v21.0",timeout_seconds:15}}),[l,r]=i.useState({importing:!1,downloading:!1,error:"",success:"",fileName:"",payload:null}),o=ua(),{branding:u}=el();i.useEffect(()=>{let b=!0;async function k(){try{const _=await U("/api/saas-admin/overview");if(!b)return;a({loading:!1,error:"",data:_})}catch(_){b&&a({loading:!1,error:(_==null?void 0:_.message)||"Unable to load SaaS admin dashboard.",data:null})}}return k(),()=>{b=!1}},[]),i.useEffect(()=>{if(o.pathname!=="/saas-admin")return;let b=!0;async function k(){try{const P=await U("/api/saas-admin/settings/whatsapp-cloud");if(!b)return;n(S=>({...S,loading:!1,loaded:!0,data:P,error:"",success:"",form:{is_active:!!(P!=null&&P.is_active),phone_number_id:(P==null?void 0:P.phone_number_id)||"",access_token:"",admin_phone:(P==null?void 0:P.admin_phone)||"",admin_template_name:(P==null?void 0:P.admin_template_name)||"new_user_admin_alert",user_welcome_template_name:(P==null?void 0:P.user_welcome_template_name)||"welcome_user_signup",template_language:(P==null?void 0:P.template_language)||"en_US",graph_api_version:(P==null?void 0:P.graph_api_version)||"v21.0",timeout_seconds:Number((P==null?void 0:P.timeout_seconds)||15)}}))}catch(P){if(!b)return;n(S=>({...S,loading:!1,error:(P==null?void 0:P.message)||"Unable to load WhatsApp settings.",success:""}))}}k();const _=()=>{b&&window.location.pathname.endsWith("/saas-admin")&&k()};return window.addEventListener("focus",_),()=>{b=!1,window.removeEventListener("focus",_)}},[o.pathname]);const c=t.data||{},d=c.stats||{},h=y(c.products||[]).filter(b=>String((b==null?void 0:b.status)||"").toLowerCase()==="active"),p=o.hash==="#products";if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading SaaS admin..."})]});if(t.error)return e.jsx("div",{className:"alert alert-danger",children:t.error});const g=[{label:"Total Orgs",value:d.total_orgs??0,icon:"bi-building"},{label:"Total Users",value:d.total_users??0,icon:"bi-people"},{label:"Active Subs",value:d.active_subscriptions??0,icon:"bi-check2-circle"},{label:"Pending Transfers",value:d.pending_transfers??0,icon:"bi-hourglass-split"},{label:"Expiring (Monthly)",value:d.expiring_monthly??0,icon:"bi-clock"},{label:"Expiring (Yearly)",value:d.expiring_yearly??0,icon:"bi-clock-history"},{label:"MRR (INR)",value:d.mrr??0,icon:"bi-cash"},{label:"ARR (INR)",value:d.arr??0,icon:"bi-graph-up-arrow"}];async function N(){r(b=>({...b,downloading:!0,error:"",success:""}));try{const b=await fetch("/api/saas-admin/settings/setup/export",{credentials:"include"});if(!b.ok)throw new Error(`Download failed (${b.status})`);const k=await b.blob(),P=(b.headers.get("Content-Disposition")||"").match(/filename=\"?([^\";]+)\"?/i),S=(P==null?void 0:P[1])||`workzilla-saas-setup-${Date.now()}.json`,F=window.URL.createObjectURL(k),L=document.createElement("a");L.href=F,L.download=S,document.body.appendChild(L),L.click(),L.remove(),window.URL.revokeObjectURL(F),r(Q=>({...Q,downloading:!1,success:"Setup JSON downloaded.",error:""}))}catch(b){r(k=>({...k,downloading:!1,success:"",error:(b==null?void 0:b.message)||"Unable to download setup JSON."}))}}async function v(b){var _;const k=(_=b.target.files)==null?void 0:_[0];if(k)try{const P=await k.text(),S=JSON.parse(P);r(F=>({...F,fileName:k.name,payload:S,error:"",success:"Setup file loaded. Click Import to apply."}))}catch{r(S=>({...S,fileName:"",payload:null,success:"",error:"Invalid JSON file. Please choose a valid setup export."}))}finally{b.target.value=""}}async function w(){if(!l.payload){r(b=>({...b,error:"Choose a setup JSON file before import.",success:""}));return}r(b=>({...b,importing:!0,error:"",success:""}));try{const b=await U("/api/saas-admin/settings/setup/import",{method:"POST",body:JSON.stringify(l.payload)}),k=(b==null?void 0:b.imported)||{};r(_=>({..._,importing:!1,success:`Imported successfully. Products: ${k.saas_products||0}, Catalog: ${k.catalog_products||0}, Plans: ${k.plans||0}.`,error:""}))}catch(b){r(k=>({...k,importing:!1,success:"",error:(b==null?void 0:b.message)||"Setup import failed."}))}}function A(b){return(b==null?void 0:b.slug)==="monitor"?(u==null?void 0:u.tagline)||(u==null?void 0:u.description)||"Work Zilla Work Suite productivity insights.":(b==null?void 0:b.description)||"-"}function y(b){const k=new Map;b.forEach(S=>{const F=(S==null?void 0:S.slug)||(S==null?void 0:S.name),L=F?String(F).trim().toLowerCase():"";if(!L)return;const Q=k.get(L);if(!Q){k.set(L,S);return}const E=String(Q.description||Q.short_description||"").trim(),C=String(S.description||S.short_description||"").trim();if(!E&&C){k.set(L,S);return}const z=String(Q.icon||"").trim(),M=String(S.icon||"").trim();!z&&M&&k.set(L,S)});const _=Array.from(k.values());if(_.length<=1)return _;const P=new Map;return _.forEach(S=>{const F=String((S==null?void 0:S.name)||"").trim().toLowerCase();if(!F)return;const L=P.get(F);if(!L){P.set(F,S);return}const Q=x(L);x(S)>Q&&P.set(F,S)}),Array.from(P.values())}function x(b){const k=String((b==null?void 0:b.description)||(b==null?void 0:b.short_description)||"").trim(),_=String((b==null?void 0:b.icon)||"").trim();let P=0;return k&&(P+=2),_&&(P+=1),b!=null&&b.slug&&(P+=1),P}return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",id:p?"products":"overview",children:p?"Products":"SaaS Admin"}),e.jsx("hr",{className:"section-divider"}),p?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"saas-admin-kpis",children:g.map(b=>e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:`bi ${b.icon}`,"aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:b.label}),e.jsx("div",{className:"stat-value",children:b.value})]},b.label))}),e.jsxs("div",{className:"row g-3 mt-4",children:[e.jsx("div",{className:"col-12 col-xl-6",children:e.jsxs("div",{className:"p-4 h-100",children:[e.jsx("h4",{children:"Operations"}),e.jsxs("div",{className:"saas-admin-feature-grid mt-1",children:[e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-shield-check","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Retention Policy"}),e.jsx("p",{className:"text-secondary mb-3",children:"Manage retention rules and overrides."}),e.jsx(dt,{to:"/saas-admin/retention-policy",className:"btn btn-primary btn-sm",children:"Manage"})]}),e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-hdd-network","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Media Storage"}),e.jsx("p",{className:"text-secondary mb-3",children:"Configure storage targets for backups."}),e.jsx(dt,{to:"/saas-admin/storage",className:"btn btn-primary btn-sm",children:"Open"})]}),e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-cloud-download","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Org Downloads"}),e.jsx("p",{className:"text-secondary mb-3",children:"Track backup generation and downloads across orgs."}),e.jsx(dt,{to:"/saas-admin/backup-activity",className:"btn btn-primary btn-sm",children:"View Activity"})]}),e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-hdd-stack","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"System Backup Manager"}),e.jsx("p",{className:"text-secondary mb-3",children:"PostgreSQL + project backup to Google Drive with scheduler."}),e.jsx(dt,{to:"/saas-admin/system-backup-manager",className:"btn btn-primary btn-sm",children:"Open"})]}),e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-cpu","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Server Monitoring"}),e.jsx("p",{className:"text-secondary mb-3",children:"Track CPU, RAM, disk, and uptime across servers."}),e.jsx(dt,{to:"/saas-admin/server-monitoring",className:"btn btn-primary btn-sm",children:"Open"})]}),e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-download","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"SaaS Setup"}),e.jsx("p",{className:"text-secondary mb-2",children:"Export/import Products, Plans, and Website Theme settings."}),e.jsxs("div",{className:"d-flex flex-wrap gap-2 mb-2",children:[e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:N,disabled:l.downloading,children:e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"bi bi-download me-1","aria-hidden":"true"}),l.downloading?"Downloading...":"Download"]})}),e.jsxs("label",{className:"btn btn-outline-light btn-sm mb-0",title:"Choose Setup File","aria-label":"Choose Setup File",children:[e.jsx("i",{className:"bi bi-folder2-open","aria-hidden":"true"}),e.jsx("input",{type:"file",accept:"application/json,.json",onChange:v,hidden:!0})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:w,disabled:l.importing||!l.payload,title:"Import Setup","aria-label":"Import Setup",children:l.importing?e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):e.jsx("i",{className:"bi bi-upload","aria-hidden":"true"})})]}),l.fileName?e.jsxs("div",{className:"small text-secondary mb-1",children:["Selected: ",l.fileName]}):null,l.success?e.jsx("div",{className:"small text-success",children:l.success}):null,l.error?e.jsx("div",{className:"small text-danger",children:l.error}):null]}),e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-whatsapp","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"WhatsApp Cloud API"}),e.jsx("p",{className:"text-secondary mb-2",children:"Configure Meta WhatsApp signup alerts and welcome templates."}),e.jsxs("div",{className:"d-flex flex-wrap gap-2 mb-2",children:[e.jsx(dt,{to:"/saas-admin/whatsapp-cloud",className:"btn btn-primary btn-sm",children:"Configure"}),(f=s.data)!=null&&f.is_active?e.jsx("span",{className:"badge bg-success align-self-center",children:"Active"}):e.jsx("span",{className:"badge bg-secondary align-self-center",children:"Inactive"})]})]})]})]})}),e.jsx("div",{className:"col-12 col-xl-6",children:e.jsxs("div",{className:"p-4 h-100",children:[e.jsx("h4",{children:"Org Admin Common Features"}),e.jsxs("div",{className:"saas-admin-feature-grid mt-1",children:[e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-cloud-download","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Org Downloads"}),e.jsx("p",{className:"text-secondary mb-3",children:"View organization backup history and exports."}),e.jsx(dt,{to:"/saas-admin/backup-activity",className:"btn btn-primary btn-sm",children:"Open"})]}),e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-shield-check","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Retention Policy"}),e.jsx("p",{className:"text-secondary mb-3",children:"Manage global retention rules for all orgs."}),e.jsx(dt,{to:"/saas-admin/retention-policy",className:"btn btn-primary btn-sm",children:"Manage"})]}),e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-hdd-network","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Storage Settings"}),e.jsx("p",{className:"text-secondary mb-3",children:"Configure screenshot storage targets."}),e.jsx(dt,{to:"/saas-admin/storage",className:"btn btn-primary btn-sm",children:"Open"})]}),e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-images","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Media Library"}),e.jsx("p",{className:"text-secondary mb-3",children:"Browse and manage stored media files."}),e.jsx(dt,{to:"/org-admin/media-library",className:"btn btn-primary btn-sm",children:"Open"})]}),e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-receipt","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Billing"}),e.jsx("p",{className:"text-secondary mb-3",children:"Review org billing and renewals."}),e.jsx(dt,{to:"/saas-admin/billing",className:"btn btn-primary btn-sm",children:"Open"})]})]})]})})]})]}),e.jsxs("div",{className:`card p-4 ${p?"":"mt-4"}`,id:"products",children:[p?null:e.jsx("h4",{children:"Products"}),e.jsx("div",{className:"row g-3 mt-1",children:h.map(b=>e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:`bi ${b.icon||"bi-grid"}`,"aria-hidden":"true"})}),e.jsx("h5",{className:"mb-0",children:b.name})]}),e.jsx("p",{className:"text-secondary mb-2",children:A(b)}),e.jsxs("div",{className:"text-secondary mb-3",children:["Active Orgs: ",b.active_orgs??0]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[b.status==="active"?e.jsx("span",{className:"badge bg-success",children:"Active"}):b.status==="disabled"?e.jsx("span",{className:"badge bg-secondary",children:"Disabled"}):e.jsx("span",{className:"badge bg-warning text-dark",children:"Coming soon"}),e.jsx(dt,{to:`/saas-admin/products/${b.slug}`,className:"btn btn-primary btn-sm",children:"Open"})]})]})},b.id))})]})]})}function bl(t,a,s,n){const l=Number(t),r=Number(a),o=Number(s),u=Number(n);return!Number.isFinite(l)||l<=0||!Number.isFinite(r)||r<=0||!Number.isFinite(o)||o<0||!Number.isFinite(u)||u<=0?null:{costInr:l*r/1e3*o*u,tokensPerReply:r,usdPer1k:o,usdToInr:u}}async function Ww({days:t=7,org_id:a=null,product:s=null}={}){const n=new URLSearchParams;t&&n.set("days",String(t)),a&&n.set("org_id",String(a)),s&&n.set("product",s);const l=await fetch(`/api/saas-admin/observability/summary?${n.toString()}`,{credentials:"include"});if(l.status===401){typeof window<"u"&&window.location.assign("/auth/login/");const u=new Error("Unauthorized");throw u.status=401,u}if(l.status===403){const u=new Error("Not authorized");throw u.status=403,u}const r=await l.text();let o=null;if(r)try{o=JSON.parse(r)}catch{o=null}if(!l.ok){const u=(o==null?void 0:o.error)||`Request failed (${l.status})`,c=new Error(u);throw c.status=l.status,c.data=o,c}return o}const Vw={loading:!0,error:"",data:null},jl=[{key:"agent_activity_upload",label:"Activity uploads",icon:"bi-upload"},{key:"agent_screenshot_upload",label:"Screenshot uploads",icon:"bi-camera"},{key:"agent_org_settings",label:"Org settings hits",icon:"bi-gear"},{key:"agent_rate_limited",label:"Rate limited hits",icon:"bi-slash-circle"},{key:"renew_submitted",label:"Renew submitted",icon:"bi-arrow-repeat"},{key:"transfer_approved",label:"Transfer approved",icon:"bi-check2-circle"},{key:"subscription_expired",label:"Subscription expired",icon:"bi-x-circle"}],Gw=[7,14,30];function $r(t){return t==null?0:Number(t).toLocaleString()}function Wb({initialProduct:t="worksuite",initialOrgId:a="all",initialDays:s=7,showTitle:n=!0}){const[l,r]=i.useState(Vw),[o,u]=i.useState({days:s,orgId:a,product:t}),[c,d]=i.useState(0),[h,p]=i.useState(!1);i.useEffect(()=>{let f=!0;async function b(){r(k=>({...k,loading:!0,error:""}));try{const k=o.product==="worksuite"?"monitor":o.product,_=await Ww({days:o.days,org_id:o.orgId==="all"?null:o.orgId,product:k==="all"?null:k});if(!f)return;r({loading:!1,error:"",data:_})}catch(k){if(!f)return;r({loading:!1,error:(k==null?void 0:k.message)||"Unable to load observability summary.",data:null})}}return b(),()=>{f=!1}},[o,c]),i.useEffect(()=>{if(!h)return;const f=setInterval(()=>{d(b=>b+1)},6e4);return()=>clearInterval(f)},[h]);const g=l.data||{},N=g.totals||{},v=g.orgs||[],w=g.products||[],A=g.by_day||[],y=g.pending_transfers||[],x=i.useMemo(()=>A.map(f=>{const b=f.counts||{};return{date:f.date,counts:jl.reduce((k,_)=>(k[_.key]=b[_.key]??0,k),{})}}),[A]);return l.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading observability summary..."})]}):l.error?e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"alert alert-danger mb-3",children:l.error}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>d(f=>f+1),children:"Retry"})]}):e.jsxs(e.Fragment,{children:[n?e.jsx("h3",{className:"page-title",children:"Observability"}):null,e.jsxs("div",{className:"observability-filters mt-3",children:[e.jsxs("label",{className:"filter-field",children:[e.jsx("span",{children:"Organization"}),e.jsxs("select",{value:o.orgId,onChange:f=>u(b=>({...b,orgId:f.target.value})),children:[e.jsx("option",{value:"all",children:"All"}),v.map(f=>e.jsx("option",{value:String(f.id),children:f.name},f.id))]})]}),e.jsxs("label",{className:"filter-field",children:[e.jsx("span",{children:"Product"}),e.jsxs("select",{value:o.product,onChange:f=>u(b=>({...b,product:f.target.value})),children:[e.jsx("option",{value:"all",children:"All"}),w.map(f=>e.jsx("option",{value:f,children:f},f))]})]}),e.jsxs("label",{className:"filter-field",children:[e.jsx("span",{children:"Days"}),e.jsx("select",{value:o.days,onChange:f=>u(b=>({...b,days:Number(f.target.value)})),children:Gw.map(f=>e.jsxs("option",{value:f,children:[f," days"]},f))})]}),e.jsx("button",{type:"button",className:"btn btn-primary observability-refresh",onClick:()=>d(f=>f+1),children:"Refresh"}),e.jsxs("label",{className:"form-check observability-autorefresh",htmlFor:"observability-auto-refresh",children:[e.jsx("input",{id:"observability-auto-refresh",className:"form-check-input",type:"checkbox",checked:h,onChange:f=>p(f.target.checked)}),e.jsx("span",{className:"form-check-label",children:"Auto-refresh (60s)"})]})]}),e.jsx("div",{className:"observability-kpis mt-3",children:jl.map(f=>e.jsxs("div",{className:"stat-card card p-3 h-100",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:`bi ${f.icon}`,"aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:f.label}),e.jsx("div",{className:"stat-value",children:$r(N[f.key]??0)})]},f.key))}),e.jsxs("div",{className:"row g-3 mt-3",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{className:"mb-0",children:"Daily Breakdown"}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),jl.map(f=>e.jsx("th",{children:f.label},f.key))]})}),e.jsx("tbody",{children:x.length?x.map(f=>e.jsxs("tr",{children:[e.jsx("td",{children:f.date}),jl.map(b=>e.jsx("td",{children:$r(f.counts[b.key]||0)},`${f.date}-${b.key}`))]},f.date)):e.jsx("tr",{children:e.jsx("td",{colSpan:jl.length+1,children:"No metrics found."})})})]})})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("h5",{className:"mb-0",children:"Pending Approvals"}),e.jsx("span",{className:"badge bg-warning text-dark",children:$r(y.reduce((f,b)=>f+(b.count||0),0))})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Org"}),e.jsx("th",{children:"Pending Transfers"}),e.jsx("th",{children:"Link"})]})}),e.jsx("tbody",{children:y.length?y.map(f=>e.jsxs("tr",{children:[e.jsx("td",{children:f.org_name}),e.jsx("td",{children:$r(f.count)}),e.jsx("td",{children:e.jsx(dt,{className:"btn btn-outline-light btn-sm",to:`/saas-admin/transfers?org_id=${f.org_id}`,children:"View"})})]},f.org_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",children:"No pending transfers."})})})]})})]})})]})]})}const Va={loading:!0,error:"",data:null},Pf={tokensPerReply:300,usdPer1k:.002,usdToInr:85,warnHighInr:500,warnVeryHighInr:2e3},rn=[{slug:"crm",label:"CRM"},{slug:"hrm",label:"HR Management"},{slug:"projects",label:"Project Management"},{slug:"accounts",label:"Accounts / ERP"},{slug:"ticketing",label:"Ticketing System"},{slug:"stocks",label:"Stocks Management"}];function cc(t){const a=String(t||"").trim().toLowerCase();return a.includes("free")?["crm","hrm","projects","accounts"]:a.includes("starter")?["crm","hrm","projects","accounts"]:a.includes("growth")?rn.map(s=>s.slug):a.includes("pro")?rn.map(s=>s.slug):rn.map(s=>s.slug)}function Oe(t){return t==null||t===""?"-":t}function Sa(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}function Ef(){var Qu,Ju,Ku,Yu,Zu,Xu,em,tm,am,sm,nm,lm,rm,im,om,cm,dm,um,mm,hm,pm,fm,gm,xm,bm,jm,ym,vm,Nm,_m,Sm,wm,km,Cm,Pm,Em,Am,Tm,Dm,Rm,Lm,Mm,Um,Om,$m,Im,Fm,zm,Bm,Wm,Vm,Gm,Hm,qm,Qm,Jm,Km,Ym,Zm,Xm,eh,th,ah,sh,nh,lh,rh,ih,oh,ch,dh,uh,mh,hh,ph,fh,gh,xh,bh,jh,yh,vh,Nh,_h,Sh,wh,kh,Ch,Ph,Eh,Ah,Th,Dh,Rh,Lh,Mh,Uh,Oh,$h,Ih,Fh,zh;const{slug:t}=js(),a=ua(),s=ys(),{branding:n}=el(),[l,r]=i.useState(Va),[o,u]=i.useState("organizations"),[c,d]=i.useState(Va),[h,p]=i.useState("org"),[g,N]=i.useState("active"),[v,w]=i.useState("active"),[A,y]=i.useState({org:{active:{term:"",page:1},inactive:{term:"",page:1},expired:{term:"",page:1},deleted:{term:"",page:1}},dealer:{active:{term:"",page:1},inactive:{term:"",page:1},expired:{term:"",page:1},deleted:{term:"",page:1}}}),[x,f]=i.useState(Va),[b,k]=i.useState(""),[_,P]=i.useState(""),[S,F]=i.useState(1),[L,Q]=i.useState(Va),[E,C]=i.useState({open:!1,mode:"create",form:{},error:"",fieldErrors:{},loading:!1,planId:null}),[z,M]=i.useState(()=>{try{const m=window.localStorage.getItem("wz_ai_cost_assumptions");if(m)return{...Pf,...JSON.parse(m)}}catch{}return Pf}),[R,W]=i.useState(!1);function D(m){var oe;const j=(oe=E.fieldErrors)==null?void 0:oe[m];if(!j)return null;const $=Array.isArray(j)?j.join(", "):j;return e.jsx("div",{className:"text-danger small",children:$})}i.useEffect(()=>{try{window.localStorage.setItem("wz_ai_cost_assumptions",JSON.stringify(z))}catch{}},[z]);function te(m){const j=Number(m);if(!Number.isFinite(j)||j<=0)return null;const $=Number(z.tokensPerReply),oe=Number(z.usdPer1k),$e=Number(z.usdToInr);return bl(j,$,oe,$e)}const[H,O]=i.useState(Va),[V,re]=i.useState("org"),[Y,ce]=i.useState(""),[ie,ee]=i.useState(""),[T,Z]=i.useState(1),[se,be]=i.useState(Va),[ne,ae]=i.useState("approved"),[X,ke]=i.useState("org"),[Ne,Ye]=i.useState(""),[Ke,mt]=i.useState(""),[Ie,Xe]=i.useState(1),[nt,Ae]=i.useState(Va),[ue,je]=i.useState("upcoming"),[Ce,Le]=i.useState("monthly"),[Fe,ye]=i.useState(""),[Ze,pt]=i.useState(""),[ht,Ge]=i.useState(1),[gt,ft]=i.useState(Va),[G,Se]=i.useState(""),[ve,le]=i.useState(""),[xe,ge]=i.useState(1),[B,he]=i.useState(""),[we,I]=i.useState(""),[me,Me]=i.useState(1),[De,et]=i.useState(Va),[Qe,bt]=i.useState("org"),[ot,Xt]=i.useState({org:{pending:{term:"",page:1},paid:{term:"",page:1},rejected:{term:"",page:1}},dealer:{pending:{term:"",page:1},paid:{term:"",page:1},rejected:{term:"",page:1}}}),[Wt,Vt]=i.useState(Va),[kt,J]=i.useState(Va),[_e,K]=i.useState(7),[We,Be]=i.useState(""),[ct,lt]=i.useState(new Date().getFullYear()),[St,$t]=i.useState(new Date().getMonth()+1),[q,pe]=i.useState({open:!1,loading:!1,error:"",org:null,rows:[]}),[Re,vt]=i.useState({loading:!1,error:"",data:null,form:{api_key:"",model:"gpt-4o-mini",input_cost_per_1k_tokens_inr:"",output_cost_per_1k_tokens_inr:"",fixed_markup_percent:"",is_active:!0},saved:""}),[xa,de]=i.useState({loading:!1,message:"",ok:null}),[Pe,Te]=i.useState({open:!1,loading:!1,data:null,error:""}),[Je,fe]=i.useState({open:!1,loading:!1,data:null,error:"",clearing:!1,receiptPreview:""}),[Ue,at]=i.useState({open:!1,url:"",transferId:null,clearing:!1}),[qe,rl]=i.useState({open:!1,title:"",details:{}}),[_a,vs]=i.useState({open:!1,row:null,type:"org",note:"",error:"",saving:!1}),[Nt,Ht]=i.useState({open:!1,loading:!1,data:null,error:"",form:{}}),[Ut,Xi]=i.useState({open:!1,row:null}),[za,il]=i.useState({open:!1,loading:!1,data:null,error:""}),[ma,Ta]=i.useState({open:!1,loading:!1,data:null,error:"",form:{}}),jt=10;i.useEffect(()=>{const m=(a.hash||"").replace("#","").trim();u(m||"organizations")},[a.hash,a.pathname,t]),i.useEffect(()=>{let m=!0;async function j(){try{const $=await U(`/api/saas-admin/products/${t}`);if(!m)return;r({loading:!1,error:"",data:$})}catch($){m&&r({loading:!1,error:($==null?void 0:$.message)||"Unable to load product dashboard.",data:null})}}return j(),()=>{m=!1}},[t]);async function gu(){const m=await U(`/api/saas-admin/products/${t}/organizations`);d({loading:!1,error:"",data:m})}async function xu(){const m=await U(`/api/saas-admin/products/${t}/users`);f({loading:!1,error:"",data:m})}async function eo(){const m=t==="storage"||t==="online-storage"?await U("/api/saas-admin/storage/plan"):await U(`/api/saas-admin/plans?product=${t}`);Q({loading:!1,error:"",data:m})}async function to(){const m=await U(`/api/saas-admin/products/${t}/pending-transfers`);O({loading:!1,error:"",data:m})}async function ao(){const m=await U(`/api/saas-admin/products/${t}/transfer-history`);be({loading:!1,error:"",data:m})}async function Vb(){const m=await U(`/api/saas-admin/products/${t}/billing-history`);ft({loading:!1,error:"",data:m})}async function bu(){const m=await U(`/api/saas-admin/products/${t}/referrals`);et({loading:!1,error:"",data:m})}async function Gb(){const m=new URLSearchParams;m.set("days",String(_e)),m.set("year",String(ct)),m.set("month",String(St)),We&&m.set("org_id",We);const j=await U(`/api/saas-admin/ai-chatbot/usage/summary?${m.toString()}`);J({loading:!1,error:"",data:j})}async function Hb(m){if(m!=null&&m.org_id){pe({open:!0,loading:!0,error:"",org:m,rows:[]});try{const j=new URLSearchParams;j.set("org_id",String(m.org_id)),j.set("months","6");const $=await U(`/api/saas-admin/ai-chatbot/usage/trend?${j.toString()}`);pe(oe=>({...oe,loading:!1,error:"",rows:$.trend||[]}))}catch(j){pe($=>({...$,loading:!1,error:(j==null?void 0:j.message)||"Unable to load usage trend."}))}}}async function ju(){vt(m=>({...m,loading:!0,error:""}));try{const m=await U("/api/saas-admin/ai-chatbot/openai/settings");vt(j=>({...j,loading:!1,error:"",data:m,form:{api_key:"",model:m.model||"gpt-4o-mini",input_cost_per_1k_tokens_inr:m.input_cost_per_1k_tokens_inr??"",output_cost_per_1k_tokens_inr:m.output_cost_per_1k_tokens_inr??"",fixed_markup_percent:m.fixed_markup_percent??"",is_active:!!m.is_active},saved:m.updated_at||""}))}catch(m){vt(j=>({...j,loading:!1,error:(m==null?void 0:m.message)||"Unable to load OpenAI settings."}))}}async function qb(){vt(m=>({...m,loading:!0,error:""}));try{const m={api_key:Re.form.api_key,model:Re.form.model,input_cost_per_1k_tokens_inr:Number(Re.form.input_cost_per_1k_tokens_inr||0),output_cost_per_1k_tokens_inr:Number(Re.form.output_cost_per_1k_tokens_inr||0),fixed_markup_percent:Number(Re.form.fixed_markup_percent||0),is_active:!!Re.form.is_active},j=await U("/api/saas-admin/ai-chatbot/openai/settings",{method:"POST",body:JSON.stringify(m)});vt($=>({...$,loading:!1,error:"",data:j,form:{...$.form,api_key:"",model:j.model||$.form.model,input_cost_per_1k_tokens_inr:j.input_cost_per_1k_tokens_inr??$.form.input_cost_per_1k_tokens_inr,output_cost_per_1k_tokens_inr:j.output_cost_per_1k_tokens_inr??$.form.output_cost_per_1k_tokens_inr,fixed_markup_percent:j.fixed_markup_percent??$.form.fixed_markup_percent,is_active:!!j.is_active},saved:j.updated_at||new Date().toISOString()}))}catch(m){vt(j=>({...j,loading:!1,error:(m==null?void 0:m.message)||"Unable to save OpenAI settings."}))}}async function Qb(){de({loading:!0,message:"",ok:null});try{const m={api_key:Re.form.api_key,model:Re.form.model},j=await U("/api/saas-admin/ai-chatbot/openai/test",{method:"POST",body:JSON.stringify(m)});de({loading:!1,message:`Connection OK (${j.model||"model"})`,ok:!0})}catch(m){de({loading:!1,message:(m==null?void 0:m.message)||"Connection failed.",ok:!1})}}i.useEffect(()=>{let m=!0;async function j(){try{const $=await U(`/api/saas-admin/products/${t}/organizations`);m&&d({loading:!1,error:"",data:$})}catch($){m&&d({loading:!1,error:($==null?void 0:$.message)||"Unable to load organizations.",data:null})}}return j(),()=>{m=!1}},[t]),i.useEffect(()=>{let m=!0;async function j(){try{const $=await U(`/api/saas-admin/products/${t}/users`);m&&f({loading:!1,error:"",data:$})}catch($){m&&f({loading:!1,error:($==null?void 0:$.message)||"Unable to load users.",data:null})}}return j(),()=>{m=!1}},[t]),i.useEffect(()=>{let m=!0;async function j(){try{const $=t==="storage"||t==="online-storage"?await U("/api/saas-admin/storage/plan"):await U(`/api/saas-admin/plans?product=${t}`);m&&Q({loading:!1,error:"",data:$})}catch($){m&&Q({loading:!1,error:($==null?void 0:$.message)||"Unable to load plans.",data:null})}}return j(),()=>{m=!1}},[t]),i.useEffect(()=>{let m=!0;async function j(){try{const $=await U(`/api/saas-admin/products/${t}/pending-transfers`);m&&O({loading:!1,error:"",data:$})}catch($){m&&O({loading:!1,error:($==null?void 0:$.message)||"Unable to load pending transfers.",data:null})}}return j(),()=>{m=!1}},[t]),i.useEffect(()=>{let m=!0;async function j(){try{const $=await U(`/api/saas-admin/products/${t}/transfer-history`);m&&be({loading:!1,error:"",data:$})}catch($){m&&be({loading:!1,error:($==null?void 0:$.message)||"Unable to load transfer history.",data:null})}}return j(),()=>{m=!1}},[t]),i.useEffect(()=>{let m=!0;async function j(){try{const $=await U(`/api/saas-admin/products/${t}/renewals`);m&&Ae({loading:!1,error:"",data:$})}catch($){m&&Ae({loading:!1,error:($==null?void 0:$.message)||"Unable to load renewals.",data:null})}}return j(),()=>{m=!1}},[t]),i.useEffect(()=>{let m=!0;async function j(){try{const $=await U(`/api/saas-admin/products/${t}/billing-history`);m&&ft({loading:!1,error:"",data:$})}catch($){m&&ft({loading:!1,error:($==null?void 0:$.message)||"Unable to load billing history.",data:null})}}return j(),()=>{m=!1}},[t]),i.useEffect(()=>{let m=!0;async function j(){try{const $=await U(`/api/saas-admin/products/${t}/referrals`);m&&et({loading:!1,error:"",data:$})}catch($){m&&et({loading:!1,error:($==null?void 0:$.message)||"Unable to load referrals.",data:null})}}return j(),()=>{m=!1}},[t]),i.useEffect(()=>{let m=!0;async function j(){try{const $=await U(`/api/saas-admin/products/${t}/support-access`);m&&Vt({loading:!1,error:"",data:$})}catch($){m&&Vt({loading:!1,error:($==null?void 0:$.message)||"Unable to load support access.",data:null})}}return j(),()=>{m=!1}},[t]),i.useEffect(()=>{const m=setTimeout(()=>{ee(Y.trim()),Z(1)},300);return()=>clearTimeout(m)},[Y]),i.useEffect(()=>{const m=setTimeout(()=>{mt(Ne.trim()),Xe(1)},300);return()=>clearTimeout(m)},[Ne]),i.useEffect(()=>{const m=setTimeout(()=>{pt(Fe.trim()),Ge(1)},300);return()=>clearTimeout(m)},[Fe]),i.useEffect(()=>{const m=setTimeout(()=>{le(G.trim()),ge(1)},300);return()=>clearTimeout(m)},[G]),i.useEffect(()=>{const m=setTimeout(()=>{I(B.trim()),Me(1)},300);return()=>clearTimeout(m)},[B]),i.useEffect(()=>{const m=setTimeout(()=>{P(b.trim()),F(1)},300);return()=>clearTimeout(m)},[b]);const so=((Qu=c.data)==null?void 0:Qu.organizations)||[],Jb=((Ju=c.data)==null?void 0:Ju.plans)||((Ku=L.data)==null?void 0:Ku.plans)||[],Kb=((Yu=c.data)==null?void 0:Yu.deleted_orgs)||[],yu=((Zu=c.data)==null?void 0:Zu.dealers)||[],Yb=((Xu=c.data)==null?void 0:Xu.deleted_dealers)||[],Zb=i.useMemo(()=>Hj(so),[so]),Xb=i.useMemo(()=>qj(yu),[yu]),no=((em=x.data)==null?void 0:em.users)||[],ol=i.useMemo(()=>{if(!_)return no;const m=_.toLowerCase();return no.filter(j=>[j.name,j.email,j.org_name,j.device_id,j.pc_name,j.device_count,j.total_utilized_space,j.monthly_consumed_bandwidth].some($=>String($||"").toLowerCase().includes(m)))},[no,_]),ej=Math.max(Math.ceil(ol.length/jt),1),cr=i.useMemo(()=>ol.slice((S-1)*jt,S*jt),[ol,S]),vu=((tm=L.data)==null?void 0:tm.plans)||[],tj=((am=H.data)==null?void 0:am.org_transfers)||[],aj=((sm=H.data)==null?void 0:sm.dealer_transfers)||[],lo=V==="dealer"?aj:tj,sj=V==="dealer"?"Dealer":"Organization",xn=i.useMemo(()=>{if(!ie)return lo;const m=ie.toLowerCase();return lo.filter(j=>[j.organization,j.plan,j.request_type,j.billing_cycle,j.amount,j.currency,j.created_at].some($=>String($||"").toLowerCase().includes(m)))},[lo,ie]),nj=Math.max(Math.ceil(xn.length/jt),1),Nu=i.useMemo(()=>xn.slice((T-1)*jt,T*jt),[xn,T]),_u=((nm=se.data)==null?void 0:nm.transfers)||[],ro=i.useMemo(()=>_u.filter(m=>m.status===ne),[_u,ne]),io=i.useMemo(()=>X==="dealer"?ro.filter(m=>m.request_type==="dealer"):ro.filter(m=>m.request_type!=="dealer"),[ro,X]),bn=i.useMemo(()=>{if(!Ke)return io;const m=Ke.toLowerCase();return io.filter(j=>[j.organization,j.plan,j.request_type,j.billing_cycle,j.amount,j.currency,j.updated_at].some($=>String($||"").toLowerCase().includes(m)))},[io,Ke]),lj=Math.max(Math.ceil(bn.length/jt),1),Su=i.useMemo(()=>bn.slice((Ie-1)*jt,Ie*jt),[bn,Ie]),oo=nt.data||{},rj=oo.upcoming||[],ij=oo.missed||[],oj=oo.deleted||[],co=ue==="missed"?ij:ue==="deleted"?oj:rj,jn=i.useMemo(()=>{const m=ue==="deleted"||Ce==="all"?co:co.filter($=>$.billing_cycle===Ce);if(!Ze)return m;const j=Ze.toLowerCase();return m.filter($=>(ue==="deleted"?[$.organization_name,$.owner_username,$.owner_email,$.reason,$.deleted_at]:[$.organization,$.owner_name,$.owner_email,$.plan,$.billing_cycle,$.end_date,$.status,$.days_remaining,$.days_overdue]).some($e=>String($e||"").toLowerCase().includes(j)))},[co,Ze,ue,Ce]),cj=Math.max(Math.ceil(jn.length/jt),1),dr=i.useMemo(()=>jn.slice((ht-1)*jt,ht*jt),[jn,ht]),wu=gt.data||{},ku=wu.transfers||[],Cu=wu.subscriptions||[],dj=i.useMemo(()=>Sn(ku,ve,xe,(j,$)=>{if(!$)return j;const oe=$.toLowerCase();return j.filter($e=>[$e.organization,$e.owner_name,$e.owner_email,$e.request_type,$e.billing_cycle,$e.plan,$e.amount,$e.currency,$e.status,$e.paid_on,$e.reference_no,$e.created_at,$e.updated_at].some(it=>String(it||"").toLowerCase().includes(oe)))}),[ku,ve,xe]),uj=i.useMemo(()=>Sn(Cu,we,me,(j,$)=>{if(!$)return j;const oe=$.toLowerCase();return j.filter($e=>[$e.organization,$e.plan,$e.status,$e.billing_cycle,$e.start_date,$e.end_date,$e.created_at,$e.user_name,$e.user_email].some(it=>String(it||"").toLowerCase().includes(oe)))}),[Cu,we,me]),{filtered:uo,paged:Pu,totalPages:mj,currentPage:hj,startIndex:Eu}=dj,{filtered:mo,paged:Au,totalPages:pj,currentPage:fj,startIndex:Tu}=uj,Du=De.data||{},gj=Du.org_referrals||[],xj=Du.dealer_referrals||[],Ru=Qe==="dealer"?xj:gj,yn=i.useMemo(()=>Qj(Ru),[Ru]),Lu=((lm=Wt.data)==null?void 0:lm.rows)||[],vn=((rm=kt.data)==null?void 0:rm.totals)||{},Mu=((im=kt.data)==null?void 0:im.top_orgs)||[],Uu=((om=kt.data)==null?void 0:om.alerts)||[],Ou=((cm=kt.data)==null?void 0:cm.period)||"",ur=Number(z.usdPer1k),Nn=Number(z.tokensPerReply),mr=Number(z.usdToInr),$u=Number(vn.tokens_total??0),ho=Number(vn.ai_replies_used??0),Js=Number(vn.ai_replies_limit??0),po=Js?Math.round(ho/Js*100):0,fo=$u>0?bl($u/Nn,Nn,ur,mr):null,go=ho>0?bl(ho,Nn,ur,mr):null,bj=Number(vn.cost_inr_est??0)||(fo==null?void 0:fo.costInr)||(go==null?void 0:go.costInr)||0,_n=Js&&po>=100?{level:"danger",message:"AI usage limit reached. Upgrade plan to continue."}:Js&&po>=80?{level:"warning",message:"AI usage is above 80% for this org."}:null,xo=new Date().getFullYear(),jj=[xo-1,xo,xo+1],yj=Array.from({length:12},(m,j)=>j+1),bo=((dm=Re.data)==null?void 0:dm.api_key_masked)||"",Iu=!!(bo||Re.form.api_key),jo=l.data||{},Ks=jo.product||{},hr=(Ks==null?void 0:Ks.slug)||t,la=hr==="ai-chatbot",ea=hr==="storage"||hr==="online-storage",Fu=hr==="business-autopilot-erp",cl=jo.stats||{},zu=jo.monthly_sales||{},Bu=zu.INR??0,Wu=zu.USD??0,vj=Wu?`INR ${Bu} / USD ${Wu}`:`INR ${Bu}`,Nj=[{label:"Total Orgs",value:cl.total??0,icon:"bi-building"},{label:"Active Orgs",value:cl.active??0,icon:"bi-check2-circle"},{label:"Trial Orgs",value:cl.trial??0,icon:"bi-clock"},{label:"Inactive Orgs",value:cl.inactive??0,icon:"bi-slash-circle"},{label:"Pending Approvals",value:cl.pending_approvals??0,icon:"bi-hourglass-split"},{label:"Monthly Sales (30d)",value:vj,icon:"bi-cash-stack"}];i.useEffect(()=>{if(!la||o!=="ai-usage")return;let m=!0;async function j(){try{const $=new URLSearchParams;$.set("days",String(_e)),$.set("year",String(ct)),$.set("month",String(St)),We&&$.set("org_id",We);const oe=await U(`/api/saas-admin/ai-chatbot/usage/summary?${$.toString()}`);m&&J({loading:!1,error:"",data:oe})}catch($){m&&J({loading:!1,error:($==null?void 0:$.message)||"Unable to load AI usage.",data:null})}}return J($=>({...$,loading:!0,error:""})),j(),()=>{m=!1}},[o,_e,We,ct,St,la]),i.useEffect(()=>{!la||o!=="openai-settings"||ju()},[o,la]);function _j(m,j){return j==="monitor"?(n==null?void 0:n.tagline)||(n==null?void 0:n.description)||"Work Zilla Work Suite productivity insights.":m||"-"}async function Sj(m){Te({open:!0,loading:!0,data:null,error:""});try{const j=await U(`/api/saas-admin/organizations/${m}`);Te({open:!0,loading:!1,data:j,error:""})}catch(j){Te({open:!0,loading:!1,data:null,error:(j==null?void 0:j.message)||"Unable to load organization."})}}async function wj(m){fe({open:!0,loading:!0,data:null,error:"",clearing:!1,receiptPreview:""});try{const j=await U(`/api/saas-admin/products/${t}/pending-transfers/${m}`);fe({open:!0,loading:!1,data:j,error:"",clearing:!1,receiptPreview:""})}catch(j){fe({open:!0,loading:!1,data:null,error:(j==null?void 0:j.message)||"Unable to load transfer details.",clearing:!1,receiptPreview:""})}}async function kj(m){if(await s({title:"Clear Receipt",message:"Delete the uploaded receipt image?",confirmText:"Delete",confirmVariant:"danger"})){fe($=>({...$,clearing:!0}));try{await U(`/api/saas-admin/products/${t}/pending-transfers/${m}/receipt-clear`,{method:"POST"}),await to();const $=await U(`/api/saas-admin/products/${t}/pending-transfers/${m}`);fe({open:!0,loading:!1,data:$,error:"",clearing:!1})}catch($){fe(oe=>({...oe,clearing:!1,error:($==null?void 0:$.message)||"Unable to clear receipt."}))}}}async function Cj(m){if(await s({title:"Delete Attachment",message:"Delete the uploaded receipt image?",confirmText:"Delete",confirmVariant:"danger"}))try{await U(`/api/saas-admin/products/${t}/pending-transfers/${m}/receipt-clear`,{method:"POST"}),await ao()}catch($){be(oe=>({...oe,error:($==null?void 0:$.message)||"Unable to clear attachment."}))}}async function Pj(){if(!(!Ue.transferId||!await s({title:"Clear Receipt",message:"Delete the uploaded receipt image?",confirmText:"Delete",confirmVariant:"danger"}))){at(j=>({...j,clearing:!0}));try{await U(`/api/saas-admin/products/${t}/pending-transfers/${Ue.transferId}/receipt-clear`,{method:"POST"}),await to(),await ao(),at({open:!1,url:"",transferId:null,clearing:!1})}catch(j){at($=>({...$,clearing:!1})),O($=>({...$,error:(j==null?void 0:j.message)||"Unable to clear receipt."}))}}}async function Ej(m){var j,$;Ht({open:!0,loading:!0,data:null,error:"",form:{}});try{const oe=await U(`/api/saas-admin/organizations/${m}`),$e=oe.owner||{},it=oe.subscription||{},At={name:((j=oe.organization)==null?void 0:j.name)||"",company_key:(($=oe.organization)==null?void 0:$.company_key)||"",owner_username:$e.username||"",owner_first_name:$e.first_name||"",owner_last_name:$e.last_name||"",owner_email:$e.email||"",plan_id:it.plan_id||"",billing_cycle:it.billing_cycle||"monthly",status:it.status||"active",end_date:it.end_date||"",addon_count:it.addon_count??0};Ht({open:!0,loading:!1,data:oe,error:"",form:At})}catch(oe){Ht({open:!0,loading:!1,data:null,error:(oe==null?void 0:oe.message)||"Unable to load organization.",form:{}})}}async function Aj(m){if(await s({title:"Delete Organization",message:`Delete ${m.name}? This removes the organization and owner user.`,confirmText:"Delete",confirmVariant:"danger"}))try{await U(`/api/saas-admin/organizations/${m.id}`,{method:"DELETE"}),await gu()}catch($){d(oe=>({...oe,error:($==null?void 0:$.message)||"Unable to delete organization."}))}}async function Tj(){var m,j;if((j=(m=Nt.data)==null?void 0:m.organization)!=null&&j.id){Ht($=>({...$,loading:!0,error:""}));try{const $={name:Nt.form.name,company_key:Nt.form.company_key,owner_username:Nt.form.owner_username,owner_first_name:Nt.form.owner_first_name,owner_last_name:Nt.form.owner_last_name,owner_email:Nt.form.owner_email,plan_id:Nt.form.plan_id||null,billing_cycle:Nt.form.billing_cycle,status:Nt.form.status,end_date:Nt.form.end_date,addon_count:Nt.form.addon_count};await U(`/api/saas-admin/organizations/${Nt.data.organization.id}`,{method:"PUT",body:JSON.stringify($)}),await gu(),Ht({open:!1,loading:!1,data:null,error:"",form:{}})}catch($){Ht(oe=>({...oe,loading:!1,error:($==null?void 0:$.message)||"Unable to update organization."}))}}}async function Dj(m){il({open:!0,loading:!0,data:null,error:""});try{const j=await U(`/api/saas-admin/products/${t}/users/${m}`);il({open:!0,loading:!1,data:j,error:""})}catch(j){il({open:!0,loading:!1,data:null,error:(j==null?void 0:j.message)||"Unable to load user."})}}async function Rj(m){Ta({open:!0,loading:!0,data:null,error:"",form:{}});try{const j=await U(`/api/saas-admin/products/${t}/users/${m}`),$=j.user||{},oe={name:$.name||"",email:$.email||"",pc_name:$.pc_name||"",device_id:$.device_id||""};Ta({open:!0,loading:!1,data:j,error:"",form:oe})}catch(j){Ta({open:!0,loading:!1,data:null,error:(j==null?void 0:j.message)||"Unable to load user.",form:{}})}}async function Lj(){var m,j;if((j=(m=ma.data)==null?void 0:m.user)!=null&&j.id){Ta($=>({...$,loading:!0,error:""}));try{await U(`/api/saas-admin/products/${t}/users/${ma.data.user.id}`,{method:"PUT",body:JSON.stringify({name:ma.form.name,email:ma.form.email,pc_name:ma.form.pc_name,device_id:ma.form.device_id})}),await xu(),Ta({open:!1,loading:!1,data:null,error:"",form:{}})}catch($){Ta(oe=>({...oe,loading:!1,error:($==null?void 0:$.message)||"Unable to update user."}))}}}async function Mj(m){if(await s({title:"Delete User",message:`Delete ${m.name}?`,confirmText:"Delete",confirmVariant:"danger"}))try{await U(`/api/saas-admin/products/${t}/users/${m.id}`,{method:"DELETE"}),await xu()}catch($){f(oe=>({...oe,error:($==null?void 0:$.message)||"Unable to delete user."}))}}function Vu(m,j=null){const $=(j==null?void 0:j.limits)||{},oe=(j==null?void 0:j.features)||{},$e=ea?j?{name:j.name||"",monthly_price_inr:j.monthly_price_inr??j.monthly_price??"",yearly_price_inr:j.yearly_price_inr??j.yearly_price??"",monthly_price_usd:j.monthly_price_usd??j.usd_monthly_price??"",yearly_price_usd:j.yearly_price_usd??j.usd_yearly_price??"",max_users:j.max_users??"",device_limit_per_user:j.device_limit_per_user??"",storage_limit_gb:j.storage_limit_gb??"",bandwidth_limit_gb_monthly:j.bandwidth_limit_gb_monthly??"",is_bandwidth_limited:j.is_bandwidth_limited!==!1,is_active:j.is_active!==!1}:{name:"",monthly_price_inr:"",yearly_price_inr:"",monthly_price_usd:"",yearly_price_usd:"",max_users:"",device_limit_per_user:"",storage_limit_gb:"",bandwidth_limit_gb_monthly:"",is_bandwidth_limited:!0,is_active:!0}:j?{plan_template:"Custom",name:j.name||"",monthly_price:j.monthly_price??"",yearly_price:j.yearly_price??"",usd_monthly_price:j.usd_monthly_price??"",usd_yearly_price:j.usd_yearly_price??"",addon_monthly_price:j.addon_monthly_price??"",addon_yearly_price:j.addon_yearly_price??"",addon_usd_monthly_price:j.addon_usd_monthly_price??"",addon_usd_yearly_price:j.addon_usd_yearly_price??"",employee_limit:j.employee_limit??0,retention_days:j.retention_days??30,screenshot_min_minutes:j.screenshot_min_minutes??5,ai_library_limit_mb:j.ai_library_limit_mb??"",website_page_limit:j.website_page_limit??"",allow_addons:!!j.allow_addons,allow_app_usage:!!j.allow_app_usage,allow_hr_view:!!j.allow_hr_view,role_based_access:!!(oe.role_based_access??!0),erp_enabled_modules:Array.isArray(oe.erp_enabled_modules)?oe.erp_enabled_modules.filter(it=>rn.some(At=>At.slug===it)):cc(j.name||""),widgets:$.widgets??"",included_agents:$.included_agents??"",conversations_per_month:$.conversations_per_month??"",chat_history_days:$.chat_history_days??"",max_messages_per_conversation:$.max_messages_per_conversation??"",max_chars_per_message:$.max_chars_per_message??"",remove_branding:!!oe.remove_branding,analytics_basic:!!oe.analytics_basic,csv_export:!!oe.csv_export,agent_inbox:!!oe.agent_inbox,ai_enabled:!!(oe.ai_enabled??!0),ai_replies_per_month:$.ai_replies_per_month??"",ai_max_messages_per_conversation:$.ai_max_messages_per_conversation??"",ai_max_chars_per_message:$.ai_max_chars_per_message??""}:{plan_template:"Custom",name:"",monthly_price:"",yearly_price:"",usd_monthly_price:"",usd_yearly_price:"",addon_monthly_price:"",addon_yearly_price:"",addon_usd_monthly_price:"",addon_usd_yearly_price:"",employee_limit:0,retention_days:30,screenshot_min_minutes:5,ai_library_limit_mb:"",website_page_limit:"",allow_addons:!0,allow_app_usage:!1,allow_hr_view:!1,role_based_access:!0,erp_enabled_modules:cc(""),widgets:"",included_agents:"",conversations_per_month:"",chat_history_days:"",max_messages_per_conversation:"",max_chars_per_message:"",remove_branding:!1,analytics_basic:!1,csv_export:!1,agent_inbox:!0,ai_enabled:!0,ai_replies_per_month:"",ai_max_messages_per_conversation:"",ai_max_chars_per_message:""};C({open:!0,mode:m,form:$e,error:"",fieldErrors:{},loading:!1,planId:(j==null?void 0:j.id)||null})}function Uj(m){return!m||m==="Custom"?null:{"Free Trial":{widgets:1,included_agents:1,conversations_per_month:200,chat_history_days:7,max_messages_per_conversation:15,max_chars_per_message:700,ai_enabled:!0,ai_replies_per_month:50,allow_addons:!1,remove_branding:!1,analytics_basic:!1,csv_export:!1,agent_inbox:!0},Starter:{widgets:1,included_agents:1,conversations_per_month:1e3,chat_history_days:30,max_messages_per_conversation:20,max_chars_per_message:900,ai_enabled:!0,ai_replies_per_month:1e3,allow_addons:!0,remove_branding:!1,analytics_basic:!0,csv_export:!1,agent_inbox:!0},Growth:{widgets:3,included_agents:3,conversations_per_month:1e4,chat_history_days:90,max_messages_per_conversation:30,max_chars_per_message:1200,ai_enabled:!0,ai_replies_per_month:1e4,allow_addons:!0,remove_branding:!0,analytics_basic:!0,csv_export:!1,agent_inbox:!0},Pro:{widgets:10,included_agents:10,conversations_per_month:5e4,chat_history_days:180,max_messages_per_conversation:40,max_chars_per_message:1500,ai_enabled:!0,ai_replies_per_month:5e4,allow_addons:!0,remove_branding:!0,analytics_basic:!0,csv_export:!0,agent_inbox:!0}}[m]||null}async function Oj(){C(m=>({...m,loading:!0,error:"",fieldErrors:{}}));try{if(ea){const yt=(E.form.name||"").trim(),qt=["name","monthly_price_inr","yearly_price_inr","monthly_price_usd","yearly_price_usd","storage_limit_gb","bandwidth_limit_gb_monthly","device_limit_per_user"],tt={},rt=Da=>Da===""||Da===null||Da===void 0;if(qt.forEach(Da=>{const Yj=Da==="name"?yt:E.form[Da];rt(Yj)&&(tt[Da]=["This field is required."])}),Object.keys(tt).length){C(Da=>({...Da,loading:!1,fieldErrors:tt,error:"Please fix the highlighted fields."}));return}const xr={id:E.mode==="edit"?E.planId:void 0,name:yt,monthly_price_inr:E.form.monthly_price_inr,yearly_price_inr:E.form.yearly_price_inr,monthly_price_usd:E.form.monthly_price_usd,yearly_price_usd:E.form.yearly_price_usd,max_users:E.form.max_users===""?null:E.form.max_users,device_limit_per_user:E.form.device_limit_per_user===""?null:E.form.device_limit_per_user,storage_limit_gb:E.form.storage_limit_gb,bandwidth_limit_gb_monthly:E.form.bandwidth_limit_gb_monthly,is_bandwidth_limited:E.form.is_bandwidth_limited!==!1,is_active:E.form.is_active!==!1};await U("/api/saas-admin/storage/plan",{method:"POST",body:JSON.stringify(xr)}),await eo(),C({open:!1,mode:"create",form:{},error:"",fieldErrors:{},loading:!1,planId:null});return}const m=(E.form.name||"").trim(),j=la?["name","widgets","included_agents","conversations_per_month","chat_history_days","max_messages_per_conversation","max_chars_per_message","ai_replies_per_month","monthly_price","yearly_price","usd_monthly_price","usd_yearly_price","addon_monthly_price","addon_yearly_price","addon_usd_monthly_price","addon_usd_yearly_price"]:["name","employee_limit","retention_days","screenshot_min_minutes","monthly_price","yearly_price","usd_monthly_price","usd_yearly_price","addon_monthly_price","addon_yearly_price","addon_usd_monthly_price","addon_usd_yearly_price"],$={},oe=yt=>yt===""||yt===null||yt===void 0;if(j.forEach(yt=>{const qt=yt==="name"?m:E.form[yt];oe(qt)&&($[yt]=["This field is required."])}),Object.keys($).length){C(yt=>({...yt,loading:!1,fieldErrors:$,error:"Please fix the highlighted fields."}));return}const $e={widgets:E.form.widgets?Number(E.form.widgets):void 0,included_agents:E.form.included_agents?Number(E.form.included_agents):void 0,conversations_per_month:E.form.conversations_per_month?Number(E.form.conversations_per_month):void 0,chat_history_days:E.form.chat_history_days?Number(E.form.chat_history_days):void 0,max_messages_per_conversation:E.form.max_messages_per_conversation?Number(E.form.max_messages_per_conversation):void 0,max_chars_per_message:E.form.max_chars_per_message?Number(E.form.max_chars_per_message):void 0,ai_replies_per_month:E.form.ai_replies_per_month?Number(E.form.ai_replies_per_month):void 0,ai_max_messages_per_conversation:E.form.ai_max_messages_per_conversation?Number(E.form.ai_max_messages_per_conversation):void 0,ai_max_chars_per_message:E.form.ai_max_chars_per_message?Number(E.form.ai_max_chars_per_message):void 0};Object.keys($e).forEach(yt=>{($e[yt]===void 0||Number.isNaN($e[yt]))&&delete $e[yt]});const it={remove_branding:!!E.form.remove_branding,analytics_basic:!!E.form.analytics_basic,csv_export:!!E.form.csv_export,agent_inbox:!!E.form.agent_inbox,ai_enabled:!!E.form.ai_enabled};Fu&&(it.role_based_access=!!(E.form.role_based_access??!0),it.erp_enabled_modules=Array.isArray(E.form.erp_enabled_modules)?E.form.erp_enabled_modules.filter(yt=>rn.some(qt=>qt.slug===yt)):[]);const At={name:m,product_slug:t,monthly_price:E.form.monthly_price,yearly_price:E.form.yearly_price,usd_monthly_price:E.form.usd_monthly_price,usd_yearly_price:E.form.usd_yearly_price,addon_monthly_price:E.form.addon_monthly_price,addon_yearly_price:E.form.addon_yearly_price,addon_usd_monthly_price:E.form.addon_usd_monthly_price,addon_usd_yearly_price:E.form.addon_usd_yearly_price,employee_limit:E.form.employee_limit,retention_days:E.form.retention_days,screenshot_min_minutes:E.form.screenshot_min_minutes,ai_library_limit_mb:E.form.ai_library_limit_mb,website_page_limit:E.form.website_page_limit,allow_addons:!!E.form.allow_addons,allow_app_usage:!!E.form.allow_app_usage,allow_hr_view:!!E.form.allow_hr_view,limits:$e,features:it};["monthly_price","yearly_price","usd_monthly_price","usd_yearly_price","addon_monthly_price","addon_yearly_price","addon_usd_monthly_price","addon_usd_yearly_price","employee_limit","retention_days","screenshot_min_minutes","ai_library_limit_mb","website_page_limit"].forEach(yt=>{At[yt]===""&&delete At[yt]}),E.mode==="edit"?await U(`/api/saas-admin/plans/${E.planId}`,{method:"PUT",body:JSON.stringify(At)}):await U("/api/saas-admin/plans",{method:"POST",body:JSON.stringify(At)}),await eo(),C({open:!1,mode:"create",form:{},error:"",fieldErrors:{},loading:!1,planId:null})}catch(m){const j=m==null?void 0:m.data;console.error("Plan save failed",m),console.error("Plan save response",j);const $=j&&typeof j=="object"&&!Array.isArray(j)&&!j.error&&!j.detail?j:null;C(oe=>({...oe,loading:!1,fieldErrors:$||{},error:(j==null?void 0:j.detail)||($?"Please fix the highlighted fields.":(m==null?void 0:m.message)||"Unable to save plan.")}))}}async function $j(m){if(await s({title:"Delete Plan",message:`Delete ${m.name}?`,confirmText:"Delete",confirmVariant:"danger"}))try{await U(`/api/saas-admin/plans/${m.id}`,{method:"DELETE"}),await eo()}catch($){Q(oe=>({...oe,error:($==null?void 0:$.message)||"Unable to delete plan."}))}}async function yo(m,j){const $=j==="approve"?"Approve":j==="reject"?"Reject":"Delete";if(await s({title:`${$} Transfer`,message:`Are you sure you want to ${$.toLowerCase()} this transfer?`,confirmText:$,confirmVariant:j==="approve"?"primary":"danger"}))try{await U(`/api/saas-admin/products/${t}/pending-transfers/${m}/${j}`,{method:"POST"}),await to(),await ao()}catch($e){O(it=>({...it,error:($e==null?void 0:$e.message)||"Unable to update transfer."}))}}function Gu(m,j){rl({open:!0,title:j,details:(m==null?void 0:m.bank_details)||{}})}function Ij(m){Xi({open:!0,row:m})}function Hu(m,j){vs({open:!0,row:m,type:j,note:(m==null?void 0:m.payout_reference)||"",error:"",saving:!1})}async function qu(m){if(!_a.row)return;const j=_a.note.trim();if(!j){vs($=>({...$,error:"Please enter details before proceeding."}));return}vs($=>({...$,saving:!0,error:""}));try{const $={status:m,payout_reference:j,payout_date:m==="paid"?new Date().toISOString().slice(0,10):""},oe=_a.type==="dealer"?`/api/saas-admin/referrals/dealer-earnings/${_a.row.id}`:`/api/saas-admin/referrals/earnings/${_a.row.id}`;await U(oe,{method:"POST",body:JSON.stringify($)}),await bu(),vs({open:!1,row:null,type:"org",note:"",error:"",saving:!1})}catch($){vs(oe=>({...oe,saving:!1,error:($==null?void 0:$.message)||"Unable to update payout."}))}}async function pr(m,j){if(await s({title:"Reset Payout",message:"Reset this payout back to pending?",confirmText:"Reset",confirmVariant:"warning"}))try{const oe=j==="dealer"?`/api/saas-admin/referrals/dealer-earnings/${m.id}`:`/api/saas-admin/referrals/earnings/${m.id}`;await U(oe,{method:"POST",body:JSON.stringify({status:"pending",payout_reference:"",payout_date:""})}),await bu()}catch(oe){et($e=>({...$e,error:(oe==null?void 0:oe.message)||"Unable to reset payout."}))}}function fr(m,j,$){Xt(oe=>({...oe,[m]:{...oe[m],[j]:{...oe[m][j],...$}}}))}function Fj(m,j){if(!j)return m;const $=j.toLowerCase();return m.filter(oe=>[oe.referrer_org,oe.referred_org,oe.referrer_dealer,oe.referred_dealer,oe.base_amount,oe.commission_rate,oe.commission_amount,oe.flat_amount,oe.status,oe.payout_reference,oe.created_at].some($e=>String($e||"").toLowerCase().includes($)))}function Sn(m,j,$,oe){const it=(oe||Fj)(m,j),At=Math.max(Math.ceil(it.length/jt),1),yt=Math.min($,At),qt=(yt-1)*jt,tt=it.slice(qt,qt+jt);return{filtered:it,paged:tt,totalPages:At,currentPage:yt,startIndex:qt}}function gr(m,j,$){y(oe=>({...oe,[m]:{...oe[m],[j]:{...oe[m][j],...$}}}))}function zj(m,j){if(!j)return m;const $=j.toLowerCase();return m.filter(oe=>{var $e,it;return[oe.name,oe.company_key,oe.owner_name,oe.owner_email,($e=oe.subscription)==null?void 0:$e.plan_name,(it=oe.subscription)==null?void 0:it.end_date].some(At=>String(At||"").toLowerCase().includes($))})}function Bj(m,j){if(!j)return m;const $=j.toLowerCase();return m.filter(oe=>[oe.name,oe.username,oe.email,oe.referral_code,oe.referred_by,oe.subscription_status,oe.subscription_start,oe.subscription_end,oe.subscription_amount].some($e=>String($e||"").toLowerCase().includes($)))}function Wj(m,j){if(!j)return m;const $=j.toLowerCase();return m.filter(oe=>[oe.organization_name,oe.owner_username,oe.owner_email,oe.deleted_at,oe.reason].some($e=>String($e||"").toLowerCase().includes($)))}function Vj(m,j){if(!j)return m;const $=j.toLowerCase();return m.filter(oe=>[oe.name,oe.username,oe.email,oe.deleted_at,oe.reason].some($e=>String($e||"").toLowerCase().includes($)))}function Gj(m){const j=String(m.status||"").toLowerCase();if(j==="active"||j==="trial"||j==="inactive"||j==="expired")return j;const $=m.subscription||null;return $?$.status==="expired"?"expired":$.status==="active"?$.end_date&&new Date(`${$.end_date}T23:59:59`)<new Date?"expired":"active":"inactive":"inactive"}function Hj(m){const j={active:[],inactive:[],expired:[]};return m.forEach($=>{const oe=Gj($);oe==="active"?j.active.push($):oe==="expired"?j.expired.push($):j.inactive.push($)}),j}function qj(m){const j={active:[],inactive:[],expired:[]};return m.forEach($=>{const oe=String($.subscription_status||"").toLowerCase();oe==="active"?j.active.push($):oe==="expired"?j.expired.push($):j.inactive.push($)}),j}function Qj(m){const j={pending:[],paid:[],rejected:[]};return m.forEach($=>{const oe=String($.status||"pending").toLowerCase();oe==="paid"?j.paid.push($):oe==="rejected"?j.rejected.push($):j.pending.push($)}),j}function vo(m,j,$){const oe=ot[Qe][$],{filtered:$e,paged:it,totalPages:At,currentPage:yt,startIndex:qt}=Sn(m,oe.term,oe.page);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:j}),e.jsxs("label",{className:"table-search",htmlFor:`referrals-${Qe}-${$}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`referrals-${Qe}-${$}-search`,type:"text",value:oe.term,onChange:tt=>fr(Qe,$,{term:tt.target.value,page:1}),placeholder:"Search"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Referrer Org"}),e.jsx("th",{children:"Referred Org"}),e.jsx("th",{children:"Base"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Bank Details"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:it.length?it.map(tt=>e.jsxs("tr",{children:[e.jsx("td",{children:tt.referrer_org||"-"}),e.jsx("td",{children:tt.referred_org||"-"}),e.jsx("td",{children:tt.base_amount??"-"}),e.jsxs("td",{children:[tt.commission_rate??0,"%"]}),e.jsx("td",{children:tt.commission_amount??"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",onClick:()=>Gu(tt,tt.referrer_org||"ORG Account"),children:"View Account"})}),e.jsx("td",{children:tt.status==="paid"?e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"badge bg-success",children:"Paid"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>pr(tt,"org"),children:"Reset"})]}):tt.status==="rejected"?e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"badge bg-danger",children:"Rejected"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>pr(tt,"org"),children:"Reset"})]}):e.jsx("button",{type:"button",className:"btn btn-outline-warning btn-sm",onClick:()=>Hu(tt,"org"),children:"Pending"})})]},tt.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No referrals found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",$e.length?qt+1:0," to ",Math.min(qt+jt,$e.length)," of"," ",$e.length," entries"]}),e.jsx(st,{page:yt,totalPages:At,onPageChange:tt=>fr(Qe,$,{page:tt}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function No(m,j,$){const oe=ot[Qe][$],{filtered:$e,paged:it,totalPages:At,currentPage:yt,startIndex:qt}=Sn(m,oe.term,oe.page);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:j}),e.jsxs("label",{className:"table-search",htmlFor:`referrals-${Qe}-${$}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`referrals-${Qe}-${$}-search`,type:"text",value:oe.term,onChange:tt=>fr(Qe,$,{term:tt.target.value,page:1}),placeholder:"Search"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Referrer Dealer"}),e.jsx("th",{children:"Referred Org"}),e.jsx("th",{children:"Referred Dealer"}),e.jsx("th",{children:"Base"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Flat"}),e.jsx("th",{children:"Bank Details"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:it.length?it.map(tt=>e.jsxs("tr",{children:[e.jsx("td",{children:tt.referrer_dealer||"-"}),e.jsx("td",{children:tt.referred_org||"-"}),e.jsx("td",{children:tt.referred_dealer||"-"}),e.jsx("td",{children:tt.base_amount??"-"}),e.jsxs("td",{children:[tt.commission_rate??0,"%"]}),e.jsx("td",{children:tt.commission_amount??"-"}),e.jsx("td",{children:tt.flat_amount??"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",onClick:()=>Gu(tt,tt.referrer_dealer||"Dealer Account"),children:"View Account"})}),e.jsx("td",{children:tt.status==="paid"?e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"badge bg-success",children:"Paid"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>pr(tt,"dealer"),children:"Reset"})]}):tt.status==="rejected"?e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"badge bg-danger",children:"Rejected"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>pr(tt,"dealer"),children:"Reset"})]}):e.jsx("button",{type:"button",className:"btn btn-outline-warning btn-sm",onClick:()=>Hu(tt,"dealer"),children:"Pending"})})]},tt.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",children:"No referrals found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",$e.length?qt+1:0," to ",Math.min(qt+jt,$e.length)," of"," ",$e.length," entries"]}),e.jsx(st,{page:yt,totalPages:At,onPageChange:tt=>fr(Qe,$,{page:tt}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function Jj(m,j){const $=m==="deleted"?Kb:Zb[m]||[],oe=A.org[m],$e=m==="deleted"?Wj:zj,{filtered:it,paged:At,totalPages:yt,currentPage:qt,startIndex:tt}=Sn($,oe.term,oe.page,$e);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:j}),e.jsxs("label",{className:"table-search",htmlFor:`org-${m}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`org-${m}-search`,type:"text",value:oe.term,onChange:rt=>gr("org",m,{term:rt.target.value,page:1}),placeholder:"Search organizations"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:m==="deleted"?e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Owner Username"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Deleted At"}),e.jsx("th",{children:"Reason"})]}):e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Admin User Name"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Expire Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:At.length?At.map(rt=>{var xr,Da;return m==="deleted"?e.jsxs("tr",{children:[e.jsx("td",{children:rt.organization_name||"-"}),e.jsx("td",{children:rt.owner_username||"-"}),e.jsx("td",{children:rt.owner_email||"-"}),e.jsx("td",{children:rt.deleted_at||"-"}),e.jsx("td",{children:rt.reason||"-"})]},`${rt.organization_name}-${rt.deleted_at}`):e.jsxs("tr",{children:[e.jsx("td",{children:rt.name}),e.jsx("td",{children:Oe(rt.owner_name)}),e.jsx("td",{children:Oe(rt.owner_email)}),e.jsx("td",{children:((xr=rt.subscription)==null?void 0:xr.plan_name)||"-"}),e.jsx("td",{children:((Da=rt.subscription)==null?void 0:Da.end_date)||"-"}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>Sj(rt.id),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>Ej(rt.id),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>Aj(rt),children:"Delete"})]})]},rt.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:m==="deleted"?5:6,children:m==="deleted"?"No deleted organizations found.":"No organizations found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",it.length?tt+1:0," to ",Math.min(tt+jt,it.length)," of"," ",it.length," entries"]}),e.jsx(st,{page:qt,totalPages:yt,onPageChange:rt=>gr("org",m,{page:rt}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function Kj(m,j){const $=m==="deleted"?Yb:Xb[m]||[],oe=A.dealer[m],$e=m==="deleted"?Vj:Bj,{filtered:it,paged:At,totalPages:yt,currentPage:qt,startIndex:tt}=Sn($,oe.term,oe.page,$e);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:j}),e.jsxs("label",{className:"table-search",htmlFor:`dealer-${m}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`dealer-${m}-search`,type:"text",value:oe.term,onChange:rt=>gr("dealer",m,{term:rt.target.value,page:1}),placeholder:"Search dealers"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:m==="deleted"?e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Deleted At"}),e.jsx("th",{children:"Reason"})]}):e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Referral Code"}),e.jsx("th",{children:"Referred By"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:At.length?At.map(rt=>m==="deleted"?e.jsxs("tr",{children:[e.jsx("td",{children:rt.name||rt.username||"-"}),e.jsx("td",{children:rt.email||"-"}),e.jsx("td",{children:rt.deleted_at||"-"}),e.jsx("td",{children:rt.reason||"-"})]},`${rt.email}-${rt.deleted_at}`):e.jsxs("tr",{children:[e.jsx("td",{children:rt.name||rt.username||"-"}),e.jsx("td",{children:rt.email||"-"}),e.jsx("td",{children:rt.referral_code||"-"}),e.jsx("td",{children:rt.referred_by||"-"}),e.jsx("td",{children:rt.subscription_start||"-"}),e.jsx("td",{children:rt.subscription_end||"-"}),e.jsx("td",{children:rt.subscription_amount??"-"}),e.jsx("td",{children:Sa(rt.subscription_status)})]},rt.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:m==="deleted"?4:8,children:m==="deleted"?"No deleted dealers found.":"No dealers found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",it.length?tt+1:0," to ",Math.min(tt+jt,it.length)," of"," ",it.length," entries"]}),e.jsx(st,{page:qt,totalPages:yt,onPageChange:rt=>gr("dealer",m,{page:rt}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}if(l.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading product dashboard..."})]});if(l.error)return e.jsx("div",{className:"alert alert-danger",children:l.error});let _o=[{key:"organizations",label:"Organizations",icon:"bi-building"},{key:"users",label:"Users",icon:"bi-people"},{key:"plans",label:"Plans",icon:"bi-clipboard-check"},{key:"pending-transfers",label:"Pending Transfers",icon:"bi-hourglass-split"},{key:"renewals",label:"Renewals",icon:"bi-arrow-repeat"},{key:"billing",label:"Billing",icon:"bi-receipt"},{key:"referrals",label:"Referrals",icon:"bi-people-fill"},{key:"support-access",label:"Support Access",icon:"bi-shield-lock"},{key:"observability",label:"Observability",icon:"bi-bar-chart"}];la&&(_o.splice(6,0,{key:"ai-usage",label:"AI Usage & Spend",icon:"bi-cpu"}),_o.splice(7,0,{key:"openai-settings",label:"API Settings",icon:"bi-key"}));const So={active:"Active ORG",inactive:"Inactive ORG",expired:"Expired ORG",deleted:"Deleted ORG"},wo={active:"Active Dealers",inactive:"Inactive Dealers",expired:"Expired Dealers",deleted:"Deleted Dealers"};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:Ks.name||"Product Dashboard"}),e.jsx("div",{className:"text-secondary",children:_j(Ks.description,Ks.slug||t)})]}),e.jsx(dt,{to:"/saas-admin",className:"btn btn-outline-light btn-sm",children:"Back to SaaS Admin"})]}),e.jsx("hr",{className:"section-divider"}),e.jsx("div",{className:"row g-3",children:Nj.map(m=>e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:`bi ${m.icon}`,"aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:m.label}),e.jsx("div",{className:"stat-value",children:m.value})]})},m.label))}),e.jsxs("div",{className:"product-admin-layout mt-4",children:[e.jsx("aside",{className:"product-admin-sidebar",children:e.jsx("div",{className:"card p-3",children:e.jsx("div",{className:"product-admin-nav",children:_o.map(m=>e.jsxs(dt,{to:`/saas-admin/products/${t}#${m.key}`,className:`product-admin-link ${o===m.key?"active":""}`,children:[e.jsx("i",{className:`bi ${m.icon}`,"aria-hidden":"true"}),e.jsx("span",{children:m.label})]},m.key))})})}),e.jsxs("section",{className:"product-admin-content",children:[o==="organizations"?e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Organizations"})}),c.error?e.jsx("div",{className:"alert alert-danger mt-2",children:c.error}):null,e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${h==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>p("org"),children:"ORG"}),e.jsx("button",{type:"button",className:`btn btn-sm ${h==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>p("dealer"),children:"Dealers"})]}),h==="org"?e.jsx("div",{className:"d-flex gap-2 flex-wrap mt-2",children:Object.keys(So).map(m=>e.jsx("button",{type:"button",className:`btn btn-sm ${g===m?"btn-primary":"btn-outline-light"}`,onClick:()=>N(m),children:So[m]},m))}):e.jsx("div",{className:"d-flex gap-2 flex-wrap mt-2",children:Object.keys(wo).map(m=>e.jsx("button",{type:"button",className:`btn btn-sm ${v===m?"btn-primary":"btn-outline-light"}`,onClick:()=>w(m),children:wo[m]},m))}),h==="org"?Jj(g,So[g]):Kj(v,wo[v])]}):null,o==="users"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Users"}),e.jsxs("label",{className:"table-search",htmlFor:"product-user-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"product-user-search",type:"text",value:b,onChange:m=>k(m.target.value),placeholder:"Search users"})]})]}),x.error?e.jsx("div",{className:"alert alert-danger mt-2",children:x.error}):null,e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle pending-transfers-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Organization"}),e.jsx("th",{children:ea?"Device Count":"Device ID"}),e.jsx("th",{children:ea?"Total Utilized Space":"PC Name"}),ea?e.jsx("th",{children:"Monthly Consumed Bandwidth"}):null,e.jsx("th",{className:"table-actions",children:"Action"})]})}),e.jsx("tbody",{children:cr.length?cr.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:m.name}),e.jsx("td",{children:Oe(m.email)}),e.jsx("td",{children:Oe(m.org_name)}),e.jsx("td",{children:Oe(ea?m.device_count:m.device_id)}),e.jsx("td",{children:Oe(ea?m.total_utilized_space:m.pc_name)}),ea?e.jsx("td",{children:Oe(m.monthly_consumed_bandwidth)}):null,e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>Dj(m.id),children:"View"}),ea?null:e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>Rj(m.id),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>Mj(m),children:"Delete"})]})]})]},m.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:ea?7:6,children:"No users found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",cr.length?(S-1)*jt+1:0," to ",cr.length?Math.min(S*jt,ol.length):0," of ",ol.length," entries"]}),e.jsx(st,{page:S,totalPages:ej,onPageChange:F,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):null,o==="plans"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Plans"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>Vu("create"),children:"Create Plan"})]}),L.error?e.jsx("div",{className:"alert alert-danger mt-2",children:L.error}):null,e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Monthly"}),ea?e.jsxs(e.Fragment,{children:[e.jsx("th",{children:"Max Users"}),e.jsx("th",{children:"Device/User"}),e.jsx("th",{children:"Storage (GB)"}),e.jsx("th",{children:"Status"})]}):e.jsx("th",{children:"Yearly"}),ea?null:la?e.jsxs(e.Fragment,{children:[e.jsx("th",{children:"Widgets"}),e.jsx("th",{children:"Agents"}),e.jsx("th",{children:"Conversations/mo"}),e.jsx("th",{children:"Chat history (days)"}),e.jsx("th",{children:"AI replies/mo"}),e.jsx("th",{children:"Add-ons"})]}):e.jsxs(e.Fragment,{children:[e.jsx("th",{children:"Employees"}),e.jsx("th",{children:"Add-ons"}),e.jsx("th",{children:"App Usage"})]}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:vu.length?vu.map(m=>{var j,$,oe,$e,it;return e.jsxs("tr",{children:[e.jsx("td",{children:m.name}),e.jsx("td",{children:Oe(m.monthly_price_inr??m.monthly_price)}),ea?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:Oe(m.max_users??"-")}),e.jsx("td",{children:Oe(m.device_limit_per_user??"-")}),e.jsx("td",{children:Oe(m.storage_limit_gb??"-")}),e.jsx("td",{children:m.is_active===!1?"Inactive":"Active"})]}):e.jsx("td",{children:Oe(m.yearly_price)}),ea?null:la?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:((j=m.limits)==null?void 0:j.widgets)??"-"}),e.jsx("td",{children:(($=m.limits)==null?void 0:$.included_agents)??"-"}),e.jsx("td",{children:((oe=m.limits)==null?void 0:oe.conversations_per_month)??"-"}),e.jsx("td",{children:(($e=m.limits)==null?void 0:$e.chat_history_days)??"-"}),e.jsx("td",{children:((it=m.limits)==null?void 0:it.ai_replies_per_month)??"-"}),e.jsx("td",{children:m.allow_addons?"Enabled":"Disabled"})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{children:m.employee_limit===0?"Unlimited":m.employee_limit}),e.jsx("td",{children:m.allow_addons?"Enabled":"Disabled"}),e.jsx("td",{children:m.allow_app_usage?"Enabled":"Disabled"})]}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>Vu("edit",m),children:"Edit"}),ea?null:e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>$j(m),children:"Delete"})]})]},m.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:ea?7:la?10:7,children:"No plans found."})})})]})})]}):null,o==="observability"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Observability"}),e.jsx(dt,{to:"/saas-admin/observability",className:"btn btn-outline-light btn-sm",children:"Open Full View"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Wb,{initialProduct:Ks.slug||t,showTitle:!1})})]}):null,o==="ai-usage"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-0",children:"AI Usage & Spend"}),Ou?e.jsxs("div",{className:"text-secondary small",children:["Period: ",Ou]}):null]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Gb,children:"Refresh"})]}),e.jsxs("div",{className:"d-flex gap-3 flex-wrap align-items-center mt-2",children:[e.jsxs("label",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"Days"}),e.jsxs("select",{className:"form-select form-select-sm",value:_e,onChange:m=>K(Number(m.target.value)),children:[e.jsx("option",{value:7,children:"7 days"}),e.jsx("option",{value:14,children:"14 days"}),e.jsx("option",{value:30,children:"30 days"})]})]}),e.jsxs("label",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"Year"}),e.jsx("select",{className:"form-select form-select-sm",value:ct,onChange:m=>lt(Number(m.target.value)),children:jj.map(m=>e.jsx("option",{value:m,children:m},m))})]}),e.jsxs("label",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"Month"}),e.jsx("select",{className:"form-select form-select-sm",value:St,onChange:m=>$t(Number(m.target.value)),children:yj.map(m=>e.jsx("option",{value:m,children:m.toString().padStart(2,"0")},m))})]}),e.jsxs("label",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"Organization"}),e.jsxs("select",{className:"form-select form-select-sm",value:We,onChange:m=>Be(m.target.value),children:[e.jsx("option",{value:"",children:"All"}),so.map(m=>e.jsx("option",{value:String(m.id),children:m.name},m.id))]})]})]}),kt.loading?e.jsx("div",{className:"text-secondary mt-2",children:"Loading..."}):null,kt.error?e.jsx("div",{className:"alert alert-danger mt-2",children:kt.error}):null,Uu.length||_n?e.jsxs("div",{className:`alert ${(_n==null?void 0:_n.level)==="danger"?"alert-danger":"alert-warning"} mt-2`,children:[_n?e.jsx("div",{children:_n.message}):null,Uu.map((m,j)=>e.jsx("div",{children:m.message},`${m.level}-${j}`))]}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-robot","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"AI Replies Used"}),e.jsx("div",{className:"stat-value",children:Number(vn.ai_replies_used??0).toLocaleString()})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-speedometer2","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"AI Usage Limit"}),e.jsx("div",{className:"stat-value",children:Js?Js.toLocaleString():"-"}),Js?e.jsxs("div",{className:"text-secondary small",children:[po,"% used"]}):null]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-hash","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"Tokens Total"}),e.jsx("div",{className:"stat-value",children:Number(vn.tokens_total??0).toLocaleString()})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-currency-rupee","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"Estimated Cost (INR)"}),e.jsxs("div",{className:"stat-value",children:["INR ",Number(bj).toLocaleString()]})]})})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Replies"}),e.jsx("th",{children:"Tokens"}),e.jsx("th",{children:"Estimated INR"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:Mu.length?Mu.map(m=>{const j=Number(m.tokens_total??0),$=Number(m.ai_replies_used??0),oe=j>0?bl(j/Nn,Nn,ur,mr):null,$e=$>0?bl($,Nn,ur,mr):null,it=Number(m.cost_inr_est??0)||(oe==null?void 0:oe.costInr)||($e==null?void 0:$e.costInr)||0;return e.jsxs("tr",{children:[e.jsx("td",{children:m.org_name||"-"}),e.jsx("td",{children:$.toLocaleString()}),e.jsx("td",{children:j.toLocaleString()}),e.jsxs("td",{children:["INR ",Number(it).toLocaleString()]}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Hb(m),children:"View Trend"})})]},m.org_id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:"No usage data found."})})})]})})]}):null,o==="openai-settings"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"API Settings"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:ju,children:"Refresh"})]}),Re.error?e.jsx("div",{className:"alert alert-danger mt-2",children:Re.error}):null,!Iu||!Re.form.is_active?e.jsxs("div",{className:"alert alert-warning mt-2",children:[Iu?null:e.jsx("div",{children:"OpenAI API key is missing."}),Re.form.is_active?null:e.jsx("div",{children:"AI is currently disabled globally."})]}):null,e.jsx("div",{className:"text-secondary small mt-1",children:bo?`API Key: ${bo}`:"API Key: Not set"}),Re.saved?e.jsxs("div",{className:"text-secondary small",children:["Last updated: ",Re.saved]}):null,e.jsxs("div",{className:"modal-form-grid mt-3",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"OpenAI API Key"}),e.jsx("input",{type:"password",value:Re.form.api_key,onChange:m=>vt(j=>({...j,form:{...j.form,api_key:m.target.value}})),placeholder:"Enter new key to update"})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Default Model"}),e.jsx("input",{type:"text",value:Re.form.model,onChange:m=>vt(j=>({...j,form:{...j.form,model:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Input Cost / 1K Tokens (INR)"}),e.jsx("input",{type:"number",value:Re.form.input_cost_per_1k_tokens_inr,onChange:m=>vt(j=>({...j,form:{...j.form,input_cost_per_1k_tokens_inr:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Output Cost / 1K Tokens (INR)"}),e.jsx("input",{type:"number",value:Re.form.output_cost_per_1k_tokens_inr,onChange:m=>vt(j=>({...j,form:{...j.form,output_cost_per_1k_tokens_inr:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Markup %"}),e.jsx("input",{type:"number",value:Re.form.fixed_markup_percent,onChange:m=>vt(j=>({...j,form:{...j.form,fixed_markup_percent:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"AI Enabled"}),e.jsxs("select",{value:Re.form.is_active?"yes":"no",onChange:m=>vt(j=>({...j,form:{...j.form,is_active:m.target.value==="yes"}})),children:[e.jsx("option",{value:"yes",children:"Yes"}),e.jsx("option",{value:"no",children:"No"})]})]})]}),xa.message?e.jsx("div",{className:`alert mt-3 ${xa.ok?"alert-success":"alert-danger"}`,children:xa.message}):null,e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:Qb,disabled:xa.loading||Re.loading,children:xa.loading?"Testing...":"Test Connection"}),e.jsx("button",{type:"button",className:"btn btn-success",onClick:qb,disabled:Re.loading,children:Re.loading?"Saving...":"Save"})]})]}):null,o==="pending-transfers"?e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Pending Transfers"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${V==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>re("org"),children:"ORG Transfers"}),e.jsx("button",{type:"button",className:`btn btn-sm ${V==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>re("dealer"),children:"Dealer Transfers"})]}),H.error?e.jsx("div",{className:"alert alert-danger mt-2",children:H.error}):null,e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",jt," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"pending-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"pending-search",type:"text",value:Y,onChange:m=>ce(m.target.value),placeholder:"Search transfers"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:sj}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Billing"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Receipt"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:Nu.length?Nu.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:m.organization}),e.jsx("td",{children:Sa(m.request_type)}),e.jsx("td",{children:m.plan}),e.jsxs("td",{children:[m.currency," ",m.amount]}),e.jsx("td",{children:Sa(m.billing_cycle)}),e.jsx("td",{children:m.created_at||"-"}),e.jsx("td",{children:m.receipt_url?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>at({open:!0,url:m.receipt_url,transferId:m.id,clearing:!1}),children:"Image"}):e.jsx("span",{className:"text-secondary",children:"Not Available"})}),e.jsx("td",{className:"table-actions",children:e.jsxs("div",{className:"d-flex flex-wrap gap-1 pending-action-group",children:[e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",onClick:()=>wj(m.id),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-success btn-sm",onClick:()=>yo(m.id,"approve"),children:"Approve"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>yo(m.id,"reject"),children:"Reject"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>yo(m.id,"delete"),children:"Delete"})]})})]},m.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No pending transfers."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",xn.length?(T-1)*jt+1:0," ","to ",Math.min(T*jt,xn.length)," of ",xn.length," entries"]}),e.jsx(st,{page:T,totalPages:nj,onPageChange:Z,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):null,o==="pending-transfers"?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Transfer History"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${ne==="approved"?"btn-primary":"btn-outline-light"}`,onClick:()=>ae("approved"),children:"Approved Transfers"}),e.jsx("button",{type:"button",className:`btn btn-sm ${ne==="rejected"?"btn-primary":"btn-outline-light"}`,onClick:()=>ae("rejected"),children:"Rejected Transfers"})]}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${X==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>ke("org"),children:"ORG Transfers"}),e.jsx("button",{type:"button",className:`btn btn-sm ${X==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>ke("dealer"),children:"Dealer Transfers"})]}),se.error?e.jsx("div",{className:"alert alert-danger mt-2",children:se.error}):null,e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",jt," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"history-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"history-search",type:"text",value:Ne,onChange:m=>Ye(m.target.value),placeholder:"Search transfers"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization / Dealer"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Billing Cycle"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:ne==="approved"?"Attachment":"Receipt"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:Su.length?Su.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:m.organization}),e.jsx("td",{children:Sa(m.request_type)}),e.jsx("td",{children:m.plan}),e.jsxs("td",{children:[m.currency," ",m.amount]}),e.jsx("td",{children:Sa(m.billing_cycle)}),e.jsx("td",{children:m.updated_at||"-"}),e.jsx("td",{children:m.receipt_url?e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>at({open:!0,url:m.receipt_url,transferId:m.id,clearing:!1}),children:ne==="approved"?"Attachment":"View Image"}),ne==="approved"?e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>Cj(m.id),children:"Delete"}):null]}):e.jsx("span",{className:"text-secondary",children:"Not Available"})}),e.jsx("td",{children:Sa(m.status)})]},m.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No transfer history."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",bn.length?(Ie-1)*jt+1:0," ","to ",Math.min(Ie*jt,bn.length)," of ",bn.length," entries"]}),e.jsx(st,{page:Ie,totalPages:lj,onPageChange:Xe,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):null,o==="renewals"?e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Renewals"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${ue==="upcoming"?"btn-primary":"btn-outline-light"}`,onClick:()=>{je("upcoming"),Le("monthly"),Ge(1)},children:"Upcoming Renewals"}),e.jsx("button",{type:"button",className:`btn btn-sm ${ue==="missed"?"btn-primary":"btn-outline-light"}`,onClick:()=>{je("missed"),Le("monthly"),Ge(1)},children:"Missed Renewals"}),e.jsx("button",{type:"button",className:`btn btn-sm ${ue==="deleted"?"btn-primary":"btn-outline-light"}`,onClick:()=>{je("deleted"),Le("monthly"),Ge(1)},children:"Deleted Accounts"})]}),ue!=="deleted"?e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${Ce==="monthly"?"btn-primary":"btn-outline-light"}`,onClick:()=>{Le("monthly"),Ge(1)},children:"Monthly"}),e.jsx("button",{type:"button",className:`btn btn-sm ${Ce==="yearly"?"btn-primary":"btn-outline-light"}`,onClick:()=>{Le("yearly"),Ge(1)},children:"Yearly"})]}):null,nt.error?e.jsx("div",{className:"alert alert-danger mt-2",children:nt.error}):null,e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",jt," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"renewals-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"renewals-search",type:"text",value:Fe,onChange:m=>ye(m.target.value),placeholder:"Search renewals"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsx("table",{className:"table table-dark table-striped table-hover align-middle",children:ue==="deleted"?e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Owner"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Deleted At"}),e.jsx("th",{children:"Reason"})]})}),e.jsx("tbody",{children:dr.length?dr.map((m,j)=>e.jsxs("tr",{children:[e.jsx("td",{children:m.organization_name||"-"}),e.jsx("td",{children:m.owner_username||"-"}),e.jsx("td",{children:m.owner_email||"-"}),e.jsx("td",{children:m.deleted_at||"-"}),e.jsx("td",{children:m.reason||"-"})]},`${m.organization_name}-${j}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No deleted accounts."})})})]}):e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Owner"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Billing Cycle"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:ue==="missed"?"Days Overdue":"Days Remaining"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:dr.length?dr.map((m,j)=>e.jsxs("tr",{children:[e.jsx("td",{children:m.organization||"-"}),e.jsx("td",{children:m.owner_name||"-"}),e.jsx("td",{children:m.owner_email||"-"}),e.jsx("td",{children:m.plan||"-"}),e.jsx("td",{children:Sa(m.billing_cycle)}),e.jsx("td",{children:m.end_date||"-"}),e.jsx("td",{children:ue==="missed"?m.days_overdue??"-":m.days_remaining??"-"}),e.jsx("td",{children:Sa(m.status)})]},`${m.organization}-${j}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No renewals found."})})})]})})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",jn.length?(ht-1)*jt+1:0," ","to ",Math.min(ht*jt,jn.length)," of ",jn.length," entries"]}),e.jsx(st,{page:ht,totalPages:cj,onPageChange:Ge,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):null,o==="billing"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Billing"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Vb,children:"Refresh"})]}),gt.error?e.jsx("div",{className:"alert alert-danger mt-2",children:gt.error}):null,e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:"Billing Activity"}),e.jsxs("label",{className:"table-search",htmlFor:"billing-transfer-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"billing-transfer-search",type:"text",value:G,onChange:m=>Se(m.target.value),placeholder:"Search billing activity"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Owner"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Paid On"}),e.jsx("th",{children:"GST Bill"}),e.jsx("th",{children:"View"})]})}),e.jsx("tbody",{children:Pu.length?Pu.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:m.organization||"-"}),e.jsx("td",{children:m.owner_name||"-"}),e.jsx("td",{children:m.owner_email||"-"}),e.jsx("td",{children:m.plan||"-"}),e.jsx("td",{children:m.request_type||"-"}),e.jsx("td",{children:m.billing_cycle||"-"}),e.jsx("td",{children:m.currency?`${m.currency} ${Oe(m.amount)}`:Oe(m.amount)}),e.jsx("td",{children:m.status||"-"}),e.jsx("td",{children:m.paid_on||"-"}),e.jsx("td",{children:m.invoice_available&&m.invoice_url?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:m.invoice_url,target:"_blank",rel:"noreferrer",children:"Download"}):"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Ij(m),children:"View"})})]},m.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"11",children:"No billing activity found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",uo.length?Eu+1:0," to"," ",Math.min(Eu+jt,uo.length)," of"," ",uo.length," entries"]}),e.jsx(st,{page:hj,totalPages:mj,onPageChange:ge,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:"Subscription History"}),e.jsxs("label",{className:"table-search",htmlFor:"billing-sub-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"billing-sub-search",type:"text",value:B,onChange:m=>he(m.target.value),placeholder:"Search subscription history"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Email"})]})}),e.jsx("tbody",{children:Au.length?Au.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:m.organization||"-"}),e.jsx("td",{children:m.plan||"-"}),e.jsx("td",{children:m.status||"-"}),e.jsx("td",{children:m.billing_cycle||"-"}),e.jsx("td",{children:m.start_date||"-"}),e.jsx("td",{children:m.end_date||"-"}),e.jsx("td",{children:m.created_at||"-"}),e.jsx("td",{children:m.user_name||"-"}),e.jsx("td",{children:m.user_email||"-"})]},m.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",children:"No subscription history found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",mo.length?Tu+1:0," to"," ",Math.min(Tu+jt,mo.length)," of"," ",mo.length," entries"]}),e.jsx(st,{page:fj,totalPages:pj,onPageChange:Me,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]}):null,o==="referrals"?e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Referrals"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${Qe==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>{bt("org")},children:"ORG Referrals"}),e.jsx("button",{type:"button",className:`btn btn-sm ${Qe==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>{bt("dealer")},children:"Dealer Referrals"})]}),De.error?e.jsx("div",{className:"alert alert-danger mt-2",children:De.error}):null,Qe==="org"?e.jsxs(e.Fragment,{children:[vo(yn.pending,"Pending Payments","pending"),vo(yn.paid,"Completed Payments","paid"),vo(yn.rejected,"Rejected Payments","rejected")]}):e.jsxs(e.Fragment,{children:[No(yn.pending,"Pending Payments","pending"),No(yn.paid,"Completed Payments","paid"),No(yn.rejected,"Rejected Payments","rejected")]})]}):null,o==="support-access"?e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Support Access"})}),Wt.error?e.jsx("div",{className:"alert alert-danger mt-2",children:Wt.error}):null,e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Admin"}),e.jsx("th",{children:"Monitoring Mode"}),e.jsx("th",{children:"Approved Duration"}),e.jsx("th",{children:"Access Until"})]})}),e.jsx("tbody",{children:Lu.length?Lu.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:m.organization}),e.jsxs("td",{children:[e.jsx("div",{children:m.admin_name}),e.jsx("small",{className:"text-secondary",children:m.admin_email})]}),e.jsx("td",{children:m.monitoring_mode}),e.jsx("td",{children:m.approved_duration}),e.jsx("td",{children:m.support_access_until||"-"})]},m.org_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No support access entries."})})})]})})]}):null]})]}),q.open?e.jsx("div",{className:"modal-overlay",onClick:()=>pe({open:!1,loading:!1,error:"",org:null,rows:[]}),children:e.jsxs("div",{className:"modal-panel",onClick:m=>m.stopPropagation(),children:[e.jsx("h5",{children:"AI Usage Trend"}),e.jsx("div",{className:"text-secondary small mb-2",children:(um=q.org)!=null&&um.org_name?`Organization: ${q.org.org_name}`:"Organization"}),q.loading?e.jsx("div",{className:"text-secondary",children:"Loading..."}):null,q.error?e.jsx("div",{className:"alert alert-danger",children:q.error}):null,q.loading?null:e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Month"}),e.jsx("th",{children:"Replies"}),e.jsx("th",{children:"Tokens"}),e.jsx("th",{children:"Cost (INR)"})]})}),e.jsx("tbody",{children:q.rows.length?q.rows.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:`${m.year}-${String(m.month).padStart(2,"0")}`}),e.jsx("td",{children:Number(m.ai_replies_used??0).toLocaleString()}),e.jsx("td",{children:Number(m.total_tokens??0).toLocaleString()}),e.jsxs("td",{children:["INR ",Number(m.cost_inr??0).toLocaleString()]})]},`${m.year}-${m.month}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,children:"No trend data."})})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>pe({open:!1,loading:!1,error:"",org:null,rows:[]}),children:"Close"})})]})}):null,Pe.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Te({open:!1,loading:!1,data:null,error:""}),children:e.jsxs("div",{className:`modal-panel ${la?"ai-chatbot-plan-modal":""}`,onClick:m=>m.stopPropagation(),children:[e.jsx("h5",{children:"Organization Details"}),Pe.loading?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading..."})]}):Pe.error?e.jsx("div",{className:"alert alert-danger",children:Pe.error}):Pe.data?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Name:"})," ",Oe((mm=Pe.data.organization)==null?void 0:mm.name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Company Key:"})," ",Oe((hm=Pe.data.organization)==null?void 0:hm.company_key)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Created:"})," ",Oe((pm=Pe.data.organization)==null?void 0:pm.created_at)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner:"})," ",Oe(`${((fm=Pe.data.owner)==null?void 0:fm.first_name)||""} ${((gm=Pe.data.owner)==null?void 0:gm.last_name)||""}`.trim())]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner Email:"})," ",Oe((xm=Pe.data.owner)==null?void 0:xm.email)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"User Phone:"})," ",Oe((bm=Pe.data.profile)==null?void 0:bm.phone_number)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner Username:"})," ",Oe((jm=Pe.data.owner)==null?void 0:jm.username)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Plan:"})," ",Oe((ym=Pe.data.subscription)==null?void 0:ym.plan_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Status:"})," ",Sa((vm=Pe.data.subscription)==null?void 0:vm.status)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Billing Cycle:"})," ",Sa((Nm=Pe.data.subscription)==null?void 0:Nm.billing_cycle)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"End Date:"})," ",Oe((_m=Pe.data.subscription)==null?void 0:_m.end_date)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Add-ons:"})," ",Oe((Sm=Pe.data.subscription)==null?void 0:Sm.addon_count)]}),e.jsxs("div",{className:"border-top pt-2 mt-3",children:[e.jsx("div",{className:"fw-semibold mb-2",children:"Settings"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Screenshot Interval:"})," ",Oe((wm=Pe.data.settings)==null?void 0:wm.screenshot_interval_minutes)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Monitoring Mode:"})," ",Oe((km=Pe.data.settings)==null?void 0:km.monitoring_mode)]})]})]}),e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("div",{className:"fw-semibold mb-2",children:"Billing Profile"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Contact Name:"})," ",Oe((Cm=Pe.data.billing_profile)==null?void 0:Cm.contact_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Company Name:"})," ",Oe((Pm=Pe.data.billing_profile)==null?void 0:Pm.company_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Email:"})," ",Oe((Em=Pe.data.billing_profile)==null?void 0:Em.email)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Phone:"})," ",Oe((Am=Pe.data.billing_profile)==null?void 0:Am.phone)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Address:"})," ",Oe((Tm=Pe.data.billing_profile)==null?void 0:Tm.address_line1)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Address 2:"})," ",Oe((Dm=Pe.data.billing_profile)==null?void 0:Dm.address_line2)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"City:"})," ",Oe((Rm=Pe.data.billing_profile)==null?void 0:Rm.city)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"State:"})," ",Oe((Lm=Pe.data.billing_profile)==null?void 0:Lm.state)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Postal Code:"})," ",Oe((Mm=Pe.data.billing_profile)==null?void 0:Mm.postal_code)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Country:"})," ",Oe((Um=Pe.data.billing_profile)==null?void 0:Um.country)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"GSTIN:"})," ",Oe((Om=Pe.data.billing_profile)==null?void 0:Om.gstin)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Updated:"})," ",Oe(($m=Pe.data.billing_profile)==null?void 0:$m.updated_at)]})]})]})}):null,e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Te({open:!1,loading:!1,data:null,error:""}),children:"Close"})})]})}):null,Je.open?e.jsx("div",{className:"modal-overlay",onClick:()=>fe({open:!1,loading:!1,data:null,error:"",clearing:!1,receiptPreview:""}),children:e.jsxs("div",{className:"modal-panel",onClick:m=>m.stopPropagation(),children:[e.jsx("h5",{children:"Pending Transfer Details"}),Je.loading?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading..."})]}):Je.error?e.jsx("div",{className:"alert alert-danger",children:Je.error}):Je.data?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Organization / Dealer:"})," ",Oe(((Im=Je.data.transfer)==null?void 0:Im.organization)||((Fm=Je.data.transfer)==null?void 0:Fm.dealer))]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Type:"})," ",Sa((zm=Je.data.transfer)==null?void 0:zm.request_type)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Plan:"})," ",Oe((Bm=Je.data.transfer)==null?void 0:Bm.plan)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Amount:"})," ",Oe((Wm=Je.data.transfer)==null?void 0:Wm.currency)," ",Oe((Vm=Je.data.transfer)==null?void 0:Vm.amount)]}),((Gm=Je.data.transfer)==null?void 0:Gm.request_type)==="addon"||((Hm=Je.data.transfer)==null?void 0:Hm.addon_count)!==void 0?e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Add-on Users:"})," ",Oe(((qm=Je.data.transfer)==null?void 0:qm.addon_count)??"-")]}):null,e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Billing Cycle:"})," ",Sa((Qm=Je.data.transfer)==null?void 0:Qm.billing_cycle)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Reference No:"})," ",Oe((Jm=Je.data.transfer)==null?void 0:Jm.reference_no)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Status:"})," ",Sa((Km=Je.data.transfer)==null?void 0:Km.status)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Created:"})," ",Oe((Ym=Je.data.transfer)==null?void 0:Ym.created_at)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Updated:"})," ",Oe((Zm=Je.data.transfer)==null?void 0:Zm.updated_at)]}),(Xm=Je.data.transfer)!=null&&Xm.notes?e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Notes:"})," ",(eh=Je.data.transfer)==null?void 0:eh.notes]}):null,(th=Je.data.transfer)!=null&&th.receipt_url?e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Receipt:"}),e.jsx("div",{className:"mt-2",children:Je.receiptPreview?e.jsx("img",{src:Je.receiptPreview,alt:"Receipt",style:{maxWidth:"100%",borderRadius:"8px"}}):e.jsx("span",{className:"text-secondary",children:"Not Available"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[Je.receiptPreview?null:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>fe(m=>{var j,$;return{...m,receiptPreview:(($=(j=m.data)==null?void 0:j.transfer)==null?void 0:$.receipt_url)||""}}),children:"View Image"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>kj(Je.data.transfer.id),disabled:Je.clearing,children:Je.clearing?"Clearing...":"Clear Image"})]})]}):e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Receipt:"})," -"]})]}):null]})}):null,Ue.open?e.jsx("div",{className:"modal-overlay",onClick:()=>at({open:!1,url:"",transferId:null,clearing:!1}),children:e.jsxs("div",{className:"modal-panel",style:{width:"min(520px, 90vw)"},onClick:m=>m.stopPropagation(),children:[e.jsx("h5",{children:"Receipt Image"}),e.jsx("div",{className:"mt-3",children:Ue.url?e.jsx("img",{src:Ue.url,alt:"Receipt",style:{width:"100%",borderRadius:"8px"}}):e.jsx("div",{className:"text-secondary",children:"Not Available"})}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-danger",onClick:Pj,disabled:Ue.clearing,children:Ue.clearing?"Clearing...":"Clear Image"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>at({open:!1,url:"",transferId:null,clearing:!1}),children:"Close"})]})]})}):null,Ut.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Xi({open:!1,row:null}),children:e.jsxs("div",{className:"modal-panel",onClick:m=>m.stopPropagation(),children:[e.jsx("h5",{children:"Billing Details"}),e.jsxs("div",{className:"modal-form-grid billing-modal-grid mt-3",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Organization"}),e.jsx("div",{children:Oe((ah=Ut.row)==null?void 0:ah.organization)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Owner"}),e.jsx("div",{children:Oe((sh=Ut.row)==null?void 0:sh.owner_name)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Email"}),e.jsx("div",{children:Oe((nh=Ut.row)==null?void 0:nh.owner_email)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Plan"}),e.jsx("div",{children:Oe((lh=Ut.row)==null?void 0:lh.plan)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Type"}),e.jsx("div",{children:Oe((rh=Ut.row)==null?void 0:rh.request_type)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Cycle"}),e.jsx("div",{children:Oe((ih=Ut.row)==null?void 0:ih.billing_cycle)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Amount"}),e.jsx("div",{children:(oh=Ut.row)!=null&&oh.currency?`${Ut.row.currency} ${Oe((ch=Ut.row)==null?void 0:ch.amount)}`:Oe((dh=Ut.row)==null?void 0:dh.amount)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Status"}),e.jsx("div",{children:Oe((uh=Ut.row)==null?void 0:uh.status)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Paid On"}),e.jsx("div",{children:Oe((mh=Ut.row)==null?void 0:mh.paid_on)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Reference"}),e.jsx("div",{children:Oe((hh=Ut.row)==null?void 0:hh.reference_no)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Created"}),e.jsx("div",{children:Oe((ph=Ut.row)==null?void 0:ph.created_at)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Updated"}),e.jsx("div",{children:Oe((fh=Ut.row)==null?void 0:fh.updated_at)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Notes"}),e.jsx("div",{children:Oe((gh=Ut.row)==null?void 0:gh.notes)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Receipt"}),(xh=Ut.row)!=null&&xh.receipt_url?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:Ut.row.receipt_url,target:"_blank",rel:"noreferrer",children:"View"}):e.jsx("div",{children:"-"})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"GST Bill"}),(bh=Ut.row)!=null&&bh.invoice_available&&((jh=Ut.row)!=null&&jh.invoice_url)?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:Ut.row.invoice_url,target:"_blank",rel:"noreferrer",children:"Download"}):e.jsx("div",{children:"-"})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Xi({open:!1,row:null}),children:"Close"})})]})}):null,qe.open?e.jsx("div",{className:"modal-overlay",onClick:()=>rl({open:!1,title:"",details:{}}),children:e.jsxs("div",{className:"modal-panel",onClick:m=>m.stopPropagation(),children:[e.jsxs("h5",{children:["Bank Details - ",qe.title||"Account"]}),e.jsxs("div",{className:"modal-form-grid mt-3",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Contact Name"}),e.jsx("div",{children:Oe(((yh=qe.details)==null?void 0:yh.contact_name)||((vh=qe.details)==null?void 0:vh.name))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Company Name"}),e.jsx("div",{children:Oe((Nh=qe.details)==null?void 0:Nh.company_name)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Email"}),e.jsx("div",{children:Oe((_h=qe.details)==null?void 0:_h.email)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Phone"}),e.jsx("div",{children:Oe((Sh=qe.details)==null?void 0:Sh.phone)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Bank Name"}),e.jsx("div",{children:Oe((wh=qe.details)==null?void 0:wh.bank_name)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Account Number"}),e.jsx("div",{children:Oe((kh=qe.details)==null?void 0:kh.bank_account_number)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"IFSC"}),e.jsx("div",{children:Oe((Ch=qe.details)==null?void 0:Ch.bank_ifsc)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"UPI"}),e.jsx("div",{children:Oe((Ph=qe.details)==null?void 0:Ph.upi_id)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Address Line 1"}),e.jsx("div",{children:Oe((Eh=qe.details)==null?void 0:Eh.address_line1)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Address Line 2"}),e.jsx("div",{children:Oe((Ah=qe.details)==null?void 0:Ah.address_line2)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"City"}),e.jsx("div",{children:Oe((Th=qe.details)==null?void 0:Th.city)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"State"}),e.jsx("div",{children:Oe((Dh=qe.details)==null?void 0:Dh.state)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Postal Code"}),e.jsx("div",{children:Oe((Rh=qe.details)==null?void 0:Rh.postal_code)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Country"}),e.jsx("div",{children:Oe((Lh=qe.details)==null?void 0:Lh.country)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"GSTIN"}),e.jsx("div",{children:Oe((Mh=qe.details)==null?void 0:Mh.gstin)})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>rl({open:!1,title:"",details:{}}),children:"Close"})})]})}):null,_a.open?e.jsx("div",{className:"modal-overlay",onClick:()=>vs({open:!1,row:null,type:"org",note:"",error:"",saving:!1}),children:e.jsxs("div",{className:"modal-panel",onClick:m=>m.stopPropagation(),children:[e.jsx("h5",{children:"Update Referral Payout"}),e.jsx("p",{className:"text-secondary mb-2",children:"Add payment or rejection details before updating the status."}),_a.error?e.jsx("div",{className:"alert alert-danger",children:_a.error}):null,e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Details"}),e.jsx("textarea",{className:"form-control",rows:"3",value:_a.note,onChange:m=>vs(j=>({...j,note:m.target.value})),placeholder:"Ref: 251245 / Date: 03/01/2026 / Reason"})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>vs({open:!1,row:null,type:"org",note:"",error:"",saving:!1}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>qu("rejected"),disabled:_a.saving,children:_a.saving?"Saving...":"Reject"}),e.jsx("button",{type:"button",className:"btn btn-success",onClick:()=>qu("paid"),disabled:_a.saving,children:_a.saving?"Saving...":"Paid"})]})]})}):null,Nt.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Ht({open:!1,loading:!1,data:null,error:"",form:{}}),children:e.jsxs("div",{className:"modal-panel",onClick:m=>m.stopPropagation(),children:[e.jsx("h5",{children:"Edit Organization"}),Nt.error?e.jsx("div",{className:"alert alert-danger",children:Nt.error}):null,Nt.loading?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading..."})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"modal-form-grid",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Organization Name"}),e.jsx("input",{type:"text",className:"form-control",value:Nt.form.name||"",onChange:m=>Ht(j=>({...j,form:{...j.form,name:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Company Key"}),e.jsx("input",{type:"text",className:"form-control",value:Nt.form.company_key||"",onChange:m=>Ht(j=>({...j,form:{...j.form,company_key:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Username"}),e.jsx("input",{type:"text",className:"form-control",value:Nt.form.owner_username||"",onChange:m=>Ht(j=>({...j,form:{...j.form,owner_username:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin First Name"}),e.jsx("input",{type:"text",className:"form-control",value:Nt.form.owner_first_name||"",onChange:m=>Ht(j=>({...j,form:{...j.form,owner_first_name:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Last Name"}),e.jsx("input",{type:"text",className:"form-control",value:Nt.form.owner_last_name||"",onChange:m=>Ht(j=>({...j,form:{...j.form,owner_last_name:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Email"}),e.jsx("input",{type:"email",className:"form-control",value:Nt.form.owner_email||"",onChange:m=>Ht(j=>({...j,form:{...j.form,owner_email:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan"}),e.jsxs("select",{className:"form-select",value:Nt.form.plan_id||"",onChange:m=>Ht(j=>({...j,form:{...j.form,plan_id:Number(m.target.value)||""}})),children:[e.jsx("option",{value:"",children:"Select Plan"}),Jb.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Billing Cycle"}),e.jsxs("select",{className:"form-select",value:Nt.form.billing_cycle||"monthly",onChange:m=>Ht(j=>({...j,form:{...j.form,billing_cycle:m.target.value}})),children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:Nt.form.status||"active",onChange:m=>Ht(j=>({...j,form:{...j.form,status:m.target.value}})),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Expire Date"}),e.jsx("input",{type:"date",className:"form-control",value:Nt.form.end_date||"",onChange:m=>Ht(j=>({...j,form:{...j.form,end_date:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Add-on Count"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:Nt.form.addon_count??0,onChange:m=>Ht(j=>({...j,form:{...j.form,addon_count:m.target.value}}))})]})]})}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Ht({open:!1,loading:!1,data:null,error:"",form:{}}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Tj,disabled:Nt.loading,children:"Save"})]})]})}):null,za.open?e.jsx("div",{className:"modal-overlay",onClick:()=>il({open:!1,loading:!1,data:null,error:""}),children:e.jsxs("div",{className:"modal-panel",onClick:m=>m.stopPropagation(),children:[e.jsx("h5",{children:"User Details"}),za.loading?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading..."})]}):za.error?e.jsx("div",{className:"alert alert-danger",children:za.error}):za.data?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Name:"})," ",Oe((Uh=za.data.user)==null?void 0:Uh.name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Email:"})," ",Oe((Oh=za.data.user)==null?void 0:Oh.email)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Organization:"})," ",Oe(($h=za.data.user)==null?void 0:$h.org_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Device ID:"})," ",Oe((Ih=za.data.user)==null?void 0:Ih.device_id)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"PC Name:"})," ",Oe((Fh=za.data.user)==null?void 0:Fh.pc_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Created:"})," ",Oe((zh=za.data.user)==null?void 0:zh.created_at)]})]}):null,e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>il({open:!1,loading:!1,data:null,error:""}),children:"Close"})})]})}):null,ma.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Ta({open:!1,loading:!1,data:null,error:"",form:{}}),children:e.jsxs("div",{className:"modal-panel",onClick:m=>m.stopPropagation(),children:[e.jsx("h5",{children:"Edit User"}),ma.error?e.jsx("div",{className:"alert alert-danger",children:ma.error}):null,ma.loading?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading..."})]}):e.jsxs("div",{className:"modal-form-grid",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:ma.form.name||"",onChange:m=>Ta(j=>({...j,form:{...j.form,name:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:ma.form.email||"",onChange:m=>Ta(j=>({...j,form:{...j.form,email:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"PC Name"}),e.jsx("input",{type:"text",className:"form-control",value:ma.form.pc_name||"",onChange:m=>Ta(j=>({...j,form:{...j.form,pc_name:m.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Device ID"}),e.jsx("input",{type:"text",className:"form-control",value:ma.form.device_id||"",onChange:m=>Ta(j=>({...j,form:{...j.form,device_id:m.target.value}}))})]})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Ta({open:!1,loading:!1,data:null,error:"",form:{}}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Lj,disabled:ma.loading,children:"Save"})]})]})}):null,E.open?e.jsx("div",{className:"modal-overlay",onClick:()=>C({open:!1,mode:"create",form:{},error:"",fieldErrors:{},loading:!1,planId:null}),children:e.jsxs("div",{className:`modal-panel ${la?"ai-chatbot-plan-modal":""}`,onClick:m=>m.stopPropagation(),children:[e.jsx("h5",{children:E.mode==="edit"?"Edit Plan":"Create Plan"}),E.error?e.jsx("div",{className:"alert alert-danger",children:E.error}):null,ea?e.jsxs("div",{className:"modal-form-grid",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan Name"}),e.jsx("input",{type:"text",className:"form-control",value:E.form.name||"",onChange:m=>C(j=>({...j,form:{...j.form,name:m.target.value}}))}),D("name")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Monthly Price (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.monthly_price_inr??"",onChange:m=>C(j=>({...j,form:{...j.form,monthly_price_inr:m.target.value}}))}),D("monthly_price_inr")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Yearly Price (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.yearly_price_inr??"",onChange:m=>C(j=>({...j,form:{...j.form,yearly_price_inr:m.target.value}}))}),D("yearly_price_inr")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Monthly Price (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.monthly_price_usd??"",onChange:m=>C(j=>({...j,form:{...j.form,monthly_price_usd:m.target.value}}))}),D("monthly_price_usd")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Yearly Price (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.yearly_price_usd??"",onChange:m=>C(j=>({...j,form:{...j.form,yearly_price_usd:m.target.value}}))}),D("yearly_price_usd")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Max Users"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:E.form.max_users??"",onChange:m=>C(j=>({...j,form:{...j.form,max_users:m.target.value}}))}),D("max_users")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Device Limit per User"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:E.form.device_limit_per_user??"",onChange:m=>C(j=>({...j,form:{...j.form,device_limit_per_user:m.target.value}}))}),D("device_limit_per_user")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Storage Limit (GB)"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:E.form.storage_limit_gb??"",onChange:m=>C(j=>({...j,form:{...j.form,storage_limit_gb:m.target.value}}))}),D("storage_limit_gb")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Bandwidth Limit (GB / month)"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:E.form.bandwidth_limit_gb_monthly??"",onChange:m=>C(j=>({...j,form:{...j.form,bandwidth_limit_gb_monthly:m.target.value}}))}),D("bandwidth_limit_gb_monthly")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Bandwidth Limited"}),e.jsxs("select",{className:"form-select",value:E.form.is_bandwidth_limited===!1?"false":"true",onChange:m=>C(j=>({...j,form:{...j.form,is_bandwidth_limited:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:E.form.is_active?"true":"false",onChange:m=>C(j=>({...j,form:{...j.form,is_active:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]})]}):e.jsxs("div",{className:"modal-form-grid",style:la?{gridTemplateColumns:"repeat(4, minmax(0, 1fr))"}:void 0,children:[la?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan Template"}),e.jsxs("select",{className:"form-select",value:E.form.plan_template||"Custom",onChange:m=>{const j=m.target.value,$=Uj(j);C(oe=>({...oe,form:{...oe.form,plan_template:j,...$||{}}}))},children:[e.jsx("option",{value:"Free Trial",children:"Free Trial"}),e.jsx("option",{value:"Starter",children:"Starter"}),e.jsx("option",{value:"Growth",children:"Growth"}),e.jsx("option",{value:"Pro",children:"Pro"}),e.jsx("option",{value:"Custom",children:"Custom"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan Name"}),e.jsx("input",{type:"text",className:"form-control",value:E.form.name||"",onChange:m=>C(j=>({...j,form:{...j.form,name:m.target.value}}))}),D("name")]})]}):e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan Name"}),e.jsx("input",{type:"text",className:"form-control",value:E.form.name||"",onChange:m=>C(j=>({...j,form:{...j.form,name:m.target.value}}))}),D("name")]}),la?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Widgets"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:E.form.widgets??"",onChange:m=>C(j=>({...j,form:{...j.form,widgets:m.target.value}}))}),D("widgets")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Agents Included"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:E.form.included_agents??"",onChange:m=>C(j=>({...j,form:{...j.form,included_agents:m.target.value}}))}),D("included_agents")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Conversations / Month"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:E.form.conversations_per_month??"",onChange:m=>C(j=>({...j,form:{...j.form,conversations_per_month:m.target.value}}))}),D("conversations_per_month")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Chat History (days)"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:E.form.chat_history_days??"",onChange:m=>C(j=>({...j,form:{...j.form,chat_history_days:m.target.value}}))}),D("chat_history_days")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Max Messages / Conversation"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:E.form.max_messages_per_conversation??"",onChange:m=>C(j=>({...j,form:{...j.form,max_messages_per_conversation:m.target.value}}))}),D("max_messages_per_conversation")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Max Chars / Message"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:E.form.max_chars_per_message??"",onChange:m=>C(j=>({...j,form:{...j.form,max_chars_per_message:m.target.value}}))}),D("max_chars_per_message")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"AI Max Messages / Conversation"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:E.form.ai_max_messages_per_conversation??"",onChange:m=>C(j=>({...j,form:{...j.form,ai_max_messages_per_conversation:m.target.value}}))}),D("ai_max_messages_per_conversation")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"AI Max Chars / Message"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:E.form.ai_max_chars_per_message??"",onChange:m=>C(j=>({...j,form:{...j.form,ai_max_chars_per_message:m.target.value}}))}),D("ai_max_chars_per_message")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"AI Library Limit (MB)"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:E.form.ai_library_limit_mb??"",onChange:m=>C(j=>({...j,form:{...j.form,ai_library_limit_mb:m.target.value}}))}),D("ai_library_limit_mb")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Maximum Website Pages Allowed for AI Import"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:E.form.website_page_limit??"",onChange:m=>C(j=>({...j,form:{...j.form,website_page_limit:m.target.value}}))}),D("website_page_limit")]})]}):e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Employee Limit"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:E.form.employee_limit??0,onChange:m=>C(j=>({...j,form:{...j.form,employee_limit:m.target.value}}))}),D("employee_limit")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Monthly Price (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.monthly_price??"",onChange:m=>C(j=>({...j,form:{...j.form,monthly_price:m.target.value}}))}),D("monthly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Yearly Price (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.yearly_price??"",onChange:m=>C(j=>({...j,form:{...j.form,yearly_price:m.target.value}}))}),D("yearly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Monthly Price (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.usd_monthly_price??"",onChange:m=>C(j=>({...j,form:{...j.form,usd_monthly_price:m.target.value}}))}),D("usd_monthly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Yearly Price (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.usd_yearly_price??"",onChange:m=>C(j=>({...j,form:{...j.form,usd_yearly_price:m.target.value}}))}),D("usd_yearly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Addon Monthly (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.addon_monthly_price??"",onChange:m=>C(j=>({...j,form:{...j.form,addon_monthly_price:m.target.value}}))}),D("addon_monthly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Addon Yearly (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.addon_yearly_price??"",onChange:m=>C(j=>({...j,form:{...j.form,addon_yearly_price:m.target.value}}))}),D("addon_yearly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Addon Monthly (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.addon_usd_monthly_price??"",onChange:m=>C(j=>({...j,form:{...j.form,addon_usd_monthly_price:m.target.value}}))}),D("addon_usd_monthly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Addon Yearly (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:E.form.addon_usd_yearly_price??"",onChange:m=>C(j=>({...j,form:{...j.form,addon_usd_yearly_price:m.target.value}}))}),D("addon_usd_yearly_price")]}),la?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Retention Days"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:E.form.retention_days??30,onChange:m=>C(j=>({...j,form:{...j.form,retention_days:m.target.value}}))}),D("retention_days")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Screenshot Interval (min)"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:E.form.screenshot_min_minutes??5,onChange:m=>C(j=>({...j,form:{...j.form,screenshot_min_minutes:m.target.value}}))}),D("screenshot_min_minutes")]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Allow Add-ons"}),e.jsxs("select",{className:"form-select",value:E.form.allow_addons?"true":"false",onChange:m=>C(j=>({...j,form:{...j.form,allow_addons:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),D("allow_addons")]}),la?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Remove Branding"}),e.jsxs("select",{className:"form-select",value:E.form.remove_branding?"true":"false",onChange:m=>C(j=>({...j,form:{...j.form,remove_branding:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),D("remove_branding")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Analytics (Basic)"}),e.jsxs("select",{className:"form-select",value:E.form.analytics_basic?"true":"false",onChange:m=>C(j=>({...j,form:{...j.form,analytics_basic:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),D("analytics_basic")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"CSV Export"}),e.jsxs("select",{className:"form-select",value:E.form.csv_export?"true":"false",onChange:m=>C(j=>({...j,form:{...j.form,csv_export:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),D("csv_export")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Agent Inbox"}),e.jsxs("select",{className:"form-select",value:E.form.agent_inbox?"true":"false",onChange:m=>C(j=>({...j,form:{...j.form,agent_inbox:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),D("agent_inbox")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"AI Enabled"}),e.jsxs("select",{className:"form-select",value:E.form.ai_enabled?"true":"false",onChange:m=>C(j=>({...j,form:{...j.form,ai_enabled:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),D("ai_enabled")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"AI Replies / Month"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:E.form.ai_replies_per_month??"",onChange:m=>C(j=>({...j,form:{...j.form,ai_replies_per_month:m.target.value}}))}),D("ai_replies_per_month"),(()=>{const m=te(E.form.ai_replies_per_month);if(!m)return null;const j=m.costInr,$=j>=z.warnHighInr,oe=j>=z.warnVeryHighInr;return e.jsxs("div",{className:"text-secondary small mt-1",children:[e.jsxs("div",{children:["Estimated OpenAI cost (Approx): INR ",j.toFixed(0)," / month"]}),e.jsxs("div",{children:["Assumes ",m.tokensPerReply," tokens per reply, $",m.usdPer1k,"/1k tokens, 1 USD=INR ",m.usdToInr]}),oe?e.jsx("div",{className:"text-danger",children:"Very high AI cost - review limits"}):$?e.jsx("div",{className:"text-warning",children:"High AI cost"}):null]})})(),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm mt-2",onClick:()=>W(m=>!m),children:R?"Hide assumptions":"Edit assumptions"}),R?e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("label",{className:"form-label",children:"Avg tokens/reply"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:z.tokensPerReply,onChange:m=>M(j=>({...j,tokensPerReply:Number(m.target.value)}))})]}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("label",{className:"form-label",children:"USD / 1k tokens"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",className:"form-control",value:z.usdPer1k,onChange:m=>M(j=>({...j,usdPer1k:Number(m.target.value)}))})]}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("label",{className:"form-label",children:"USD to INR"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:z.usdToInr,onChange:m=>M(j=>({...j,usdToInr:Number(m.target.value)}))})]})]})}):null]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Allow App Usage"}),e.jsxs("select",{className:"form-select",value:E.form.allow_app_usage?"true":"false",onChange:m=>C(j=>({...j,form:{...j.form,allow_app_usage:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),D("allow_app_usage")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Allow HR View Login"}),e.jsxs("select",{className:"form-select",value:E.form.allow_hr_view?"true":"false",onChange:m=>C(j=>({...j,form:{...j.form,allow_hr_view:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),D("allow_hr_view")]}),Fu?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Role Based Access"}),e.jsxs("select",{className:"form-select",value:E.form.role_based_access?"true":"false",onChange:m=>C(j=>({...j,form:{...j.form,role_based_access:m.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Enabled"}),e.jsx("option",{value:"false",children:"Disabled"})]}),e.jsx("div",{className:"text-secondary small mt-1",children:"Recommended: enable for Free, Starter, Growth, and Pro."})]}),e.jsxs("div",{className:"modal-form-field",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Enabled ERP Modules for this Plan"}),e.jsx("div",{className:"row g-2",children:rn.map(m=>{const j=Array.isArray(E.form.erp_enabled_modules)?E.form.erp_enabled_modules.includes(m.slug):!1;return e.jsx("div",{className:"col-12 col-md-6 col-xl-4",children:e.jsxs("label",{className:"d-flex align-items-center gap-2 border rounded px-2 py-2 h-100",children:[e.jsx("input",{type:"checkbox",checked:j,onChange:$=>{C(oe=>{const $e=new Set(Array.isArray(oe.form.erp_enabled_modules)?oe.form.erp_enabled_modules:[]);return $.target.checked?$e.add(m.slug):$e.delete(m.slug),{...oe,form:{...oe.form,erp_enabled_modules:Array.from($e)}}})}}),e.jsx("span",{children:m.label})]})},`erp-module-opt-${m.slug}`)})}),e.jsxs("div",{className:"d-flex gap-2 mt-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>C(m=>({...m,form:{...m.form,erp_enabled_modules:cc(m.form.name||"")}})),children:"Auto by Plan Name"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>C(m=>({...m,form:{...m.form,erp_enabled_modules:rn.map(j=>j.slug)}})),children:"Select All"})]})]})]}):null]})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>C({open:!1,mode:"create",form:{},error:"",fieldErrors:{},loading:!1,planId:null}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Oj,disabled:E.loading,children:"Save"})]})]})}):null]})}const Hw={loading:!0,error:"",data:null};function Qt(t){return t==null||t===""?"-":t}function Af(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}function qw(){var $t,q,pe,Re,vt,xa;const[t,a]=i.useState(Hw),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState("all"),[c,d]=i.useState(1),[h,p]=i.useState("org"),[g,N]=i.useState(""),[v,w]=i.useState(""),[A,y]=i.useState(1),[x,f]=i.useState("org"),[b,k]=i.useState(""),[_,P]=i.useState(""),[S,F]=i.useState(1),[L,Q]=i.useState(""),[E,C]=i.useState(""),[z,M]=i.useState(1),[R,W]=i.useState("org"),[D,te]=i.useState(""),[H,O]=i.useState(""),[V,re]=i.useState(1),[Y,ce]=i.useState(""),[ie,ee]=i.useState(""),[T,Z]=i.useState(1),[se,be]=i.useState({open:!1,loading:!1,data:null,error:""}),[ne,ae]=i.useState({open:!1,loading:!1,data:null,error:"",form:{}}),X=ys(),ke=bs(),Ne=10;async function Ye(){const de=await U("/api/saas-admin/organizations");a({loading:!1,error:"",data:de})}i.useEffect(()=>{let de=!0;async function Pe(){try{const Te=await U("/api/saas-admin/organizations");if(!de)return;a({loading:!1,error:"",data:Te})}catch(Te){de&&a({loading:!1,error:(Te==null?void 0:Te.message)||"Unable to load organizations.",data:null})}}return Pe(),()=>{de=!1}},[]),i.useEffect(()=>{const de=setTimeout(()=>{r(s.trim()),d(1)},300);return()=>clearTimeout(de)},[s]),i.useEffect(()=>{const de=setTimeout(()=>{w(g.trim()),y(1)},300);return()=>clearTimeout(de)},[g]),i.useEffect(()=>{const de=setTimeout(()=>{P(b.trim()),F(1)},300);return()=>clearTimeout(de)},[b]),i.useEffect(()=>{const de=setTimeout(()=>{C(L.trim()),M(1)},300);return()=>clearTimeout(de)},[L]),i.useEffect(()=>{const de=setTimeout(()=>{O(D.trim()),re(1)},300);return()=>clearTimeout(de)},[D]),i.useEffect(()=>{const de=setTimeout(()=>{ee(Y.trim()),Z(1)},300);return()=>clearTimeout(de)},[Y]);const Ke=(($t=t.data)==null?void 0:$t.organizations)||[],mt=((q=t.data)==null?void 0:q.dealers)||[];(pe=t.data)!=null&&pe.plans;const Ie=((Re=t.data)==null?void 0:Re.products)||[],Xe=((vt=t.data)==null?void 0:vt.deleted_orgs)||[],nt=((xa=t.data)==null?void 0:xa.deleted_dealers)||[],Ae=i.useMemo(()=>{if(!l)return o==="all"?Ke:Ke.filter(Pe=>(Pe.products||[]).includes(o));const de=l.toLowerCase();return Ke.filter(Pe=>{var Ue,at;const Te=((Ue=Pe.subscription)==null?void 0:Ue.plan_name)||"",Je=[Pe.name,Pe.company_key,Pe.owner_name,Pe.owner_email,Te,(at=Pe.subscription)==null?void 0:at.end_date].some(qe=>String(qe||"").toLowerCase().includes(de)),fe=o==="all"||(Pe.products||[]).includes(o);return Je&&fe})},[Ke,l,o]),ue=Math.max(Math.ceil(Ae.length/Ne),1),je=i.useMemo(()=>Ae.slice((c-1)*Ne,c*Ne),[Ae,c]),Ce=Ae.length,Le=Ce?(c-1)*Ne+1:0,Fe=Ce?Math.min(c*Ne,Ce):0,ye=i.useMemo(()=>{if(!v)return mt;const de=v.toLowerCase();return mt.filter(Pe=>[Pe.name,Pe.email,Pe.referral_code,Pe.referred_by,Pe.subscription_status,Pe.subscription_end].some(Te=>String(Te||"").toLowerCase().includes(de)))},[mt,v]),Ze=Math.max(Math.ceil(ye.length/Ne),1),pt=i.useMemo(()=>ye.slice((A-1)*Ne,A*Ne),[ye,A]),ht=ye.length,Ge=ht?(A-1)*Ne+1:0,gt=ht?Math.min(A*Ne,ht):0,ft=i.useMemo(()=>Ke.filter(de=>{var Ue,at;const Pe=String(((Ue=de.subscription)==null?void 0:Ue.status)||"").toLowerCase(),Je=(de.product_statuses||[]).some(qe=>qe.status==="inactive"),fe=!((at=de.subscription)!=null&&at.plan_name);return Je||Pe==="inactive"||Pe==="expired"||fe}),[Ke]),G=i.useMemo(()=>{const de=ft.filter(Te=>o==="all"?!0:(Te.products||[]).includes(o));if(!_)return de;const Pe=_.toLowerCase();return de.filter(Te=>{var fe,Ue;const Je=((fe=Te.subscription)==null?void 0:fe.plan_name)||"";return[Te.name,Te.company_key,Te.owner_name,Te.owner_email,Je,(Ue=Te.subscription)==null?void 0:Ue.end_date].some(at=>String(at||"").toLowerCase().includes(Pe))})},[ft,_,o]),Se=Math.max(Math.ceil(G.length/Ne),1),ve=i.useMemo(()=>G.slice((S-1)*Ne,S*Ne),[G,S]),le=G.length,xe=le?(S-1)*Ne+1:0,ge=le?Math.min(S*Ne,le):0,B=i.useMemo(()=>mt.filter(de=>String(de.subscription_status||"").toLowerCase()!=="active"),[mt]),he=i.useMemo(()=>{if(!E)return B;const de=E.toLowerCase();return B.filter(Pe=>[Pe.name,Pe.email,Pe.referral_code,Pe.referred_by,Pe.subscription_status,Pe.subscription_end].some(Te=>String(Te||"").toLowerCase().includes(de)))},[B,E]),we=Math.max(Math.ceil(he.length/Ne),1),I=i.useMemo(()=>he.slice((z-1)*Ne,z*Ne),[he,z]),me=he.length,Me=me?(z-1)*Ne+1:0,De=me?Math.min(z*Ne,me):0,et=i.useMemo(()=>{if(!H)return Xe;const de=H.toLowerCase();return Xe.filter(Pe=>[Pe.organization_name,Pe.owner_username,Pe.owner_email,Pe.reason,Pe.deleted_at].some(Te=>String(Te||"").toLowerCase().includes(de)))},[Xe,H]),Qe=Math.max(Math.ceil(et.length/Ne),1),bt=i.useMemo(()=>et.slice((V-1)*Ne,V*Ne),[et,V]),ot=et.length,Xt=ot?(V-1)*Ne+1:0,Wt=ot?Math.min(V*Ne,ot):0,Vt=i.useMemo(()=>{if(!ie)return nt;const de=ie.toLowerCase();return nt.filter(Pe=>[Pe.name,Pe.email,Pe.reason,Pe.deleted_at].some(Te=>String(Te||"").toLowerCase().includes(de)))},[nt,ie]),kt=Math.max(Math.ceil(Vt.length/Ne),1),J=i.useMemo(()=>Vt.slice((T-1)*Ne,T*Ne),[Vt,T]),_e=Vt.length,K=_e?(T-1)*Ne+1:0,We=_e?Math.min(T*Ne,_e):0;i.useEffect(()=>{c>ue&&d(ue)},[c,ue]),i.useEffect(()=>{A>Ze&&y(Ze)},[A,Ze]),i.useEffect(()=>{S>Se&&F(Se)},[S,Se]),i.useEffect(()=>{z>we&&M(we)},[z,we]),i.useEffect(()=>{V>Qe&&re(Qe)},[V,Qe]),i.useEffect(()=>{T>kt&&Z(kt)},[T,kt]);function Be(){be({open:!1,loading:!1,data:null,error:""})}async function ct(de){if(await X({title:"Delete Organization",message:`Delete ${de.name}? This removes the organization and owner user.`,confirmText:"Delete",confirmVariant:"danger"}))try{await U(`/api/saas-admin/organizations/${de.id}`,{method:"DELETE"}),await Ye()}catch(Te){a(Je=>({...Je,error:(Te==null?void 0:Te.message)||"Unable to delete organization."}))}}async function lt(de){if(await X({title:"Delete Dealer",message:`Delete ${de.name||de.email}? This removes the dealer account and user login.`,confirmText:"Delete",confirmVariant:"danger"}))try{await U(`/api/saas-admin/dealers/${de.id}`,{method:"DELETE"}),await Ye()}catch(Te){a(Je=>({...Je,error:(Te==null?void 0:Te.message)||"Unable to delete dealer."}))}}async function St(de){if(!(!(de!=null&&de.id)||!await X({title:"Delete Deleted Account",message:`Delete deleted account entry for ${de.organization_name||"this organization"}?`,confirmText:"Delete",confirmVariant:"danger"})))try{await U(`/api/saas-admin/deleted-accounts/${de.id}`,{method:"DELETE"}),await Ye()}catch(Te){a(Je=>({...Je,error:(Te==null?void 0:Te.message)||"Unable to delete deleted account."}))}}return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading organizations..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"page-title",children:"Organizations"}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex gap-2 flex-wrap mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${h==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>p("org"),children:"ORG Accounts"}),e.jsx("button",{type:"button",className:`btn btn-sm ${h==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>p("dealer"),children:"Dealer Accounts"})]}),h==="org"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",Ne," entries"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsxs("label",{className:"table-search",htmlFor:"saas-org-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-org-search",type:"text",value:s,onChange:de=>n(de.target.value),placeholder:"Search organizations"})]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-org-product",children:[e.jsx("span",{children:"Product:"}),e.jsxs("select",{id:"saas-org-product",value:o,onChange:de=>{u(de.target.value),d(1)},children:[e.jsx("option",{value:"all",children:"All"}),Ie.map(de=>e.jsx("option",{value:de.slug,children:de.name},de.slug))]})]})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Admin User Name"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Products"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Expire Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:je.length?je.map(de=>{var Pe,Te;return e.jsxs("tr",{children:[e.jsx("td",{children:de.name}),e.jsx("td",{children:Qt(de.owner_name)}),e.jsx("td",{children:Qt(de.owner_email)}),e.jsx("td",{children:de.product_statuses&&de.product_statuses.length?de.product_statuses.map(Je=>Je.name).join(", "):"-"}),e.jsx("td",{children:((Pe=de.subscription)==null?void 0:Pe.plan_name)||"-"}),e.jsx("td",{children:((Te=de.subscription)==null?void 0:Te.end_date)||"-"}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>ke(`/saas-admin/organizations/${de.id}`),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>ke(`/saas-admin/organizations/${de.id}#edit`),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>ct(de),children:"Delete"})]})]},de.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No organizations found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Le," to ",Fe," of ",Ce," entries"]}),e.jsx(st,{page:c,totalPages:ue,onPageChange:d,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",Ne," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-dealer-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-dealer-search",type:"text",value:g,onChange:de=>N(de.target.value),placeholder:"Search dealers"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Referral Code"}),e.jsx("th",{children:"Referred By"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:pt.length?pt.map(de=>e.jsxs("tr",{children:[e.jsx("td",{children:de.name||"-"}),e.jsx("td",{children:Qt(de.email)}),e.jsx("td",{children:Qt(de.referral_code)}),e.jsx("td",{children:Qt(de.referred_by)}),e.jsx("td",{children:Af(de.subscription_status)}),e.jsx("td",{children:de.subscription_start||"-"}),e.jsx("td",{children:de.subscription_end||"-"}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>ke(`/saas-admin/dealers/${de.id}`),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>ke(`/saas-admin/dealers/${de.id}#edit`),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>lt(de),children:"Delete"})]})]},de.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No dealers found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Ge," to ",gt," of ",ht," entries"]}),e.jsx(st,{page:A,totalPages:Ze,onPageChange:y,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]}),e.jsxs("div",{className:"card p-3 mt-4",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h4",{className:"mb-0",children:"Inactive Accounts"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-3 mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${x==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>f("org"),children:"ORG Accounts"}),e.jsx("button",{type:"button",className:`btn btn-sm ${x==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>f("dealer"),children:"Dealer Accounts"})]}),x==="org"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",Ne," entries"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsxs("label",{className:"table-search",htmlFor:"saas-inactive-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-inactive-search",type:"text",value:b,onChange:de=>k(de.target.value),placeholder:"Search organizations"})]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-inactive-product",children:[e.jsx("span",{children:"Product:"}),e.jsxs("select",{id:"saas-inactive-product",value:o,onChange:de=>{u(de.target.value),F(1)},children:[e.jsx("option",{value:"all",children:"All"}),Ie.map(de=>e.jsx("option",{value:de.slug,children:de.name},de.slug))]})]})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Admin User Name"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Products"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Expire Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:ve.length?ve.map(de=>{var Pe,Te;return e.jsxs("tr",{children:[e.jsx("td",{children:de.name}),e.jsx("td",{children:Qt(de.owner_name)}),e.jsx("td",{children:Qt(de.owner_email)}),e.jsx("td",{children:de.product_statuses&&de.product_statuses.length?de.product_statuses.map(Je=>Je.name).join(", "):"-"}),e.jsx("td",{children:((Pe=de.subscription)==null?void 0:Pe.plan_name)||"-"}),e.jsx("td",{children:((Te=de.subscription)==null?void 0:Te.end_date)||"-"}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>ke(`/saas-admin/organizations/${de.id}`),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>ke(`/saas-admin/organizations/${de.id}#edit`),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>ct(de),children:"Delete"})]})]},`inactive-${de.id}`)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No inactive organizations found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",xe," to ",ge," of ",le," entries"]}),e.jsx(st,{page:S,totalPages:Se,onPageChange:F,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",Ne," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-inactive-dealer-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-inactive-dealer-search",type:"text",value:L,onChange:de=>Q(de.target.value),placeholder:"Search dealers"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Referral Code"}),e.jsx("th",{children:"Referred By"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:I.length?I.map(de=>e.jsxs("tr",{children:[e.jsx("td",{children:de.name||"-"}),e.jsx("td",{children:Qt(de.email)}),e.jsx("td",{children:Qt(de.referral_code)}),e.jsx("td",{children:Qt(de.referred_by)}),e.jsx("td",{children:Af(de.subscription_status)}),e.jsx("td",{children:de.subscription_start||"-"}),e.jsx("td",{children:de.subscription_end||"-"}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>ke(`/saas-admin/dealers/${de.id}`),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>ke(`/saas-admin/dealers/${de.id}#edit`),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>lt(de),children:"Delete"})]})]},`inactive-dealer-${de.id}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No inactive dealers found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Me," to ",De," of ",me," entries"]}),e.jsx(st,{page:z,totalPages:we,onPageChange:M,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]}),e.jsxs("div",{className:"card p-3 mt-4",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h4",{className:"mb-0",children:"Deleted Accounts"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-3 mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${R==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>W("org"),children:"ORG Accounts"}),e.jsx("button",{type:"button",className:`btn btn-sm ${R==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>W("dealer"),children:"Dealer Accounts"})]}),R==="org"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",Ne," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-deleted-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-deleted-search",type:"text",value:D,onChange:de=>te(de.target.value),placeholder:"Search organizations"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Admin User Name"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Deleted At"}),e.jsx("th",{children:"Reason"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:bt.length?bt.map((de,Pe)=>e.jsxs("tr",{children:[e.jsx("td",{children:Qt(de.organization_name)}),e.jsx("td",{children:Qt(de.owner_username)}),e.jsx("td",{children:Qt(de.owner_email)}),e.jsx("td",{children:Qt(de.deleted_at)}),e.jsx("td",{children:Qt(de.reason)}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>St(de),disabled:!de.id,children:"Delete"})})]},`deleted-org-${de.organization_name}-${Pe}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No deleted organizations found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Xt," to ",Wt," of ",ot," entries"]}),e.jsx(st,{page:V,totalPages:Qe,onPageChange:re,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",Ne," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-deleted-dealer-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-deleted-dealer-search",type:"text",value:Y,onChange:de=>ce(de.target.value),placeholder:"Search dealers"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Deleted At"}),e.jsx("th",{children:"Reason"})]})}),e.jsx("tbody",{children:J.length?J.map((de,Pe)=>e.jsxs("tr",{children:[e.jsx("td",{children:Qt(de.name)}),e.jsx("td",{children:Qt(de.email)}),e.jsx("td",{children:Qt(de.deleted_at)}),e.jsx("td",{children:Qt(de.reason)})]},`deleted-dealer-${de.id||de.email}-${Pe}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No deleted dealers found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",K," to ",We," of ",_e," entries"]}),e.jsx(st,{page:T,totalPages:kt,onPageChange:Z,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]}),se.open?e.jsx("div",{className:"modal-overlay",onClick:Be,children:e.jsxs("div",{className:"modal-panel",onClick:de=>de.stopPropagation(),children:[e.jsx("h5",{children:"Organization Details"}),e.jsx("div",{className:"text-secondary",children:"Use the separate organization page to view and edit details."}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:Be,children:"Close"})})]})}):null]})}const Qw={loading:!0,error:"",data:null};function Ir(t){return t==null||t===""?"-":t}function dc(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}function Jw(){var C,z,M;const{dealerId:t}=js(),a=ua(),s=bs(),[n,l]=i.useState(Qw),[r,o]=i.useState(""),[u,c]=i.useState("org"),[d,h]=i.useState(""),[p,g]=i.useState(""),[N,v]=i.useState(1),[w,A]=i.useState({name:"",email:"",phone_number:"",address_line1:"",address_line2:"",city:"",state:"",postal_code:"",bank_name:"",bank_account_number:"",bank_ifsc:"",upi_id:"",subscription_status:"pending"}),y=8;i.useEffect(()=>{let R=!0;async function W(){o("");try{const D=await U(`/api/saas-admin/dealers/${t}`);if(!R)return;l({loading:!1,error:"",data:D});const te=D.dealer||{};A({name:te.name||"",email:te.email||"",phone_number:te.phone_number||"",address_line1:te.address_line1||"",address_line2:te.address_line2||"",city:te.city||"",state:te.state||"",postal_code:te.postal_code||"",bank_name:te.bank_name||"",bank_account_number:te.bank_account_number||"",bank_ifsc:te.bank_ifsc||"",upi_id:te.upi_id||"",subscription_status:te.subscription_status||"pending"})}catch(D){R&&l({loading:!1,error:(D==null?void 0:D.message)||"Unable to load dealer details.",data:null})}}return W(),()=>{R=!1}},[t]),i.useEffect(()=>{const R=setTimeout(()=>{g(d.trim()),v(1)},300);return()=>clearTimeout(R)},[d]),i.useEffect(()=>{if(a.hash==="#edit"){const R=document.getElementById("dealer-edit-section");R&&R.scrollIntoView({behavior:"smooth"})}},[a.hash]);async function x(R){R.preventDefault(),o("");try{await U(`/api/saas-admin/dealers/${t}`,{method:"PUT",body:JSON.stringify(w)}),o("Dealer details updated.")}catch(W){l(D=>({...D,error:(W==null?void 0:W.message)||"Unable to update dealer."}))}}const f=((C=n.data)==null?void 0:C.org_referrals)||[],b=((z=n.data)==null?void 0:z.dealer_referrals)||[],k=u==="dealer"?b:f,_=i.useMemo(()=>{if(!p)return k;const R=p.toLowerCase();return k.filter(W=>[W.referred_org,W.referred_dealer,W.transfer_id,W.base_amount,W.commission_rate,W.commission_amount,W.flat_amount,W.status,W.payout_reference,W.payout_date,W.created_at].some(D=>String(D||"").toLowerCase().includes(R)))},[k,p]),P=Math.max(Math.ceil(_.length/y),1),S=i.useMemo(()=>_.slice((N-1)*y,N*y),[_,N]),F=_.length,L=F?(N-1)*y+1:0,Q=F?Math.min(N*y,F):0;if(n.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading dealer..."})]});const E=((M=n.data)==null?void 0:M.dealer)||{};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h3",{className:"page-title",children:"Dealer Details"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>s("/saas-admin/organizations"),children:"Back"})]}),r?e.jsx("div",{className:"alert alert-success mt-2",children:r}):null,n.error?e.jsx("div",{className:"alert alert-danger mt-2",children:n.error}):null,e.jsx("div",{className:"card p-3 mt-3",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("h5",{children:"Profile"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Referral Code:"})," ",Ir(E.referral_code)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Referred By:"})," ",Ir(E.referred_by)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Subscription Status:"})," ",dc(E.subscription_status)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Start Date:"})," ",Ir(E.subscription_start)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"End Date:"})," ",Ir(E.subscription_end)]})]}),e.jsxs("div",{className:"col-12 col-lg-6",id:"dealer-edit-section",children:[e.jsx("h5",{children:"Edit Dealer"}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:w.name,onChange:R=>A(W=>({...W,name:R.target.value})),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:w.email,onChange:R=>A(W=>({...W,email:R.target.value})),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{type:"text",className:"form-control",value:w.phone_number,onChange:R=>A(W=>({...W,phone_number:R.target.value}))})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:w.subscription_status,onChange:R=>A(W=>({...W,subscription_status:R.target.value})),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm",children:"Save"})]})]})]})}),e.jsx("div",{className:"card p-3 mt-3",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("h5",{children:"Bank Details"}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Bank Name"}),e.jsx("input",{type:"text",className:"form-control",value:w.bank_name,onChange:R=>A(W=>({...W,bank_name:R.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Account Number"}),e.jsx("input",{type:"text",className:"form-control",value:w.bank_account_number,onChange:R=>A(W=>({...W,bank_account_number:R.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"IFSC"}),e.jsx("input",{type:"text",className:"form-control",value:w.bank_ifsc,onChange:R=>A(W=>({...W,bank_ifsc:R.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"UPI ID"}),e.jsx("input",{type:"text",className:"form-control",value:w.upi_id,onChange:R=>A(W=>({...W,upi_id:R.target.value}))})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm mt-3",children:"Save Bank Details"})]})]}),e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("h5",{children:"Address"}),e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Address Line 1"}),e.jsx("input",{type:"text",className:"form-control",value:w.address_line1,onChange:R=>A(W=>({...W,address_line1:R.target.value}))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Address Line 2"}),e.jsx("input",{type:"text",className:"form-control",value:w.address_line2,onChange:R=>A(W=>({...W,address_line2:R.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",className:"form-control",value:w.city,onChange:R=>A(W=>({...W,city:R.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"State"}),e.jsx("input",{type:"text",className:"form-control",value:w.state,onChange:R=>A(W=>({...W,state:R.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Pincode"}),e.jsx("input",{type:"text",className:"form-control",value:w.postal_code,onChange:R=>A(W=>({...W,postal_code:R.target.value}))})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm mt-3",children:"Save Address"})]})]})]})}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex gap-2 flex-wrap mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${u==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>c("org"),children:"ORG Referrals"}),e.jsx("button",{type:"button",className:`btn btn-sm ${u==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>c("dealer"),children:"Dealer Referrals"})]}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",y," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dealer-referral-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dealer-referral-search",type:"text",value:d,onChange:R=>h(R.target.value),placeholder:"Search referrals"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:u==="org"?e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Transfer"}),e.jsx("th",{children:"Base Amount"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]}):e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Flat Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]})}),e.jsx("tbody",{children:S.length?S.map(R=>e.jsx("tr",{children:u==="org"?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:R.referred_org||"-"}),e.jsx("td",{children:R.transfer_id||"-"}),e.jsx("td",{children:R.base_amount??"-"}),e.jsxs("td",{children:[R.commission_rate??0,"%"]}),e.jsx("td",{children:R.commission_amount??"-"}),e.jsx("td",{children:dc(R.status)}),e.jsx("td",{children:R.payout_reference||"-"}),e.jsx("td",{children:R.payout_date||"-"})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{children:R.referred_dealer||"-"}),e.jsx("td",{children:R.flat_amount??"-"}),e.jsx("td",{children:dc(R.status)}),e.jsx("td",{children:R.payout_reference||"-"}),e.jsx("td",{children:R.payout_date||"-"})]})},R.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:u==="org"?8:5,children:"No referrals found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",L," to ",Q," of ",F," entries"]}),e.jsx(st,{page:N,totalPages:P,onPageChange:v,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})}const Kw={loading:!0,error:"",data:null},Yw={india:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"],"united states":["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],canada:["Alberta","British Columbia","Manitoba","New Brunswick","Newfoundland and Labrador","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Northwest Territories","Nunavut","Yukon"],australia:["Australian Capital Territory","New South Wales","Northern Territory","Queensland","South Australia","Tasmania","Victoria","Western Australia"],"united kingdom":["England","Northern Ireland","Scotland","Wales"]};function Zw(t){return String(t||"").trim().toLowerCase()}function Tf(t){return Yw[Zw(t)]||[]}function Tt(t){return t==null||t===""?"-":t}function uc(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}function Xw(){var f,b,k,_,P,S,F;const{orgId:t}=js(),a=ua(),s=bs(),[n,l]=i.useState(Kw),[r,o]=i.useState(""),[u,c]=i.useState([]),[d,h]=i.useState({name:"",company_key:"",owner_username:"",owner_first_name:"",owner_last_name:"",owner_email:"",plan_id:"",billing_cycle:"monthly",status:"active",end_date:"",addon_count:0}),[p,g]=i.useState({contact_name:"",company_name:"",email:"",phone:"",address_line1:"",address_line2:"",city:"",state:"",postal_code:"",country:"",gstin:""});i.useEffect(()=>{let L=!0;async function Q(){var E,C;o("");try{const z=await U(`/api/saas-admin/organizations/${t}`);if(!L)return;l({loading:!1,error:"",data:z});const M=z.owner||{},R=z.subscription||{},W=z.billing_profile||{};h({name:((E=z.organization)==null?void 0:E.name)||"",company_key:((C=z.organization)==null?void 0:C.company_key)||"",owner_username:M.username||"",owner_first_name:M.first_name||"",owner_last_name:M.last_name||"",owner_email:M.email||"",plan_id:R.plan_id||"",billing_cycle:R.billing_cycle||"monthly",status:R.status||"active",end_date:R.end_date||"",addon_count:R.addon_count??0}),g({contact_name:W.contact_name||"",company_name:W.company_name||"",email:W.email||"",phone:W.phone||"",address_line1:W.address_line1||"",address_line2:W.address_line2||"",city:W.city||"",state:W.state||"",postal_code:W.postal_code||"",country:W.country||"",gstin:W.gstin||""})}catch(z){L&&l({loading:!1,error:(z==null?void 0:z.message)||"Unable to load organization.",data:null})}}return Q(),()=>{L=!1}},[t]),i.useEffect(()=>{let L=!0;async function Q(){try{const E=await U("/api/saas-admin/plans");if(!L)return;c(E.plans||[])}catch{L&&c([])}}return Q(),()=>{L=!1}},[]),i.useEffect(()=>{if(a.hash==="#edit"){const L=document.getElementById("org-edit-section");L&&L.scrollIntoView({behavior:"smooth"})}},[a.hash]);async function N(L){L.preventDefault(),o("");try{await U(`/api/saas-admin/organizations/${t}`,{method:"PUT",body:JSON.stringify({name:d.name,company_key:d.company_key,owner_username:d.owner_username,owner_first_name:d.owner_first_name,owner_last_name:d.owner_last_name,owner_email:d.owner_email,plan_id:d.plan_id||null,billing_cycle:d.billing_cycle,status:d.status,end_date:d.end_date,addon_count:d.addon_count,billing_contact_name:p.contact_name,billing_company_name:p.company_name,billing_email:p.email,billing_phone:p.phone,billing_address_line1:p.address_line1,billing_address_line2:p.address_line2,billing_city:p.city,billing_state:p.state,billing_postal_code:p.postal_code,billing_country:p.country,billing_gstin:p.gstin})}),o("Organization updated.")}catch(Q){l(E=>({...E,error:(Q==null?void 0:Q.message)||"Unable to update organization."}))}}if(n.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading organization..."})]});const v=((f=n.data)==null?void 0:f.organization)||{},w=((b=n.data)==null?void 0:b.owner)||{},A=((k=n.data)==null?void 0:k.subscription)||{},y=((_=n.data)==null?void 0:_.billing_profile)||{},x=((P=n.data)==null?void 0:P.settings)||{};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h3",{className:"page-title",children:"Organization Details"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>s("/saas-admin/organizations"),children:"Back"})]}),r?e.jsx("div",{className:"alert alert-success mt-2",children:r}):null,n.error?e.jsx("div",{className:"alert alert-danger mt-2",children:n.error}):null,e.jsx("div",{className:"card p-3 mt-3",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("h5",{children:"Profile"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Name:"})," ",Tt(v.name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Company Key:"})," ",Tt(v.company_key)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Created:"})," ",Tt(v.created_at)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner:"})," ",Tt(`${w.first_name||""} ${w.last_name||""}`.trim())]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner Email:"})," ",Tt(w.email)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner Phone:"})," ",Tt((F=(S=n.data)==null?void 0:S.profile)==null?void 0:F.phone_number)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner Username:"})," ",Tt(w.username)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Plan:"})," ",Tt(A.plan_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Status:"})," ",uc(A.status)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Billing Cycle:"})," ",uc(A.billing_cycle)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"End Date:"})," ",Tt(A.end_date)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Add-ons:"})," ",Tt(A.addon_count)]})]}),e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("h5",{children:"Billing Profile"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Contact Name:"})," ",Tt(y.contact_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Company Name:"})," ",Tt(y.company_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Email:"})," ",Tt(y.email)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Phone:"})," ",Tt(y.phone)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Address:"})," ",Tt(y.address_line1)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Address 2:"})," ",Tt(y.address_line2)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"City:"})," ",Tt(y.city)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"State:"})," ",Tt(y.state)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Postal Code:"})," ",Tt(y.postal_code)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Country:"})," ",Tt(y.country)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"GSTIN:"})," ",Tt(y.gstin)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Updated:"})," ",Tt(y.updated_at)]})]})]})}),e.jsxs("div",{className:"card p-3 mt-3",id:"org-edit-section",children:[e.jsx("h5",{children:"Edit Organization"}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"modal-form-grid",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Organization Name"}),e.jsx("input",{type:"text",className:"form-control",value:d.name,onChange:L=>h(Q=>({...Q,name:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Company Key"}),e.jsx("input",{type:"text",className:"form-control",value:d.company_key,onChange:L=>h(Q=>({...Q,company_key:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Username"}),e.jsx("input",{type:"text",className:"form-control",value:d.owner_username,onChange:L=>h(Q=>({...Q,owner_username:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin First Name"}),e.jsx("input",{type:"text",className:"form-control",value:d.owner_first_name,onChange:L=>h(Q=>({...Q,owner_first_name:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Last Name"}),e.jsx("input",{type:"text",className:"form-control",value:d.owner_last_name,onChange:L=>h(Q=>({...Q,owner_last_name:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Email"}),e.jsx("input",{type:"email",className:"form-control",value:d.owner_email,onChange:L=>h(Q=>({...Q,owner_email:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan"}),e.jsxs("select",{className:"form-select",value:d.plan_id||"",onChange:L=>h(Q=>({...Q,plan_id:Number(L.target.value)||""})),children:[e.jsx("option",{value:"",children:"Select Plan"}),u.map(L=>e.jsx("option",{value:L.id,children:L.name},L.id))]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Billing Cycle"}),e.jsxs("select",{className:"form-select",value:d.billing_cycle,onChange:L=>h(Q=>({...Q,billing_cycle:L.target.value})),children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:d.status,onChange:L=>h(Q=>({...Q,status:L.target.value})),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Expire Date"}),e.jsx("input",{type:"date",className:"form-control",value:d.end_date||"",onChange:L=>h(Q=>({...Q,end_date:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Add-on Count"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:d.addon_count??0,onChange:L=>h(Q=>({...Q,addon_count:L.target.value}))})]})]}),e.jsx("div",{className:"d-flex justify-content-end gap-2 mt-3",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"Edit Billing Profile"}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"modal-form-grid",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Contact Name"}),e.jsx("input",{type:"text",className:"form-control",value:p.contact_name,onChange:L=>g(Q=>({...Q,contact_name:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Company Name"}),e.jsx("input",{type:"text",className:"form-control",value:p.company_name,onChange:L=>g(Q=>({...Q,company_name:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:p.email,onChange:L=>g(Q=>({...Q,email:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{type:"text",className:"form-control",value:p.phone,onChange:L=>g(Q=>({...Q,phone:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Address Line 1"}),e.jsx("input",{type:"text",className:"form-control",value:p.address_line1,onChange:L=>g(Q=>({...Q,address_line1:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Address Line 2"}),e.jsx("input",{type:"text",className:"form-control",value:p.address_line2,onChange:L=>g(Q=>({...Q,address_line2:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",className:"form-control",value:p.city,onChange:L=>g(Q=>({...Q,city:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Postal Code"}),e.jsx("input",{type:"text",className:"form-control",value:p.postal_code,onChange:L=>g(Q=>({...Q,postal_code:L.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{type:"text",className:"form-control",value:p.country,onChange:L=>{const Q=L.target.value,E=Tf(Q);g(C=>({...C,country:Q,state:E.length&&!E.includes(C.state)?"":C.state}))},list:"country-options"})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"State"}),e.jsx("input",{type:"text",className:"form-control",value:p.state,onChange:L=>g(Q=>({...Q,state:L.target.value})),list:"state-options",disabled:!String(p.country||"").trim()})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"GSTIN"}),e.jsx("input",{type:"text",className:"form-control",value:p.gstin,onChange:L=>g(Q=>({...Q,gstin:L.target.value}))})]})]}),e.jsx("div",{className:"d-flex justify-content-end gap-2 mt-3",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Billing Profile"})})]}),e.jsx("datalist",{id:"country-options",children:Zi.map(L=>e.jsx("option",{value:L},L))}),e.jsx("datalist",{id:"state-options",children:Tf(p.country).map(L=>e.jsx("option",{value:L},L))})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"Settings"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Screenshot Interval:"})," ",Tt(x.screenshot_interval_minutes)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Monitoring Mode:"})," ",uc(x.monitoring_mode)]})]})]})}const e0={loading:!0,error:"",data:null};function t0(){var Xe,nt,Ae;const[t,a]=i.useState(e0),[s,n]=i.useState(""),[l,r]=i.useState("org"),[o,u]=i.useState("0"),[c,d]=i.useState("0"),[h,p]=i.useState("0"),[g,N]=i.useState("0"),[v,w]=i.useState({}),[A,y]=i.useState({}),[x,f]=i.useState({}),[b,k]=i.useState(""),[_,P]=i.useState(""),[S,F]=i.useState(1),[L,Q]=i.useState({org:{pending:{term:"",page:1},paid:{term:"",page:1},rejected:{term:"",page:1}},dealer:{pending:{term:"",page:1},paid:{term:"",page:1},rejected:{term:"",page:1}}}),E=10;i.useEffect(()=>{let ue=!0;async function je(){var Ce,Le,Fe,ye;n("");try{const Ze=await U("/api/saas-admin/referrals");if(!ue)return;a({loading:!1,error:"",data:Ze}),u(String(((Ce=Ze.settings)==null?void 0:Ce.commission_rate)??0)),d(String(((Le=Ze.settings)==null?void 0:Le.dealer_commission_rate)??0)),p(String(((Fe=Ze.settings)==null?void 0:Fe.dealer_subscription_amount)??0)),N(String(((ye=Ze.settings)==null?void 0:ye.dealer_referral_flat_amount)??0))}catch(Ze){ue&&a({loading:!1,error:(Ze==null?void 0:Ze.message)||"Unable to load referral data.",data:null})}}return je(),()=>{ue=!1}},[]),i.useEffect(()=>{const ue=setTimeout(()=>{P(b.trim()),F(1)},300);return()=>clearTimeout(ue)},[b]);const C=((Xe=t.data)==null?void 0:Xe.org_earnings)||[],z=((nt=t.data)==null?void 0:nt.dealer_earnings)||[],M=((Ae=t.data)==null?void 0:Ae.dealers)||[],R=i.useMemo(()=>C.map(ue=>({...ue,form:v[ue.id]||{status:ue.status,payout_reference:ue.payout_reference||"",payout_date:ue.payout_date||""}})),[C,v]),W=i.useMemo(()=>z.map(ue=>({...ue,form:x[ue.id]||{status:ue.status,payout_reference:ue.payout_reference||"",payout_date:ue.payout_date||""}})),[z,x]),D=i.useMemo(()=>M.map(ue=>({...ue,form:A[ue.id]||{subscription_status:ue.subscription_status,subscription_start:te(ue.subscription_start),subscription_end:te(ue.subscription_end),subscription_amount:ue.subscription_amount??0}})),[M,A]);function te(ue){if(!ue)return"";const je=String(ue);return je.includes("T")?je.split("T")[0]:je.includes(" ")?je.split(" ")[0]:je}const H=i.useMemo(()=>{if(!_)return D;const ue=_.toLowerCase();return D.filter(je=>{var Ce,Le,Fe,ye;return[je.username,je.email,je.referral_code,je.referred_by,(Ce=je.form)==null?void 0:Ce.subscription_status,(Le=je.form)==null?void 0:Le.subscription_start,(Fe=je.form)==null?void 0:Fe.subscription_end,(ye=je.form)==null?void 0:ye.subscription_amount].some(Ze=>String(Ze||"").toLowerCase().includes(ue))})},[D,_]),O=Math.max(Math.ceil(H.length/E),1),V=i.useMemo(()=>H.slice((S-1)*E,S*E),[H,S]),re=H.length,Y=re?(S-1)*E+1:0,ce=re?Math.min(S*E,re):0;i.useEffect(()=>{S>O&&F(O)},[S,O]);function ie(ue,je,Ce){Q(Le=>({...Le,[ue]:{...Le[ue],[je]:{...Le[ue][je],...Ce}}}))}function ee(ue){const je={pending:[],paid:[],rejected:[]};return ue.forEach(Ce=>{const Le=String(Ce.status||"pending").toLowerCase();Le==="paid"?je.paid.push(Ce):Le==="rejected"?je.rejected.push(Ce):je.pending.push(Ce)}),je}function T(ue,je){if(!je)return ue;const Ce=je.toLowerCase();return ue.filter(Le=>[Le.referrer_org,Le.referred_org,Le.referrer_dealer,Le.referred_dealer,Le.transfer_id,Le.base_amount,Le.commission_rate,Le.commission_amount,Le.flat_amount,Le.status,Le.payout_reference,Le.payout_date].some(Fe=>String(Fe||"").toLowerCase().includes(Ce)))}function Z(ue,je,Ce){const Le=T(ue,je),Fe=Math.max(Math.ceil(Le.length/E),1),ye=Math.min(Ce,Fe),Ze=(ye-1)*E,pt=Le.slice(Ze,Ze+E);return{filtered:Le,paged:pt,totalPages:Fe,currentPage:ye,startIndex:Ze}}const se=i.useMemo(()=>ee(R),[R]),be=i.useMemo(()=>ee(W),[W]);function ne(ue,je,Ce){const Le=L.org[Ce],{filtered:Fe,paged:ye,totalPages:Ze,currentPage:pt,startIndex:ht}=Z(ue,Le.term,Le.page);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:je}),e.jsxs("label",{className:"table-search",htmlFor:`referrals-org-${Ce}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`referrals-org-${Ce}-search`,type:"text",value:Le.term,onChange:Ge=>ie("org",Ce,{term:Ge.target.value,page:1}),placeholder:"Search"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Referrer"}),e.jsx("th",{children:"Referred Org"}),e.jsx("th",{children:"Transfer"}),e.jsx("th",{children:"Base Amount"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:ye.length?ye.map(Ge=>e.jsxs("tr",{children:[e.jsx("td",{children:Ge.referrer_org||"-"}),e.jsx("td",{children:Ge.referred_org||"-"}),e.jsx("td",{children:Ge.transfer_id||"-"}),e.jsx("td",{children:Ge.base_amount??"-"}),e.jsxs("td",{children:[Ge.commission_rate??0,"%"]}),e.jsx("td",{children:Ge.commission_amount??"-"}),e.jsx("td",{children:e.jsxs("select",{className:"form-select form-select-sm",value:Ge.form.status||"pending",onChange:gt=>X(Ge.id,"status",gt.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"form-control form-control-sm",value:Ge.form.payout_reference||"",onChange:gt=>X(Ge.id,"payout_reference",gt.target.value),placeholder:"Ref: 251245"})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"form-control form-control-sm",value:Ge.form.payout_date||"",onChange:gt=>X(Ge.id,"payout_date",gt.target.value)})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-outline-light btn-sm",type:"button",onClick:()=>Ke(Ge),children:"Update"})})]},Ge.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",children:"No referrals found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Fe.length?ht+1:0," to ",Math.min(ht+E,Fe.length)," of"," ",Fe.length," entries"]}),e.jsx(st,{page:pt,totalPages:Ze,onPageChange:Ge=>ie("org",Ce,{page:Ge}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function ae(ue,je,Ce){const Le=L.dealer[Ce],{filtered:Fe,paged:ye,totalPages:Ze,currentPage:pt,startIndex:ht}=Z(ue,Le.term,Le.page);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:je}),e.jsxs("label",{className:"table-search",htmlFor:`referrals-dealer-${Ce}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`referrals-dealer-${Ce}-search`,type:"text",value:Le.term,onChange:Ge=>ie("dealer",Ce,{term:Ge.target.value,page:1}),placeholder:"Search"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Referrer"}),e.jsx("th",{children:"Referred Org"}),e.jsx("th",{children:"Referred Dealer"}),e.jsx("th",{children:"Transfer"}),e.jsx("th",{children:"Base"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Flat"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:ye.length?ye.map(Ge=>e.jsxs("tr",{children:[e.jsx("td",{children:Ge.referrer_dealer||"-"}),e.jsx("td",{children:Ge.referred_org||"-"}),e.jsx("td",{children:Ge.referred_dealer||"-"}),e.jsx("td",{children:Ge.transfer_id||"-"}),e.jsx("td",{children:Ge.base_amount??"-"}),e.jsxs("td",{children:[Ge.commission_rate??0,"%"]}),e.jsx("td",{children:Ge.commission_amount??"-"}),e.jsx("td",{children:Ge.flat_amount??"-"}),e.jsx("td",{children:e.jsxs("select",{className:"form-select form-select-sm",value:Ge.form.status||"pending",onChange:gt=>Ne(Ge.id,"status",gt.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"form-control form-control-sm",value:Ge.form.payout_reference||"",onChange:gt=>Ne(Ge.id,"payout_reference",gt.target.value),placeholder:"Ref: 251245"})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"form-control form-control-sm",value:Ge.form.payout_date||"",onChange:gt=>Ne(Ge.id,"payout_date",gt.target.value)})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-outline-light btn-sm",type:"button",onClick:()=>Ie(Ge),children:"Update"})})]},Ge.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"12",children:"No referrals found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Fe.length?ht+1:0," to ",Math.min(ht+E,Fe.length)," of"," ",Fe.length," entries"]}),e.jsx(st,{page:pt,totalPages:Ze,onPageChange:Ge=>ie("dealer",Ce,{page:Ge}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function X(ue,je,Ce){w(Le=>({...Le,[ue]:{...Le[ue]||{},[je]:Ce}}))}function ke(ue,je,Ce){y(Le=>({...Le,[ue]:{...Le[ue]||{},[je]:Ce}}))}function Ne(ue,je,Ce){f(Le=>({...Le,[ue]:{...Le[ue]||{},[je]:Ce}}))}async function Ye(ue){ue.preventDefault(),n("");try{const je=await U("/api/saas-admin/referrals/settings",{method:"POST",body:JSON.stringify({commission_rate:o,dealer_commission_rate:c,dealer_subscription_amount:h,dealer_referral_flat_amount:g})});n("Referral commission updated."),u(String(je.commission_rate??0)),d(String(je.dealer_commission_rate??0)),p(String(je.dealer_subscription_amount??0)),N(String(je.dealer_referral_flat_amount??0))}catch(je){n(""),a(Ce=>({...Ce,error:(je==null?void 0:je.message)||"Unable to update commission rate."}))}}async function Ke(ue){n("");try{const je=ue.form||{};await U(`/api/saas-admin/referrals/earnings/${ue.id}`,{method:"POST",body:JSON.stringify(je)}),n("Referral payout updated."),w(Le=>{const Fe={...Le};return delete Fe[ue.id],Fe});const Ce=await U("/api/saas-admin/referrals");a({loading:!1,error:"",data:Ce})}catch(je){n(""),a(Ce=>({...Ce,error:(je==null?void 0:je.message)||"Unable to update payout."}))}}async function mt(ue){n("");try{await U(`/api/saas-admin/referrals/dealers/${ue.id}`,{method:"POST",body:JSON.stringify(ue.form||{})}),n("Dealer subscription updated."),y(Ce=>{const Le={...Ce};return delete Le[ue.id],Le});const je=await U("/api/saas-admin/referrals");a({loading:!1,error:"",data:je})}catch(je){n(""),a(Ce=>({...Ce,error:(je==null?void 0:je.message)||"Unable to update dealer subscription."}))}}async function Ie(ue){n("");try{const je=ue.form||{};await U(`/api/saas-admin/referrals/dealer-earnings/${ue.id}`,{method:"POST",body:JSON.stringify(je)}),n("Dealer payout updated."),f(Le=>{const Fe={...Le};return delete Fe[ue.id],Fe});const Ce=await U("/api/saas-admin/referrals");a({loading:!1,error:"",data:Ce})}catch(je){n(""),a(Ce=>({...Ce,error:(je==null?void 0:je.message)||"Unable to update dealer payout."}))}}return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading referrals..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Referral Program"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsx("h5",{children:"Referral Commission Settings"}),e.jsxs("form",{onSubmit:Ye,className:"referral-settings-grid",children:[e.jsxs("div",{className:"referral-settings-field",children:[e.jsx("label",{className:"form-label",children:"ORG Commission Rate (%)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"form-control",value:o,onChange:ue=>u(ue.target.value)})]}),e.jsxs("div",{className:"referral-settings-field",children:[e.jsx("label",{className:"form-label",children:"Dealer Commission Rate (%)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"form-control",value:c,onChange:ue=>d(ue.target.value)})]}),e.jsxs("div",{className:"referral-settings-field",children:[e.jsx("label",{className:"form-label",children:"Dealer Subscription Amount (Yearly)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"form-control",value:h,onChange:ue=>p(ue.target.value)})]}),e.jsxs("div",{className:"referral-settings-field",children:[e.jsx("label",{className:"form-label",children:"Dealer Referral Flat Amount"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"form-control",value:g,onChange:ue=>N(ue.target.value)})]}),e.jsx("div",{className:"referral-settings-action",children:e.jsx("button",{className:"btn btn-primary w-100",type:"submit",children:"Save"})})]})]}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${l==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>r("org"),children:"ORG Accounts"}),e.jsx("button",{type:"button",className:`btn btn-sm ${l==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>r("dealer"),children:"Dealer Accounts"})]}),l==="org"?e.jsxs(e.Fragment,{children:[ne(se.pending,"Pending Payments","pending"),ne(se.paid,"Completed Payments","paid"),ne(se.rejected,"Rejected Payments","rejected")]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsx("h5",{children:"Dealer Subscriptions"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",E," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-dealer-sub-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-dealer-sub-search",type:"text",value:b,onChange:ue=>k(ue.target.value),placeholder:"Search dealers"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Referral Code"}),e.jsx("th",{children:"Referred By"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:V.length?V.map(ue=>e.jsxs("tr",{children:[e.jsx("td",{children:ue.username}),e.jsx("td",{children:ue.email||"-"}),e.jsx("td",{children:ue.referral_code||"-"}),e.jsx("td",{children:ue.referred_by||"-"}),e.jsx("td",{children:e.jsxs("select",{className:"form-select form-select-sm",value:ue.form.subscription_status||"pending",onChange:je=>ke(ue.id,"subscription_status",je.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"})]})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"form-control form-control-sm",value:ue.form.subscription_start||"",onChange:je=>ke(ue.id,"subscription_start",je.target.value)})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"form-control form-control-sm",value:ue.form.subscription_end||"",onChange:je=>ke(ue.id,"subscription_end",je.target.value)})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"form-control form-control-sm",value:ue.form.subscription_amount??0,onChange:je=>ke(ue.id,"subscription_amount",je.target.value)})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-outline-light btn-sm",type:"button",onClick:()=>mt(ue),children:"Update"})})]},ue.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",children:"No dealers found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Y," to ",ce," of ",re," entries"]}),e.jsx(st,{page:S,totalPages:O,onPageChange:F,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),ae(be.pending,"Pending Payments","pending"),ae(be.paid,"Completed Payments","paid"),ae(be.rejected,"Rejected Payments","rejected")]})]})}const a0={loading:!0,error:"",data:null},s0=ls;function n0(){var f;const[t,a]=i.useState(a0),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState("+91"),[c,d]=i.useState(""),[h,p]=i.useState(""),[g,N]=i.useState(""),[v,w]=i.useState("");i.useEffect(()=>{let b=!0;async function k(){var _,P;n("");try{const S=await U("/api/dashboard/profile");if(!b)return;a({loading:!1,error:"",data:S}),r(((_=S.user)==null?void 0:_.email)||""),u(S.phone_country||"+91"),d(S.phone_number||"")}catch(S){if((P=S==null?void 0:S.data)!=null&&P.redirect){window.location.href=S.data.redirect;return}b&&a({loading:!1,error:(S==null?void 0:S.message)||"Unable to load profile.",data:null})}}return k(),()=>{b=!1}},[]);async function A(b){b.preventDefault(),n("");try{await U("/api/dashboard/profile/email",{method:"POST",body:JSON.stringify({email:l,phone_country:o,phone_number:c})}),n("Profile updated successfully.")}catch(k){a(_=>({..._,error:(k==null?void 0:k.message)||"Unable to update profile."}))}}async function y(b){b.preventDefault(),n("");try{await U("/api/dashboard/profile/password",{method:"POST",body:JSON.stringify({current_password:h,new_password:g,confirm_password:v})}),n("Password updated successfully."),p(""),N(""),w("")}catch(k){a(_=>({..._,error:(k==null?void 0:k.message)||"Unable to update password."}))}}if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading profile..."})]});const x=((f=t.data)==null?void 0:f.user)||{};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Profile"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Account"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",x.username||"-"]}),e.jsxs("form",{className:"mt-3",onSubmit:A,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:l,onChange:b=>r(b.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Mobile Number"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",value:o,onChange:b=>u(b.target.value),style:{maxWidth:"170px"},children:s0.map(b=>e.jsxs("option",{value:b.code,children:[b.label," ",b.code]},`${b.code}-${b.label}`))}),e.jsx("input",{type:"tel",className:"form-control",value:c,onChange:b=>d(b.target.value),placeholder:"Phone number"})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm",children:"Update Details"})]})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Update Password"}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Current Password"}),e.jsx("input",{type:"password",className:"form-control",value:h,onChange:b=>p(b.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsx("input",{type:"password",className:"form-control",value:g,onChange:b=>N(b.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Confirm New Password"}),e.jsx("input",{type:"password",className:"form-control",value:v,onChange:b=>w(b.target.value),required:!0})]}),e.jsx("button",{className:"btn btn-warning btn-sm",children:"Update Password"})]})]})})]})]})}async function l0({page:t=1,pageSize:a=20}={}){const s=new URLSearchParams;return s.set("page",String(t)),s.set("page_size",String(a)),U(`/api/saas-admin/inbox?${s.toString()}`)}async function Df(t){const a=Array.isArray(t)?{ids:t}:{id:t};return U("/api/saas-admin/inbox/read",{method:"POST",body:JSON.stringify(a)})}async function r0(t){return U(`/api/saas-admin/inbox/${t}`,{method:"DELETE"})}const i0={loading:!0,error:"",data:null},o0="Auto cleanup: Older inbox messages are automatically deleted when inbox exceeds 100 notifications (same rule for all products).";function mc(t){return t==null||t===""?"-":t}function c0(t,a=120){if(!t)return"";const s=String(t);return s.length<=a?s:`${s.slice(0,a).trim()}...`}function d0(){var x,f,b,k;const[t,a]=i.useState(i0),[s,n]=i.useState(null),[l,r]=i.useState(1),[o,u]=i.useState(!1),c=ys(),d=20,h=((x=t.data)==null?void 0:x.results)||[],p=((f=t.data)==null?void 0:f.total_pages)||1,g=((b=t.data)==null?void 0:b.unread_count)||0;async function N({keepSelection:_=!1}={}){var P,S;a(F=>({...F,loading:!0,error:""}));try{const F=await l0({page:l,pageSize:d});if(a({loading:!1,error:"",data:F}),!_){const L=((S=(P=F==null?void 0:F.results)==null?void 0:P[0])==null?void 0:S.id)||null;n(L)}}catch(F){a({loading:!1,error:(F==null?void 0:F.message)||"Unable to load inbox.",data:null})}}i.useEffect(()=>{N()},[l]),i.useEffect(()=>{if(!o)return;const _=setInterval(()=>{N({keepSelection:!0})},3e4);return()=>clearInterval(_)},[o,l]),i.useEffect(()=>{if(!h.length){n(null);return}s&&h.some(_=>_.id===s)||n(h[0].id)},[h,s]);const v=i.useMemo(()=>h.find(_=>_.id===s)||null,[h,s]);async function w(_){if(!(!_||_.is_read))try{await Df([_.id]),a(P=>({...P,data:{...P.data,results:P.data.results.map(S=>S.id===_.id?{...S,is_read:!0}:S),unread_count:Math.max((P.data.unread_count||0)-1,0)}}))}catch{}}async function A(_){if(!(!_||!await c({title:"Delete Notification",message:"Delete this notification from inbox?",confirmText:"Delete",confirmVariant:"danger"})))try{await r0(_.id),await N({keepSelection:!1})}catch(S){a(F=>({...F,error:(S==null?void 0:S.message)||"Unable to delete notification."}))}}async function y(){const _=h.filter(P=>!P.is_read).map(P=>P.id);if(_.length)try{await Df(_),a(P=>({...P,data:{...P.data,results:P.data.results.map(S=>({...S,is_read:!0})),unread_count:0}}))}catch(P){a(S=>({...S,error:(P==null?void 0:P.message)||"Unable to mark notifications as read."}))}}return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading inbox..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h3",{className:"page-title mb-0",children:"Inbox"}),e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"btn btn-primary btn-sm disabled",role:"status","aria-live":"polite",children:[g," unread"]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:y,children:"Mark all read"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>N({keepSelection:!0}),children:"Refresh"}),e.jsxs("label",{className:"form-check inbox-auto-refresh",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:o,onChange:_=>u(_.target.checked)}),e.jsx("span",{className:"form-check-label",children:"Auto-refresh (30s)"})]})]})]}),t.error?e.jsx("div",{className:"alert alert-danger mt-3",children:t.error}):null,e.jsx("div",{className:"small text-secondary mt-3",children:o0}),e.jsxs("div",{className:"inbox-layout mt-3",children:[e.jsxs("div",{className:"card inbox-list",children:[e.jsxs("div",{className:"inbox-list-header",children:[e.jsx("span",{children:"All Notifications"}),e.jsxs("span",{className:"text-secondary small",children:[mc((k=t.data)==null?void 0:k.total)," total"]})]}),e.jsx("div",{className:"inbox-list-body",children:h.length?h.map(_=>e.jsxs("button",{type:"button",className:`inbox-item ${_.id===s?"active":""} ${_.is_read?"read":"unread"}`,onClick:()=>{n(_.id),w(_)},children:[e.jsxs("div",{className:"inbox-item-title",children:[e.jsx("span",{children:_.title}),e.jsx("span",{className:"inbox-item-date",children:mc(_.created_at)})]}),e.jsxs("div",{className:"inbox-item-meta",children:[e.jsx("span",{children:_.organization_name||"Global"}),_.org_admin_name?e.jsxs("span",{children:["Org Admin: ",_.org_admin_name]}):null,e.jsx("span",{className:"inbox-item-type",children:_.event_type})]}),e.jsx("div",{className:"inbox-item-preview",children:c0(_.message)})]},_.id)):e.jsx("div",{className:"text-secondary p-3",children:"No notifications yet."})}),e.jsx("div",{className:"inbox-list-footer",children:e.jsx(st,{page:l,totalPages:p,onPageChange:r,showPageLinks:!0,showPageLabel:!1,maxPageLinks:5})})]}),e.jsx("div",{className:"card inbox-detail",children:v?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"inbox-detail-header",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:v.title}),e.jsxs("div",{className:"text-secondary small",children:[v.organization_name||"Global","  ",v.event_type]}),v.org_admin_name?e.jsxs("div",{className:"text-secondary small mt-1",children:["Org Admin: ",v.org_admin_name,v.org_admin_email?` (${v.org_admin_email})`:""]}):null]}),e.jsxs("div",{className:"inbox-detail-actions",children:[v.is_read?null:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>w(v),children:"Mark read"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>A(v),children:"Delete"})]})]}),e.jsx("div",{className:"inbox-detail-meta",children:e.jsx("span",{children:mc(v.created_at)})}),e.jsx("div",{className:"inbox-detail-body",children:v.message?e.jsx("p",{className:"mb-0",children:v.message}):e.jsx("p",{className:"text-secondary mb-0",children:"No additional details."})})]}):e.jsx("div",{className:"text-secondary p-4",children:"Select a notification to view details."})})]})]})}async function u0({page:t=1,pageSize:a=20,productSlug:s=""}={}){const n=new URLSearchParams;return n.set("page",String(t)),n.set("page_size",String(a)),s&&n.set("product",String(s)),U(`/api/dashboard/inbox?${n.toString()}`)}async function Rf(t){const a=Array.isArray(t)?{ids:t}:{id:t};return U("/api/dashboard/inbox/read",{method:"POST",body:JSON.stringify(a)})}async function m0(t){return U(`/api/dashboard/inbox/${t}`,{method:"DELETE"})}async function h0(t){return U("/api/dashboard/inbox/compose",{method:"POST",body:JSON.stringify(t||{})})}const p0={loading:!0,error:"",data:null},f0="Auto cleanup: Older inbox messages are automatically deleted when inbox exceeds 100 notifications (same rule for all products).";function hc(t){return t==null||t===""?"-":t}function g0(t,a=120){if(!t)return"";const s=String(t);return s.length<=a?s:`${s.slice(0,a).trim()}...`}function x0(t){const a=String(t||"").toLowerCase();return a.includes("/storage")?"storage":a.includes("/business-autopilot")?"business-autopilot-erp":a.includes("/whatsapp-automation")?"whatsapp-automation":a.includes("/ai-chatbot")?"ai-chatbot":a.includes("/digital-card")?"digital-card":a.includes("/ai-chat-widget")?"ai-chat-widget":"monitor"}function b0(){var Q,E,C,z;const t=ua(),[a,s]=i.useState(p0),[n,l]=i.useState(null),[r,o]=i.useState(1),[u,c]=i.useState(!1),[d,h]=i.useState(!1),[p,g]=i.useState({title:"",message:"",channel:"email"}),[N,v]=i.useState({sending:!1,error:"",success:""}),w=ys(),A=20,y=i.useMemo(()=>x0(t.pathname),[t.pathname]),x=((Q=a.data)==null?void 0:Q.results)||[],f=((E=a.data)==null?void 0:E.total_pages)||1,b=((C=a.data)==null?void 0:C.unread_count)||0;async function k({keepSelection:M=!1}={}){var R,W;s(D=>({...D,loading:!0,error:""}));try{const D=await u0({page:r,pageSize:A,productSlug:y});s({loading:!1,error:"",data:D}),M||l(((W=(R=D==null?void 0:D.results)==null?void 0:R[0])==null?void 0:W.id)||null)}catch(D){s({loading:!1,error:(D==null?void 0:D.message)||"Unable to load inbox.",data:null})}}i.useEffect(()=>{k()},[y,r]),i.useEffect(()=>{if(!u)return;const M=setInterval(()=>k({keepSelection:!0}),3e4);return()=>clearInterval(M)},[u,y,r]),i.useEffect(()=>{if(!x.length){l(null);return}n&&x.some(M=>M.id===n)||l(x[0].id)},[x,n]);const _=i.useMemo(()=>x.find(M=>M.id===n)||null,[x,n]);async function P(M){if(!(!M||M.is_read))try{await Rf([M.id]),s(R=>({...R,data:{...R.data,results:R.data.results.map(W=>W.id===M.id?{...W,is_read:!0}:W),unread_count:Math.max((R.data.unread_count||0)-1,0)}}))}catch{}}async function S(M){if(!(!M||!await w({title:"Delete Notification",message:"Delete this notification from inbox?",confirmText:"Delete",confirmVariant:"danger"})))try{await m0(M.id),await k({keepSelection:!1})}catch(W){s(D=>({...D,error:(W==null?void 0:W.message)||"Unable to delete notification."}))}}async function F(){const M=x.filter(R=>!R.is_read).map(R=>R.id);if(M.length)try{await Rf(M),s(R=>({...R,data:{...R.data,results:R.data.results.map(W=>({...W,is_read:!0})),unread_count:0}}))}catch(R){s(W=>({...W,error:(R==null?void 0:R.message)||"Unable to mark notifications as read."}))}}async function L(M){M.preventDefault();const R=String(p.title||"").trim(),W=String(p.message||"").trim();if(!R||!W){v({sending:!1,error:"Subject and message are required.",success:""});return}v({sending:!0,error:"",success:""});try{await h0({title:R,message:W,channel:p.channel||"email",product_slug:y}),g({title:"",message:"",channel:"email"}),v({sending:!1,error:"",success:"Message sent to all users inbox."}),h(!1),await k({keepSelection:!1})}catch(D){v({sending:!1,error:(D==null?void 0:D.message)||"Unable to send message to inbox.",success:""})}}return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading inbox..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h3",{className:"page-title mb-0",children:"Inbox"}),e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsxs("span",{className:"btn btn-primary btn-sm disabled",role:"status","aria-live":"polite",children:[b," unread"]}),e.jsxs("button",{type:"button",className:`btn btn-sm ${d?"btn-primary":"btn-outline-light"}`,onClick:()=>{h(M=>!M),v(M=>({...M,error:"",success:""}))},children:[e.jsx("i",{className:"bi bi-pencil-square me-1","aria-hidden":"true"}),"Compose"]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:F,children:"Mark all read"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>k({keepSelection:!0}),children:"Refresh"}),e.jsxs("label",{className:"form-check inbox-auto-refresh",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:u,onChange:M=>c(M.target.checked)}),e.jsx("span",{className:"form-check-label",children:"Auto-refresh (30s)"})]})]})]}),a.error?e.jsx("div",{className:"alert alert-danger mt-3",children:a.error}):null,N.success?e.jsx("div",{className:"alert alert-success mt-3 py-2",children:N.success}):null,e.jsx("div",{className:"small text-secondary mt-3",children:f0}),d?e.jsxs("div",{className:"card mt-3 p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 mb-2",children:[e.jsx("h6",{className:"mb-0",children:"Compose Admin Message"}),e.jsx("span",{className:"badge bg-secondary",children:"Send to all users inbox"})]}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:L,children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Subject"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Enter subject",value:p.title,onChange:M=>g(R=>({...R,title:M.target.value}))})]}),e.jsxs("div",{className:"col-12 col-lg-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Channel"}),e.jsxs("select",{className:"form-select",value:p.channel,onChange:M=>g(R=>({...R,channel:M.target.value})),children:[e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"system",children:"System"}),e.jsx("option",{value:"whatsapp",children:"WhatsApp"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Message"}),e.jsx("textarea",{className:"form-control",rows:4,placeholder:"Write message for all users...",value:p.message,onChange:M=>g(R=>({...R,message:M.target.value}))})]}),N.error?e.jsx("div",{className:"alert alert-danger py-2 mb-0",children:N.error}):null,e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",disabled:N.sending,children:N.sending?"Sending...":"Send to All Users"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",disabled:N.sending,onClick:()=>{h(!1),v(M=>({...M,error:""}))},children:"Cancel"})]})]})]}):null,e.jsxs("div",{className:"inbox-layout mt-3",children:[e.jsxs("div",{className:"card inbox-list",children:[e.jsxs("div",{className:"inbox-list-header",children:[e.jsx("span",{children:"All Notifications"}),e.jsxs("span",{className:"text-secondary small",children:[hc((z=a.data)==null?void 0:z.total)," total"]})]}),e.jsx("div",{className:"inbox-list-body",children:x.length?x.map(M=>e.jsxs("button",{type:"button",className:`inbox-item ${M.id===n?"active":""} ${M.is_read?"read":"unread"}`,onClick:()=>{l(M.id),P(M)},children:[e.jsxs("div",{className:"inbox-item-title",children:[e.jsx("span",{children:M.title}),e.jsx("span",{className:"inbox-item-date",children:hc(M.created_at)})]}),e.jsxs("div",{className:"inbox-item-meta",children:[e.jsx("span",{children:M.product_slug||M.organization_name||"Notification"}),e.jsx("span",{className:`badge ${M.is_read?"bg-secondary":"bg-primary"}`,children:M.is_read?"Read":"Unread"})]}),e.jsx("div",{className:"inbox-item-message",children:g0(M.message,90)})]},M.id)):e.jsx("div",{className:"text-secondary p-3",children:"No notifications yet."})}),e.jsx("div",{className:"inbox-list-footer",children:e.jsx(st,{page:r,totalPages:f,onPageChange:o,showPageLinks:!0,showPageLabel:!1,maxPageLinks:5})})]}),e.jsx("div",{className:"card inbox-detail",children:_?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:_.title}),e.jsxs("div",{className:"text-secondary small",children:[hc(_.created_at),"  ",_.channel||"email",_.product_slug?`  ${_.product_slug}`:""]})]}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>S(_),children:"Delete"})]}),e.jsx("div",{className:"inbox-detail-body",children:_.message||"-"})]}):e.jsx("div",{className:"text-secondary p-4",children:"Select a notification to view details."})})]})]})}const j0={grace_days:30,archive_days:60,hard_delete_days:0};function y0(){const[t,a]=i.useState(!0),[s,n]=i.useState(!1),[l,r]=i.useState(""),[o,u]=i.useState(""),[c,d]=i.useState(""),[h,p]=i.useState(j0);i.useEffect(()=>{let N=!0;async function v(){a(!0),r("");try{const w=await U("/api/saas-admin/settings/retention-policy");if(!N)return;p({grace_days:Number(w.grace_days??30),archive_days:Number(w.archive_days??60),hard_delete_days:Number(w.hard_delete_days??0)}),d(w.updated_at||"")}catch(w){N&&r((w==null?void 0:w.message)||"Unable to load retention policy.")}finally{N&&a(!1)}}return v(),()=>{N=!1}},[]);async function g(){n(!0),r(""),u("");try{const N={grace_days:Number(h.grace_days||0),archive_days:Number(h.archive_days||0),hard_delete_days:Number(h.hard_delete_days||0)},v=await U("/api/saas-admin/settings/retention-policy",{method:"PUT",body:JSON.stringify(N)});d(v.updated_at||new Date().toISOString()),u("Retention policy saved.")}catch(N){r((N==null?void 0:N.message)||"Unable to save retention policy.")}finally{n(!1)}}return e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-0",children:"Retention Policy"}),e.jsx("div",{className:"text-secondary small",children:"Applies to all products and organizations."})]}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:g,disabled:s||t,children:s?"Saving...":"Save"})]}),t?e.jsx("div",{className:"text-secondary mt-2",children:"Loading..."}):null,l?e.jsx("div",{className:"alert alert-danger mt-2",children:l}):null,o?e.jsx("div",{className:"alert alert-success mt-2",children:o}):null,c?e.jsxs("div",{className:"text-secondary small mt-2",children:["Last updated: ",c]}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Grace Days"}),e.jsx("input",{type:"number",min:"0",value:h.grace_days,onChange:N=>p(v=>({...v,grace_days:N.target.value}))}),e.jsx("div",{className:"text-secondary small",children:"After plan expiry, organization is read-only until this ends."})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Archive Days"}),e.jsx("input",{type:"number",min:"0",value:h.archive_days,onChange:N=>p(v=>({...v,archive_days:N.target.value}))}),e.jsx("div",{className:"text-secondary small",children:"After grace period, organization is archived and cannot log in."})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Hard Delete Days"}),e.jsx("input",{type:"number",min:"0",value:h.hard_delete_days,onChange:N=>p(v=>({...v,hard_delete_days:N.target.value}))}),e.jsx("div",{className:"text-secondary small",children:"Optional permanent deletion after archive. 0 means never delete."})]})})]})]})}const v0={loading:!0,error:"",folders:[],basePrefix:"",storageMode:"local",items:[],isTruncated:!1,nextToken:null,currentPrefix:""},N0=[{value:"all",label:"All"},{value:"images",label:"Images"},{value:"documents",label:"Documents"}];function _0(t){if(!t)return"0 B";const a=["B","KB","MB","GB","TB"];let s=t,n=0;for(;s>=1024&&n<a.length-1;)s/=1024,n+=1;return`${s.toFixed(s>=10||n===0?0:1)} ${a[n]}`}function gd({scope:t,embedded:a=!1,hideTabs:s=!1,initialCategory:n="screenshots",showTabs:l=!1}){const[r,o]=i.useState(v0),[u,c]=i.useState(""),[d,h]=i.useState(""),[p,g]=i.useState(""),[N,v]=i.useState("all"),[w,A]=i.useState([]),[y,x]=i.useState(null),[f,b]=i.useState(new Set),[k,_]=i.useState({open:!1,message:"",onConfirm:null}),[P,S]=i.useState(""),[F,L]=i.useState(""),[Q,E]=i.useState(null),[C,z]=i.useState([{key:"screenshots",label:"Screenshots"},{key:"ai_media_library",label:"AI Media Library"},{key:"payments",label:"Payments"}]),[M,R]=i.useState(n),W=t==="saas",D=M==="online_storage",te=M!=="screenshots"&&!D;i.useEffect(()=>{let ne=!0;async function ae(){o(X=>({...X,loading:!0,error:""}));try{const X=new URLSearchParams;M&&X.set("category",M),W&&F&&X.set("org_id",F);const ke=await U(`/api/storage/media/folders?${X.toString()}`);if(!ne)return;o(Ne=>({...Ne,loading:!1,error:"",folders:ke.folders||[],basePrefix:ke.base_prefix||"",storageMode:ke.storage_mode||"object"})),ke.categories&&Array.isArray(ke.categories)&&z(ke.categories),h(ke.base_prefix||""),A([]),x(null),b(new Set)}catch(X){if(!ne)return;o(ke=>({...ke,loading:!1,error:(X==null?void 0:X.message)||"Unable to load folders."}))}}return ae(),()=>{ne=!1}},[W,F,M]),i.useEffect(()=>{let ne=!0;async function ae(){if(r.storageMode==="object"){o(X=>({...X,error:""}));try{const X=new URLSearchParams;d&&X.set("folder",d),p&&!D&&X.set("q",p),N&&!D&&X.set("type",N),X.set("limit","25"),y&&X.set("continuation_token",y),M&&X.set("category",M),W&&F&&X.set("org_id",F);const ke=await U(`/api/storage/media/objects?${X.toString()}`);if(!ne)return;o(Ne=>({...Ne,items:ke.items||[],isTruncated:!!ke.is_truncated,nextToken:ke.next_token||null,currentPrefix:ke.current_prefix||d})),b(new Set)}catch(X){if(!ne)return;o(ke=>({...ke,error:(X==null?void 0:X.message)||"Unable to load objects."}))}}}return(d||r.basePrefix)&&ae(),()=>{ne=!1}},[d,p,N,y,W,F,M,r.storageMode,r.basePrefix,D]);const H=i.useMemo(()=>{if(!u)return r.folders;const ne=u.toLowerCase();return r.folders.filter(ae=>{const X=String(ae.name||"").toLowerCase(),ke=String(ae.prefix||"").toLowerCase();return X.includes(ne)||ke.includes(ne)})},[u,r.folders]),O=ne=>{b(ae=>{const X=new Set(ae);return X.has(ne)?X.delete(ne):X.add(ne),X})},V=()=>{b(new Set(r.items.map(ne=>ne.key)))},re=()=>{b(new Set)},Y=async ne=>{try{await navigator.clipboard.writeText(ne),S("Copied.")}catch{S("Copy failed.")}},ce=async ne=>{try{const ae=new URLSearchParams;ae.set("key",ne),M&&ae.set("category",M),W&&F&&ae.set("org_id",F);const X=await U(`/api/storage/media/signed-url?${ae.toString()}`);X!=null&&X.url&&window.open(X.url,"_blank","noopener")}catch(ae){S((ae==null?void 0:ae.message)||"Unable to open file.")}},ie=async ne=>{try{const ae=new URLSearchParams;ae.set("key",ne),M&&ae.set("category",M),W&&F&&ae.set("org_id",F);const X=await U(`/api/storage/media/signed-url?${ae.toString()}`);X!=null&&X.url&&await Y(X.url)}catch(ae){S((ae==null?void 0:ae.message)||"Unable to copy URL.")}},ee=ne=>{_({open:!0,message:`Delete ${ne.length} file(s)? This cannot be undone.`,onConfirm:()=>T(ne)})},T=async ne=>{_({open:!1,message:"",onConfirm:null});try{ne.length===1?await U("/api/storage/media/object",{method:"DELETE",body:JSON.stringify({key:ne[0],org_id:W&&F?F:void 0,category:M})}):await U("/api/storage/media/bulk-delete",{method:"POST",body:JSON.stringify({keys:ne,org_id:W&&F?F:void 0,category:M})}),S("Deleted successfully."),b(new Set),x(null)}catch(ae){S((ae==null?void 0:ae.message)||"Delete failed.")}},Z=()=>{r.nextToken&&(A(ne=>[...ne,y]),x(r.nextToken))},se=()=>{A(ne=>{if(!ne.length)return ne;const ae=[...ne],X=ae.pop();return x(X||null),ae})},be=l&&!s&&!a;return e.jsxs("div",{className:`${a?"":"page-shell"} media-library`,children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Media Library"}),e.jsx("p",{className:"text-secondary mb-0",children:"Browse files stored in object storage."})]}),P?e.jsx("div",{className:"alert alert-info mb-0",children:P}):null]}),r.storageMode!=="object"?e.jsx("div",{className:"alert alert-warning mt-3",children:"Switch to Object Storage to use Media Library."}):null,r.error?e.jsx("div",{className:"alert alert-danger mt-3",children:r.error}):null,be?e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:C.map(ne=>e.jsx("button",{type:"button",className:`btn btn-sm ${M===ne.key?"btn-primary":"btn-outline-light"}`,onClick:()=>{R(ne.key),h(""),x(null),A([])},children:ne.label},ne.key))}):null,e.jsxs("div",{className:`row g-3 mt-2 ${a?"mt-3":""}`,children:[e.jsx("div",{className:"col-12 col-lg-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h6",{className:"mb-0",children:"Folders"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>c(""),children:"Clear"})]}),e.jsx("input",{type:"text",className:"form-control mb-2",placeholder:D?"Search orgs/folders":"Search folders",value:u,onChange:ne=>c(ne.target.value)}),e.jsx("div",{className:"list-group media-library-folders",children:C.map(ne=>{const ae=Q===ne.key,X=M===ne.key;return e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:`list-group-item list-group-item-action d-flex align-items-center justify-content-between media-library-folder__category ${X?"active":""} ${ae?"is-open":""}`,onClick:()=>{R(ne.key),h(""),x(null),A([]),E(ke=>ke===ne.key?null:ne.key)},children:[e.jsx("span",{children:ne.label}),e.jsx("span",{className:"media-library-folder__icon",children:ae?"-":"+"})]}),ae?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:`list-group-item list-group-item-action media-library-folder__item ${d===r.basePrefix?"active":""}`,onClick:()=>{h(r.basePrefix),x(null),A([])},children:"All"}),(ne.key==="online_storage"?H:H.filter(ke=>{const Ne=String(ke.name||"").toLowerCase(),Ye=/^[0-9]+$/.test(Ne),Ke=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/.test(Ne);return Ye||Ke})).map(ke=>e.jsx("button",{type:"button",className:`list-group-item list-group-item-action media-library-folder__item ${d===ke.prefix?"active":""}`,onClick:()=>{h(ke.prefix),x(null),A([])},children:ke.name},ke.prefix))]}):null]},ne.key)})})]})}),e.jsx("div",{className:"col-12 col-lg-10",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-end mb-2",children:[e.jsxs("div",{className:"flex-grow-1",style:{minWidth:"240px"},children:[e.jsx("label",{className:"form-label",children:D?"Search":"Search files"}),e.jsx("input",{type:"text",className:"form-control",placeholder:D?"Search by folder path":"Search by filename or key",value:p,onChange:ne=>g(ne.target.value),disabled:D})]}),e.jsxs("div",{style:{minWidth:"120px"},children:[e.jsx("label",{className:"form-label",children:"Type"}),e.jsx("select",{className:"form-select",value:N,onChange:ne=>v(ne.target.value),disabled:D,children:N0.map(ne=>e.jsx("option",{value:ne.value,children:ne.label},ne.value))})]}),W?e.jsxs("div",{style:{minWidth:"140px"},children:[e.jsx("label",{className:"form-label",children:"Org ID"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Org ID",value:F,onChange:ne=>L(ne.target.value),disabled:D})]}):null,e.jsxs("div",{style:{minWidth:"180px"},children:[e.jsx("label",{className:"form-label",children:"Actions"}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:V,disabled:D,children:"Select All"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:re,disabled:D,children:"Clear"})]})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"40px"}}),e.jsx("th",{children:D?"Root Folder":"Full Key"}),e.jsx("th",{style:{width:"70px"},children:"Size"}),e.jsx("th",{style:{minWidth:"140px",whiteSpace:"nowrap"},children:"Content Type"}),e.jsx("th",{style:{minWidth:"180px",whiteSpace:"nowrap"},children:"Last Modified"}),e.jsx("th",{style:{minWidth:"200px"},children:"Actions"})]})}),e.jsx("tbody",{children:r.items.length?r.items.map(ne=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:f.has(ne.key),onChange:()=>O(ne.key)})}),e.jsx("td",{className:"text-secondary small",children:ne.key}),e.jsx("td",{children:_0(ne.size)}),e.jsx("td",{children:ne.content_type_guess||"-"}),e.jsx("td",{children:ne.last_modified||"-"}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2 flex-nowrap",children:[te?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>ce(ne.key),disabled:r.storageMode!=="object",children:"View"}):null,e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Y(ne.key),disabled:r.storageMode!=="object",children:"Copy Key"}),te?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>ie(ne.key),disabled:r.storageMode!=="object",children:"Copy URL"}):null,e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>ee([ne.key]),disabled:r.storageMode!=="object"||D,children:"Delete"})]})})]},ne.key)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center text-secondary",children:"No files found."})})})]})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",disabled:!w.length,onClick:se,children:"Prev"}),e.jsxs("div",{className:"text-secondary small",children:[r.items.length," items"]}),e.jsx("button",{type:"button",className:"btn btn-outline-light",disabled:!r.isTruncated,onClick:Z,children:"Next"})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-danger",disabled:!f.size||r.storageMode!=="object"||D,onClick:()=>ee(Array.from(f)),children:"Delete Selected"})})]})})]}),k.open?e.jsx("div",{className:"modal-overlay",onClick:()=>_({open:!1,message:"",onConfirm:null}),children:e.jsxs("div",{className:"modal-panel",onClick:ne=>ne.stopPropagation(),children:[e.jsx("h5",{children:"Confirm"}),e.jsx("div",{className:"text-secondary mb-3",children:k.message}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>_({open:!1,message:"",onConfirm:null}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>k.onConfirm&&k.onConfirm(),children:"Delete"})]})]})}):null]})}const S0={loading:!0,error:"",saving:!1,storage_mode:"local",endpoint_url:"",bucket_name:"",access_key_id:"",secret_access_key:"",region_name:"",base_path:"",updated_at:"",has_secret_access_key:!1};function w0(){const[t,a]=i.useState(S0),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState(""),[c,d]=i.useState(null),[h,p]=i.useState(!1),[g,N]=i.useState({open:!1,message:"",resolve:null});i.useEffect(()=>{let b=!0;return(async()=>{try{const _=await U("/api/saas-admin/settings/media-storage");if(!b)return;a(P=>({...P,loading:!1,error:"",storage_mode:_.storage_mode||"local",endpoint_url:_.endpoint_url||"",bucket_name:_.bucket_name||"",access_key_id:_.access_key_id||"",region_name:_.region_name||"",base_path:_.base_path||"",updated_at:_.updated_at||"",has_secret_access_key:!!_.has_secret_access_key}))}catch(_){if(!b)return;a(P=>({...P,loading:!1,error:(_==null?void 0:_.message)||"Unable to load storage settings."}))}})(),()=>{b=!1}},[]);const v=b=>k=>{const _=k.target.value;a(P=>({...P,[b]:_}))},w=async()=>{n(""),r(""),a(b=>({...b,saving:!0,error:""}));try{const b={storage_mode:t.storage_mode,endpoint_url:t.endpoint_url,bucket_name:t.bucket_name,access_key_id:t.access_key_id,secret_access_key:t.secret_access_key,region_name:t.region_name,base_path:t.base_path},k=await U("/api/saas-admin/settings/media-storage",{method:"PUT",body:JSON.stringify(b)});a(_=>({..._,saving:!1,error:"",secret_access_key:"",updated_at:k.updated_at||_.updated_at,has_secret_access_key:!!k.has_secret_access_key})),n("Storage settings saved.")}catch(b){a(k=>({...k,saving:!1,error:(b==null?void 0:b.message)||"Unable to save."}))}},A=b=>new Promise(k=>{N({open:!0,message:b,resolve:k})}),y=b=>{N(k=>(k.resolve&&k.resolve(b),{open:!1,message:"",resolve:null}))};i.useEffect(()=>{if(!o)return;let b=!0;const k=async()=>{try{const P=await U(`/api/saas-admin/settings/media-storage/pull-local/status/${o}`);if(!b)return;d(S=>S&&!P.total_files&&S.total_files?{...P,total_files:S.total_files}:P),(P.status==="completed"||P.status==="failed")&&u("")}catch(P){if(!b)return;d(S=>({...S||{},status:"failed",error_message:(P==null?void 0:P.message)||"Unable to load status."})),u("")}};k();const _=setInterval(k,1500);return()=>{b=!1,clearInterval(_)}},[o]);const x=async()=>{if(n(""),r(""),t.storage_mode!=="object"){r("Switch to Online Object Storage before pulling local files.");return}try{const b=await U("/api/saas-admin/settings/media-storage/pull-local/preview",{method:"POST",body:JSON.stringify({})});if(!b.total){r("No local files found to pull.");return}let k=!1;if(b.partial&&!await A(`Validated only ${b.checked} files out of ${b.total}. Continue with pull?`))return;if(b.existing){if(!await A(`Found ${b.existing} files already in object storage. Pull again and overwrite?`))return;k=!0}const _=await A("Delete local media files after successful pull?"),P=await U("/api/saas-admin/settings/media-storage/pull-local/start",{method:"POST",body:JSON.stringify({overwrite:k,delete_local:_})});d({status:"pending",total_files:b.total||0,existing_files:b.existing||0,copied_files:0,skipped_files:0,file_type_counts:{},current_path:""}),p(!0),u(P.job_id||"")}catch(b){r((b==null?void 0:b.message)||"Unable to pull local files.")}},f=t.storage_mode==="object";return e.jsxs("div",{className:"page-shell",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"d-flex align-items-start justify-content-between gap-3 flex-wrap",children:e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Media Storage"}),e.jsx("p",{className:"text-secondary mb-0",children:"Global storage mode for all products and organizations."}),t.updated_at?e.jsxs("div",{className:"text-secondary small mt-2",children:["Last updated: ",t.updated_at]}):null]})}),t.error?e.jsx("div",{className:"alert alert-danger mt-3",children:t.error}):null,s?e.jsx("div",{className:"alert alert-success mt-3",children:s}):null,l?e.jsx("div",{className:"alert alert-info mt-3",children:l}):null,e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Storage Mode"}),e.jsxs("select",{className:"form-select",value:t.storage_mode,onChange:v("storage_mode"),children:[e.jsx("option",{value:"local",children:"Local (server disk)"}),e.jsx("option",{value:"object",children:"Online Object Storage (Backblaze/S3)"})]}),e.jsx("div",{className:"text-secondary small mt-1",children:"Local stores screenshots inside the server. Object storage pushes files to S3-compatible buckets."})]}),f?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Endpoint URL"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"https://s3.us-west-004.backblazeb2.com",value:t.endpoint_url,onChange:v("endpoint_url")}),e.jsx("div",{className:"text-secondary small mt-1",children:"Backblaze B2 or other S3 endpoint."})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Bucket Name"}),e.jsx("input",{type:"text",className:"form-control",value:t.bucket_name,onChange:v("bucket_name")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Access Key ID"}),e.jsx("input",{type:"text",className:"form-control",value:t.access_key_id,onChange:v("access_key_id")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Secret Access Key"}),e.jsx("input",{type:"password",className:"form-control",placeholder:t.has_secret_access_key?"Stored (leave blank to keep)":"",value:t.secret_access_key,onChange:v("secret_access_key")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Region"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"us-west-004",value:t.region_name,onChange:v("region_name")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Base Path (Optional prefix inside the bucket)"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"screenshots/",value:t.base_path,onChange:v("base_path")})]})]}):null,e.jsxs("div",{className:"col-12 col-md-6 col-xl-3 d-flex align-items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-success",onClick:w,disabled:t.saving,children:t.saving?"Saving...":"Save Data"}),e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:x,disabled:t.saving,children:"Pull Local Media"})]})]})]}),h&&c?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:"Pulling Local Media"}),e.jsx("div",{className:"text-secondary",children:c.status==="failed"?"Failed to pull files.":c.status==="completed"?"Pull completed.":"Transfer in progress..."}),c.finished_at?e.jsxs("div",{className:"text-secondary small mt-1",children:["Completed at: ",c.finished_at]}):null]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>p(!1),children:"Close"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:(c.copied_files||0)+(c.skipped_files||0)})," /"," ",e.jsx("strong",{children:c.total_files||0})," files processed"]}),e.jsx("div",{className:"progress mb-2",style:{height:"8px"},children:e.jsx("div",{className:"progress-bar bg-success",style:{width:c.total_files?`${Math.min(100,Math.round(((c.copied_files||0)+(c.skipped_files||0))/c.total_files*100))}%`:"0%"}})}),e.jsxs("div",{className:"text-secondary small",children:["Current: ",c.current_path||"-"]}),e.jsxs("div",{className:"text-secondary small mt-1",children:["Uploaded: ",c.copied_files||0," | Skipped: ",c.skipped_files||0]}),c.status==="completed"?e.jsxs("div",{className:"text-secondary small mt-2",children:[Object.keys(c.file_type_counts||{}).length?Object.entries(c.file_type_counts).map(([b,k])=>e.jsxs("span",{className:"me-2",children:[b.toUpperCase()," ",k," files"]},b)):null,c.copied_files?`Total ${c.copied_files} media updated`:null]}):null,c.error_message?e.jsx("div",{className:"alert alert-danger mt-2",children:c.error_message}):null]})]}):null,e.jsx("div",{className:"mt-4",children:e.jsx(gd,{scope:"saas",embedded:!0,hideTabs:!0,initialCategory:"screenshots",showTabs:!1})}),g.open?e.jsx("div",{className:"modal-overlay",onClick:()=>y(!1),children:e.jsxs("div",{className:"modal-panel",onClick:b=>b.stopPropagation(),children:[e.jsx("h5",{children:"Confirm"}),e.jsx("div",{className:"text-secondary mb-3",children:g.message}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>y(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-success",onClick:()=>y(!0),children:"OK"})]})]})}):null]})}const k0={loading:!0,saving:!1,error:"",success:"",data:null,notificationCatalog:{admin:[],user:[]},form:{is_active:!1,phone_number_id:"",access_token:"",admin_phone:"",notify_admin_new_user:!0,notify_user_welcome:!0,notification_toggles:{admin:{},user:{}},admin_template_name:"new_user_admin_alert",user_welcome_template_name:"welcome_user_signup",template_language:"en_US",graph_api_version:"v21.0",timeout_seconds:15}},Lf="admin_new_user_registration_alert",Mf="user_welcome_message";function C0(t,a){const s=t==null?void 0:t.data;if(s&&typeof s=="object"&&!Array.isArray(s)){const n=Object.entries(s).map(([l,r])=>Array.isArray(r)?`${l}: ${r.join(", ")}`:typeof r=="string"?`${l}: ${r}`:null).filter(Boolean);if(n.length)return n.join(" | ")}return(t==null?void 0:t.message)||a}function P0(){var r,o;const[t,a]=i.useState(k0);i.useEffect(()=>{let u=!0;async function c(){try{const d=await U("/api/saas-admin/settings/whatsapp-cloud");if(!u)return;a(h=>{var p,g,N,v;return{...h,loading:!1,data:d,error:"",form:{is_active:!!(d!=null&&d.is_active),phone_number_id:(d==null?void 0:d.phone_number_id)||"",access_token:"",admin_phone:(d==null?void 0:d.admin_phone)||"",notify_admin_new_user:!!((d==null?void 0:d.notify_admin_new_user)??!0),notify_user_welcome:!!((d==null?void 0:d.notify_user_welcome)??!0),notification_toggles:{admin:{...((p=d==null?void 0:d.notification_toggles)==null?void 0:p.admin)||{}},user:{...((g=d==null?void 0:d.notification_toggles)==null?void 0:g.user)||{}}},admin_template_name:(d==null?void 0:d.admin_template_name)||"new_user_admin_alert",user_welcome_template_name:(d==null?void 0:d.user_welcome_template_name)||"welcome_user_signup",template_language:(d==null?void 0:d.template_language)||"en_US",graph_api_version:(d==null?void 0:d.graph_api_version)||"v21.0",timeout_seconds:Number((d==null?void 0:d.timeout_seconds)||15)},notificationCatalog:{admin:Array.isArray((N=d==null?void 0:d.notification_catalog)==null?void 0:N.admin)?d.notification_catalog.admin:[],user:Array.isArray((v=d==null?void 0:d.notification_catalog)==null?void 0:v.user)?d.notification_catalog.user:[]}}})}catch(d){if(!u)return;a(h=>({...h,loading:!1,error:(d==null?void 0:d.message)||"Unable to load WhatsApp Cloud settings."}))}}return c(),()=>{u=!1}},[]);const s=u=>c=>{const d=u==="is_active"?c.target.checked:c.target.value;a(h=>({...h,error:"",success:"",form:{...h.form,[u]:d}}))},n=async()=>{var u,c;a(d=>({...d,saving:!0,error:"",success:""}));try{const d={is_active:!!t.form.is_active,phone_number_id:t.form.phone_number_id,access_token:t.form.access_token,admin_phone:t.form.admin_phone,notify_admin_new_user:!!t.form.notify_admin_new_user,notify_user_welcome:!!t.form.notify_user_welcome,notification_toggles:{admin:{...((u=t.form.notification_toggles)==null?void 0:u.admin)||{}},user:{...((c=t.form.notification_toggles)==null?void 0:c.user)||{}}},admin_template_name:t.form.admin_template_name,user_welcome_template_name:t.form.user_welcome_template_name,template_language:t.form.template_language,graph_api_version:t.form.graph_api_version,timeout_seconds:Number(t.form.timeout_seconds||15)},h=await U("/api/saas-admin/settings/whatsapp-cloud",{method:"PUT",body:JSON.stringify(d)});a(p=>{var g,N,v,w;return{...p,saving:!1,success:"WhatsApp Cloud API settings saved.",data:h,form:{...p.form,access_token:"",is_active:!!(h!=null&&h.is_active),phone_number_id:(h==null?void 0:h.phone_number_id)||"",admin_phone:(h==null?void 0:h.admin_phone)||"",notify_admin_new_user:!!((h==null?void 0:h.notify_admin_new_user)??p.form.notify_admin_new_user),notify_user_welcome:!!((h==null?void 0:h.notify_user_welcome)??p.form.notify_user_welcome),notification_toggles:{admin:{...((g=h==null?void 0:h.notification_toggles)==null?void 0:g.admin)||((N=p.form.notification_toggles)==null?void 0:N.admin)||{}},user:{...((v=h==null?void 0:h.notification_toggles)==null?void 0:v.user)||((w=p.form.notification_toggles)==null?void 0:w.user)||{}}},admin_template_name:(h==null?void 0:h.admin_template_name)||p.form.admin_template_name,user_welcome_template_name:(h==null?void 0:h.user_welcome_template_name)||p.form.user_welcome_template_name,template_language:(h==null?void 0:h.template_language)||p.form.template_language,graph_api_version:(h==null?void 0:h.graph_api_version)||p.form.graph_api_version,timeout_seconds:Number((h==null?void 0:h.timeout_seconds)||p.form.timeout_seconds||15)}}})}catch(d){a(h=>({...h,saving:!1,error:C0(d,"Unable to save WhatsApp Cloud settings.")}))}},l=(u,c)=>{a(d=>{var h,p,g,N,v,w;return{...d,error:"",success:"",form:{...d.form,notification_toggles:{...d.form.notification_toggles||{},[u]:{...d.form.notification_toggles&&d.form.notification_toggles[u]||{},[c]:!((p=(h=d.form.notification_toggles)==null?void 0:h[u])!=null&&p[c])}},notify_admin_new_user:c===Lf?!((N=(g=d.form.notification_toggles)==null?void 0:g.admin)!=null&&N[Lf]):d.form.notify_admin_new_user,notify_user_welcome:c===Mf?!((w=(v=d.form.notification_toggles)==null?void 0:v.user)!=null&&w[Mf]):d.form.notify_user_welcome}}})};return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading WhatsApp Cloud settings..."})]}):e.jsxs("div",{className:"page-shell",children:[e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-2 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"WhatsApp Cloud API"}),e.jsx("p",{className:"text-secondary mb-0",children:"Configure Meta WhatsApp Cloud API for signup admin alerts and user welcome messages."}),(r=t.data)!=null&&r.updated_at?e.jsxs("div",{className:"text-secondary small mt-2",children:["Last updated: ",t.data.updated_at]}):null]}),e.jsx(dt,{to:"/saas-admin",className:"btn btn-outline-light btn-sm",children:"Back to Overview"})]}),t.error?e.jsx("div",{className:"alert alert-danger mt-3",children:t.error}):null,t.success?e.jsx("div",{className:"alert alert-success mt-3",children:t.success}):null,e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Enable Integration"}),e.jsxs("div",{className:"form-check form-switch mt-2",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:!!t.form.is_active,onChange:s("is_active")}),e.jsx("label",{className:"form-check-label",children:t.form.is_active?"Active":"Inactive"})]})]}),e.jsxs("div",{className:"col-12 col-md-5",children:[e.jsx("label",{className:"form-label",children:"WhatsApp Phone Number ID"}),e.jsx("input",{type:"text",className:"form-control",value:t.form.phone_number_id,onChange:s("phone_number_id"),placeholder:"999319036601668"})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Admin WhatsApp Number"}),e.jsx("input",{type:"text",className:"form-control",value:t.form.admin_phone,onChange:s("admin_phone"),placeholder:"9198XXXXXXXX"}),e.jsx("div",{className:"text-secondary small mt-1",children:"Use international format digits (without `+` also okay)."})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Access Token"}),e.jsx("input",{type:"password",className:"form-control",value:t.form.access_token,onChange:s("access_token"),placeholder:(o=t.data)!=null&&o.has_access_token?`Leave blank to keep existing token (${t.data.access_token_masked})`:"Paste Meta WhatsApp Cloud access token"})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Template Language"}),e.jsx("input",{type:"text",className:"form-control",value:t.form.template_language,onChange:s("template_language"),placeholder:"en_US"})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Graph API Version"}),e.jsx("input",{type:"text",className:"form-control",value:t.form.graph_api_version,onChange:s("graph_api_version"),placeholder:"v21.0"})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"HTTP Timeout (sec)"}),e.jsx("input",{type:"number",className:"form-control",min:"5",max:"60",value:t.form.timeout_seconds,onChange:s("timeout_seconds")})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"mb-2",children:"WhatsApp Notification Features"}),e.jsx("div",{className:"text-secondary small mb-3",children:"Like Email Notifications, choose which WhatsApp notifications should be sent."}),e.jsxs("div",{className:"row g-4",children:[e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("h6",{className:"mb-2",children:"Admin Notifications"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("th",{className:"text-end",children:"Action"})]})}),e.jsx("tbody",{children:(t.notificationCatalog.admin||[]).map(u=>{var d,h;const c=!!((h=(d=t.form.notification_toggles)==null?void 0:d.admin)!=null&&h[u.key]);return e.jsxs("tr",{children:[e.jsx("td",{children:u.title}),e.jsx("td",{className:"text-end",children:e.jsxs("div",{className:"d-inline-flex align-items-center gap-2",children:[e.jsx("span",{className:"small text-secondary",children:c?"On":"Off"}),e.jsx("div",{className:"form-check form-switch mb-0",children:e.jsx("input",{type:"checkbox",className:"form-check-input",checked:c,onChange:()=>l("admin",u.key),"aria-label":`Toggle ${u.title} notification`})})]})})]},u.key)})})]})})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("h6",{className:"mb-2",children:"User Notifications"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("th",{className:"text-end",children:"Action"})]})}),e.jsx("tbody",{children:(t.notificationCatalog.user||[]).map(u=>{var d,h;const c=!!((h=(d=t.form.notification_toggles)==null?void 0:d.user)!=null&&h[u.key]);return e.jsxs("tr",{children:[e.jsx("td",{children:u.title}),e.jsx("td",{className:"text-end",children:e.jsxs("div",{className:"d-inline-flex align-items-center gap-2",children:[e.jsx("span",{className:"small text-secondary",children:c?"On":"Off"}),e.jsx("div",{className:"form-check form-switch mb-0",children:e.jsx("input",{type:"checkbox",className:"form-check-input",checked:c,onChange:()=>l("user",u.key),"aria-label":`Toggle ${u.title} notification`})})]})})]},u.key)})})]})})]})]}),e.jsxs("div",{className:"d-flex gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-primary",onClick:n,disabled:t.saving,children:t.saving?"Saving...":"Save WhatsApp Settings"}),e.jsx(dt,{to:"/saas-admin",className:"btn btn-outline-light",children:"Cancel"})]})]})]})}const E0=[{key:"system",label:"System Backup"},{key:"org",label:"Organization Backup"},{key:"restore",label:"Restore Manager"},{key:"scheduler",label:"Scheduler"},{key:"logs",label:"Logs"}],A0=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function _s(t,a){var s;return((s=t==null?void 0:t.data)==null?void 0:s.detail)||(t==null?void 0:t.message)||a}function Fr({value:t}){const a=String(t||"").toLowerCase(),s=a.includes("complete")||a==="connected"||a==="active"?"bg-success":a.includes("fail")||a==="error"?"bg-danger":a.includes("run")||a.includes("validat")?"bg-warning text-dark":"bg-secondary";return e.jsx("span",{className:`badge ${s}`,children:t||"-"})}function T0(){var ce,ie,ee;const[t,a]=i.useState("system"),[s,n]=i.useState(!0),[l,r]=i.useState(!1),[o,u]=i.useState(!1),[c,d]=i.useState(""),[h,p]=i.useState(""),[g,N]=i.useState(null),[v,w]=i.useState([]),[A,y]=i.useState([]),[x,f]=i.useState([]),[b,k]=i.useState([]),[_,P]=i.useState({is_active:!1,google_client_id:"",google_client_secret:"",google_redirect_uri:"",google_drive_folder_id:"",scheduler_enabled:!1,schedule_frequency:"daily",schedule_weekday:0,schedule_hour_utc:2,schedule_minute_utc:0,keep_last_backups:7}),[S,F]=i.useState(""),[L,Q]=i.useState(""),[E,C]=i.useState(""),z=(g==null?void 0:g.organizations)||[],M=async(T=!1)=>{T?r(!0):n(!0);try{const[Z,se,be,ne]=await Promise.all([U("/api/saas-admin/system-backup-manager/dashboard"),U("/api/saas-admin/system-backup-manager/logs?limit=10"),U("/api/saas-admin/system-backup-manager/org-backups/logs?limit=20"),U("/api/saas-admin/system-backup-manager/restore/logs?limit=20")]);N(Z),w((se==null?void 0:se.items)||[]),y((be==null?void 0:be.items)||[]),f((ne==null?void 0:ne.items)||[]);const ae=(Z==null?void 0:Z.settings)||{};P(X=>({...X,is_active:!!ae.is_active,google_client_id:ae.google_client_id||"",google_client_secret:"",google_redirect_uri:ae.google_redirect_uri||"",google_drive_folder_id:ae.google_drive_folder_id||"",scheduler_enabled:!!ae.scheduler_enabled,schedule_frequency:ae.schedule_frequency||"daily",schedule_weekday:Number(ae.schedule_weekday||0),schedule_hour_utc:Number(ae.schedule_hour_utc??2),schedule_minute_utc:Number(ae.schedule_minute_utc??0),keep_last_backups:Number(ae.keep_last_backups||7)})),!S&&((Z==null?void 0:Z.organizations)||[]).length&&F(String(Z.organizations[0].id)),!L&&((Z==null?void 0:Z.organizations)||[]).length&&Q(String(Z.organizations[0].id)),d("")}catch(Z){d(_s(Z,"Unable to load backup manager."))}finally{n(!1),r(!1)}};i.useEffect(()=>{M(!1);const T=setInterval(()=>M(!0),1e4);return()=>clearInterval(T)},[]),i.useEffect(()=>{if(!L){k([]);return}let T=!0;return U(`/api/saas-admin/system-backup-manager/restore/available?org_id=${encodeURIComponent(L)}`).then(Z=>{if(!T)return;const se=Array.isArray(Z==null?void 0:Z.items)?Z.items:[];k(se),se.length&&!se.some(be=>be.id===E)&&C(se[0].id)}).catch(()=>{T&&k([])}),()=>{T=!1}},[L]);const R=T=>Z=>{const se=Z.target.type==="checkbox"?Z.target.checked:Z.target.value;P(be=>({...be,[T]:se})),d(""),p("")},W=async()=>{u(!0),d(""),p("");try{await U("/api/saas-admin/settings/system-backup-manager",{method:"PUT",body:JSON.stringify({..._,schedule_weekday:Number(_.schedule_weekday||0),schedule_hour_utc:Number(_.schedule_hour_utc||0),schedule_minute_utc:Number(_.schedule_minute_utc||0),keep_last_backups:Number(_.keep_last_backups||7)})}),p("Backup settings saved."),await M(!0)}catch(T){d(_s(T,"Unable to save backup settings."))}finally{u(!1)}},D=async()=>{try{d(""),p(""),await U("/api/saas-admin/system-backup-manager/run",{method:"POST",body:JSON.stringify({})}),p("System backup queued."),await M(!0)}catch(T){d(_s(T,"Unable to queue system backup."))}},te=async()=>{if(S)try{d(""),p(""),await U("/api/saas-admin/system-backup-manager/org-backups/run",{method:"POST",body:JSON.stringify({org_id:Number(S)})}),p("Organization backup queued."),await M(!0)}catch(T){d(_s(T,"Unable to queue organization backup."))}},H=async()=>{try{d(""),p(""),await U("/api/saas-admin/system-backup-manager/org-backups/run-all",{method:"POST",body:JSON.stringify({})}),p("Backup All Organizations queued."),await M(!0)}catch(T){d(_s(T,"Unable to queue all-organization backup."))}},O=async()=>{if(!L||!E)return;const T=b.find(Z=>Z.id===E);try{d(""),p(""),await U("/api/saas-admin/system-backup-manager/restore/run",{method:"POST",body:JSON.stringify({org_id:Number(L),backup_file_id:E,backup_file_name:(T==null?void 0:T.name)||""})}),p("Restore job queued. Safe staged restore flow will validate before applying."),await M(!0)}catch(Z){d(_s(Z,"Unable to queue restore."))}},V=async()=>{try{const T=await U("/api/saas-admin/system-backup-manager/google-drive/auth-start");T!=null&&T.auth_url&&window.open(T.auth_url,"wzGoogleDriveConnect","width=640,height=760"),p("Google Drive OAuth window opened.")}catch(T){d(_s(T,"Unable to start Google Drive OAuth."))}},re=async()=>{try{await U("/api/saas-admin/system-backup-manager/google-drive/disconnect",{method:"POST",body:JSON.stringify({})}),p("Google Drive disconnected."),await M(!0)}catch(T){d(_s(T,"Unable to disconnect Google Drive."))}},Y=i.useMemo(()=>{const T=(g==null?void 0:g.settings)||{};return[{label:"Last Backup Date",value:T.last_backup_date||"-"},{label:"Backup Status",value:T.last_backup_status||"never"},{label:"Google Drive",value:T.google_drive_connection_status||"not_connected"},{label:"Scheduler",value:T.scheduler_enabled?"enabled":"disabled"}]},[g]);return s?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading Backup Manager..."})]}):e.jsx("div",{className:"page-shell",children:e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start gap-2 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Backup Manager"}),e.jsx("p",{className:"text-secondary mb-0",children:"System + organization backups, restore manager, scheduler, and logs."})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>M(!0),disabled:l,children:l?"Refreshing...":"Refresh"}),e.jsx(dt,{to:"/saas-admin",className:"btn btn-outline-light btn-sm",children:"Back to Overview"})]})]}),c?e.jsx("div",{className:"alert alert-danger mt-3",children:c}):null,h?e.jsx("div",{className:"alert alert-success mt-3",children:h}):null,e.jsx("div",{className:"row g-3 mt-2",children:Y.map(T=>e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("div",{className:"small text-secondary",children:T.label}),e.jsx("div",{className:"mt-1",children:e.jsx(Fr,{value:T.value})})]})},T.label))}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-4",children:E0.map(T=>e.jsx("button",{type:"button",className:`btn btn-sm ${t===T.key?"btn-primary":"btn-outline-light"}`,onClick:()=>a(T.key),children:T.label},T.key))}),t==="system"?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{className:"mb-3",children:"System Backup"}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Google OAuth Client ID"}),e.jsx("input",{className:"form-control",value:_.google_client_id,onChange:R("google_client_id")})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Google OAuth Client Secret"}),e.jsx("input",{type:"password",className:"form-control",value:_.google_client_secret,onChange:R("google_client_secret"),placeholder:(ce=g==null?void 0:g.settings)!=null&&ce.has_google_client_secret?"Leave blank to keep existing":"Paste secret"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Google Drive Folder ID"}),e.jsx("input",{className:"form-control",value:_.google_drive_folder_id,onChange:R("google_drive_folder_id"),placeholder:"Optional root folder id"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Enable Backup Manager"}),e.jsxs("div",{className:"form-check form-switch mt-2",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:!!_.is_active,onChange:R("is_active")}),e.jsx("label",{className:"form-check-label",children:_.is_active?"Active":"Inactive"})]})]})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:W,disabled:o,children:o?"Saving...":"Save"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:V,children:"Connect Google Drive"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:re,disabled:!((ie=g==null?void 0:g.settings)!=null&&ie.google_connected),children:"Disconnect"}),e.jsx("button",{type:"button",className:"btn btn-success btn-sm",onClick:D,disabled:(ee=g==null?void 0:g.settings)==null?void 0:ee.backup_running,children:"Run Backup"})]}),e.jsxs("div",{className:"small text-secondary mt-2",children:["Flow: pg_dump ","->"," zip project ","->"," upload to Google Drive ","->"," delete local temp files on success only."]})]}):null,t==="org"?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{className:"mb-3",children:"Organization Backup"}),e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Select Organization"}),e.jsx("select",{className:"form-select",value:S,onChange:T=>F(T.target.value),children:(z||[]).map(T=>e.jsx("option",{value:T.id,children:T.name},T.id))})]}),e.jsxs("div",{className:"col-12 col-md-6 d-flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:te,disabled:!S,children:"Backup Selected Organization"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:H,children:"Backup All Organizations"})]})]}),e.jsxs("div",{className:"small text-secondary mt-2",children:["Temp file ","->"," Google Drive ",e.jsxs("code",{children:["/SaaSBackups/org_","{org_id}","/"]})," ","->"," local temp delete. Server permanent storage not used."]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Org"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Records"}),e.jsx("th",{children:"Models"}),e.jsx("th",{children:"Drive File"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Completed"}),e.jsx("th",{children:"Message"})]})}),e.jsx("tbody",{children:(A||[]).length?A.map(T=>e.jsxs("tr",{children:[e.jsx("td",{children:T.org_name}),e.jsx("td",{children:e.jsx(Fr,{value:T.status})}),e.jsx("td",{children:T.records_exported}),e.jsx("td",{children:T.model_count}),e.jsx("td",{children:T.drive_file_name||"-"}),e.jsx("td",{children:T.created_at||"-"}),e.jsx("td",{children:T.completed_at||"-"}),e.jsx("td",{className:"small",children:T.error_message||T.message||"-"})]},T.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No organization backups yet."})})})]})})]}):null,t==="restore"?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{className:"mb-3",children:"Restore Manager"}),e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Select Organization"}),e.jsx("select",{className:"form-select",value:L,onChange:T=>Q(T.target.value),children:(z||[]).map(T=>e.jsx("option",{value:T.id,children:T.name},T.id))})]}),e.jsxs("div",{className:"col-12 col-md-8",children:[e.jsx("label",{className:"form-label",children:"Available Backups (Google Drive)"}),e.jsx("select",{className:"form-select",value:E,onChange:T=>C(T.target.value),children:(b||[]).map(T=>e.jsxs("option",{value:T.id,children:[T.name," (",T.created_at||"-",")"]},T.id))})]})]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:O,disabled:!L||!E,children:"Restore Selected Backup"})}),e.jsx("div",{className:"small text-warning mt-2",children:"Enterprise safe mode: downloads to temp file, stages in temp restore DB, validates schema/org/records, then restores with no-overwrite policy inside transaction."}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Org"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Backup File"}),e.jsx("th",{children:"Restored"}),e.jsx("th",{children:"Started"}),e.jsx("th",{children:"Completed"}),e.jsx("th",{children:"Result"})]})}),e.jsx("tbody",{children:(x||[]).length?x.map(T=>e.jsxs("tr",{children:[e.jsx("td",{children:T.org_name}),e.jsx("td",{children:e.jsx(Fr,{value:T.status})}),e.jsx("td",{children:T.backup_file_name||"-"}),e.jsx("td",{children:T.restored_records}),e.jsx("td",{children:T.started_at||"-"}),e.jsx("td",{children:T.completed_at||"-"}),e.jsx("td",{className:"small",children:T.errors||T.message||"-"})]},T.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No restore jobs yet."})})})]})})]}):null,t==="scheduler"?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{className:"mb-3",children:"Scheduler"}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Enable Scheduler"}),e.jsxs("div",{className:"form-check form-switch mt-2",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:!!_.scheduler_enabled,onChange:R("scheduler_enabled")}),e.jsx("label",{className:"form-check-label",children:_.scheduler_enabled?"Enabled":"Disabled"})]})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Frequency"}),e.jsxs("select",{className:"form-select",value:_.schedule_frequency,onChange:R("schedule_frequency"),children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"})]})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("label",{className:"form-label",children:"Weekday (UTC)"}),e.jsx("select",{className:"form-select",value:_.schedule_weekday,onChange:R("schedule_weekday"),disabled:_.schedule_frequency!=="weekly",children:A0.map((T,Z)=>e.jsx("option",{value:Z,children:T},T))})]}),e.jsxs("div",{className:"col-6 col-md-2",children:[e.jsx("label",{className:"form-label",children:"Hour"}),e.jsx("input",{type:"number",min:"0",max:"23",className:"form-control",value:_.schedule_hour_utc,onChange:R("schedule_hour_utc")})]}),e.jsxs("div",{className:"col-6 col-md-2",children:[e.jsx("label",{className:"form-label",children:"Minute"}),e.jsx("input",{type:"number",min:"0",max:"59",className:"form-control",value:_.schedule_minute_utc,onChange:R("schedule_minute_utc")})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Keep Last Backups"}),e.jsx("input",{type:"number",min:"1",max:"30",className:"form-control",value:_.keep_last_backups,onChange:R("keep_last_backups")})]})]}),e.jsx("div",{className:"d-flex gap-2 mt-3",children:e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:W,disabled:o,children:o?"Saving...":"Save Scheduler"})}),e.jsx("div",{className:"small text-secondary mt-2",children:"Celery Beat tick runs every 15 minutes and checks DB schedule. Requires Redis + Celery worker + Celery Beat in production."})]}):null,t==="logs"?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{className:"mb-3",children:"Logs"}),e.jsx("h6",{className:"mb-2",children:"System Backup Logs"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Trigger"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Completed"}),e.jsx("th",{children:"Files"}),e.jsx("th",{children:"Message"})]})}),e.jsx("tbody",{children:(v||[]).length?v.map(T=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(Fr,{value:T.status})}),e.jsx("td",{children:T.trigger}),e.jsx("td",{children:T.created_at}),e.jsx("td",{children:T.completed_at||"-"}),e.jsx("td",{children:T.drive_sql_file_name||T.drive_zip_file_name?`${T.drive_sql_file_name||"SQL"} / ${T.drive_zip_file_name||"ZIP"}`:"-"}),e.jsx("td",{className:"small",children:T.error_message||T.message||"-"})]},T.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No system backup logs yet."})})})]})}),e.jsx("div",{className:"small text-warning mt-2",children:"Restore logs keep temp file paths only when failures happen (for investigation). Success flow removes local temp files immediately."})]}):null]})})}const D0={loading:!0,error:"",data:null};function ta(t){return t==null||t===""?"-":t}function R0(){var M,R,W,D,te,H,O,V,re,Y,ce,ie,ee,T,Z,se,be,ne,ae;const[t,a]=i.useState(D0),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState(1),[c,d]=i.useState(""),[h,p]=i.useState(""),[g,N]=i.useState(1),[v,w]=i.useState({open:!1,row:null}),[A,y]=i.useState(""),[x,f]=i.useState(""),b=i.useRef(null),k=i.useRef(null),_=i.useRef(null),P=i.useRef(null),S=10;i.useEffect(()=>{let X=!0;async function ke(){try{const Ne=await U("/api/saas-admin/billing-history");X&&a({loading:!1,error:"",data:Ne})}catch(Ne){X&&a({loading:!1,error:(Ne==null?void 0:Ne.message)||"Unable to load billing history.",data:null})}}return ke(),()=>{X=!1}},[]),i.useEffect(()=>{const X=setTimeout(()=>{r(s.trim()),u(1)},300);return()=>clearTimeout(X)},[s]),i.useEffect(()=>{const X=setTimeout(()=>{p(c.trim()),N(1)},300);return()=>clearTimeout(X)},[c]);const F=t.data||{},L=F.transfers||[],Q=F.subscriptions||[],E=F.available_months||[];i.useEffect(()=>{if(!E.length){y(""),f("");return}y(X=>X||E[0]),f(X=>X||E[E.length-1])},[E]),i.useEffect(()=>{if(!window.flatpickr)return;const X=E.map(Ne=>`${Ne}-01`),ke={wrap:!0,altInput:!0,altFormat:"M Y",dateFormat:"Y-m-d",altInputClass:"date-input flatpickr-input",enable:X,allowInput:!1,disableMobile:!0};b.current&&!_.current&&(_.current=window.flatpickr(b.current,{...ke,onChange:(Ne,Ye)=>{y(Ye?Ye.slice(0,7):"")}})),k.current&&!P.current&&(P.current=window.flatpickr(k.current,{...ke,onChange:(Ne,Ye)=>{f(Ye?Ye.slice(0,7):"")}})),_.current&&(_.current.set("enable",X),A?_.current.setDate(`${A}-01`,!1):_.current.clear()),P.current&&(P.current.set("enable",X),x?P.current.setDate(`${x}-01`,!1):P.current.clear())},[E,A,x]),i.useEffect(()=>()=>{_.current&&_.current.destroy(),P.current&&P.current.destroy()},[]);const C=i.useMemo(()=>{const ke=((Ie,Xe)=>{if(!Xe)return Ie;const nt=Xe.toLowerCase();return Ie.filter(Ae=>[Ae.organization,Ae.owner_name,Ae.owner_email,Ae.product,Ae.request_type,Ae.billing_cycle,Ae.plan,Ae.amount,Ae.currency,Ae.status,Ae.paid_on,Ae.reference_no,Ae.created_at,Ae.updated_at].some(ue=>String(ue||"").toLowerCase().includes(nt)))})(L,l),Ne=Math.max(Math.ceil(ke.length/S),1),Ye=Math.min(o,Ne),Ke=(Ye-1)*S,mt=ke.slice(Ke,Ke+S);return{filtered:ke,paged:mt,totalPages:Ne,currentPage:Ye,startIndex:Ke}},[L,l,o]),z=i.useMemo(()=>{const ke=((Ie,Xe)=>{if(!Xe)return Ie;const nt=Xe.toLowerCase();return Ie.filter(Ae=>[Ae.organization,Ae.product,Ae.plan,Ae.status,Ae.billing_cycle,Ae.start_date,Ae.end_date,Ae.created_at,Ae.user_name,Ae.user_email].some(ue=>String(ue||"").toLowerCase().includes(nt)))})(Q,h),Ne=Math.max(Math.ceil(ke.length/S),1),Ye=Math.min(g,Ne),Ke=(Ye-1)*S,mt=ke.slice(Ke,Ke+S);return{filtered:ke,paged:mt,totalPages:Ne,currentPage:Ye,startIndex:Ke}},[Q,h,g]);return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading billing history..."})]}):t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"page-title",children:"Billing"}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Billing Activity"}),e.jsxs("label",{className:"table-search",htmlFor:"saas-billing-transfer-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-billing-transfer-search",type:"text",value:s,onChange:X=>n(X.target.value),placeholder:"Search billing activity"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Owner"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Paid On"}),e.jsx("th",{children:"GST Bill"}),e.jsx("th",{children:"View"})]})}),e.jsx("tbody",{children:C.paged.length?C.paged.map(X=>e.jsxs("tr",{children:[e.jsx("td",{children:X.organization||"-"}),e.jsx("td",{children:X.owner_name||"-"}),e.jsx("td",{children:X.owner_email||"-"}),e.jsx("td",{children:X.product||"-"}),e.jsx("td",{children:X.plan||"-"}),e.jsx("td",{children:X.request_type||"-"}),e.jsx("td",{children:X.billing_cycle||"-"}),e.jsx("td",{children:X.currency?`${X.currency} ${ta(X.amount)}`:ta(X.amount)}),e.jsx("td",{children:X.status||"-"}),e.jsx("td",{children:X.paid_on||"-"}),e.jsx("td",{children:X.invoice_available&&X.invoice_url?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:X.invoice_url,target:"_blank",rel:"noreferrer",children:"Download"}):"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>w({open:!0,row:X}),children:"View"})})]},X.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"12",children:"No billing activity found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",C.filtered.length?C.startIndex+1:0," to"," ",Math.min(C.startIndex+S,C.filtered.length)," of"," ",C.filtered.length," entries"]}),e.jsx(st,{page:C.currentPage,totalPages:C.totalPages,onPageChange:u,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Subscription History"}),e.jsxs("label",{className:"table-search",htmlFor:"saas-billing-sub-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-billing-sub-search",type:"text",value:c,onChange:X=>d(X.target.value),placeholder:"Search subscription history"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Email"})]})}),e.jsx("tbody",{children:z.paged.length?z.paged.map(X=>e.jsxs("tr",{children:[e.jsx("td",{children:X.organization||"-"}),e.jsx("td",{children:X.product||"-"}),e.jsx("td",{children:X.plan||"-"}),e.jsx("td",{children:X.status||"-"}),e.jsx("td",{children:X.billing_cycle||"-"}),e.jsx("td",{children:X.start_date||"-"}),e.jsx("td",{children:X.end_date||"-"}),e.jsx("td",{children:X.created_at||"-"}),e.jsx("td",{children:X.user_name||"-"}),e.jsx("td",{children:X.user_email||"-"})]},X.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",children:"No subscription history found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",z.filtered.length?z.startIndex+1:0," to"," ",Math.min(z.startIndex+S,z.filtered.length)," of"," ",z.filtered.length," entries"]}),e.jsx(st,{page:z.currentPage,totalPages:z.totalPages,onPageChange:N,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"GST Bills (Monthly)"})}),E.length?e.jsxs("div",{className:"d-flex flex-wrap align-items-end gap-2 mt-3",children:[e.jsxs("label",{className:"gst-date-label",children:[e.jsx("span",{children:"From Month"}),e.jsxs("div",{className:"date-picker-wrap",ref:b,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsxs("label",{className:"gst-date-label",children:[e.jsx("span",{children:"To Month"}),e.jsxs("div",{className:"date-picker-wrap",ref:k,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:!A||!x,onClick:()=>{!A||!x||window.location.assign(`/api/saas-admin/billing-gst-archive?from=${encodeURIComponent(A)}&to=${encodeURIComponent(x)}`)},children:"Download Zip"})]}):e.jsx("div",{className:"text-secondary mt-2",children:"No approved GST bills available yet."})]}),v.open?e.jsx("div",{className:"modal-overlay",onClick:()=>w({open:!1,row:null}),children:e.jsxs("div",{className:"modal-panel",onClick:X=>X.stopPropagation(),children:[e.jsx("h5",{children:"Billing Details"}),e.jsxs("div",{className:"modal-form-grid billing-modal-grid mt-3",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Organization"}),e.jsx("div",{children:ta((M=v.row)==null?void 0:M.organization)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Owner"}),e.jsx("div",{children:ta((R=v.row)==null?void 0:R.owner_name)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Email"}),e.jsx("div",{children:ta((W=v.row)==null?void 0:W.owner_email)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Product"}),e.jsx("div",{children:ta((D=v.row)==null?void 0:D.product)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Plan"}),e.jsx("div",{children:ta((te=v.row)==null?void 0:te.plan)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Type"}),e.jsx("div",{children:ta((H=v.row)==null?void 0:H.request_type)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Cycle"}),e.jsx("div",{children:ta((O=v.row)==null?void 0:O.billing_cycle)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Amount"}),e.jsx("div",{children:(V=v.row)!=null&&V.currency?`${v.row.currency} ${ta((re=v.row)==null?void 0:re.amount)}`:ta((Y=v.row)==null?void 0:Y.amount)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Status"}),e.jsx("div",{children:ta((ce=v.row)==null?void 0:ce.status)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Paid On"}),e.jsx("div",{children:ta((ie=v.row)==null?void 0:ie.paid_on)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Reference"}),e.jsx("div",{children:ta((ee=v.row)==null?void 0:ee.reference_no)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Created"}),e.jsx("div",{children:ta((T=v.row)==null?void 0:T.created_at)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Updated"}),e.jsx("div",{children:ta((Z=v.row)==null?void 0:Z.updated_at)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Notes"}),e.jsx("div",{children:ta((se=v.row)==null?void 0:se.notes)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Receipt"}),(be=v.row)!=null&&be.receipt_url?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:v.row.receipt_url,target:"_blank",rel:"noreferrer",children:"View"}):e.jsx("div",{children:"-"})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"GST Bill"}),(ne=v.row)!=null&&ne.invoice_available&&((ae=v.row)!=null&&ae.invoice_url)?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:v.row.invoice_url,target:"_blank",rel:"noreferrer",children:"Download"}):e.jsx("div",{children:"-"})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>w({open:!1,row:null}),children:"Close"})})]})}):null]})}const L0={loading:!0,error:"",items:[],total:0},yl=25;function M0(){const[t,a]=i.useState(L0),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState(""),[c,d]=i.useState([]),[h,p]=i.useState(1);i.useEffect(()=>{let N=!0;async function v(){try{const w=new URLSearchParams;w.set("limit",String(yl)),w.set("offset",String((h-1)*yl)),s.trim()&&w.set("q",s.trim()),l&&w.set("status",l),o&&w.set("product_id",o);const A=await U(`/api/saas-admin/backup-activity?${w.toString()}`);if(!N)return;a({loading:!1,error:"",items:Array.isArray(A.items)?A.items:[],total:A.total||0})}catch(w){if(!N)return;a({loading:!1,error:(w==null?void 0:w.message)||"Unable to load backup activity.",items:[],total:0})}}return v(),()=>{N=!1}},[s,l,o,h]),i.useEffect(()=>{let N=!0;async function v(){try{const w=await U("/api/saas-admin/overview");if(!N)return;d(Array.isArray(w.products)?w.products:[])}catch{if(!N)return;d([])}}return v(),()=>{N=!1}},[]);const g=Math.max(1,Math.ceil(t.total/yl));return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Org Downloads"}),e.jsx("hr",{className:"section-divider"}),e.jsx("div",{className:"card p-3 mb-3",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Search Org"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Organization name",value:s,onChange:N=>n(N.target.value)})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:l,onChange:N=>r(N.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"queued",children:"Queued"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Product"}),e.jsxs("select",{className:"form-select",value:o,onChange:N=>u(N.target.value),children:[e.jsx("option",{value:"",children:"All"}),c.map(N=>e.jsx("option",{value:String(N.id),children:N.name},N.id))]})]})]})}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Org"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Admin User"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Generated"}),e.jsx("th",{children:"Expiry"})]})}),e.jsx("tbody",{children:t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"Loading activity..."})}):t.items.length?t.items.map(N=>e.jsxs("tr",{children:[e.jsx("td",{children:N.organization_name||"-"}),e.jsx("td",{children:N.product_name||"-"}),e.jsx("td",{children:N.admin_user||"-"}),e.jsx("td",{children:N.size_bytes?`${(N.size_bytes/(1024*1024)).toFixed(2)} MB`:"-"}),e.jsx("td",{children:N.status||"-"}),e.jsx("td",{children:N.completed_at||N.requested_at||"-"}),e.jsx("td",{children:N.expires_at||"-"})]},N.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No backup activity."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",t.items.length?(h-1)*yl+1:0," to"," ",Math.min(h*yl,t.total)," of ",t.total," entries"]}),e.jsx(st,{page:h,totalPages:g,onPageChange:p,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})}const U0={loading:!0,error:"",items:[],total:0},vl=10;function O0(){const[t,a]=i.useState(U0),[s,n]=i.useState([]),[l,r]=i.useState(""),[o,u]=i.useState(1);i.useEffect(()=>{let d=!0;async function h(){try{const p=await U("/api/auth/subscriptions");if(!d)return;const g=(p.subscriptions||[]).map(N=>({slug:N.product_slug,name:N.product_name||N.product_slug}));n(g),!l&&g.length&&r(g[0].slug)}catch{if(!d)return;n([])}}return h(),()=>{d=!1}},[]),i.useEffect(()=>{let d=!0;async function h(){if(!l){a(p=>({...p,loading:!1}));return}a(p=>({...p,loading:!0,error:""}));try{const p=new URLSearchParams;p.set("limit",String(vl)),p.set("offset",String((o-1)*vl)),p.set("product_slug",l);const g=await U(`/api/backup/list?${p.toString()}`);if(!d)return;a({loading:!1,error:"",items:Array.isArray(g.items)?g.items:[],total:g.total||0})}catch(p){if(!d)return;a({loading:!1,error:(p==null?void 0:p.message)||"Unable to load backup history.",items:[],total:0})}}return h(),()=>{d=!1}},[l,o]);const c=Math.max(1,Math.ceil(t.total/vl));return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Backup History"}),e.jsx("hr",{className:"section-divider"}),e.jsx("div",{className:"card p-3 mb-3",children:e.jsx("div",{className:"row g-3 align-items-end",children:e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Product"}),e.jsx("select",{className:"form-select",value:l,onChange:d=>{r(d.target.value),u(1)},children:s.length?s.map(d=>e.jsx("option",{value:d.slug,children:d.name},d.slug)):e.jsx("option",{value:"",children:"No products"})})]})})}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Expires"}),e.jsx("th",{children:"Download"})]})}),e.jsx("tbody",{children:t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"Loading backups..."})}):t.items.length?t.items.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.product_name||"-"}),e.jsx("td",{children:d.status||"-"}),e.jsx("td",{children:d.size_bytes?`${(d.size_bytes/(1024*1024)).toFixed(2)} MB`:"-"}),e.jsx("td",{children:d.completed_at||d.requested_at||"-"}),e.jsx("td",{children:d.expires_at||"-"}),e.jsx("td",{children:d.can_download&&d.download_url?e.jsx("a",{className:"btn btn-sm btn-outline-light",href:d.download_url,children:"Download"}):"-"})]},d.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No backups yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",t.items.length?(o-1)*vl+1:0," to"," ",Math.min(o*vl,t.total)," of ",t.total," entries"]}),e.jsx(st,{page:o,totalPages:c,onPageChange:u,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})}const $0={loading:!0,error:"",servers:[]};function I0(t){return Qs(t)}function F0(){const[t,a]=i.useState($0);return i.useEffect(()=>{let s=!0;async function n(){try{const l=await U("/api/monitoring/servers");if(!s)return;a({loading:!1,error:"",servers:l||[]})}catch(l){if(!s)return;a({loading:!1,error:(l==null?void 0:l.message)||"Unable to load servers.",servers:[]})}}return n(),()=>{s=!1}},[]),t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading servers..."})]}):t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Server Monitoring"}),e.jsx("p",{className:"text-secondary mb-0",children:"Track server health and latest resource usage."})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(dt,{to:"/saas-admin/server-monitoring/alerts",className:"btn btn-outline-light btn-sm",children:"Alerts"}),e.jsx(dt,{to:"/saas-admin/server-monitoring/settings",className:"btn btn-outline-light btn-sm",children:"Settings"})]})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Region"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Last Seen"}),e.jsx("th",{children:"CPU %"}),e.jsx("th",{children:"RAM %"}),e.jsx("th",{children:"Disk %"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:t.servers.length?t.servers.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:s.role}),e.jsx("td",{children:s.region||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.status==="UP"?"bg-success":"bg-danger"}`,children:s.status})}),e.jsx("td",{children:I0(s.last_seen_at)}),e.jsx("td",{children:Math.round(s.cpu_percent||0)}),e.jsx("td",{children:Math.round(s.ram_percent||0)}),e.jsx("td",{children:Math.round(s.disk_percent||0)}),e.jsx("td",{children:e.jsx(dt,{to:`/saas-admin/server-monitoring/${s.id}`,className:"btn btn-primary btn-sm",children:"View"})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",children:"No servers configured."})})})]})})]})}const z0={loading:!0,error:"",server:null,metrics:[]},B0=[{key:"1h",label:"1 Hour"},{key:"24h",label:"24 Hours"},{key:"7d",label:"7 Days"}];function W0(t){return Qs(t)}function V0(){const{serverId:t}=js(),[a,s]=i.useState(z0),[n,l]=i.useState("24h");i.useEffect(()=>{let o=!0;async function u(){try{const[c,d]=await Promise.all([U(`/api/monitoring/servers/${t}`),U(`/api/monitoring/servers/${t}/metrics?range=${n}`)]);if(!o)return;s({loading:!1,error:"",server:c,metrics:d||[]})}catch(c){if(!o)return;s({loading:!1,error:(c==null?void 0:c.message)||"Unable to load server details.",server:null,metrics:[]})}}return u(),()=>{o=!1}},[t,n]);const r=i.useMemo(()=>a.metrics.length?a.metrics[a.metrics.length-1]:null,[a.metrics]);return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading server details..."})]}):a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):a.server?e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:a.server.name}),e.jsxs("div",{className:"text-secondary",children:[a.server.role,"  ",a.server.region||"Unknown","  ",a.server.hostname||"-"]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(dt,{to:"/saas-admin/server-monitoring",className:"btn btn-outline-light btn-sm",children:"Back"}),e.jsx(dt,{to:"/saas-admin/server-monitoring/alerts",className:"btn btn-outline-light btn-sm",children:"Alerts"})]})]}),e.jsxs("div",{className:"row g-3 mt-3",children:[e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-cpu","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"CPU %"}),e.jsx("div",{className:"stat-value",children:r?Math.round(r.cpu_percent||0):0})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-memory","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"RAM %"}),e.jsx("div",{className:"stat-value",children:r?Math.round(r.ram_percent||0):0})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-hdd","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"Disk %"}),e.jsx("div",{className:"stat-value",children:r?Math.round(r.disk_percent||0):0})]})})]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 mt-4 flex-wrap",children:[e.jsxs("h5",{className:"mb-0",children:["Metrics (",n,")"]}),e.jsx("select",{className:"form-select",style:{width:"180px"},value:n,onChange:o=>l(o.target.value),children:B0.map(o=>e.jsx("option",{value:o.key,children:o.label},o.key))})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Time"}),e.jsx("th",{children:"CPU %"}),e.jsx("th",{children:"RAM %"}),e.jsx("th",{children:"Disk %"}),e.jsx("th",{children:"Load 1"}),e.jsx("th",{children:"Load 5"}),e.jsx("th",{children:"Load 15"})]})}),e.jsx("tbody",{children:a.metrics.length?a.metrics.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:W0(o.ts_minute)}),e.jsx("td",{children:Math.round(o.cpu_percent||0)}),e.jsx("td",{children:Math.round(o.ram_percent||0)}),e.jsx("td",{children:Math.round(o.disk_percent||0)}),e.jsx("td",{children:Math.round(o.load1||0)}),e.jsx("td",{children:Math.round(o.load5||0)}),e.jsx("td",{children:Math.round(o.load15||0)})]},o.ts_minute)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No metrics found."})})})]})})]}):e.jsx("div",{className:"alert alert-warning",children:"Server not found."})}const G0={loading:!0,error:"",saving:!1,enabled:!0,heartbeat_expected_seconds:30,down_after_minutes:3,cpu_threshold:85,ram_threshold:90,disk_threshold:90,breach_minutes:5,email_enabled:!0,alert_emails:"",retention_days_metrics:30};function H0(){const[t,a]=i.useState(G0),[s,n]=i.useState("");i.useEffect(()=>{let o=!0;async function u(){try{const c=await U("/api/monitoring/settings");if(!o)return;a({loading:!1,error:"",saving:!1,enabled:!!c.enabled,heartbeat_expected_seconds:c.heartbeat_expected_seconds??30,down_after_minutes:c.down_after_minutes??3,cpu_threshold:c.cpu_threshold??85,ram_threshold:c.ram_threshold??90,disk_threshold:c.disk_threshold??90,breach_minutes:c.breach_minutes??5,email_enabled:!!c.email_enabled,alert_emails:(c.alert_emails||[]).join(", "),retention_days_metrics:c.retention_days_metrics??30})}catch(c){if(!o)return;a(d=>({...d,loading:!1,error:(c==null?void 0:c.message)||"Unable to load settings."}))}}return u(),()=>{o=!1}},[]);const l=o=>u=>{const c=u.target.type==="checkbox"?u.target.checked:u.target.value;a(d=>({...d,[o]:c}))},r=async()=>{n(""),a(o=>({...o,saving:!0,error:""}));try{const o={enabled:t.enabled,heartbeat_expected_seconds:Number(t.heartbeat_expected_seconds),down_after_minutes:Number(t.down_after_minutes),cpu_threshold:Number(t.cpu_threshold),ram_threshold:Number(t.ram_threshold),disk_threshold:Number(t.disk_threshold),breach_minutes:Number(t.breach_minutes),email_enabled:t.email_enabled,alert_emails:t.alert_emails.split(",").map(c=>c.trim()).filter(Boolean),retention_days_metrics:Number(t.retention_days_metrics)},u=await U("/api/monitoring/settings",{method:"POST",body:JSON.stringify(o)});a(c=>({...c,saving:!1,error:"",alert_emails:(u.alert_emails||[]).join(", ")})),n("Settings saved.")}catch(o){a(u=>({...u,saving:!1,error:(o==null?void 0:o.message)||"Unable to save settings."}))}};return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading settings..."})]}):e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between gap-2 flex-wrap",children:e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Server Monitoring Settings"}),e.jsx("p",{className:"text-secondary mb-0",children:"Thresholds, heartbeat, and notifications."})]})}),t.error?e.jsx("div",{className:"alert alert-danger mt-3",children:t.error}):null,s?e.jsx("div",{className:"alert alert-success mt-3",children:s}):null,e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Heartbeat Expected (seconds)"}),e.jsx("input",{type:"number",className:"form-control",value:t.heartbeat_expected_seconds,onChange:l("heartbeat_expected_seconds")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Down After (minutes)"}),e.jsx("input",{type:"number",className:"form-control",value:t.down_after_minutes,onChange:l("down_after_minutes")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Breach Window (minutes)"}),e.jsx("input",{type:"number",className:"form-control",value:t.breach_minutes,onChange:l("breach_minutes")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"CPU Threshold"}),e.jsx("input",{type:"number",className:"form-control",value:t.cpu_threshold,onChange:l("cpu_threshold")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"RAM Threshold"}),e.jsx("input",{type:"number",className:"form-control",value:t.ram_threshold,onChange:l("ram_threshold")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Disk Threshold"}),e.jsx("input",{type:"number",className:"form-control",value:t.disk_threshold,onChange:l("disk_threshold")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Retention (days)"}),e.jsx("input",{type:"number",className:"form-control",value:t.retention_days_metrics,onChange:l("retention_days_metrics")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Alert Emails"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"ops@company.com, admin@company.com",value:t.alert_emails,onChange:l("alert_emails")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Email Alerts"}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:t.email_enabled,onChange:l("email_enabled"),id:"monitoring-email"}),e.jsx("label",{className:"form-check-label",htmlFor:"monitoring-email",children:"Send email alerts"})]})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Enabled"}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:t.enabled,onChange:l("enabled"),id:"monitoring-enabled-bottom"}),e.jsx("label",{className:"form-check-label",htmlFor:"monitoring-enabled-bottom",children:"Monitoring Enabled"})]})]}),e.jsx("div",{className:"col-12 col-md-6 col-xl-3 d-flex align-items-end",children:e.jsx("button",{type:"button",className:"btn btn-success",onClick:r,disabled:t.saving,children:t.saving?"Saving...":"Data Save"})})]})]})}const q0={loading:!0,error:"",alerts:[]};function Uf(t){return Qs(t)}function Q0(){const[t,a]=i.useState(q0),[s,n]=i.useState("open");return i.useEffect(()=>{let l=!0;async function r(){try{const o=await U(`/api/monitoring/alerts?status=${s}`);if(!l)return;a({loading:!1,error:"",alerts:o||[]})}catch(o){if(!l)return;a({loading:!1,error:(o==null?void 0:o.message)||"Unable to load alerts.",alerts:[]})}}return r(),()=>{l=!1}},[s]),t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading alerts..."})]}):e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Server Alerts"}),e.jsx("p",{className:"text-secondary mb-0",children:"Active and historical alert events."})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(dt,{to:"/saas-admin/server-monitoring",className:"btn btn-outline-light btn-sm",children:"Back"}),e.jsxs("select",{className:"form-select",style:{width:"160px"},value:s,onChange:l=>n(l.target.value),children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]})]})]}),t.error?e.jsx("div",{className:"alert alert-danger mt-3",children:t.error}):null,e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Server"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Severity"}),e.jsx("th",{children:"Started"}),e.jsx("th",{children:"Ended"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:t.alerts.length?t.alerts.map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:l.server_name}),e.jsx("td",{children:l.type}),e.jsx("td",{children:l.severity}),e.jsx("td",{children:Uf(l.started_at)}),e.jsx("td",{children:Uf(l.ended_at)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${l.is_active?"bg-danger":"bg-secondary"}`,children:l.is_active?"Open":"Closed"})})]},l.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No alerts."})})})]})})]})}const Cl=50,Of={loading:!0,error:"",items:[],folderId:null,rootId:null,pagination:{limit:Cl,offset:0,total_folders:0,total_files:0}},J0={loading:!0,error:"",total_gb:0,used_gb:0,remaining_gb:0,bandwidth_total_gb:0,bandwidth_used_gb:0,bandwidth_remaining_gb:0,bandwidth_limited:!1,addon_slots:0},K0={loading:!0,error:"",items:[]},Y0={loading:!0,error:"",items:[]};function $f(t){const a=Number(t||0);if(!a)return"0 B";const s=a/1024;if(s<1024)return`${s.toFixed(1)} KB`;const n=s/1024;return n<1024?`${n.toFixed(1)} MB`:`${(n/1024).toFixed(2)} GB`}function kn(t){return`${Number(t||0).toFixed(0)} GB`}function If(t){return Qs(t)}async function Z0(t,a){ns()||await fetch("/api/auth/csrf",{credentials:"include"});const s=await fetch(t,{method:"POST",credentials:"include",headers:{"X-CSRFToken":ns()},body:a}),n=await s.text();let l=null;if(n)try{l=JSON.parse(n)}catch{l=null}if(!s.ok){const r=(l==null?void 0:l.error)||(l==null?void 0:l.detail)||`Request failed (${s.status})`,o=new Error(r);throw o.status=s.status,o.data=l,o}return l}function X0(t){return!t||!t.length?"Root":t.map(a=>a.name).join(" / ")}function La(t,a){var l,r;const s=((l=t==null?void 0:t.data)==null?void 0:l.error)||((r=t==null?void 0:t.data)==null?void 0:r.detail)||(t==null?void 0:t.message);return{permission_denied:"You do not have access to this item.",storage_limit_exceeded:"Storage limit exceeded. Please upgrade your storage.",bandwidth_limit_exceeded:"Bandwidth limit exceeded. Please upgrade your plan.",invalid_folder:"Folder not found.",file_not_found:"File not found.",uploads_disabled:"Uploads are currently disabled.",rate_limited:"Too many requests. Please try again shortly.",storage_unavailable:"Storage is temporarily unavailable.",read_only:"This organization is currently in read-only mode."}[s]||a||"Something went wrong."}function Ff(){var gt,ft;const t=typeof window<"u"&&window.__WZ_READ_ONLY__===!0,a=js(),s=bs(),n=ys(),[l,r]=i.useState(Of),[o,u]=i.useState(J0),[c,d]=i.useState(K0),[h,p]=i.useState(!1),[g,N]=i.useState(a.id?Number(a.id):null),[v,w]=i.useState([]),[A,y]=i.useState({}),[x,f]=i.useState(()=>new Set),[b,k]=i.useState(""),[_,P]=i.useState(""),[S,F]=i.useState({loading:!1,error:"",items:[],limit:50}),[L,Q]=i.useState([]),[E,C]=i.useState(""),[z,M]=i.useState(!1),[R,W]=i.useState({open:!1,item:null,type:"",targetId:""}),[D,te]=i.useState(Y0),[H,O]=i.useState(a.device_id||""),[V,re]=i.useState(null),Y=i.useMemo(()=>X0(v),[v]),ce=i.useMemo(()=>{if(!H)return"Root";const G=D.items.find(Se=>Se.device_id===H);return(G==null?void 0:G.device_name)||H},[D.items,H]);i.useEffect(()=>{if(a.id){const G=Number(a.id);Number.isNaN(G)||N(G)}else N(null)},[a.id]),i.useEffect(()=>{let G=!0;async function Se(){try{const ve=await U("/api/storage/org/users");if(!G)return;d({loading:!1,error:"",items:ve.items||[]}),p(!0)}catch(ve){if(!G)return;if((ve==null?void 0:ve.status)===403){d({loading:!1,error:"",items:[]}),p(!1);return}d({loading:!1,error:La(ve,"Unable to load users."),items:[]}),p(!1)}}return Se(),()=>{G=!1}},[]),i.useEffect(()=>{let G=!0;async function Se(){try{const ve=new URLSearchParams;g&&ve.set("user_id",String(g));const le=await U(`/api/storage/org/devices?${ve.toString()}`);if(!G)return;te({loading:!1,error:"",items:le.items||[]})}catch(ve){if(!G)return;if((ve==null?void 0:ve.status)===403){te({loading:!1,error:"",items:[]});return}te({loading:!1,error:La(ve,"Unable to load devices."),items:[]})}}return Se(),()=>{G=!1}},[g]),i.useEffect(()=>{H||D.items.length&&O(D.items[0].device_id)},[D.items,H]),i.useEffect(()=>{const G=setTimeout(()=>{P(b.trim())},300);return()=>clearTimeout(G)},[b]),i.useEffect(()=>{let G=!0;async function Se(){if(!_){F({loading:!1,error:"",items:[],limit:50});return}F(ve=>({...ve,loading:!0,error:""}));try{const ve=new URLSearchParams;ve.set("q",_),ve.set("limit","50"),g&&ve.set("user_id",String(g));const le=await U(`/api/storage/explorer/search?${ve.toString()}`);if(!G)return;F({loading:!1,error:"",items:le.items||[],limit:le.limit||50})}catch(ve){if(!G)return;F({loading:!1,error:La(ve,"Unable to search files."),items:[],limit:50})}}return Se(),()=>{G=!1}},[_,g]),i.useEffect(()=>{let G=!0;async function Se(){try{const ve=await U("/api/storage/explorer/status");if(!G)return;u({loading:!1,error:"",total_gb:ve.total_allowed_storage_gb||0,used_gb:ve.used_storage_gb||0,remaining_gb:ve.remaining_storage_gb||0,bandwidth_total_gb:ve.total_allowed_bandwidth_gb||0,bandwidth_used_gb:ve.used_bandwidth_gb||0,bandwidth_remaining_gb:ve.remaining_bandwidth_gb||0,bandwidth_limited:!!ve.is_bandwidth_limited,addon_slots:Number(ve.addon_slots||0)}),M(!!(ve.total_allowed_storage_gb&&ve.remaining_storage_gb<=0))}catch(ve){if(!G)return;u({loading:!1,error:La(ve,"Unable to load storage usage."),total_gb:0,used_gb:0,remaining_gb:0,bandwidth_total_gb:0,bandwidth_used_gb:0,bandwidth_remaining_gb:0,bandwidth_limited:!1,addon_slots:0})}}return Se(),()=>{G=!1}},[g]),i.useEffect(()=>{let G=!0;async function Se(){var ve,le;r(xe=>({...xe,loading:!0,error:""}));try{const xe=new URLSearchParams;xe.set("limit",String(Cl)),xe.set("offset","0"),g&&xe.set("user_id",String(g));const ge=await U(`/api/storage/explorer/root?${xe.toString()}`);if(!G)return;const B=ge.folder_id||null;let he=B;if(H&&((ve=ge.items)!=null&&ve.length)){const me=ge.items.find(Me=>Me.type==="folder"&&Me.name===H);me!=null&&me.id&&(he=me.id)}let we=ge.items||[];he&&he!==B&&(we=(await U(`/api/storage/explorer/folder/${he}?${xe.toString()}`)).items||[]),re(he),r({loading:!1,error:"",items:we,folderId:he,rootId:B,pagination:ge.pagination||{limit:Cl,offset:0,total_folders:0,total_files:0}});const I=H?((le=D.items.find(me=>me.device_id===H))==null?void 0:le.device_name)||H:"Root";w(he?[{id:he,name:I}]:[]),he&&(y(me=>({...me,[he]:we.filter(Me=>Me.type==="folder")})),f(new Set([he])))}catch(xe){if(!G)return;r({...Of,loading:!1,error:La(xe,"Unable to load folders.")})}}return Se(),()=>{G=!1}},[g,H,D.items]),i.useEffect(()=>{v.length&&f(G=>{const Se=new Set(G);return v.forEach(ve=>{ve!=null&&ve.id&&Se.add(ve.id)}),Se})},[v]);const ie=(((gt=l.pagination)==null?void 0:gt.total_folders)||0)+(((ft=l.pagination)==null?void 0:ft.total_files)||0),ee=l.items.length<ie;function T(G){if(!g)return G;const Se=G.includes("?")?"&":"?";return`${G}${Se}user_id=${g}`}async function Z(){l.folderId&&await se(l.folderId,{reset:!0,pathOverride:v})}async function se(G,{reset:Se=!1,pathOverride:ve=null,offset:le=0,append:xe=!1}={}){var ge,B;if(G){Se&&r(he=>({...he,loading:!0,error:"",items:xe?he.items:[]}));try{const he=new URLSearchParams;he.set("limit",String(Cl)),he.set("offset",String(le)),g&&he.set("user_id",String(g));const we=await U(`/api/storage/explorer/folder/${G}?${he.toString()}`),I=xe?[...l.items,...we.items||[]]:we.items||[];r({loading:!1,error:"",items:I,folderId:G,rootId:l.rootId,pagination:we.pagination||l.pagination}),y(me=>({...me,[G]:(we.items||[]).filter(Me=>Me.type==="folder")})),ve&&w(ve)}catch(he){if((((ge=he==null?void 0:he.data)==null?void 0:ge.error)||((B=he==null?void 0:he.data)==null?void 0:B.detail))==="invalid_folder"){await be();return}r(I=>({...I,loading:!1,error:La(he,"Unable to load folder.")}))}}}async function be(){var Se;if(k(""),P(""),F({loading:!1,error:"",items:[],limit:50}),!V)return;const G=H?((Se=D.items.find(ve=>ve.device_id===H))==null?void 0:Se.device_name)||H:"Root";w([{id:V,name:G}]),await se(V,{reset:!0,pathOverride:[{id:V,name:G}]})}function ne(G){if(!G||!G.id)return;k(""),P(""),F({loading:!1,error:"",items:[],limit:50});const Se=v.findIndex(le=>le.id===G.id),ve=Se>=0?v.slice(0,Se+1):[...v,{id:G.id,name:G.name}];w(ve),se(G.id,{reset:!0,pathOverride:ve})}function ae(G,Se){if(!(G!=null&&G.id))return;const ve=v.slice(0,Se+1);w(ve),se(G.id,{reset:!0,pathOverride:ve})}function X(G){const Se=G.target.value;if(O(""),!Se){s("/");return}s(`/user/${Se}`)}async function ke(){const G=window.prompt("Folder name");if(G){C("");try{await U(T("/api/storage/explorer/folders/create"),{method:"POST",body:JSON.stringify({name:G.trim(),parent_id:l.folderId})}),await Z()}catch(Se){C(La(Se,"Unable to create folder."))}}}async function Ne(G){var ve;const Se=window.prompt("Rename",(G==null?void 0:G.name)||"");if(!(!Se||!G)){C("");try{G.type==="folder"?await U(T(`/api/storage/explorer/folders/${G.id}/rename`),{method:"POST",body:JSON.stringify({name:Se.trim()})}):await U(T(`/api/storage/explorer/files/${G.id}/rename`),{method:"POST",body:JSON.stringify({name:Se.trim()})}),await Z()}catch(le){((ve=le==null?void 0:le.data)==null?void 0:ve.error)==="file_not_found"&&await Z(),C(La(le,"Unable to rename item."))}}}async function Ye(G){if(!(!G||!await n({title:"Confirm Delete",message:`Delete ${G.type==="folder"?"folder":"file"} "${G.name}"?`,confirmVariant:"danger"}))){C("");try{G.type==="folder"?await U(T(`/api/storage/explorer/folders/${G.id}/delete`),{method:"DELETE"}):await U(T(`/api/storage/explorer/files/${G.id}/delete`),{method:"DELETE"}),await Z(),await Ke()}catch(ve){C(La(ve,"Unable to delete item."))}}}async function Ke(){try{const G=await U("/api/storage/explorer/status");u({loading:!1,error:"",total_gb:G.total_allowed_storage_gb||0,used_gb:G.used_storage_gb||0,remaining_gb:G.remaining_storage_gb||0,bandwidth_total_gb:G.total_allowed_bandwidth_gb||0,bandwidth_used_gb:G.used_bandwidth_gb||0,bandwidth_remaining_gb:G.remaining_bandwidth_gb||0,bandwidth_limited:!!G.is_bandwidth_limited,addon_slots:Number(G.addon_slots||0)}),M(!!(G.total_allowed_storage_gb&&G.remaining_storage_gb<=0))}catch(G){u(Se=>({...Se,loading:!1,error:La(G,"Unable to load storage usage.")}))}}async function mt(G){var le;const Se=Array.from(G.target.files||[]);if(G.target.value="",!Se.length)return;const ve=Se.map(xe=>({id:`${xe.name}-${xe.size}-${Date.now()}`,name:xe.name,status:"uploading",error:""}));Q(xe=>[...ve,...xe]);for(let xe=0;xe<Se.length;xe+=1){const ge=Se[xe],B=ve[xe].id,he=new FormData;he.append("file",ge),l.folderId&&he.append("folder_id",l.folderId),g&&he.append("user_id",String(g));try{await Z0("/api/storage/explorer/upload",he),Q(we=>we.map(I=>I.id===B?{...I,status:"done"}:I)),await Z(),await Ke()}catch(we){const I=(le=we==null?void 0:we.data)==null?void 0:le.error;Q(me=>me.map(Me=>Me.id===B?{...Me,status:"error",error:I==="storage_limit_exceeded"?"Storage limit exceeded.":La(we,"Upload failed.")}:Me)),I==="storage_limit_exceeded"&&(C("Storage limit exceeded. Upgrade storage to continue uploading."),M(!0))}}}function Ie(G={}){const Se=new URLSearchParams;return G.file_id&&Se.set("file_id",G.file_id),G.folder_id&&Se.set("folder_id",G.folder_id),G.user_id&&Se.set("user_id",G.user_id),G.device_id&&Se.set("device_id",G.device_id),`/api/storage/download/?${Se.toString()}`}function Xe(G){if(!G)return;const Se={file_id:G.id};g&&(Se.user_id=g),window.location.href=Ie(Se)}function nt(G){const Se={folder_id:G};g&&(Se.user_id=g),window.location.href=Ie(Se)}function Ae(){g&&(window.location.href=Ie({user_id:g}))}function ue(){H&&(window.location.href=Ie({device_id:H}))}function je(G,Se){W({open:!0,item:G,type:Se,targetId:V||""})}function Ce(){const G=[];V&&G.push({id:V,name:ce});const Se=new Set(G.map(ve=>ve.id));return Object.values(A).forEach(ve=>{(ve||[]).forEach(le=>{le!=null&&le.id&&!Se.has(le.id)&&(Se.add(le.id),G.push({id:le.id,name:le.name}))})}),G}async function Le(){if(!R.item||!R.targetId){W({open:!1,item:null,type:"",targetId:""});return}C("");try{R.type==="folder"?await U(T(`/api/storage/explorer/folders/${R.item.id}/move`),{method:"POST",body:JSON.stringify({parent_id:R.targetId})}):await U(T(`/api/storage/explorer/files/${R.item.id}/move`),{method:"POST",body:JSON.stringify({folder_id:R.targetId})}),W({open:!1,item:null,type:"",targetId:""}),await Z()}catch(G){C(La(G,"Unable to move item."))}}async function Fe(){var Se,ve;const G=(((Se=l.pagination)==null?void 0:Se.offset)||0)+(((ve=l.pagination)==null?void 0:ve.limit)||Cl);await se(l.folderId,{offset:G,append:!0,reset:!0,pathOverride:v})}function ye(G){var le;if(!(G!=null&&G.folder_path)||!G.folder_path.length)return;const Se=G.folder_path.map(xe=>({id:xe.id,name:xe.name})),ve=(le=Se[Se.length-1])==null?void 0:le.id;ve&&(w(Se),k(""),P(""),F({loading:!1,error:"",items:[],limit:50}),se(ve,{reset:!0,pathOverride:Se}))}function Ze(G){f(Se=>{const ve=new Set(Se);return ve.has(G)?ve.delete(G):ve.add(G),ve})}function pt({nodeId:G,label:Se,depth:ve}){const le=A[G]||[],xe=x.has(G);return e.jsxs("div",{style:{marginLeft:ve*12},children:[e.jsxs("div",{className:`storage-tree-item ${v.some(ge=>ge.id===G)?"active":""}`,children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light storage-tree-toggle",onClick:()=>Ze(G),"aria-label":xe?"Collapse":"Expand",children:e.jsx("i",{className:`bi ${xe?"bi-caret-down":"bi-caret-right"}`,"aria-hidden":"true"})}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link text-start storage-tree-label",onClick:()=>ne({id:G,name:Se}),children:Se})]}),xe&&le.length?e.jsx("div",{children:le.map(ge=>e.jsx(pt,{nodeId:ge.id,label:ge.name,depth:ve+1},ge.id))}):null]})}const ht=o.total_gb?Math.min(100,Math.round(o.used_gb/o.total_gb*100)):0,Ge=i.useMemo(()=>Ce(),[A,V,ce]);return e.jsxs("div",{className:"container-fluid storage-explorer",children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:"Online Storage"}),e.jsx("div",{className:"text-secondary",children:"Windows-style explorer for your files and folders."})]}),e.jsx("div",{className:"storage-usage-card",children:o.loading?e.jsx("div",{className:"text-secondary",children:"Loading storage..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"storage-usage-row",children:[e.jsxs("div",{className:"storage-usage-col",children:[e.jsx("div",{className:"small text-secondary",children:"Storage usage"}),e.jsxs("div",{className:"fw-semibold",children:[kn(o.used_gb)," used / ",kn(o.total_gb)]}),e.jsx("div",{className:"progress storage-usage-bar",children:e.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${ht}%`},"aria-valuenow":ht,"aria-valuemin":"0","aria-valuemax":"100"})}),e.jsxs("div",{className:"small text-secondary",children:[kn(o.remaining_gb)," remaining"]})]}),o.bandwidth_total_gb||o.bandwidth_limited?e.jsxs("div",{className:"storage-usage-col",children:[e.jsx("div",{className:"small text-secondary",children:"Bandwidth usage"}),e.jsxs("div",{className:"fw-semibold",children:[kn(o.bandwidth_used_gb)," used / ",kn(o.bandwidth_total_gb)]}),e.jsxs("div",{className:"small text-secondary",children:[kn(o.bandwidth_remaining_gb)," remaining"]})]}):null]}),e.jsxs("div",{className:"storage-usage-meta small text-secondary",children:["Add-on slots: ",e.jsx("span",{className:"text-light",children:o.addon_slots||0})]})]})})]}),E?e.jsx("div",{className:"alert alert-warning mt-3",children:E}):null,t?e.jsxs("div",{className:"alert alert-info mt-3 d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("div",{children:"Read-only mode enabled. Upgrade your plan to resume uploads and sync."}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>s("/plans"),children:"Upgrade now"})]}):null,z?e.jsxs("div",{className:"alert alert-info mt-3 d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("div",{children:"Storage limit reached. Upgrade storage to continue uploading."}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>s("/plans"),children:"Upgrade storage"})]}):null,l.error?e.jsx("div",{className:"alert alert-danger mt-3",children:l.error}):null,c.error?e.jsx("div",{className:"alert alert-danger mt-3",children:c.error}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-lg-3",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h5",{className:"mb-0",children:"Folder Tree"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:be,children:"Root"})]}),h&&c.items.length?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"View user"}),e.jsxs("select",{className:"form-select",value:g||"",onChange:X,children:[e.jsx("option",{value:"",children:"My Files"}),c.items.map(G=>e.jsx("option",{value:G.user_id,children:G.name||G.email||G.username},G.user_id))]}),e.jsx("div",{className:"d-flex gap-2 flex-wrap mt-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Ae,disabled:!g,children:"Download User Files"})}),e.jsx("label",{className:"form-label mt-3",children:"Device"}),e.jsxs("select",{className:"form-select form-select-sm",value:H,onChange:G=>O(G.target.value),children:[e.jsx("option",{value:"",children:"Select device"}),D.items.map(G=>e.jsx("option",{value:G.device_id,children:G.device_name||G.device_id},G.device_id))]}),e.jsx("div",{className:"d-flex gap-2 flex-wrap mt-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:ue,disabled:!H,children:"Download Device Files"})})]}):null,e.jsx("div",{className:"storage-tree",children:V?e.jsx(pt,{nodeId:V,label:ce,depth:0}):e.jsx("div",{className:"text-secondary",children:"Loading tree..."})})]})}),e.jsx("div",{className:"col-12 col-lg-9",children:e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-secondary small",children:"Current folder"}),e.jsx("div",{className:"fw-semibold",children:Y})]}),e.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[e.jsxs("label",{className:"btn btn-outline-light btn-sm mb-0",children:[e.jsx("input",{type:"file",multiple:!0,hidden:!0,onChange:mt}),e.jsx("i",{className:"bi bi-upload","aria-hidden":"true"})," Upload"]}),e.jsxs("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>nt(l.folderId||V),disabled:!l.folderId&&!V,children:[e.jsx("i",{className:"bi bi-download","aria-hidden":"true"})," Download Folder"]}),e.jsxs("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:ke,children:[e.jsx("i",{className:"bi bi-folder-plus","aria-hidden":"true"})," New Folder"]}),e.jsxs("div",{className:"input-group input-group-sm storage-search",children:[e.jsx("span",{className:"input-group-text",children:e.jsx("i",{className:"bi bi-search","aria-hidden":"true"})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search files",value:b,onChange:G=>k(G.target.value)}),b?e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>k(""),children:"Clear"}):null]})]})]}),e.jsx("div",{className:"storage-breadcrumb mb-3",children:v.map((G,Se)=>e.jsx("button",{type:"button",className:"btn btn-link btn-sm",onClick:()=>ae(G,Se),children:G.name},G.id))}),L.length?e.jsxs("div",{className:"card p-2 mb-3 storage-upload-queue",children:[e.jsx("div",{className:"small text-secondary",children:"Upload queue"}),L.map(G=>e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("div",{className:"text-truncate",children:G.name}),e.jsx("div",{className:`small ${G.status==="error"?"text-danger":"text-secondary"}`,children:G.status==="uploading"?"Uploading...":G.status==="done"?"Done":G.error})]},G.id))]}):null,_?e.jsxs("div",{children:[e.jsxs("div",{className:"text-secondary small mb-2",children:['Search results for "',_,'"']}),S.loading?e.jsx("div",{className:"text-secondary",children:"Searching..."}):S.error?e.jsx("div",{className:"alert alert-danger",children:S.error}):S.items.length?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"File"}),e.jsx("th",{children:"Path"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:S.items.map(G=>e.jsxs("tr",{children:[e.jsx("td",{children:G.filename}),e.jsx("td",{className:"text-secondary",children:(G.folder_path||[]).map(Se=>Se.name).join(" / ")}),e.jsx("td",{children:$f(G.size)}),e.jsx("td",{children:If(G.created_at)}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>ye(G),children:"Open"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Xe({id:G.file_id}),children:"Download"})]})})]},G.file_id))})]})}):e.jsx("div",{className:"text-secondary",children:"No matching files."})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"text-secondary small mb-2",children:["Showing ",l.items.length," of ",ie," items"]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:l.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:"Loading..."})}):l.items.length?l.items.map(G=>e.jsxs("tr",{className:"storage-file-row",children:[e.jsx("td",{children:G.type==="folder"?e.jsxs("button",{type:"button",className:"btn btn-link text-start",onClick:()=>ne(G),children:[e.jsx("i",{className:"bi bi-folder me-2","aria-hidden":"true"}),G.name]}):e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-file-earmark me-2","aria-hidden":"true"}),G.name]})}),e.jsx("td",{children:G.type==="folder"?"Folder":"File"}),e.jsx("td",{children:G.type==="file"?$f(G.size||G.size_bytes):"-"}),e.jsx("td",{children:If(G.created_at)}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[G.type==="file"?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Xe(G),children:"Download"}):e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>nt(G.id),children:"Download"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Ne(G),children:"Rename"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>je(G,G.type),children:"Move"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>Ye(G),children:"Delete"})]})})]},G.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:"No files or folders yet."})})})]})}),ee?e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Fe,children:"Load more"})}):null]})]})})]}),R.open?e.jsx("div",{className:"modal-overlay",onClick:()=>W({open:!1,item:null,type:"",targetId:""}),children:e.jsxs("div",{className:"modal-panel",onClick:G=>G.stopPropagation(),children:[e.jsxs("h5",{children:["Move ",R.type==="folder"?"Folder":"File"]}),e.jsx("div",{className:"text-secondary small mb-3",children:"Select a destination folder."}),e.jsx("select",{className:"form-select",value:R.targetId||"",onChange:G=>W(Se=>({...Se,targetId:G.target.value})),children:Ge.map(G=>e.jsx("option",{value:G.id,children:G.name},G.id))}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>W({open:!1,item:null,type:"",targetId:""}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Le,disabled:!R.targetId,children:"Move"})]})]})}):null]})}const ek={loading:!0,error:"",items:[]};function tk(){const[t,a]=i.useState(ek),[s,n]=i.useState({name:"",email:"",password:"",invite:!1}),[l,r]=i.useState(!1),[o,u]=i.useState("");async function c(){a(h=>({...h,loading:!0,error:""}));try{const h=await U("/api/storage/org/users");a({loading:!1,error:"",items:h.items||[]})}catch(h){a({loading:!1,error:(h==null?void 0:h.message)||"Unable to load users.",items:[]})}}i.useEffect(()=>{c()},[]);async function d(h){h.preventDefault(),u(""),r(!0);try{const p={name:s.name.trim(),email:s.email.trim(),password:s.invite?"":s.password,invite:s.invite};await U("/api/storage/org/users/create",{method:"POST",body:JSON.stringify(p)}),n({name:"",email:"",password:"",invite:!1}),await c(),u("User created.")}catch(p){u((p==null?void 0:p.message)||"Unable to create user.")}finally{r(!1)}}return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between mb-3",children:e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:"Organization Users"}),e.jsx("div",{className:"text-secondary",children:"Create and manage storage users under your organization."})]})}),o?e.jsx("div",{className:"alert alert-info",children:o}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsx("h5",{className:"mb-2",children:"Create User"}),e.jsxs("form",{className:"row g-3",onSubmit:d,children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:s.name,onChange:h=>n(p=>({...p,name:h.target.value})),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:s.email,onChange:h=>n(p=>({...p,email:h.target.value})),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Password"}),e.jsx("input",{type:"password",className:"form-control",value:s.password,onChange:h=>n(p=>({...p,password:h.target.value})),disabled:s.invite,required:!s.invite}),e.jsx("div",{className:"form-text text-secondary",children:"Leave empty if using invite."})]}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"storage-user-invite",checked:s.invite,onChange:h=>n(p=>({...p,invite:h.target.checked}))}),e.jsx("label",{className:"form-check-label",htmlFor:"storage-user-invite",children:"Send invite (auto-generate password)"})]})}),e.jsx("div",{className:"col-12",children:e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",disabled:l,children:l?"Creating...":"Create User"})})]})]}),e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h5",{className:"mb-0",children:"Users"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:c,children:"Refresh"})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Devices"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"Loading..."})}):t.items.length?t.items.map(h=>e.jsxs("tr",{children:[e.jsx("td",{children:h.name||"-"}),e.jsx("td",{children:h.email||"-"}),e.jsx("td",{children:h.role||"org_user"}),e.jsx("td",{children:h.device_count??0}),e.jsx("td",{children:h.is_active===!1?"Inactive":"Active"})]},h.user_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No users found."})})})]})})]})]})}const ak={loading:!0,error:"",data:null};function Ss(t){const a=Number(t||0);return a?a>=1024?`${(a/1024).toFixed(1)} TB`:`${a.toFixed(0)} GB`:"0 GB"}function pc(t){const a=Number(t||0);return Number.isNaN(a)?0:Math.min(100,Math.max(0,a))}function sk({subscriptions:t=[]}){const[a,s]=i.useState(ak),[n,l]=i.useState([]);i.useEffect(()=>{let f=!0;async function b(){try{const k=await U("/api/storage/explorer/status");if(!f)return;s({loading:!1,error:"",data:k})}catch(k){if(!f)return;s({loading:!1,error:(k==null?void 0:k.message)||"Unable to load storage usage.",data:null})}}return b(),()=>{f=!1}},[]),i.useEffect(()=>{let f=!0;async function b(){try{const k=await U("/api/dashboard/summary");if(!f)return;l(k.products||[])}catch{f&&l([])}}return b(),()=>{f=!1}},[]);const r=a.data||{},o=Number(r.total_allowed_storage_gb||0),u=Number(r.used_storage_gb||0),c=Math.max(0,o-u),d=o?pc(u/o*100):0,h=Number(r.total_allowed_bandwidth_gb||0),p=Number(r.used_bandwidth_gb||0),g=Math.max(0,h-p),N=!!r.is_bandwidth_limited,v=h?pc(p/h*100):0,w=Number(r.max_users||0),A=Number(r.user_count||0),y=w?pc(A/w*100):0,x=i.useMemo(()=>[{key:"storage",title:"Storage Usage",meta:`${Ss(u)} used  ${Ss(c)} remaining`,percent:d,minLabel:"0 GB",maxLabel:Ss(o||0),highlight:Ss(u)},{key:"bandwidth",title:"Bandwidth Usage",meta:N?`${Ss(p)} used  ${Ss(g)} remaining`:"Unlimited monthly bandwidth",percent:N?v:0,minLabel:N?"0 GB":"Unlimited",maxLabel:N?Ss(h||0):"Unlimited",highlight:N?Ss(p):"Unlimited"},{key:"users",title:"User Usage",meta:w?`${A} of ${w} users`:`${A} users active`,percent:w?y:0,minLabel:"0",maxLabel:w?String(w):"Unlimited",highlight:String(A)}],[u,c,o,d,p,g,h,v,N,w,A,y]);return e.jsxs("div",{className:"container-fluid storage-dashboard",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2 mb-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"Storage Overview"}),e.jsx("p",{className:"text-secondary mb-0",children:"Track storage, bandwidth, and user usage for your org."})]})}),a.loading?e.jsx("div",{className:"text-secondary",children:"Loading dashboard..."}):a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):e.jsx("div",{className:"row g-3",children:x.map(f=>e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 storage-meter-card h-100",children:[e.jsxs("div",{className:"storage-meter-card__header",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:f.title}),e.jsx("div",{className:"text-secondary small",children:f.meta})]}),e.jsx("div",{className:"storage-meter-card__badge",children:f.highlight})]}),e.jsxs("div",{className:"storage-meter",children:[e.jsxs("div",{className:"storage-meter__track",children:[e.jsx("div",{className:"storage-meter__fill",style:{width:`${f.percent}%`}}),e.jsx("div",{className:"storage-meter__pointer",style:{left:`${f.percent}%`},children:e.jsx("span",{className:"storage-meter__pointer-arrow"})})]}),e.jsxs("div",{className:"storage-meter__labels",children:[e.jsx("span",{children:f.minLabel}),e.jsx("span",{children:f.maxLabel})]})]})]})},f.key))}),e.jsx(Ki,{products:n,subscriptions:t,isReadOnly:!1,currentProductKey:"storage"})]})}const nk={loading:!0,error:"",plan:null,license:null,devices:[],users:[],activity:[]};function ws(t){return t||"-"}function lk({isAdmin:t=!1}){const[a,s]=i.useState(nk),[n,l]=i.useState("");async function r(){s(d=>({...d,loading:!0,error:""}));try{const[d,h,p,g,N]=await Promise.all([U("/api/product/plan"),U("/api/product/license"),U("/api/product/devices"),t?U("/api/product/users"):Promise.resolve({items:[]}),U("/api/product/activity?limit=20")]);s({loading:!1,error:"",plan:d,license:h,devices:p.items||[],users:g.items||[],activity:N.items||[]})}catch(d){s(h=>({...h,loading:!1,error:(d==null?void 0:d.message)||"Unable to load product dashboard."}))}}i.useEffect(()=>{r()},[]);async function o(d){const h=window.prompt("Enter new device name",d.device_name||"");if(!(!h||!h.trim())){l("");try{await U("/api/product/devices",{method:"POST",body:JSON.stringify({action:"rename",device_id:d.device_id,device_name:h.trim()})}),await r(),l("Device renamed.")}catch(p){l((p==null?void 0:p.message)||"Unable to rename device.")}}}async function u(d){if(window.confirm(`Deactivate ${d.device_name||d.device_id}?`)){l("");try{await U("/api/product/devices",{method:"POST",body:JSON.stringify({action:"deactivate",device_id:d.device_id})}),await r(),l("Device deactivated.")}catch(h){l((h==null?void 0:h.message)||"Unable to deactivate device.")}}}const c=i.useMemo(()=>{const d=a.plan||{},h=a.license||{},p=a.devices.filter(N=>N.status==="active").length,g=a.users.filter(N=>N.status==="active").length;return[{label:"Active Plan",value:ws(d.plan_name)},{label:"License Code",value:ws(h.license_code)},{label:"Registered Devices",value:String(p)},{label:"Device Limit",value:String(d.device_limit??0)},{label:"Active Users",value:t?String(g):"-"},{label:"Trial Days Remaining",value:String(d.trial_days_remaining??0)}]},[a.devices,a.license,a.plan,a.users,t]);return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title mb-1",children:"Imposition Dashboard"}),e.jsx("div",{className:"text-secondary",children:"Product overview, device status, and recent activity."})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:r,children:"Refresh"})]}),n?e.jsx("div",{className:"alert alert-info",children:n}):null,a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):null,e.jsx("div",{className:"row g-3 mb-3",children:c.map(d=>e.jsx("div",{className:"col-12 col-md-6 col-xl-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("div",{className:"text-secondary small",children:d.label}),e.jsx("div",{className:"fs-5 fw-semibold",children:d.value})]})},d.label))}),e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between mb-2",children:e.jsx("h5",{className:"mb-0",children:"Registered Devices"})}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Device Name"}),e.jsx("th",{children:"Device ID"}),e.jsx("th",{children:"OS"}),e.jsx("th",{children:"Last Active"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:a.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"Loading..."})}):a.devices.length?a.devices.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:ws(d.device_name)}),e.jsx("td",{children:d.device_id}),e.jsx("td",{children:ws(d.os)}),e.jsx("td",{children:ws(d.last_active)}),e.jsx("td",{children:d.status==="active"?"Active":"Inactive"}),e.jsxs("td",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",disabled:!t,onClick:()=>o(d),children:"Rename"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",disabled:!t||d.status!=="active",onClick:()=>u(d),children:"Deactivate"})]})]},d.device_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No devices registered."})})})]})})]}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{className:"mb-2",children:"Recent Activity"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Event"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Device"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:a.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"Loading..."})}):a.activity.length?a.activity.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.event_type}),e.jsx("td",{children:ws(d.user_name)}),e.jsx("td",{children:ws(d.device_name)}),e.jsx("td",{children:ws(d.created_at)})]},d.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No activity yet."})})})]})})]})]})}const zf={user_name:"",email:"",password:"",role:"org_user"};function rk(){const[t,a]=i.useState(!0),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState({items:[],user_limit:0,active_users:0,can_add_user:!1,limit_message:"Upgrade plan or purchase additional user."}),[c,d]=i.useState(zf),[h,p]=i.useState(!1);async function g(){a(!0),n("");try{const y=await U("/api/product/users");u({items:y.items||[],user_limit:y.user_limit??0,active_users:y.active_users??0,can_add_user:!!y.can_add_user,limit_message:y.limit_message||"Upgrade plan or purchase additional user."})}catch(y){n((y==null?void 0:y.message)||"Unable to load users.")}finally{a(!1)}}i.useEffect(()=>{g()},[]);const N=i.useMemo(()=>`${o.active_users}/${o.user_limit||0}`,[o.active_users,o.user_limit]);async function v(y){var x;y.preventDefault(),p(!0),r("");try{await U("/api/product/users",{method:"POST",body:JSON.stringify({action:"add",...c})}),d(zf),r("User added."),await g()}catch(f){r(((x=f==null?void 0:f.data)==null?void 0:x.message)||(f==null?void 0:f.message)||"Unable to add user.")}finally{p(!1)}}async function w(y,x){var f;if(x!=null&&x.user_id){r("");try{await U("/api/product/users",{method:"POST",body:JSON.stringify({action:y,user_id:x.user_id})}),await g(),r(`User ${y} completed.`)}catch(b){r(((f=b==null?void 0:b.data)==null?void 0:f.message)||(b==null?void 0:b.message)||`Unable to ${y} user.`)}}}async function A(y){const x=window.prompt("User Name",y.user_name||"");if(!x)return;const f=window.prompt("Email",y.email||"");if(f){r("");try{await U("/api/product/users",{method:"POST",body:JSON.stringify({action:"edit",user_id:y.user_id,user_name:x.trim(),email:f.trim(),role:y.role||"org_user"})}),await g(),r("User updated.")}catch(b){r((b==null?void 0:b.message)||"Unable to update user.")}}}return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title mb-1",children:"Imposition Users"}),e.jsx("div",{className:"text-secondary",children:"Manage users for Imposition Software under this organization."})]}),e.jsxs("div",{className:"text-secondary small",children:["Active Users: ",N]})]}),l?e.jsx("div",{className:"alert alert-info",children:l}):null,s?e.jsx("div",{className:"alert alert-danger",children:s}):null,o.can_add_user?null:e.jsx("div",{className:"alert alert-warning",children:o.limit_message}),e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsx("h5",{className:"mb-2",children:"Add User"}),e.jsxs("form",{className:"row g-3",onSubmit:v,children:[e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"User Name"}),e.jsx("input",{type:"text",className:"form-control",value:c.user_name,onChange:y=>d(x=>({...x,user_name:y.target.value})),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:c.email,onChange:y=>d(x=>({...x,email:y.target.value})),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Password"}),e.jsx("input",{type:"password",className:"form-control",value:c.password,onChange:y=>d(x=>({...x,password:y.target.value})),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("label",{className:"form-label",children:"Role"}),e.jsxs("select",{className:"form-select",value:c.role,onChange:y=>d(x=>({...x,role:y.target.value})),children:[e.jsx("option",{value:"org_user",children:"Org User"}),e.jsx("option",{value:"company_admin",children:"Company Admin"})]})]}),e.jsx("div",{className:"col-12 col-md-1 d-flex align-items-end",children:e.jsx("button",{type:"submit",className:"btn btn-primary w-100",disabled:h||!o.can_add_user,children:h?"...":"Add"})})]})]}),e.jsx("div",{className:"card p-3",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"License Code"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Last Login"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:t?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"Loading..."})}):o.items.length?o.items.map(y=>e.jsxs("tr",{children:[e.jsx("td",{children:y.user_name||"-"}),e.jsx("td",{children:y.email||"-"}),e.jsx("td",{children:y.role||"org_user"}),e.jsx("td",{children:y.license_code||"-"}),e.jsx("td",{children:y.status||"-"}),e.jsx("td",{children:y.last_login||"-"}),e.jsxs("td",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>A(y),children:"Edit"}),y.status==="active"?e.jsx("button",{type:"button",className:"btn btn-outline-warning btn-sm",onClick:()=>w("disable",y),children:"Disable"}):e.jsx("button",{type:"button",className:"btn btn-outline-success btn-sm",onClick:()=>w("enable",y),children:"Enable"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>w("delete",y),children:"Delete"})]})]},y.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No users found."})})})]})})})]})}function ik(){const[t,a]=i.useState(!0),[s,n]=i.useState(""),[l,r]=i.useState([]);async function o(){a(!0),n("");try{const u=await U("/api/product/billing");r(u.items||[])}catch(u){n((u==null?void 0:u.message)||"Unable to load billing history.")}finally{a(!1)}}return i.useEffect(()=>{o()},[]),e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title mb-1",children:"Billing History"}),e.jsx("div",{className:"text-secondary",children:"Invoices and payment history for Imposition Software."})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:o,children:"Refresh"})]}),s?e.jsx("div",{className:"alert alert-danger",children:s}):null,e.jsx("div",{className:"card p-3",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Invoice Number"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Currency"}),e.jsx("th",{children:"Payment Method"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:t?e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"Loading..."})}):l.length?l.map(u=>e.jsxs("tr",{children:[e.jsx("td",{children:u.invoice_number}),e.jsx("td",{children:u.plan||"-"}),e.jsx("td",{children:u.amount??"-"}),e.jsx("td",{children:u.currency||"-"}),e.jsx("td",{children:u.payment_method||"-"}),e.jsx("td",{children:u.status||"-"}),e.jsx("td",{children:u.date||"-"}),e.jsxs("td",{className:"d-flex gap-2",children:[u.invoice_url?e.jsx("a",{href:u.invoice_url,className:"btn btn-outline-light btn-sm",target:"_blank",rel:"noreferrer",children:"Download Invoice"}):e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",disabled:!0,children:"Download Invoice"}),e.jsx("a",{href:"/pricing/?product=imposition-software",className:"btn btn-primary btn-sm",children:"Renew Plan"})]})]},u.invoice_number)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No billing records found."})})})]})})})]})}function ok(t){return t.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}function ck(){var k,_,P,S,F,L,Q,E,C,z;const[t,a]=i.useState(!0),[s,n]=i.useState(""),[l,r]=i.useState(""),[o,u]=i.useState(null),[c,d]=i.useState({open:!1,addon:null,quantity:1,cycle:"monthly",saving:!1});async function h(){a(!0),n("");try{const M=await U("/api/product/plan");u(M)}catch(M){n((M==null?void 0:M.message)||"Unable to load plan.")}finally{a(!1)}}i.useEffect(()=>{h()},[]);function p(M){d({open:!0,addon:M,quantity:Math.max(1,Number((M==null?void 0:M.current_quantity)||1)),cycle:(M==null?void 0:M.current_billing_cycle)||"monthly",saving:!1})}function g(){d(M=>({...M,open:!1}))}async function N(){if(c.addon){d(M=>({...M,saving:!0})),r("");try{const M={addon_code:c.addon.addon_code,quantity:Math.max(0,Number(c.quantity||0)),billing_cycle:c.cycle||"monthly"};await U("/api/product/addons/purchase",{method:"POST",body:JSON.stringify(M)}),r("Add-on updated successfully."),g(),await h()}catch(M){r((M==null?void 0:M.message)||"Unable to purchase add-on."),d(R=>({...R,saving:!1}))}}}const v=i.useMemo(()=>{const M=(o==null?void 0:o.features)||{};return Object.keys(M).filter(R=>!!M[R])},[o]),w=((o==null?void 0:o.addons)||[])[0]||null,A=Math.max(0,Number(c.quantity||0)),y=c.cycle==="yearly"?"yearly":"monthly",f=Number(((_=(k=w==null?void 0:w.pricing)==null?void 0:k[y])==null?void 0:_.inr)||0)*A,b=y==="yearly"?"/ year":"/ month";return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title mb-1",children:"Plan"}),e.jsx("div",{className:"text-secondary",children:"Current subscription and feature access."})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:h,children:"Refresh"})]}),s?e.jsx("div",{className:"alert alert-danger",children:s}):null,l?e.jsx("div",{className:"alert alert-info",children:l}):null,t?e.jsx("div",{className:"text-secondary",children:"Loading plan..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("div",{className:"text-secondary small",children:"Plan Name"}),e.jsx("div",{className:"fw-semibold",children:(o==null?void 0:o.plan_name)||"-"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("div",{className:"text-secondary small",children:"Billing Cycle"}),e.jsx("div",{className:"fw-semibold",children:(o==null?void 0:o.billing_cycle)||"-"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("div",{className:"text-secondary small",children:"Device Limit"}),e.jsx("div",{className:"fw-semibold",children:(o==null?void 0:o.device_limit)??0})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("div",{className:"text-secondary small",children:"User Limit"}),e.jsx("div",{className:"fw-semibold",children:(o==null?void 0:o.user_limit)??0})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("div",{className:"text-secondary small mb-1",children:"Features"}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:v.length?v.map(M=>e.jsx("span",{className:"badge text-bg-success",children:ok(M)},M)):e.jsx("span",{className:"text-secondary",children:"No features configured."})})]})]}),e.jsxs("div",{className:"d-flex gap-2 mt-3",children:[e.jsx("a",{href:"/pricing/?product=imposition-software",className:"btn btn-primary btn-sm",children:"Upgrade Plan"}),e.jsx("a",{href:"/pricing/?product=imposition-software",className:"btn btn-outline-light btn-sm",children:"Change Billing Cycle"})]})]}),w?e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{className:"mb-2",children:"ADD-ONS"}),e.jsxs("div",{className:"border rounded p-3",children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between flex-wrap gap-2 mb-2",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1",children:w.addon_name}),e.jsx("div",{className:"text-secondary small",children:w.description})]}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>p(w),children:"Buy Add-on"})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"INR"}),e.jsx("th",{children:"USD"})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{children:"Monthly"}),e.jsx("td",{children:`${((S=(P=w.pricing)==null?void 0:P.monthly)==null?void 0:S.inr)||0} / user`}),e.jsx("td",{children:`$${((L=(F=w.pricing)==null?void 0:F.monthly)==null?void 0:L.usd)||0} / user`})]}),e.jsxs("tr",{children:[e.jsx("td",{children:"Yearly"}),e.jsx("td",{children:`${((E=(Q=w.pricing)==null?void 0:Q.yearly)==null?void 0:E.inr)||0} / user`}),e.jsx("td",{children:`$${((z=(C=w.pricing)==null?void 0:C.yearly)==null?void 0:z.usd)||0} / user`})]})]})]})}),e.jsxs("div",{className:"text-secondary small mt-2",children:["Current Add-on Users: ",w.current_quantity||0," | Total Allowed Users: ",w.total_allowed_users||(o==null?void 0:o.user_limit)||0]})]})]}):null]}),c.open&&c.addon?e.jsx("div",{className:"modal-overlay",onClick:g,children:e.jsxs("div",{className:"modal-panel",onClick:M=>M.stopPropagation(),children:[e.jsx("h5",{className:"mb-2",children:"Buy Add-on"}),e.jsx("div",{className:"text-secondary small mb-3",children:c.addon.addon_name}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Quantity"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:c.quantity,onChange:M=>d(R=>({...R,quantity:Math.max(0,Number(M.target.value||0))}))})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Billing Cycle"}),e.jsxs("select",{className:"form-select",value:c.cycle,onChange:M=>d(R=>({...R,cycle:M.target.value})),children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{className:"alert alert-secondary",children:[e.jsx("div",{children:"Pricing Calculation"}),e.jsx("div",{children:`${A} Users ${y==="yearly"?"Yearly":"Monthly"}`}),e.jsx("div",{className:"fw-semibold",children:`${f} ${b}`})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary btn-sm",onClick:g,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",disabled:c.saving,onClick:N,children:c.saving?"Processing...":"Confirm Purchase"})]})]})}):null]})}function ks(t){return t||"-"}function dk(){var p,g,N;const[t,a]=i.useState(!0),[s,n]=i.useState(""),[l,r]=i.useState(null),[o,u]=i.useState(null);async function c(){a(!0),n("");try{const[v,w]=await Promise.all([U("/api/auth/me"),U("/api/product/license")]);r(v),u(w)}catch(v){n((v==null?void 0:v.message)||"Unable to load profile.")}finally{a(!1)}}i.useEffect(()=>{c()},[]);const d=((p=l==null?void 0:l.profile)==null?void 0:p.organization)||{},h=(l==null?void 0:l.user)||{};return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title mb-1",children:"Profile"}),e.jsx("div",{className:"text-secondary",children:"Organization profile and license details."})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:c,children:"Refresh"})]}),s?e.jsx("div",{className:"alert alert-danger",children:s}):null,t?e.jsx("div",{className:"text-secondary",children:"Loading profile..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsx("h5",{className:"mb-3",children:"Organization Product Profile"}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("div",{className:"text-secondary small",children:"Company Name"}),e.jsx("div",{children:ks(d.name)})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("div",{className:"text-secondary small",children:"Contact Email"}),e.jsx("div",{children:ks(h.email)})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("div",{className:"text-secondary small",children:"Phone"}),e.jsx("div",{children:ks((g=l==null?void 0:l.profile)==null?void 0:g.phone_number)})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("div",{className:"text-secondary small",children:"Country"}),e.jsx("div",{children:ks((N=l==null?void 0:l.profile)==null?void 0:N.country)})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("div",{className:"text-secondary small",children:"Timezone"}),e.jsx("div",{children:ks(l==null?void 0:l.org_timezone)})]})]})]}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{className:"mb-3",children:"License Info"}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("div",{className:"text-secondary small",children:"License Code"}),e.jsx("div",{children:ks(o==null?void 0:o.license_code)})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("div",{className:"text-secondary small",children:"Activation Date"}),e.jsx("div",{children:ks(o==null?void 0:o.activation_date)})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("div",{className:"text-secondary small",children:"Plan Expiry Date"}),e.jsx("div",{children:ks(o==null?void 0:o.plan_expiry_date)})]})]})]})]})]})}const Bf={name:"",email:"",password:"",role:"org_user",department_id:"",employee_role_id:""},Wf={membership_id:"",name:"",role:"org_user",department_id:"",employee_role_id:"",is_active:!0},Vf="wz_business_autopilot_role_access",fc=[{key:"system:company_admin",label:"Company Admin"},{key:"system:org_user",label:"Org User"},{key:"system:hr_view",label:"HR View"}],si=[{key:"dashboard",label:"Dashboard"},{key:"inbox",label:"Inbox"},{key:"crm",label:"CRM"},{key:"hr",label:"HR"},{key:"projects",label:"Projects"},{key:"accounts",label:"Accounts / ERP"},{key:"ticketing",label:"Ticketing"},{key:"stocks",label:"Stocks"},{key:"users",label:"Users"},{key:"billing",label:"Billing"},{key:"plans",label:"Plans"},{key:"profile",label:"Profile"}],uk=["No Access","View","Create/Edit","Full Access"];function Gf(){return{sections:si.reduce((t,a)=>(t[a.key]="No Access",t),{}),can_export:!1,can_delete:!1,attendance_self_service:!1,remarks:""}}function mk(){const[t,a]=i.useState("users"),[s,n]=i.useState(""),[l,r]=i.useState(1),[o,u]=i.useState(!0),[c,d]=i.useState(!1),[h,p]=i.useState(!1),[g,N]=i.useState([]),[v,w]=i.useState([]),[A,y]=i.useState([]),[x,f]=i.useState(""),[b,k]=i.useState(""),[_,P]=i.useState(!1),[S,F]=i.useState(!1),[L,Q]=i.useState(""),[E,C]=i.useState(""),[z,M]=i.useState(1),[R,W]=i.useState(1),[D,te]=i.useState(""),[H,O]=i.useState(""),[V,re]=i.useState(""),[Y,ce]=i.useState(""),[ie,ee]=i.useState(""),[T,Z]=i.useState(""),[se,be]=i.useState(""),[ne,ae]=i.useState(""),[X,ke]=i.useState(Bf),[Ne,Ye]=i.useState(Wf),[Ke,mt]=i.useState(!1),[Ie,Xe]=i.useState(""),[nt,Ae]=i.useState(""),[ue,je]=i.useState({}),[Ce,Le]=i.useState(fc[0].key),Fe=5;async function ye(){u(!0),Ae("");try{const q=await U("/api/business-autopilot/users");N(q.users||[]),w(q.employee_roles||[]),y(q.departments||[]),p(!!q.can_manage_users)}catch(q){Ae((q==null?void 0:q.message)||"Unable to load users."),N([]),w([]),y([]),p(!1)}finally{u(!1)}}function Ze(q){const pe=v.find(vt=>vt.name===(q.employee_role||"")),Re=A.find(vt=>vt.name===(q.department||""));Ye({membership_id:q.membership_id,name:q.name||"",role:q.role||"org_user",department_id:Re?String(Re.id):"",employee_role_id:pe?String(pe.id):"",is_active:!!q.is_active}),Ae("")}function pt(){Ye(Wf)}async function ht(q){if(q.preventDefault(),!(!Ne.membership_id||Ke)){mt(!0),Ae("");try{const pe=await U(`/api/business-autopilot/users/${Ne.membership_id}`,{method:"PUT",body:JSON.stringify({name:Ne.name,role:Ne.role,department_id:Ne.department_id||null,employee_role_id:Ne.employee_role_id||null,is_active:!!Ne.is_active})});N(pe.users||[]),w(pe.employee_roles||[]),y(pe.departments||[]),Ae("User updated successfully."),pt()}catch(pe){Ae((pe==null?void 0:pe.message)||"Unable to update user.")}finally{mt(!1)}}}async function Ge(q){if(!(!q||Ie)){Xe(String(q)),Ae("");try{const pe=await U(`/api/business-autopilot/users/${q}`,{method:"DELETE"});N(pe.users||[]),w(pe.employee_roles||[]),y(pe.departments||[]),String(Ne.membership_id)===String(q)&&pt(),Ae("User deleted successfully.")}catch(pe){Ae((pe==null?void 0:pe.message)||"Unable to delete user.")}finally{Xe("")}}}i.useEffect(()=>{ye()},[]),i.useEffect(()=>{try{const q=window.localStorage.getItem(Vf);if(!q)return;const pe=JSON.parse(q);pe&&typeof pe=="object"&&!Array.isArray(pe)&&je(pe)}catch{}},[]),i.useEffect(()=>{window.localStorage.setItem(Vf,JSON.stringify(ue))},[ue]),i.useEffect(()=>{r(1)},[s,g.length]),i.useEffect(()=>{M(1)},[L,v.length]),i.useEffect(()=>{W(1)},[E,A.length]);async function gt(q){if(q.preventDefault(),!(!h||c)){d(!0),Ae("");try{const pe=await U("/api/business-autopilot/users",{method:"POST",body:JSON.stringify(X)});N(pe.users||[]),w(pe.employee_roles||[]),y(pe.departments||[]),ke(Bf),Ae("User created successfully.")}catch(pe){Ae((pe==null?void 0:pe.message)||"Unable to create user.")}finally{d(!1)}}}async function ft(q){if(q.preventDefault(),!h||_)return;const pe=x.trim();if(pe){P(!0),Ae("");try{const Re=await U("/api/business-autopilot/employee-roles",{method:"POST",body:JSON.stringify({name:pe})});w(Re.employee_roles||[]),Re.departments&&y(Re.departments),f(""),Ae("Employee role created.")}catch(Re){Ae((Re==null?void 0:Re.message)||"Unable to create employee role.")}finally{P(!1)}}}async function G(q){if(q.preventDefault(),!h||S)return;const pe=b.trim();if(pe){F(!0),Ae("");try{const Re=await U("/api/business-autopilot/departments",{method:"POST",body:JSON.stringify({name:pe})});y(Re.departments||[]),k(""),Ae("Department created.")}catch(Re){Ae((Re==null?void 0:Re.message)||"Unable to create department.")}finally{F(!1)}}}function Se(q){te(String(q.id)),O(String(q.name||"")),Ae("")}function ve(){te(""),O("")}async function le(q){const pe=H.trim();if(!(!q||!pe||ie)){ee(String(q)),Ae("");try{const Re=await U(`/api/business-autopilot/employee-roles/${q}`,{method:"PUT",body:JSON.stringify({name:pe})});w(Re.employee_roles||[]),Re.departments&&y(Re.departments||[]),ve(),Ae("Employee role updated.")}catch(Re){Ae((Re==null?void 0:Re.message)||"Unable to update employee role.")}finally{ee("")}}}async function xe(q){if(!(!q||se)){be(String(q)),Ae("");try{const pe=await U(`/api/business-autopilot/employee-roles/${q}`,{method:"DELETE"});w(pe.employee_roles||[]),pe.departments&&y(pe.departments||[]),String(D)===String(q)&&ve(),Ae("Employee role deleted.")}catch(pe){Ae((pe==null?void 0:pe.message)||"Unable to delete employee role.")}finally{be("")}}}function ge(q){re(String(q.id)),ce(String(q.name||"")),Ae("")}function B(){re(""),ce("")}async function he(q){const pe=Y.trim();if(!(!q||!pe||T)){Z(String(q)),Ae("");try{const Re=await U(`/api/business-autopilot/departments/${q}`,{method:"PUT",body:JSON.stringify({name:pe})});y(Re.departments||[]),Re.employee_roles&&w(Re.employee_roles||[]),B(),Ae("Department updated.")}catch(Re){Ae((Re==null?void 0:Re.message)||"Unable to update department.")}finally{Z("")}}}async function we(q){if(!(!q||ne)){ae(String(q)),Ae("");try{const pe=await U(`/api/business-autopilot/departments/${q}`,{method:"DELETE"});y(pe.departments||[]),pe.employee_roles&&w(pe.employee_roles||[]),String(V)===String(q)&&B(),Ae("Department deleted.")}catch(pe){Ae((pe==null?void 0:pe.message)||"Unable to delete department.")}finally{ae("")}}}const I=i.useMemo(()=>{const q=s.trim().toLowerCase();return q?g.filter(pe=>[pe.name,pe.email,pe.department,pe.role,pe.employee_role,pe.is_active?"active":"inactive"].filter(Boolean).join(" ").toLowerCase().includes(q)):g},[g,s]),me=i.useMemo(()=>{const q=L.trim().toLowerCase();return q?v.filter(pe=>String(pe.name||"").toLowerCase().includes(q)):v},[v,L]),Me=i.useMemo(()=>{const q=E.trim().toLowerCase();return q?A.filter(pe=>String(pe.name||"").toLowerCase().includes(q)):A},[A,E]),De=Math.max(1,Math.ceil(I.length/Fe)),et=Math.min(l,De),Qe=I.slice((et-1)*Fe,et*Fe),bt=I.length?(et-1)*Fe+1:0,ot=Math.min(et*Fe,I.length),Xt=Math.max(1,Math.ceil(me.length/Fe)),Wt=Math.min(z,Xt),Vt=me.slice((Wt-1)*Fe,Wt*Fe),kt=me.length?(Wt-1)*Fe+1:0,J=Math.min(Wt*Fe,me.length),_e=Math.max(1,Math.ceil(Me.length/Fe)),K=Math.min(R,_e),We=Me.slice((K-1)*Fe,K*Fe),Be=Me.length?(K-1)*Fe+1:0,ct=Math.min(K*Fe,Me.length),lt=i.useMemo(()=>{const q=v.map(Re=>({key:`employee_role:${String(Re.name||"").trim()}`,label:`Employee Role: ${Re.name}`})).filter(Re=>Re.key!=="employee_role:"),pe=new Map;return[...fc,...q].forEach(Re=>{pe.has(Re.key)||pe.set(Re.key,Re)}),Array.from(pe.values())},[v]);i.useEffect(()=>{var q;lt.some(pe=>pe.key===Ce)||Le(((q=lt[0])==null?void 0:q.key)||fc[0].key)},[lt,Ce]);const St=ue[Ce]||Gf();function $t(q){h&&(je(pe=>{const Re=pe[Ce]||Gf(),vt=typeof q=="function"?q(Re):Re;return{...pe,[Ce]:vt}}),Ae("Role access settings saved locally."))}return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"ERP Users"}),e.jsx("p",{className:"text-secondary mb-0",children:"Create and manage users for Business Autopilot ERP."}),e.jsxs("div",{className:"d-flex flex-wrap gap-2 mt-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${t==="users"?"btn-success":"btn-outline-light"}`,onClick:()=>a("users"),children:"Users"}),e.jsx("button",{type:"button",className:`btn btn-sm ${t==="role-access"?"btn-success":"btn-outline-light"}`,onClick:()=>a("role-access"),children:"Role Based Access"})]})]}),nt?e.jsx("div",{className:"alert alert-info py-2 mb-0",children:nt}):null,t==="users"?e.jsxs(e.Fragment,{children:[h?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-xl-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h6",{className:"mb-3",children:"Employee Role Master"}),e.jsxs("form",{className:"row g-2",onSubmit:ft,children:[e.jsx("div",{className:"col-12 col-md-8",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Create Employee Role (e.g. Accountant)",value:x,onChange:q=>f(q.target.value)})}),e.jsx("div",{className:"col-12 col-md-4 d-grid",children:e.jsx("button",{type:"submit",className:"btn btn-outline-success",disabled:_,children:_?"Adding...":"Add Role"})})]}),e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-end gap-2 mt-3 mb-2",children:[e.jsxs("span",{className:"badge bg-secondary",children:[me.length," items"]}),e.jsxs("div",{className:"table-search",children:[e.jsx("i",{className:"bi bi-search","aria-hidden":"true"}),e.jsx("input",{type:"search",className:"form-control form-control-sm",placeholder:"Search roles",value:L,onChange:q=>Q(q.target.value)})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Role Name"}),e.jsx("th",{className:"text-end",children:"Action"})]})}),e.jsx("tbody",{children:Vt.length?Vt.map(q=>e.jsxs("tr",{children:[e.jsx("td",{children:D===String(q.id)?e.jsx("input",{type:"text",className:"form-control form-control-sm",value:H,onChange:pe=>O(pe.target.value)}):q.name}),e.jsx("td",{className:"text-end",children:e.jsx("div",{className:"d-inline-flex gap-2",children:D===String(q.id)?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-success",disabled:ie===String(q.id),onClick:()=>le(q.id),children:ie===String(q.id)?"Saving...":"Save"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:ve,children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>Se(q),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",disabled:se===String(q.id),onClick:()=>xe(q.id),children:se===String(q.id)?"Deleting...":"Delete"})]})})})]},`employee-role-${q.id}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:"No employee roles found."})})})]})}),e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mt-2",children:[e.jsxs("div",{className:"small text-secondary",children:["Showing ",kt," to ",J," of ",me.length," entries"]}),e.jsx(st,{page:Wt,totalPages:Xt,onPageChange:M})]})]})}),e.jsx("div",{className:"col-12 col-xl-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h6",{className:"mb-3",children:"Department Master"}),e.jsxs("form",{className:"row g-2",onSubmit:G,children:[e.jsx("div",{className:"col-12 col-md-8",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Create Department (e.g. Accounts)",value:b,onChange:q=>k(q.target.value)})}),e.jsx("div",{className:"col-12 col-md-4 d-grid",children:e.jsx("button",{type:"submit",className:"btn btn-outline-success",disabled:S,children:S?"Adding...":"Add Department"})})]}),e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-end gap-2 mt-3 mb-2",children:[e.jsxs("span",{className:"badge bg-secondary",children:[Me.length," items"]}),e.jsxs("div",{className:"table-search",children:[e.jsx("i",{className:"bi bi-search","aria-hidden":"true"}),e.jsx("input",{type:"search",className:"form-control form-control-sm",placeholder:"Search departments",value:E,onChange:q=>C(q.target.value)})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Department Name"}),e.jsx("th",{className:"text-end",children:"Action"})]})}),e.jsx("tbody",{children:We.length?We.map(q=>e.jsxs("tr",{children:[e.jsx("td",{children:V===String(q.id)?e.jsx("input",{type:"text",className:"form-control form-control-sm",value:Y,onChange:pe=>ce(pe.target.value)}):q.name}),e.jsx("td",{className:"text-end",children:e.jsx("div",{className:"d-inline-flex gap-2",children:V===String(q.id)?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-success",disabled:T===String(q.id),onClick:()=>he(q.id),children:T===String(q.id)?"Saving...":"Save"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:B,children:"Cancel"})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>ge(q),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",disabled:ne===String(q.id),onClick:()=>we(q.id),children:ne===String(q.id)?"Deleting...":"Delete"})]})})})]},`department-${q.id}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:"No departments found."})})})]})}),e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mt-2",children:[e.jsxs("div",{className:"small text-secondary",children:["Showing ",Be," to ",ct," of ",Me.length," entries"]}),e.jsx(st,{page:K,totalPages:_e,onPageChange:W})]})]})})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"mb-3",children:"Create User"}),e.jsxs("form",{className:"row g-2",onSubmit:gt,children:[e.jsx("div",{className:"col-12 col-md-2",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Full Name",value:X.name,onChange:q=>ke(pe=>({...pe,name:q.target.value})),required:!0})}),e.jsx("div",{className:"col-12 col-md-2",children:e.jsx("input",{type:"email",className:"form-control",placeholder:"Email",value:X.email,onChange:q=>ke(pe=>({...pe,email:q.target.value})),required:!0})}),e.jsx("div",{className:"col-12 col-md-2",children:e.jsx("input",{type:"password",className:"form-control",placeholder:"Password",value:X.password,onChange:q=>ke(pe=>({...pe,password:q.target.value})),minLength:6,required:!0})}),e.jsx("div",{className:"col-12 col-md-2",children:e.jsxs("select",{className:"form-select",value:X.department_id,onChange:q=>ke(pe=>({...pe,department_id:q.target.value})),children:[e.jsx("option",{value:"",children:"Department"}),A.map(q=>e.jsx("option",{value:q.id,children:q.name},q.id))]})}),e.jsx("div",{className:"col-12 col-md-2",children:e.jsxs("select",{className:"form-select",value:X.employee_role_id,onChange:q=>ke(pe=>({...pe,employee_role_id:q.target.value})),children:[e.jsx("option",{value:"",children:"Employee Role"}),v.map(q=>e.jsx("option",{value:q.id,children:q.name},q.id))]})}),e.jsx("div",{className:"col-12 col-md-2 d-grid",children:e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:c,title:"Create User",children:c?"Creating...":"Create"})})]})]})]}):e.jsx("div",{className:"card p-3",children:e.jsx("div",{className:"text-secondary",children:"Only company admin can create users."})}),Ne.membership_id?e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:"Edit User"}),e.jsxs("form",{className:"row g-2",onSubmit:ht,children:[e.jsx("div",{className:"col-12 col-md-3",children:e.jsx("input",{type:"text",className:"form-control",placeholder:"Full Name",value:Ne.name,onChange:q=>Ye(pe=>({...pe,name:q.target.value})),required:!0})}),e.jsx("div",{className:"col-12 col-md-2",children:e.jsxs("select",{className:"form-select",value:Ne.role,onChange:q=>Ye(pe=>({...pe,role:q.target.value})),children:[e.jsx("option",{value:"org_user",children:"Org User"}),e.jsx("option",{value:"hr_view",children:"HR View"}),e.jsx("option",{value:"company_admin",children:"Company Admin"})]})}),e.jsx("div",{className:"col-12 col-md-2",children:e.jsxs("select",{className:"form-select",value:Ne.department_id,onChange:q=>Ye(pe=>({...pe,department_id:q.target.value})),children:[e.jsx("option",{value:"",children:"Department"}),A.map(q=>e.jsx("option",{value:q.id,children:q.name},q.id))]})}),e.jsx("div",{className:"col-12 col-md-3",children:e.jsxs("select",{className:"form-select",value:Ne.employee_role_id,onChange:q=>Ye(pe=>({...pe,employee_role_id:q.target.value})),children:[e.jsx("option",{value:"",children:"Employee Role"}),v.map(q=>e.jsx("option",{value:q.id,children:q.name},q.id))]})}),e.jsx("div",{className:"col-12 col-md-2",children:e.jsxs("select",{className:"form-select",value:Ne.is_active?"active":"inactive",onChange:q=>Ye(pe=>({...pe,is_active:q.target.value==="active"})),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]})}),e.jsxs("div",{className:"col-12 col-md-2 d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success w-100",disabled:Ke,children:Ke?"Updating...":"Update"}),e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:pt,children:"Cancel"})]})]})]}):null,e.jsxs("div",{children:[e.jsx("h6",{className:"mb-3",children:"User List"}),e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-end gap-2 mb-2",children:[e.jsxs("span",{className:"badge bg-secondary",children:[I.length," items"]}),e.jsxs("div",{className:"table-search",children:[e.jsx("i",{className:"bi bi-search","aria-hidden":"true"}),e.jsx("input",{type:"search",className:"form-control form-control-sm",placeholder:"Search users",value:s,onChange:q=>n(q.target.value)})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Employee Role"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:o?e.jsx("tr",{children:e.jsx("td",{colSpan:7,children:"Loading users..."})}):Qe.length?Qe.map(q=>e.jsxs("tr",{children:[e.jsx("td",{children:q.name||"-"}),e.jsx("td",{children:q.email||"-"}),e.jsx("td",{children:q.department||"-"}),e.jsx("td",{children:(q.role||"org_user").replace("_"," ")}),e.jsx("td",{children:q.employee_role||"-"}),e.jsx("td",{children:q.is_active?"Active":"Inactive"}),e.jsx("td",{children:e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>Ze(q),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>Ge(q.membership_id),disabled:Ie===String(q.membership_id),children:Ie===String(q.membership_id)?"Deleting...":"Delete"})]})})]},q.membership_id||q.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,children:"No users found."})})})]})}),o?null:e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mt-2",children:[e.jsxs("div",{className:"small text-secondary",children:["Showing ",bt," to ",ot," of ",I.length," entries"]}),e.jsx(st,{page:et,totalPages:De,onPageChange:r})]})]})]}):e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1",children:"Role Based Access"}),e.jsx("div",{className:"small text-secondary",children:"Configure section-level permissions for system roles and employee roles."})]}),e.jsxs("div",{style:{minWidth:280},children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Role"}),e.jsx("select",{className:"form-select form-select-sm",value:Ce,onChange:q=>Le(q.target.value),children:lt.map(q=>e.jsx("option",{value:q.key,children:q.label},q.key))})]})]}),h?null:e.jsx("div",{className:"alert alert-warning py-2",children:"Only company admin can update role based access."}),e.jsx("div",{className:"table-responsive mb-3",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Section"}),e.jsx("th",{children:"Access Level"})]})}),e.jsx("tbody",{children:si.map(q=>{var pe;return e.jsxs("tr",{children:[e.jsx("td",{children:q.label}),e.jsx("td",{children:e.jsx("select",{className:"form-select form-select-sm",value:((pe=St.sections)==null?void 0:pe[q.key])||"No Access",disabled:!h,onChange:Re=>$t(vt=>({...vt,sections:{...vt.sections||{},[q.key]:Re.target.value}})),children:uk.map(Re=>e.jsx("option",{value:Re,children:Re},`${q.key}-${Re}`))})})]},q.key)})})]})}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{id:"rbac-export",className:"form-check-input",type:"checkbox",checked:!!St.can_export,disabled:!h,onChange:q=>$t(pe=>({...pe,can_export:q.target.checked}))}),e.jsx("label",{className:"form-check-label",htmlFor:"rbac-export",children:"Allow Export"})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{id:"rbac-delete",className:"form-check-input",type:"checkbox",checked:!!St.can_delete,disabled:!h,onChange:q=>$t(pe=>({...pe,can_delete:q.target.checked}))}),e.jsx("label",{className:"form-check-label",htmlFor:"rbac-delete",children:"Allow Delete"})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"form-check form-switch",children:[e.jsx("input",{id:"rbac-self-att",className:"form-check-input",type:"checkbox",checked:!!St.attendance_self_service,disabled:!h,onChange:q=>$t(pe=>({...pe,attendance_self_service:q.target.checked}))}),e.jsx("label",{className:"form-check-label",htmlFor:"rbac-self-att",children:"Attendance Self-Service"})]})}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Remarks"}),e.jsx("textarea",{className:"form-control",rows:"2",placeholder:"Notes for this role",value:St.remarks||"",disabled:!h,onChange:q=>$t(pe=>({...pe,remarks:q.target.value}))})]})]}),e.jsx("hr",{}),e.jsxs("div",{children:[e.jsx("div",{className:"small text-secondary mb-2",children:"Enabled Access Preview"}),e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[si.filter(q=>{var pe;return(((pe=St.sections)==null?void 0:pe[q.key])||"No Access")!=="No Access"}).map(q=>{var pe;return e.jsxs("span",{className:"badge text-bg-success",children:[q.label,": ",(pe=St.sections)==null?void 0:pe[q.key]]},`rbac-preview-${q.key}`)}),si.some(q=>{var pe;return(((pe=St.sections)==null?void 0:pe[q.key])||"No Access")!=="No Access"})?null:e.jsx("span",{className:"text-secondary small",children:"No access sections configured."})]})]})]})]})}const hk={loading:!0,error:"",conversations:[],selectedId:null,messages:[],loadingMessages:!1,filterStatus:"open",replyText:"",sendingReply:!1,sendingAttachment:!1,orgTimezone:"UTC",confirmCloseOpen:!1},pk=["","","","","","","","","","","",""];function Hf(t,a){if(!t)return"";const s=new Date(t);if(Number.isNaN(s.getTime()))return"";const l=new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:a}).formatToParts(s).reduce((r,o)=>(r[o.type]=o.value,r),{});return`${l.year}-${l.month}-${l.day} ${l.hour}:${l.minute}:${l.second}`}function qf(t){if(!t)return!1;const a=new Date(t);if(Number.isNaN(a.getTime()))return!1;const s=new Date;return a.getFullYear()===s.getFullYear()&&a.getMonth()===s.getMonth()&&a.getDate()===s.getDate()}function fk(){const[t,a]=i.useState(hk),[s,n]=i.useState("all"),[l,r]=i.useState(!1),[o,u]=i.useState(!1),[c,d]=i.useState({loading:!0,premadeReplies:[],allowVisitorAttachments:!1}),[h,p]=i.useState(()=>window.localStorage.getItem("wz_ai_chatbot_admin_sound")!=="0"),g=i.useRef(null),N=i.useRef(!1),v=i.useRef(new Set),w=i.useRef(!1),A=i.useRef({conversations:null,messages:null}),y=i.useRef(null);i.useEffect(()=>{let O=!0;async function V(){try{const re=new URLSearchParams;re.set("status",t.filterStatus),s!=="all"&&re.set("category",s);const Y=await U(`/api/ai-chatbot/inbox/conversations?${re.toString()}`);if(!O)return;a(ce=>{var ie,ee;return{...ce,loading:!1,error:"",conversations:Y.conversations||[],selectedId:((ee=(ie=Y.conversations)==null?void 0:ie[0])==null?void 0:ee.id)||null}})}catch(re){O&&a(Y=>({...Y,loading:!1,error:(re==null?void 0:re.message)||"Unable to load conversations."}))}}return V(),()=>{O=!1}},[t.filterStatus,s]),i.useEffect(()=>{let O=!0;async function V(){try{const re=await U("/api/ai-chatbot/org/chat-settings");if(!O)return;d({loading:!1,premadeReplies:re.premade_replies||[],allowVisitorAttachments:!!re.allow_visitor_attachments})}catch(re){O&&(d(Y=>({...Y,loading:!1})),a(Y=>({...Y,error:(re==null?void 0:re.message)||"Unable to load chat settings."})))}}return V(),()=>{O=!1}},[]);async function x(O,{silent:V=!1,retryOnAssign:re=!0}={}){var Y;if(!O){a(ce=>({...ce,messages:[]}));return}V||a(ce=>({...ce,loadingMessages:!0}));try{const ce=await U(`/api/ai-chatbot/inbox/conversations/${O}/messages`);a(ie=>({...ie,loadingMessages:!1,messages:ce.messages||[],orgTimezone:ce.org_timezone||ie.orgTimezone||"UTC"}))}catch(ce){if((ce==null?void 0:ce.status)===409&&((Y=ce==null?void 0:ce.data)==null?void 0:Y.detail)==="conversation_unassigned"&&re){try{return await U(`/api/ai-chatbot/inbox/conversations/${O}/take`,{method:"POST"}),x(O,{silent:V,retryOnAssign:!1})}catch(ie){a(ee=>({...ee,loadingMessages:!1,error:(ie==null?void 0:ie.message)||"Unable to take conversation."}))}return}a(ie=>({...ie,loadingMessages:!1,error:(ce==null?void 0:ce.message)||"Unable to load messages."}))}}i.useEffect(()=>{x(t.selectedId)},[t.selectedId]),i.useEffect(()=>(A.current.conversations&&window.clearInterval(A.current.conversations),A.current.conversations=window.setInterval(()=>{k()},5e3),()=>{A.current.conversations&&(window.clearInterval(A.current.conversations),A.current.conversations=null)}),[t.filterStatus,s]),i.useEffect(()=>(A.current.messages&&window.clearInterval(A.current.messages),t.selectedId?(A.current.messages=window.setInterval(()=>{x(t.selectedId,{silent:!0})},4e3),()=>{A.current.messages&&(window.clearInterval(A.current.messages),A.current.messages=null)}):()=>{}),[t.selectedId]);function f(){if(!h)return;const O=window.AudioContext||window.webkitAudioContext;if(O)try{const V=new O,re=V.createGain(),Y=V.createOscillator();Y.type="sine",Y.frequency.value=880,re.gain.value=.25,Y.connect(re),re.connect(V.destination),Y.start(),re.gain.exponentialRampToValueAtTime(.001,V.currentTime+.6),Y.stop(V.currentTime+.6),window.setTimeout(()=>{const ce=V.createOscillator(),ie=V.createGain();ce.type="sine",ce.frequency.value=660,ie.gain.value=.25,ce.connect(ie),ie.connect(V.destination),ce.start(),ie.gain.exponentialRampToValueAtTime(.001,V.currentTime+1),ce.stop(V.currentTime+1)},150)}catch{}}function b(){if(!h)return;const O=window.AudioContext||window.webkitAudioContext;if(O)try{const V=new O,re=V.createGain(),Y=V.createOscillator();Y.type="triangle",Y.frequency.value=740,re.gain.value=.2,Y.connect(re),re.connect(V.destination),Y.start(),re.gain.exponentialRampToValueAtTime(.001,V.currentTime+.35),Y.stop(V.currentTime+.35)}catch{}}i.useEffect(()=>{const O=t.conversations||[];if(!O.length)return;if(!w.current){O.forEach(re=>{re!=null&&re.id&&v.current.add(re.id)}),w.current=!0;return}const V=O.filter(re=>(re==null?void 0:re.id)&&!v.current.has(re.id));V.length&&(V.forEach(re=>{re!=null&&re.id&&v.current.add(re.id)}),f())},[t.conversations]),i.useEffect(()=>{if(!t.messages.length)return;const O=t.messages[t.messages.length-1];if(!N.current){g.current=O.id,N.current=!0;return}O.id&&O.id!==g.current&&(g.current=O.id,b())},[t.messages]);async function k(){a(O=>({...O,loading:!0,error:""}));try{const O=new URLSearchParams;O.set("status",t.filterStatus),s!=="all"&&O.set("category",s);const V=await U(`/api/ai-chatbot/inbox/conversations?${O.toString()}`);a(re=>{var ie;const Y=V.conversations||[],ce=Y.some(ee=>ee.id===re.selectedId);return{...re,loading:!1,conversations:Y,selectedId:ce?re.selectedId:((ie=Y[0])==null?void 0:ie.id)||null}})}catch(O){a(V=>({...V,loading:!1,error:(O==null?void 0:O.message)||"Unable to load conversations."}))}}const _=t.conversations.find(O=>O.id===t.selectedId);function P(){p(O=>{const V=!O;return window.localStorage.setItem("wz_ai_chatbot_admin_sound",V?"1":"0"),V})}async function S(){if(!(!t.selectedId||!t.replyText.trim()||t.sendingReply)){a(O=>({...O,sendingReply:!0}));try{const V=(await U(`/api/ai-chatbot/inbox/conversations/${t.selectedId}/reply`,{method:"POST",body:JSON.stringify({text:t.replyText.trim()})})).message;a(re=>({...re,sendingReply:!1,replyText:"",messages:V?[...re.messages,V]:re.messages})),await k()}catch(O){a(V=>({...V,sendingReply:!1,error:(O==null?void 0:O.message)||"Unable to send reply."}))}}}function F(O){O.key==="Enter"&&(O.ctrlKey||O.metaKey)&&(O.preventDefault(),S())}async function L(O){var re;const V=(re=O.target.files)==null?void 0:re[0];if(!(!V||!t.selectedId)){a(Y=>({...Y,sendingAttachment:!0}));try{ns()||await fetch("/api/auth/csrf",{credentials:"include"});const Y=new FormData;Y.append("file",V);const ce=await fetch(`/api/ai-chatbot/inbox/conversations/${t.selectedId}/attachment`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":ns()},body:Y}),ie=await ce.json();if(!ce.ok)throw new Error((ie==null?void 0:ie.detail)||"Unable to upload attachment.");const ee=ie.message;a(T=>({...T,sendingAttachment:!1,messages:ee?[...T.messages,ee]:T.messages})),await k()}catch(Y){a(ce=>({...ce,sendingAttachment:!1,error:(Y==null?void 0:Y.message)||"Unable to upload attachment."}))}finally{O.target&&(O.target.value="")}}}function Q(O){a(V=>({...V,replyText:`${V.replyText}${O}`})),r(!1)}function E(){r(O=>!O)}function C(){u(O=>!O)}function z(O){O&&(a(V=>({...V,replyText:V.replyText?`${V.replyText} ${O}`:O})),u(!1))}async function M(){if(c.loading)return;const O=!c.allowVisitorAttachments;d(V=>({...V,allowVisitorAttachments:O}));try{const V=await U("/api/ai-chatbot/org/chat-settings",{method:"PATCH",body:JSON.stringify({allow_visitor_attachments:O})});d(re=>({...re,premadeReplies:V.premade_replies||re.premadeReplies,allowVisitorAttachments:!!V.allow_visitor_attachments}))}catch(V){d(re=>({...re,allowVisitorAttachments:!O})),a(re=>({...re,error:(V==null?void 0:V.message)||"Unable to update chat settings."}))}}async function R(O){if(t.selectedId){if(O==="close"){a(V=>({...V,confirmCloseOpen:!0}));return}try{await U(`/api/ai-chatbot/inbox/conversations/${t.selectedId}/${O}`,{method:"POST"}),await k()}catch(V){a(re=>({...re,error:(V==null?void 0:V.message)||"Unable to update status."}))}}}async function W(){const O=t.selectedId;if(!O){a(V=>({...V,confirmCloseOpen:!1}));return}a(V=>({...V,confirmCloseOpen:!1}));try{await U(`/api/ai-chatbot/inbox/conversations/${O}/close`,{method:"POST"}),await k()}catch(V){a(re=>({...re,error:(V==null?void 0:V.message)||"Unable to update status."}))}}const D=t.conversations.filter(O=>qf(O.last_message_at||O.created_at)),te=t.conversations.filter(O=>!qf(O.last_message_at||O.created_at));function H(O){return t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:"Loading..."})}):O.length?O.map(V=>{const re=V.source==="public_page"?"Public Page":"Widget",Y=V.source==="public_page"?"bg-info":"bg-secondary",ce=V.category?V.category.charAt(0).toUpperCase()+V.category.slice(1):"-",ie=V.category==="sales"?"bg-success":V.category==="support"?"bg-primary":"bg-secondary",ee=V.visitor_name||V.visitor_id;return e.jsxs("tr",{className:V.id===t.selectedId?"table-active":"",onClick:()=>a(T=>({...T,selectedId:V.id})),style:{cursor:"pointer"},children:[e.jsx("td",{children:e.jsx("div",{className:"ai-chatbot-visitor",children:e.jsx("div",{children:ee})})}),e.jsx("td",{children:V.widget_name}),e.jsx("td",{children:e.jsx("span",{className:`badge ${ie}`,children:ce})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${Y}`,children:re})}),e.jsx("td",{children:e.jsxs("span",{className:`ai-chatbot-presence ai-chatbot-presence--${V.visitor_status||"offline"}`,children:[e.jsx("span",{className:"ai-chatbot-presence__dot"}),e.jsx("span",{children:V.visitor_status||"offline"})]})}),e.jsx("td",{children:e.jsx("span",{className:`ai-chatbot-status ai-chatbot-status--${V.status}`,children:V.status})})]},V.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:"No conversations yet."})})}return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"AI Chatbot Inbox"}),e.jsx("div",{className:"text-secondary",children:"View visitor conversations and messages."})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:P,title:h?"Sound on":"Sound off",children:h?e.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16","aria-hidden":"true",children:e.jsx("path",{fill:"currentColor",d:"M3 9v6h4l5 4V5L7 9H3zm13.5 3a4.5 4.5 0 0 0-2.25-3.9v7.8A4.5 4.5 0 0 0 16.5 12zm0-9a1 1 0 0 0-1 1 1 1 0 0 0 .5.87 8.5 8.5 0 0 1 0 14.26 1 1 0 0 0-.5.87 1 1 0 0 0 1 1 1 1 0 0 0 .5-.14 10.5 10.5 0 0 0 0-17.46 1 1 0 0 0-.5-.14z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16","aria-hidden":"true",children:[e.jsx("path",{fill:"currentColor",d:"M3 9v6h4l5 4V5L7 9H3zm13.5 3a4.5 4.5 0 0 0-2.25-3.9v7.8A4.5 4.5 0 0 0 16.5 12z"}),e.jsx("path",{fill:"currentColor",d:"M18.3 5.7a1 1 0 0 0-1.4 0l-10 10a1 1 0 0 0 1.4 1.4l10-10a1 1 0 0 0 0-1.4z"})]})}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:k,children:"Refresh"})]})]}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-lg-4",children:e.jsxs("div",{className:"user-panel h-100",children:[e.jsxs("div",{className:"user-panel-header d-flex align-items-center justify-content-between",children:[e.jsx("div",{className:"user-panel-title",children:"Conversations"}),e.jsxs("span",{className:"text-secondary small",children:[t.conversations.length," total"]})]}),e.jsxs("div",{className:"ai-chatbot-filters",children:[["open","closed","all"].map(O=>e.jsx("button",{type:"button",className:`btn btn-sm ${t.filterStatus===O?"btn-primary":"btn-outline-light"}`,onClick:()=>a(V=>({...V,filterStatus:O})),children:O==="all"?"All":O.charAt(0).toUpperCase()+O.slice(1)},O)),e.jsxs("select",{className:"form-select form-select-sm ai-chatbot-category",value:s,onChange:O=>n(O.target.value),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"sales",children:"Sales"}),e.jsx("option",{value:"support",children:"Support"})]})]}),e.jsxs("div",{className:"table-responsive",children:[e.jsxs("table",{className:"table table-dark table-hover mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Visitor"}),e.jsx("th",{children:"Widget"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Presence"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:H(D)})]}),e.jsx("div",{className:"section-divider my-2"}),e.jsx("div",{className:"small text-secondary mb-2",children:"Older Conversations"}),e.jsxs("table",{className:"table table-dark table-hover mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Visitor"}),e.jsx("th",{children:"Widget"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Presence"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:H(te)})]})]})]})}),e.jsx("div",{className:"col-lg-8",children:e.jsxs("div",{className:"user-panel h-100",children:[e.jsxs("div",{className:"user-panel-header d-flex align-items-center justify-content-between",children:[e.jsx("div",{className:"user-panel-title",children:_?_.visitor_name||_.visitor_id||"Visitor":"Messages"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{className:"text-secondary small",children:_?_.widget_name:""}),_?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:`ai-chatbot-presence ai-chatbot-presence--${_.visitor_status||"offline"}`,children:[e.jsx("span",{className:"ai-chatbot-presence__dot"}),e.jsx("span",{children:_.visitor_status||"offline"})]}),e.jsx("span",{className:`badge ${_.category==="sales"?"bg-success":"bg-primary"}`,children:(_.category||"support").charAt(0).toUpperCase()+(_.category||"support").slice(1)}),e.jsx("span",{className:`badge ${_.source==="public_page"?"bg-info":"bg-secondary"}`,children:_.source==="public_page"?"Public Page":"Widget"})]}):null,_?_.status==="open"?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>R("close"),children:"Close"}):e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>R("reopen"),children:"Reopen"}):null]})]}),e.jsx("div",{className:"ai-chatbot-thread",children:t.loadingMessages?e.jsx("div",{className:"text-secondary",children:"Loading messages..."}):t.messages.length?t.messages.map(O=>{var ee;const V=!!O.attachment_url,re=O.text&&(!V||O.text!==O.attachment_name),Y=Hf(O.created_at),ce=Hf(O.created_at,t.orgTimezone),ie=[Y,ce&&ce!==Y?ce:""].filter(Boolean).join(" / ");return e.jsxs("div",{className:`ai-chatbot-message ai-chatbot-message--${O.sender_type}`,children:[re?e.jsx("div",{className:"ai-chatbot-message__text",children:O.text}):null,V?(ee=O.attachment_type)!=null&&ee.startsWith("image/")?e.jsx("a",{className:"ai-chatbot-attachment",href:O.attachment_url,target:"_blank",rel:"noreferrer",children:e.jsx("img",{className:"ai-chatbot-attachment__image",src:O.attachment_url,alt:O.attachment_name||"Attachment"})}):e.jsx("a",{className:"ai-chatbot-attachment",href:O.attachment_url,target:"_blank",rel:"noreferrer",children:O.attachment_name||"Download attachment"}):null,e.jsxs("div",{className:"ai-chatbot-message__meta",children:[O.sender_type," - ",ie||"-"]})]},O.id)}):e.jsx("div",{className:"text-secondary",children:"Select a conversation to view messages."})}),e.jsxs("div",{className:"ai-chatbot-composer",children:[e.jsxs("div",{className:"ai-chatbot-composer__actions",children:[e.jsx("button",{type:"button",className:"ai-chatbot-action-btn",onClick:()=>{var O;return(O=y.current)==null?void 0:O.click()},disabled:!_||t.sendingAttachment,title:"Attach file",children:e.jsx("i",{className:"bi bi-paperclip","aria-hidden":"true"})}),e.jsx("button",{type:"button",className:`ai-chatbot-action-btn ${l?"is-active":""}`,onClick:E,title:"Insert emoji",children:e.jsx("i",{className:"bi bi-emoji-smile","aria-hidden":"true"})}),e.jsx("button",{type:"button",className:`ai-chatbot-action-btn ${o?"is-active":""}`,onClick:C,title:"Premade replies",children:e.jsx("i",{className:"bi bi-chat-left-text","aria-hidden":"true"})}),e.jsx("button",{type:"button",className:`ai-chatbot-action-btn ${c.allowVisitorAttachments?"is-active":""}`,onClick:M,disabled:c.loading,title:"Toggle visitor attachments",children:e.jsx("i",{className:"bi bi-cloud-arrow-up","aria-hidden":"true"})}),e.jsx("input",{ref:y,type:"file",className:"ai-chatbot-composer__file",accept:".png,.jpg,.jpeg,.gif,.webp,.pdf,.doc,.docx,.xls,.xlsx,.txt,.csv",onChange:L,disabled:!_||t.sendingAttachment}),l?e.jsx("div",{className:"ai-chatbot-emoji-panel",children:pk.map(O=>e.jsx("button",{type:"button",className:"ai-chatbot-emoji-panel__item",onClick:()=>Q(O),children:O},O))}):null,o?e.jsx("div",{className:"ai-chatbot-emoji-panel ai-chatbot-emoji-panel--wide",children:c.premadeReplies.length?c.premadeReplies.map(O=>e.jsx("button",{type:"button",className:"ai-chatbot-emoji-panel__item ai-chatbot-emoji-panel__item--text",onClick:()=>z(O),children:O},O)):e.jsx("span",{className:"ai-chatbot-emoji-panel__empty",children:"No premade replies."})}):null]}),e.jsx("textarea",{className:"form-control ai-chatbot-composer__input",rows:2,placeholder:"Type a reply...",value:t.replyText,onChange:O=>a(V=>({...V,replyText:O.target.value})),onKeyDown:F,disabled:!_}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:!_||!t.replyText.trim()||t.sendingReply,onClick:S,children:t.sendingReply?"Sending...":"Send"})]})]})})]}),t.confirmCloseOpen?e.jsx("div",{className:"wz-modal__backdrop",children:e.jsxs("div",{className:"wz-modal",children:[e.jsx("div",{className:"wz-modal__title",children:"Close chat?"}),e.jsx("div",{className:"wz-modal__body",children:"Closing this chat will end the live conversation for the visitor. Do you want to close it now?"}),e.jsxs("div",{className:"wz-modal__actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>a(O=>({...O,confirmCloseOpen:!1})),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:W,children:"Close Chat"})]})]})}):null]})}const gk={loading:!0,error:"",widgets:[]},Qf={id:null,name:"",allowedDomains:"",themePreset:"emerald",themePrimary:"",themeAccent:"",themeBackground:""},xk=[{value:"emerald",label:"Emerald"},{value:"ocean",label:"Ocean"},{value:"violet",label:"Violet"},{value:"amber",label:"Amber"},{value:"graphite",label:"Graphite"},{value:"custom",label:"Custom"}];function bk(t){return!t||!t.length?"All domains":t.join(", ")}function Jf(t){if(typeof window>"u")return`<script src="/static/js/ai_chatbot_widget.js" data-widget-key="${t}"><\/script>`;const a=window.location.origin,s=`${a}/static/js/ai_chatbot_widget.js`,n=`${a}/api/ai-chatbot`;return`<script src="${s}" data-widget-key="${t}" data-api-base="${n}"><\/script>`}function Kf(t,a){return`/api/org/ai-chatbox/qr.${t}?widget_id=${encodeURIComponent(a)}`}function jk(){const[t,a]=i.useState(gk),[s,n]=i.useState(Qf),[l,r]=i.useState(!1),[o,u]=i.useState(""),[c,d]=i.useState(""),h=i.useMemo(()=>{if(!s.id||!s.name)return"";const x=t.widgets.find(f=>f.id===s.id);return x?Jf(x.widget_key):""},[s.id,s.name,t.widgets]),p=i.useMemo(()=>{const x=c.trim().toLowerCase();return x?t.widgets.filter(f=>{var F;const b=f.name||"",k=(f.allowed_domains||[]).join(", "),_=f.is_active?"active":"inactive",P=((F=f.theme)==null?void 0:F.preset)||"emerald",S=f.public_chat_url||"";return[b,k,_,P,S].some(L=>String(L).toLowerCase().includes(x))}):t.widgets},[c,t.widgets]);i.useEffect(()=>{let x=!0;async function f(){a(b=>({...b,loading:!0,error:""}));try{const b=await U("/api/ai-chatbot/widgets");x&&a({loading:!1,error:"",widgets:b.widgets||[]})}catch(b){x&&a({loading:!1,error:(b==null?void 0:b.message)||"Unable to load widgets.",widgets:[]})}}return f(),()=>{x=!1}},[]);async function g(){u(""),a(x=>({...x,loading:!0,error:""}));try{const x=await U("/api/ai-chatbot/widgets");a({loading:!1,error:"",widgets:x.widgets||[]})}catch(x){a({loading:!1,error:(x==null?void 0:x.message)||"Unable to load widgets.",widgets:[]})}}async function N(x){if(x.preventDefault(),!s.name.trim()){a(f=>({...f,error:"Widget name is required."}));return}r(!0),u("");try{const f={name:s.name.trim(),allowed_domains:s.allowedDomains,theme:{preset:s.themePreset,primary:s.themePrimary,accent:s.themeAccent,background:s.themeBackground}};let b=null;return s.id?b=await U(`/api/ai-chatbot/widgets/${s.id}`,{method:"PATCH",body:JSON.stringify(f)}):b=await U("/api/ai-chatbot/widgets",{method:"POST",body:JSON.stringify(f)}),n({id:null,name:"",allowedDomains:"",themePreset:"emerald",themePrimary:"",themeAccent:"",themeBackground:""}),await g(),u(s.id?"Widget updated.":"Widget created."),b}catch(f){a(b=>({...b,error:(f==null?void 0:f.message)||"Unable to save widget."}))}finally{r(!1)}}function v(x){const f=x.theme||{};n({id:x.id,name:x.name||"",allowedDomains:(x.allowed_domains||[]).join(`
`),themePreset:f.preset||"emerald",themePrimary:f.primary||"",themeAccent:f.accent||"",themeBackground:f.background||""}),u("")}async function w(x){u("");try{await U(`/api/ai-chatbot/widgets/${x.id}`,{method:"PATCH",body:JSON.stringify({is_active:!x.is_active})}),await g()}catch(f){a(b=>({...b,error:(f==null?void 0:f.message)||"Unable to update widget."}))}}async function A(x){if(window.confirm("Delete this widget? This cannot be undone.")){u("");try{await U(`/api/ai-chatbot/widgets/${x.id}`,{method:"DELETE"}),await g()}catch(b){a(k=>({...k,error:(b==null?void 0:b.message)||"Unable to delete widget."}))}}}async function y(x){if(x)try{await navigator.clipboard.writeText(x),u("Embed snippet copied.")}catch{a(b=>({...b,error:"Copy failed. Please copy manually."}))}}return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"AI Chatbot Widgets"}),e.jsx("div",{className:"text-secondary",children:"Create widgets and copy the embed snippet."})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:g,children:"Refresh"})]}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,o?e.jsx("div",{className:"alert alert-success",children:o}):null,e.jsxs("div",{className:"user-panel mb-4",children:[e.jsx("div",{className:"user-panel-header",children:e.jsx("div",{className:"user-panel-title",children:s.id?"Edit Widget":"New Widget"})}),e.jsx("form",{onSubmit:N,className:"p-3",children:e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-lg-6",children:[e.jsx("label",{className:"form-label",children:"Widget Name"}),e.jsx("input",{type:"text",className:"form-control",value:s.name,onChange:x=>n(f=>({...f,name:x.target.value})),placeholder:"Support Widget"})]}),e.jsxs("div",{className:"col-lg-6",children:[e.jsx("label",{className:"form-label",children:"Theme Preset"}),e.jsx("select",{className:"form-select",value:s.themePreset,onChange:x=>n(f=>({...f,themePreset:x.target.value})),children:xk.map(x=>e.jsx("option",{value:x.value,children:x.label},x.value))})]}),s.themePreset==="custom"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-lg-2",children:[e.jsx("label",{className:"form-label",children:"Primary"}),e.jsx("input",{type:"color",className:"form-control form-control-color",value:s.themePrimary||"#22c55e",onChange:x=>n(f=>({...f,themePrimary:x.target.value}))})]}),e.jsxs("div",{className:"col-lg-2",children:[e.jsx("label",{className:"form-label",children:"Accent"}),e.jsx("input",{type:"color",className:"form-control form-control-color",value:s.themeAccent||"#2563eb",onChange:x=>n(f=>({...f,themeAccent:x.target.value}))})]}),e.jsxs("div",{className:"col-lg-2",children:[e.jsx("label",{className:"form-label",children:"Background"}),e.jsx("input",{type:"color",className:"form-control form-control-color",value:s.themeBackground||"#0f172a",onChange:x=>n(f=>({...f,themeBackground:x.target.value}))})]})]}):null,e.jsxs("div",{className:"col-lg-9",children:[e.jsx("label",{className:"form-label",children:"Allowed Domains (comma or newline)"}),e.jsx("textarea",{className:"form-control",rows:2,value:s.allowedDomains,onChange:x=>n(f=>({...f,allowedDomains:x.target.value})),placeholder:"example.com, app.example.com"})]}),e.jsxs("div",{className:"col-lg-3 d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:l,children:l?"Saving...":s.id?"Update":"Create"}),s.id?e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>n(Qf),children:"Cancel"}):null]})]})})]}),e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header ai-chatbot-widgets-header",children:[e.jsx("div",{className:"user-panel-title",children:"Widgets"}),e.jsx("div",{className:"ai-chatbot-widgets-search",children:e.jsx("input",{type:"search",className:"form-control form-control-sm",placeholder:"Search widgets...",value:c,onChange:x=>d(x.target.value)})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle mb-0 ai-chatbot-widgets-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Domains"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Theme"}),e.jsx("th",{children:"Public Chat URL"}),e.jsx("th",{children:"Embed Script"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:7,children:"Loading..."})}):p.length?p.map(x=>{var b;const f=Jf(x.widget_key);return e.jsxs("tr",{children:[e.jsx("td",{children:x.name}),e.jsx("td",{children:bk(x.allowed_domains)}),e.jsx("td",{children:x.is_active?"Active":"Inactive"}),e.jsx("td",{children:((b=x.theme)==null?void 0:b.preset)||"emerald"}),e.jsx("td",{children:e.jsx("div",{className:"ai-chatbot-widgets-actions",children:e.jsxs("div",{className:"ai-chatbot-widgets-actions-row",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>y(x.public_chat_url),disabled:!x.public_chat_url,children:"Copy URL"}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:Kf("png",x.id),children:"QR PNG"}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:Kf("svg",x.id),children:"QR SVG"})]})})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>y(f),children:"Copy"})}),e.jsxs("td",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>v(x),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>w(x),children:x.is_active?"Disable":"Enable"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>A(x),children:"Delete"})]})]},x.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:7,children:t.widgets.length?"No matches found.":"No widgets yet."})})})]})})]}),h?e.jsx("div",{className:"mt-3 text-secondary",children:"Embed snippet ready for copy."}):null]})}const yk={loading:!0,error:"",leads:[],widgets:[],retentionDays:30,toast:""},vk=[{value:7,label:"Last 7 days"},{value:14,label:"Last 14 days"},{value:30,label:"Last 30 days"}];function Nk(t){return Qs(t)}function Yf(t,a=80){const s=String(t||"");return s.length<=a?s||"-":`${s.slice(0,a)}...`}function _k(){const[t,a]=i.useState(yk),[s,n]=i.useState(7),[l,r]=i.useState(""),o=i.useMemo(()=>t.widgets||[],[t.widgets]);i.useEffect(()=>{let h=!0;async function p(){a(g=>({...g,loading:!0,error:""}));try{const[g,N]=await Promise.all([U(`/api/ai-chatbot/leads?days=${s}${l?`&widget_id=${l}`:""}`),U("/api/ai-chatbot/widgets")]);h&&a({loading:!1,error:"",leads:g.leads||[],widgets:N.widgets||[],retentionDays:g.retention_days||30,toast:""})}catch(g){h&&a({loading:!1,error:(g==null?void 0:g.message)||"Unable to load leads.",leads:[],widgets:[],retentionDays:30,toast:""})}}return p(),()=>{h=!1}},[s,l]);function u(h){a(p=>({...p,toast:h})),h&&window.setTimeout(()=>{a(p=>({...p,toast:""}))},2e3)}async function c(h,p){a(g=>({...g,leads:g.leads.map(N=>N.id===h?{...N,status:p}:N)}));try{await U(`/api/ai-chatbot/leads/${h}`,{method:"PATCH",body:JSON.stringify({status:p})}),u("Updated")}catch(g){a(N=>({...N,error:(g==null?void 0:g.message)||"Unable to update status."}))}}async function d(h){if(window.confirm("Delete this lead? This cannot be undone."))try{await U(`/api/ai-chatbot/leads/${h}/delete`,{method:"DELETE"}),a(g=>({...g,leads:g.leads.filter(N=>N.id!==h)})),u("Deleted")}catch(g){a(N=>({...N,error:(g==null?void 0:g.message)||"Unable to delete lead."}))}}return e.jsxs("div",{children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:"AI Chatbot Leads"}),e.jsx("div",{className:"text-secondary",children:"Latest enquiry form submissions from your widget."})]})}),e.jsx("hr",{className:"section-divider"}),e.jsx("div",{className:"wz-alert wz-alert--info",children:e.jsxs("div",{children:["Leads are retained for ",t.retentionDays," days based on your plans Chat History setting. Older leads are auto-deleted."]})}),t.toast?e.jsx("div",{className:"wz-alert wz-alert--success",children:t.toast}):null,e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-search",children:[e.jsx("label",{htmlFor:"leads-days",children:"Days"}),e.jsx("select",{id:"leads-days",className:"form-select",value:s,onChange:h=>n(Number(h.target.value)),children:vk.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]}),e.jsxs("div",{className:"table-search",children:[e.jsx("label",{htmlFor:"leads-widget",children:"Widget"}),e.jsxs("select",{id:"leads-widget",className:"form-select",value:l,onChange:h=>r(h.target.value),children:[e.jsx("option",{value:"",children:"All widgets"}),o.map(h=>e.jsx("option",{value:h.id,children:h.name},h.id))]})]})]}),t.loading?e.jsx("div",{className:"text-center py-4",children:"Loading leads..."}):t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-borderless",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Message"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Widget"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:t.leads.length?t.leads.map(h=>e.jsxs("tr",{children:[e.jsx("td",{children:h.name||"-"}),e.jsx("td",{children:h.phone||"-"}),e.jsx("td",{children:h.email||"-"}),e.jsx("td",{title:h.message||"",children:Yf(h.message||"")}),e.jsx("td",{children:Nk(h.created_at)}),e.jsx("td",{children:h.widget_name||"-"}),e.jsx("td",{children:h.source_url?e.jsx("a",{href:h.source_url,target:"_blank",rel:"noreferrer",children:Yf(h.source_url,40)}):"-"}),e.jsx("td",{children:e.jsxs("select",{className:"form-select form-select-sm",value:h.status||"fresh",onChange:p=>c(h.id,p.target.value),children:[e.jsx("option",{value:"fresh",children:"Fresh"}),e.jsx("option",{value:"following",children:"Following"}),e.jsx("option",{value:"completed",children:"Completed"})]})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>d(h.id),children:"Delete"})})]},h.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:9,children:"No leads found."})})})]})})]})]})}function Sk(t){if(!t)return{country:"+91",phone:""};const a=t.split(" ");if(a.length>1){const s=a[0],n=a.slice(1).join(" ");if(ls.some(l=>l.code===s))return{country:s,phone:n}}return{country:"+91",phone:t}}function wk({agent:t,onClose:a,onSuccess:s,onError:n}){const[l,r]=i.useState({name:"",email:"",phone:"",phoneCountry:"+91",agentRole:"support"}),[o,u]=i.useState(!1);i.useEffect(()=>{if(t){const{country:d,phone:h}=Sk(t.phone);r({name:t.name||"",email:t.email||"",phone:h||"",phoneCountry:d||"+91",agentRole:t.agent_role||"support"})}},[t]);async function c(d){if(d.preventDefault(),!!t){u(!0);try{const h={name:l.name.trim(),email:l.email.trim(),phone:`${l.phoneCountry} ${l.phone.trim()}`.trim(),agent_role:l.agentRole};await U(`/api/ai-chatbot/org/agents/${t.id}`,{method:"PATCH",body:JSON.stringify(h)}),s()}catch(h){n(h)}finally{u(!1)}}}return t?e.jsx("div",{className:"wz-modal__backdrop",children:e.jsxs("div",{className:"wz-modal wz-agent-modal",children:[e.jsxs("div",{className:"modal-header d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"modal-title",children:"Edit Agent"}),e.jsx("button",{type:"button",className:"btn-close",onClick:a})]}),e.jsx("hr",{className:"section-divider mt-0 mb-3"}),e.jsxs("form",{onSubmit:c,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:l.name,onChange:d=>r(h=>({...h,name:d.target.value})),placeholder:"Agent name"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:l.email,onChange:d=>r(h=>({...h,email:d.target.value})),placeholder:"agent@example.com",required:!0})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Role"}),e.jsxs("select",{className:"form-select",value:l.agentRole,onChange:d=>r(h=>({...h,agentRole:d.target.value})),children:[e.jsx("option",{value:"support",children:"Support"}),e.jsx("option",{value:"sales",children:"Sales"}),e.jsx("option",{value:"both",children:"Both"})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select wz-phone-country-select",value:l.phoneCountry,onChange:d=>r(h=>({...h,phoneCountry:d.target.value})),children:ls.map(d=>e.jsxs("option",{value:d.code,children:[d.label," ",d.code]},`${d.code}-${d.label}`))}),e.jsx("input",{type:"text",className:"form-control",value:l.phone,onChange:d=>r(h=>({...h,phone:d.target.value})),placeholder:"Phone number"})]})]})]})}),e.jsxs("div",{className:"modal-footer wz-modal__actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:a,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:o,children:o?"Saving...":"Update Agent"})]})]})]})}):null}const kk={loading:!0,error:"",agents:[],toast:"",tempPassword:""},Zf={name:"",email:"",phone:"",phoneCountry:"+91",password:"",chatAccess:["support"]};function Ck(){var k,_;const[t,a]=i.useState(kk),[s,n]=i.useState(Zf),[l,r]=i.useState(!1),[o,u]=i.useState(!1),[c,d]=i.useState({open:!1,agent:null}),[h,p]=i.useState({open:!1,agent:null,newPassword:"",confirmPassword:"",submitting:!1});i.useEffect(()=>{let P=!0;async function S(){a(F=>({...F,loading:!0,error:""}));try{const F=await U("/api/ai-chatbot/org/agents");P&&a(L=>({...L,loading:!1,error:"",agents:F.agents||[]}))}catch(F){P&&a(L=>({...L,loading:!1,error:(F==null?void 0:F.message)||"Unable to load agents."}))}}return S(),()=>{P=!1}},[]);function g(P,S=""){a(F=>({...F,toast:P,tempPassword:S})),P&&window.setTimeout(()=>{a(F=>({...F,toast:"",tempPassword:""}))},2500)}function N(P){d({open:!0,agent:P})}async function v(){a(P=>({...P,loading:!0,error:""}));try{const P=await U("/api/ai-chatbot/org/agents");a(S=>({...S,loading:!1,agents:P.agents||[]}))}catch(P){a(S=>({...S,loading:!1,error:(P==null?void 0:P.message)||"Unable to load agents."}))}}function w(P){const{value:S,checked:F}=P.target;n(L=>{const{chatAccess:Q}=L;return F?{...L,chatAccess:[...Q,S]}:{...L,chatAccess:Q.filter(E=>E!==S)}})}async function A(P){if(P.preventDefault(),!s.email.trim()){a(S=>({...S,error:"Email is required."}));return}if(!s.password.trim()){a(S=>({...S,error:"Temp password is required."}));return}if(s.chatAccess.length===0){a(S=>({...S,error:"Select at least one chat access type."}));return}r(!0);try{const S={name:s.name.trim(),email:s.email.trim(),phone:`${s.phoneCountry} ${s.phone.trim()}`.trim(),password:s.password.trim(),chat_access:s.chatAccess},F=await U("/api/ai-chatbot/org/agents",{method:"POST",body:JSON.stringify(S)});n(Zf),await v(),g("Agent created.",F.temp_password||""),u(!1)}catch(S){a(F=>({...F,error:(S==null?void 0:S.message)||"Unable to create agent."}))}finally{r(!1)}}async function y(P){try{await U(`/api/ai-chatbot/org/agents/${P.id}`,{method:"PATCH",body:JSON.stringify({is_active:!P.is_active})}),await v(),g(P.is_active?"Agent disabled.":"Agent enabled.")}catch(S){a(F=>({...F,error:(S==null?void 0:S.message)||"Unable to update agent."}))}}async function x(P){if(window.confirm("Delete this agent? This cannot be undone."))try{await U(`/api/ai-chatbot/org/agents/${P.id}`,{method:"DELETE"}),a(F=>({...F,agents:F.agents.filter(L=>L.id!==P.id)})),g("Agent deleted.")}catch(F){a(L=>({...L,error:(F==null?void 0:F.message)||"Unable to delete agent."}))}}function f(P){p({open:!0,agent:P,newPassword:"",confirmPassword:"",submitting:!1})}async function b(P){if(P.preventDefault(),!!h.agent){if(!h.newPassword.trim()){a(S=>({...S,error:"New password is required."}));return}if(h.newPassword!==h.confirmPassword){a(S=>({...S,error:"New passwords do not match."}));return}p(S=>({...S,submitting:!0}));try{await U(`/api/ai-chatbot/org/agents/${h.agent.id}/password`,{method:"POST",body:JSON.stringify({new_password:h.newPassword,confirm_password:h.confirmPassword})}),g("Password updated."),p({open:!1,agent:null,newPassword:"",confirmPassword:"",submitting:!1})}catch(S){a(F=>({...F,error:(S==null?void 0:S.message)||"Unable to update password."})),p(F=>({...F,submitting:!1}))}}}return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:"AI Chatbot Agents"}),e.jsx("div",{className:"text-secondary",children:"Add and manage support agents for AI Chatbot inbox."})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:v,children:"Refresh"})]}),e.jsx("hr",{className:"section-divider"}),e.jsx("div",{className:"alert alert-info",children:"Deleting agent will not delete conversations; it only blocks login."}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,t.toast?e.jsxs("div",{className:"alert alert-success",children:[t.toast,t.tempPassword?e.jsxs("div",{className:"mt-2",children:["Temp password: ",e.jsx("strong",{children:t.tempPassword})]}):null]}):null,e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>u(!0),children:"Add Agent"})}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{className:"mb-3",children:"Agents"}),t.loading?e.jsx("div",{className:"text-center py-4",children:"Loading agents..."}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-borderless",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Chat Access"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:t.agents.length?t.agents.map(P=>{var S;return e.jsxs("tr",{children:[e.jsx("td",{children:P.name||"-"}),e.jsx("td",{children:P.email||"-"}),e.jsx("td",{children:P.phone||"-"}),e.jsx("td",{children:((S=P.chat_access)==null?void 0:S.join(", "))||"sales, support"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${P.is_active?"bg-success":"bg-secondary"}`,children:P.is_active?"Active":"Disabled"})}),e.jsxs("td",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",onClick:()=>N(P),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>y(P),children:P.is_active?"Disable":"Enable"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>x(P),children:"Delete"}),e.jsx("button",{type:"button",className:"btn btn-outline-success btn-sm",onClick:()=>f(P),children:"Password Change"})]})]},P.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:"No agents yet."})})})]})})]}),o?e.jsx("div",{className:"wz-modal__backdrop",children:e.jsxs("div",{className:"wz-modal wz-agent-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Add Agent"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>u("")})]}),e.jsx("hr",{className:"section-divider mt-0 mb-3"}),e.jsxs("form",{onSubmit:A,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:s.name,onChange:P=>n(S=>({...S,name:P.target.value})),placeholder:"Agent name"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:s.email,onChange:P=>n(S=>({...S,email:P.target.value})),placeholder:"agent@example.com",required:!0})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Chat Access"}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",value:"sales",id:"access-sales-new",checked:s.chatAccess.includes("sales"),onChange:w}),e.jsx("label",{className:"form-check-label",htmlFor:"access-sales-new",children:"Sales"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",value:"support",id:"access-support-new",checked:s.chatAccess.includes("support"),onChange:w}),e.jsx("label",{className:"form-check-label",htmlFor:"access-support-new",children:"Support"})]})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",value:s.phoneCountry,onChange:P=>n(S=>({...S,phoneCountry:P.target.value})),style:{maxWidth:"110px"},children:ls.map(P=>e.jsxs("option",{value:P.code,children:[P.label," ",P.code]},`${P.code}-${P.label}`))}),e.jsx("input",{type:"text",className:"form-control",value:s.phone,onChange:P=>n(S=>({...S,phone:P.target.value})),placeholder:"Phone number"})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Temp Password"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",className:"form-control",value:s.password,onChange:P=>n(S=>({...S,password:P.target.value})),placeholder:"Temp@12345",required:!0}),e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>n(P=>({...P,password:`Temp@${Math.random().toString(36).slice(2,8)}`})),style:{minWidth:"130px"},children:"Auto-generate"})]})]})]})}),e.jsxs("div",{className:"modal-footer wz-modal__actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>u(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:l,children:l?"Saving...":"Create Agent"})]})]})]})}):null,c.open?e.jsx(wk,{agent:c.agent,onClose:()=>d({open:!1,agent:null}),onSuccess:async()=>{d({open:!1,agent:null}),await v(),g("Agent updated.")},onError:P=>a(S=>({...S,error:(P==null?void 0:P.message)||"Unable to update agent."}))}):null,h.open?e.jsx("div",{className:"wz-modal__backdrop",children:e.jsxs("div",{className:"wz-modal wz-agent-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Change Password"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>p(P=>({...P,open:!1}))})]}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"mb-2 text-secondary",children:["Agent: ",((k=h.agent)==null?void 0:k.name)||((_=h.agent)==null?void 0:_.email)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsx("input",{type:"password",className:"form-control",value:h.newPassword,onChange:P=>p(S=>({...S,newPassword:P.target.value})),required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Confirm New Password"}),e.jsx("input",{type:"password",className:"form-control",value:h.confirmPassword,onChange:P=>p(S=>({...S,confirmPassword:P.target.value})),required:!0})]})]}),e.jsxs("div",{className:"modal-footer wz-modal__actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>p(P=>({...P,open:!1})),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:h.submitting,children:h.submitting?"Saving...":"Update Password"})]})]})]})}):null]})}const Pk={loading:!0,error:"",data:null};function Ek({subscriptions:t=[]}){const[a,s]=i.useState(Pk),[n,l]=i.useState([]);i.useEffect(()=>{let d=!0;async function h(){try{const p=await U("/api/ai-chatbot/dashboard/summary");if(!d)return;s({loading:!1,error:"",data:p})}catch(p){d&&s({loading:!1,error:(p==null?void 0:p.message)||"Unable to load AI Chatbot dashboard.",data:null})}}return h(),()=>{d=!1}},[]),i.useEffect(()=>{let d=!0;async function h(){try{const p=await U("/api/dashboard/summary");if(!d)return;l(p.products||[])}catch{d&&l([])}}return h(),()=>{d=!1}},[]);const r=a.data||{},o=r.billing_preview||{},u=r.ai_usage_percent??0,c=Math.max(0,Math.min(100,u));return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading AI Chatbot dashboard..."})]}):a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"AI Chatbot Dashboard"}),e.jsx("hr",{className:"section-divider"}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 text-center h-100",children:[e.jsx("div",{className:"stat-icon",style:{color:"#4dabff"},children:e.jsx("i",{className:"bi bi-people","aria-hidden":"true"})}),e.jsx("h5",{children:"Agents Total"}),e.jsx("div",{className:"stat-value",style:{color:"#4dabff"},children:r.agents_total??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 text-center h-100",children:[e.jsx("div",{className:"stat-icon",style:{color:"#3ef58a"},children:e.jsx("i",{className:"bi bi-check2-circle","aria-hidden":"true"})}),e.jsx("h5",{children:"Agents Included"}),e.jsx("div",{className:"stat-value",style:{color:"#3ef58a"},children:r.agents_included??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 text-center h-100",children:[e.jsx("div",{className:"stat-icon",style:{color:"#ffdd57"},children:e.jsx("i",{className:"bi bi-plus-circle","aria-hidden":"true"})}),e.jsx("h5",{children:"Extra Agents"}),e.jsx("div",{className:"stat-value",style:{color:"#ffdd57"},children:r.agents_extra??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 text-center h-100",children:[e.jsx("div",{className:"stat-icon",style:{color:"#ff6b6b"},children:e.jsx("i",{className:"bi bi-robot","aria-hidden":"true"})}),e.jsx("h5",{children:"AI Replies Used"}),e.jsx("div",{className:"stat-value",style:{color:"#ff6b6b"},children:r.ai_replies_used_this_month??0})]})})]}),e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 ai-chatbot-summary-card",children:[e.jsx("h5",{children:"AI Usage Limit"}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Monthly Limit"}),e.jsx("strong",{children:r.ai_replies_limit??0})]}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Usage"}),e.jsxs("strong",{children:[u,"% this month"]})]}),e.jsx("div",{className:"ai-chatbot-usage-bar",children:e.jsx("span",{style:{width:`${c}%`}})})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 ai-chatbot-summary-card",children:[e.jsx("h5",{children:"Subscription"}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Plan"}),e.jsx("strong",{children:r.plan_name||"-"})]}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Billing Cycle"}),e.jsx("strong",{children:r.billing_cycle||"-"})]}),e.jsx("div",{className:"ai-chatbot-summary-note",children:"Manage plan settings from Billing when available."})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 ai-chatbot-summary-card",children:[e.jsx("h5",{children:"Billing Preview"}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Base Amount"}),e.jsxs("strong",{children:["INR ",o.base_amount??0]})]}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Add-on Amount"}),e.jsxs("strong",{children:["INR ",o.addon_amount??0]})]}),e.jsxs("div",{className:"ai-chatbot-summary-row ai-chatbot-summary-row--total",children:[e.jsx("span",{children:"Total Amount"}),e.jsxs("strong",{children:["INR ",o.total_amount??0]})]})]})})]}),e.jsxs("div",{className:"card p-4 mt-4",children:[e.jsx("h4",{children:"Quick Actions"}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx(dt,{to:"/ai-chatbot/inbox",className:"btn btn-outline-light btn-sm",children:"Open Inbox"}),e.jsx(dt,{to:"/ai-chatbot/widgets",className:"btn btn-outline-light btn-sm",children:"Manage Widgets"}),e.jsx(dt,{to:"/ai-chatbot/leads",className:"btn btn-outline-light btn-sm",children:"View Leads"})]})]}),e.jsx(Ki,{products:n,subscriptions:t,isReadOnly:!1,currentProductKey:"ai-chatbot"})]})}const Ak={loading:!0,error:"",conversations:[],retentionDays:30,filterStatus:"all",selected:null,messages:[],loadingMessages:!1,orgTimezone:"UTC"};function Xf(t,a){if(!t)return"";const s=new Date(t);if(Number.isNaN(s.getTime()))return"";const l=new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:a}).formatToParts(s).reduce((r,o)=>(r[o.type]=o.value,r),{});return`${l.year}-${l.month}-${l.day} ${l.hour}:${l.minute}:${l.second}`}function Tk(){const[t,a]=i.useState(Ak);i.useEffect(()=>{let o=!0;async function u(){a(c=>({...c,loading:!0,error:""}));try{const c=new URLSearchParams;c.set("status",t.filterStatus);const d=await U(`/api/ai-chatbot/history?${c.toString()}`);if(!o)return;a(h=>({...h,loading:!1,error:"",conversations:d.conversations||[],retentionDays:d.retention_days??h.retentionDays}))}catch(c){o&&a(d=>({...d,loading:!1,error:(c==null?void 0:c.message)||"Unable to load chat history."}))}}return u(),()=>{o=!1}},[t.filterStatus]);async function s(){a(o=>({...o,loading:!0,error:""}));try{const o=new URLSearchParams;o.set("status",t.filterStatus);const u=await U(`/api/ai-chatbot/history?${o.toString()}`);a(c=>({...c,loading:!1,error:"",conversations:u.conversations||[],retentionDays:u.retention_days??c.retentionDays}))}catch(o){a(u=>({...u,loading:!1,error:(o==null?void 0:o.message)||"Unable to load chat history."}))}}async function n(o){if(o){a(u=>({...u,loadingMessages:!0,selected:o,messages:[]}));try{const u=await U(`/api/ai-chatbot/history/${o.id}/messages`);a(c=>({...c,loadingMessages:!1,messages:u.messages||[],orgTimezone:u.org_timezone||c.orgTimezone||"UTC"}))}catch(u){a(c=>({...c,loadingMessages:!1,error:(u==null?void 0:u.message)||"Unable to load conversation."}))}}}function l(){a(o=>({...o,selected:null,messages:[],loadingMessages:!1}))}async function r(o){var c;if(!(!o||!window.confirm("Delete this chat history? This will remove the conversation for all users.")))try{await U(`/api/ai-chatbot/history/${o.id}`,{method:"DELETE"}),await s(),((c=t.selected)==null?void 0:c.id)===o.id&&l()}catch(d){a(h=>({...h,error:(d==null?void 0:d.message)||"Unable to delete chat history."}))}}return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"AI Chatbot History"}),e.jsx("div",{className:"text-secondary",children:"Review past conversations and manage history."})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:s,children:"Refresh"})]}),e.jsxs("div",{className:"alert alert-info retention-text",children:["Chat history is stored for up to ",t.retentionDays," days as per your plan. Older chats are deleted automatically."]}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsx("div",{className:"d-flex align-items-center gap-2 mb-2",children:["all","open","closed"].map(o=>e.jsx("button",{type:"button",className:`btn btn-sm ${t.filterStatus===o?"btn-primary":"btn-outline-light"}`,onClick:()=>a(u=>({...u,filterStatus:o})),children:o==="all"?"All":o.charAt(0).toUpperCase()+o.slice(1)},o))}),e.jsx("div",{className:"card p-3",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Visitor"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Widget"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Last Message"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:11,children:"Loading..."})}):t.conversations.length?t.conversations.map(o=>e.jsxs("tr",{children:[e.jsx("td",{children:o.visitor_id}),e.jsx("td",{children:o.visitor_name||"-"}),e.jsx("td",{children:o.visitor_email||"-"}),e.jsx("td",{children:o.visitor_phone||"-"}),e.jsx("td",{children:o.widget_name||"-"}),e.jsx("td",{children:o.category||"-"}),e.jsx("td",{children:o.source||"-"}),e.jsx("td",{children:o.status}),e.jsx("td",{children:o.last_message||"-"}),e.jsx("td",{children:o.last_message_at?o.last_message_at.slice(0,19).replace("T"," "):"-"}),e.jsxs("td",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>n(o),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>r(o),children:"Delete"})]})]},o.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:11,children:"No chat history found."})})})]})})}),t.selected?e.jsx("div",{className:"modal d-block",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-lg",role:"document",children:e.jsxs("div",{className:"modal-content wz-history-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Conversation"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsxs("div",{className:"modal-body wz-history-modal__body",children:[e.jsxs("div",{className:"text-secondary mb-2",children:[t.selected.visitor_name||t.selected.visitor_id," - ",t.selected.visitor_phone||"-"]}),e.jsx("div",{className:"card p-2",style:{maxHeight:"360px",overflowY:"auto"},children:t.loadingMessages?e.jsx("div",{className:"text-center py-3",children:"Loading messages..."}):t.messages.length?t.messages.map(o=>{const u=Xf(o.created_at),c=Xf(o.created_at,t.orgTimezone),d=[u,c&&c!==u?c:""].filter(Boolean).join(" / ");return e.jsxs("div",{className:`ai-chatbot-message ai-chatbot-message--${o.sender_type}`,children:[e.jsx("div",{className:"ai-chatbot-message__text",children:o.text}),e.jsxs("div",{className:"ai-chatbot-message__meta",children:[o.sender_type," - ",d||"-"]})]},o.id)}):e.jsx("div",{className:"text-secondary",children:"No messages."})})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:l,children:"Close"})})]})})}):null]})}const Dk={loading:!0,saving:!1,error:"",success:"",premadeRepliesText:"",allowVisitorAttachments:!1},Rk={loading:!0,error:"",items:[],usageBytes:0,limitBytes:null},Lk={loading:!0,error:"",items:[],remaining:50,limit:50};function zr(t){const a=Number(t||0);if(!a)return"0 MB";const s=a/(1024*1024);return s<1024?`${s.toFixed(1)} MB`:`${(s/1024).toFixed(2)} GB`}function eg(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}async function tg(t,a){ns()||await fetch("/api/auth/csrf",{credentials:"include"});const s=await fetch(t,{method:"POST",credentials:"include",headers:{"X-CSRFToken":ns()},body:a}),n=await s.text();let l=null;if(n)try{l=JSON.parse(n)}catch{l=null}if(!s.ok){const r=(l==null?void 0:l.detail)||(l==null?void 0:l.error)||`Request failed (${s.status})`,o=new Error(r);throw o.status=s.status,o.data=l,o}return l}function Mk(){const[t,a]=i.useState(Dk),[s,n]=i.useState(Rk),[l,r]=i.useState(Lk),[o,u]=i.useState(""),[c,d]=i.useState(!1),[h,p]=i.useState(""),[g,N]=i.useState(""),[v,w]=i.useState(!1),[A,y]=i.useState({open:!1,pages:[],total:0,allowed:0,selected:[]}),[x,f]=i.useState(""),[b,k]=i.useState(""),[_,P]=i.useState(!1),[S,F]=i.useState(""),[L,Q]=i.useState(""),E=75,C=250,z=10,M=10,[R,W]=i.useState(!1),[D,te]=i.useState(null),[H,O]=i.useState(null),[V,re]=i.useState(""),[Y,ce]=i.useState(""),[ie,ee]=i.useState({open:!1,id:null}),[T,Z]=i.useState({open:!1,question:"",answer:""}),[se,be]=i.useState(""),[ne,ae]=i.useState(1),[X,ke]=i.useState(""),[Ne,Ye]=i.useState(1),Ke=["home","about","services","pricing","contact","faq","policies"],mt=ys();function Ie(I){return I==null?"":String(I).toLowerCase()}function Xe(I,me){const Me=[],De=Math.max(1,I-2),et=Math.min(me,I+2);for(let Qe=De;Qe<=et;Qe+=1)Me.push(Qe);return Me}function nt(I,me){if(!I.length||!me)return[];const Me={};I.forEach(et=>{const Qe=et.type||"other";Me[Qe]||(Me[Qe]=[]),Me[Qe].push(et.url)});const De=[];return Ke.forEach(et=>{(Me[et]||[]).forEach(bt=>{De.length<me&&!De.includes(bt)&&De.push(bt)})}),De}function Ae(I){const me=(I==null?void 0:I.data)||{};return(me==null?void 0:me.status)!=="failed"?null:{title:{INVALID_URL:"Invalid URL",WEBSITE_NOT_REACHABLE:"Website not reachable",ACCESS_BLOCKED:"Website Access Restricted",JS_RENDER_REQUIRED:"Website needs JavaScript",LOGIN_REQUIRED:"Login required",NO_READABLE_CONTENT:"No readable content"}[me.error_code]||"Website import failed",reason:me.reason||"Unable to import website content.",suggestion:me.suggestion||"Try another URL or upload a Word file.",infoNote:me.info_note||"",errorCode:me.error_code||""}}async function ue(){try{const I=await U("/api/ai-chatbot/org/chat-settings");a(me=>({...me,loading:!1,error:"",premadeRepliesText:(I.premade_replies||[]).join(`
`),allowVisitorAttachments:!!I.allow_visitor_attachments}))}catch(I){a(me=>({...me,loading:!1,error:(I==null?void 0:I.message)||"Unable to load chat settings."}))}}async function je(){try{const I=await U("/api/ai-chatbot/media-library");n({loading:!1,error:"",items:I.items||[],usageBytes:I.usage_bytes||0,limitBytes:I.limit_bytes??null})}catch(I){n(me=>({...me,loading:!1,error:(I==null?void 0:I.message)||"Unable to load media library."}))}}async function Ce(){try{const I=await U("/api/ai-chatbot/faqs");r({loading:!1,error:"",items:I.items||[],remaining:I.remaining??0,limit:I.limit??50})}catch(I){r(me=>({...me,loading:!1,error:(I==null?void 0:I.message)||"Unable to load FAQs."}))}}i.useEffect(()=>{let I=!0;async function me(){await Promise.all([ue(),je(),Ce()])}return I&&me(),()=>{I=!1}},[]);async function Le(){if(!t.saving){a(I=>({...I,saving:!0,success:"",error:""}));try{const I=await U("/api/ai-chatbot/org/chat-settings",{method:"PATCH",body:JSON.stringify({premade_replies:t.premadeRepliesText,allow_visitor_attachments:t.allowVisitorAttachments})});a(me=>({...me,saving:!1,success:"Settings updated.",premadeRepliesText:(I.premade_replies||[]).join(`
`),allowVisitorAttachments:!!I.allow_visitor_attachments}))}catch(I){a(me=>({...me,saving:!1,error:(I==null?void 0:I.message)||"Unable to save chat settings."}))}}}async function Fe(I){var Me;const me=(Me=I.target.files)==null?void 0:Me[0];if(I.target.value="",!(!me||c)){if(me.size&&me.size>2*1024*1024){n(De=>({...De,error:"File too large. Maximum upload size is 2MB."}));return}d(!0),n(De=>({...De,error:""}));try{const De=new FormData;De.append("file",me),o.trim()&&De.append("name",o.trim()),await tg("/api/ai-chatbot/media-library",De),u(""),await je()}catch(De){n(et=>({...et,error:(De==null?void 0:De.message)||"Unable to upload document."}))}finally{d(!1)}}}async function ye(){var I,me,Me;if(!(!h.trim()||v)){w(!0),n(De=>({...De,error:""}));try{const De=await U("/api/ai-chatbot/media-library/website-import",{method:"POST",body:JSON.stringify({source_url:h.trim(),name:g.trim()})});p(""),N(""),(De==null?void 0:De.status)==="warning"&&((De==null?void 0:De.code)==="LIMITED_CONTENT"||(De==null?void 0:De.code)==="ONLY_HOMEPAGE_IMPORTED")?ce(`${De.message} ${De.suggestion}`):ce(""),await je()}catch(De){if((De==null?void 0:De.status)===409&&((I=De==null?void 0:De.data)==null?void 0:I.detail)==="website_page_limit_exceeded"){const et=De.data.pages||[],Qe=Number(De.data.allowed_pages||0),bt=nt(et,Qe);y({open:!0,pages:et,total:Number(De.data.total_pages_found||et.length||0),allowed:Qe,selected:bt}),De.data.item&&await je()}else{const et=Ae(De);if(((me=De==null?void 0:De.data)==null?void 0:me.status)==="blocked"){n(Qe=>({...Qe,error:"Already submitted"}));return}n(Qe=>({...Qe,error:et||(De==null?void 0:De.message)||"Unable to import website content."})),(Me=De==null?void 0:De.data)!=null&&Me.item&&await je()}}finally{w(!1)}}}async function Ze(){var I;if(!(!A.selected.length||v)){w(!0),n(me=>({...me,error:""}));try{const me=await U("/api/ai-chatbot/media-library/website-import",{method:"POST",body:JSON.stringify({source_url:h.trim(),name:g.trim(),selected_pages:A.selected})});p(""),N(""),y({open:!1,pages:[],total:0,allowed:0,selected:[]}),(me==null?void 0:me.status)==="warning"&&((me==null?void 0:me.code)==="LIMITED_CONTENT"||(me==null?void 0:me.code)==="ONLY_HOMEPAGE_IMPORTED")?ce(`${me.message} ${me.suggestion}`):ce(""),await je()}catch(me){const Me=Ae(me);n(De=>({...De,error:Me||(me==null?void 0:me.message)||"Unable to import selected pages."})),(I=me==null?void 0:me.data)!=null&&I.item&&await je()}finally{w(!1)}}}function pt(I){y(me=>{const Me=new Set(me.selected);return Me.has(I)?Me.delete(I):(me.allowed===0||Me.size<me.allowed)&&Me.add(I),{...me,selected:Array.from(Me)}})}async function ht(){if(!(!b.trim()||_)){P(!0),n(I=>({...I,error:""}));try{await U("/api/ai-chatbot/media-library",{method:"POST",body:JSON.stringify({type:"extra_text",name:x.trim(),content:b.trim()})}),f(""),k(""),await je()}catch(I){n(me=>({...me,error:(I==null?void 0:I.message)||"Unable to save extra text."}))}finally{P(!1)}}}async function Ge(I){n(me=>({...me,error:""}));try{await U("/api/ai-chatbot/media-library/delete",{method:"POST",body:JSON.stringify({ids:[I]})}),re(""),await je()}catch(me){n(Me=>({...Me,error:(me==null?void 0:me.message)||"Unable to delete media."}))}}async function gt(I,me){if(!(!me||H)){O(I.id),n(Me=>({...Me,error:""}));try{const Me=new FormData;Me.append("file",me),await tg(`/api/ai-chatbot/media-library/${I.id}/reupload`,Me),re(""),await je()}catch(Me){n(De=>({...De,error:(Me==null?void 0:Me.message)||"Unable to re-upload file."}))}finally{O(null)}}}async function ft(){if(!(!S.trim()||!L.trim()||R||D)){W(!0),r(I=>({...I,error:""}));try{await U("/api/ai-chatbot/faqs",{method:"POST",body:JSON.stringify({question:S.trim(),answer:L.trim()})}),F(""),Q(""),await Ce()}catch(I){r(me=>({...me,error:(I==null?void 0:I.message)||"Unable to add FAQ."}))}finally{W(!1)}}}async function G(){if(!(!D||!D.question.trim()||!D.answer.trim()||!await mt({title:"Confirm Save",message:"Are you sure you want to save the changes to this FAQ?",confirmVariant:"primary"}))){r(me=>({...me,error:""}));try{await U(`/api/ai-chatbot/faqs/${D.id}`,{method:"PATCH",body:JSON.stringify({question:D.question.trim(),answer:D.answer.trim()})}),te(null),await Ce()}catch(me){r(Me=>({...Me,error:(me==null?void 0:me.message)||"Unable to update FAQ."}))}}}async function Se(I){if(await mt({title:"Confirm Deletion",message:"Are you sure you want to delete this FAQ?",confirmVariant:"danger"})){r(Me=>({...Me,error:""}));try{await U(`/api/ai-chatbot/faqs/${I}`,{method:"DELETE"}),await Ce()}catch(Me){r(De=>({...De,error:(Me==null?void 0:Me.message)||"Unable to delete FAQ."}))}}}i.useEffect(()=>{ae(1)},[se]),i.useEffect(()=>{Ye(1)},[X]);const ve=i.useMemo(()=>{const I=se.trim().toLowerCase();return I?s.items.filter(me=>[me.name,me.type,me.source_url,me.text_content].map(Ie).join(" ").includes(I)):s.items},[s.items,se]),le=Math.max(1,Math.ceil(ve.length/z)),xe=i.useMemo(()=>{const I=(ne-1)*z;return ve.slice(I,I+z)},[ve,ne]);i.useEffect(()=>{ne>le&&ae(le)},[ne,le]);const ge=i.useMemo(()=>{const I=X.trim().toLowerCase();return I?l.items.filter(me=>[me.question,me.answer].map(Ie).join(" ").includes(I)):l.items},[l.items,X]),B=Math.max(1,Math.ceil(ge.length/M)),he=i.useMemo(()=>{const I=(Ne-1)*M;return ge.slice(I,I+M)},[ge,Ne]);i.useEffect(()=>{Ne>B&&Ye(B)},[Ne,B]);const we=i.useMemo(()=>s.limitBytes?`${zr(s.usageBytes)} / ${zr(s.limitBytes)}`:`${zr(s.usageBytes)} used (Unlimited)`,[s.usageBytes,s.limitBytes]);return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between mb-3",children:e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"AI Chatbot Settings"}),e.jsx("div",{className:"text-secondary",children:"Manage chat behavior and AI training data."})]})}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,t.success?e.jsx("div",{className:"alert alert-success",children:t.success}):null,e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx("div",{className:"col-12 col-lg-3",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Premade Replies Option for Chat Agent"}),e.jsx("textarea",{className:"form-control",rows:6,placeholder:"Enter one reply per line.",value:t.premadeRepliesText,onChange:I=>a(me=>({...me,premadeRepliesText:I.target.value})),disabled:t.loading||t.saving}),e.jsx("div",{className:"form-text",children:"Each line becomes a quick reply in the inbox."})]}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Le,disabled:t.loading||t.saving,children:t.saving?"Saving...":"Save Settings"})})]})}),e.jsx("div",{className:"col-12 col-lg-9",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsx("h5",{className:"mb-0",children:"AI Media Library"}),e.jsx("div",{style:{minWidth:"220px"},children:e.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Search media",value:se,onChange:I=>be(I.target.value)})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:s.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:"Loading..."})}):xe.length?xe.map(I=>{const me=I.type==="word_website_data",Me=me&&!I.file_url,De=I.updated_at||I.created_at;return e.jsxs("tr",{children:[e.jsx("td",{children:I.name||"-"}),e.jsxs("td",{children:[eg(I.type),Me?e.jsx("div",{className:"small text-warning",children:"Website data pending upload"}):null]}),e.jsx("td",{className:"text-break",children:I.source_url||I.text_content||"-"}),e.jsx("td",{children:zr(I.file_size)}),e.jsx("td",{children:Qs(De)}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[I.file_url?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:I.file_url,target:"_blank",rel:"noreferrer",children:"Download"}):null,me?e.jsxs("label",{className:"btn btn-outline-light btn-sm mb-0",onClick:()=>{Me&&re("Please upload the main website content as a Word file. Include About, Services, Pricing, and Support pages.")},children:[H===I.id?"Re-uploading...":"Re-upload",e.jsx("input",{type:"file",accept:".docx",onChange:et=>{var bt;const Qe=(bt=et.target.files)==null?void 0:bt[0];et.target.value="",Qe&&gt(I,Qe)},disabled:H===I.id,hidden:!0})]}):null,e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>ee({open:!0,id:I.id}),children:"Delete"})]})})]},I.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:se?"No matching media found.":"No training data yet."})})})]})}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mt-3",children:[e.jsxs("div",{className:"text-secondary small",children:["Showing ",xe.length," of ",ve.length]}),e.jsx("nav",{"aria-label":"Media pagination",children:e.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[e.jsx("li",{className:`page-item ${ne===1?"disabled":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>ae(I=>Math.max(1,I-1)),disabled:ne===1,children:"Prev"})}),Xe(ne,le).map(I=>e.jsx("li",{className:`page-item ${I===ne?"active":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>ae(I),children:I})},I)),e.jsx("li",{className:`page-item ${ne===le?"disabled":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>ae(I=>Math.min(le,I+1)),disabled:ne===le,children:"Next"})})]})})]})]})})]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"AI Training"}),e.jsx("div",{className:"text-secondary",children:"Manage documents, website data, extra text, and FAQs."})]}),e.jsxs("div",{className:"text-secondary",children:["Storage: ",we]})]}),s.error?e.jsx("div",{className:"alert alert-danger",children:typeof s.error=="string"?s.error:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fw-semibold",children:s.error.title}),e.jsx("div",{className:"small mt-1",children:s.error.reason}),s.error.errorCode==="ACCESS_BLOCKED"?e.jsxs("div",{className:"small mt-2",children:["Next steps:",e.jsx("div",{children:" Open the website in a browser"}),e.jsx("div",{children:" Copy important pages (About, Services, Pricing, Support)"}),e.jsx("div",{children:" Paste into a Word document"}),e.jsx("div",{children:" Upload the Word file in AI Media Library"})]}):e.jsxs("div",{className:"small mt-1",children:["Next: ",s.error.suggestion]}),s.error.infoNote?e.jsx("div",{className:"small mt-2 text-info",children:s.error.infoNote}):null]})}):null,Y?e.jsx("div",{className:"alert alert-warning",children:Y}):null,ie.open?e.jsx("div",{className:"modal-overlay",onClick:()=>ee({open:!1,id:null}),children:e.jsxs("div",{className:"modal-panel",onClick:I=>I.stopPropagation(),children:[e.jsx("h5",{children:"Delete Media"}),e.jsx("div",{className:"text-secondary small mb-3",children:"Are you sure you want to delete this data?"}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>ee({open:!1,id:null}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:async()=>{const I=ie.id;ee({open:!1,id:null}),I&&await Ge(I)},children:"Delete"})]})]})}):null,T.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Z({open:!1,question:"",answer:""}),children:e.jsxs("div",{className:"modal-panel",onClick:I=>I.stopPropagation(),children:[e.jsx("h5",{children:"FAQ Details"}),e.jsx("div",{className:"text-secondary small mb-2",children:"Question"}),e.jsx("div",{className:"mb-3",children:T.question||"-"}),e.jsx("div",{className:"text-secondary small mb-2",children:"Answer"}),e.jsx("div",{className:"mb-3",children:T.answer||"-"}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Z({open:!1,question:"",answer:""}),children:"Close"})})]})}):null,V?e.jsx("div",{className:"alert alert-info",children:V}):null,l.error?e.jsx("div",{className:"alert alert-danger",children:l.error}):null,e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx("div",{className:"col-12 col-xl-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Upload Document"}),e.jsx("div",{className:"text-secondary mb-3",children:"PDF, Word, or Text files only. Max 2MB."}),e.jsx("label",{className:"form-label",children:"Name (optional)"}),e.jsx("input",{type:"text",className:"form-control mb-2",value:o,onChange:I=>u(I.target.value),placeholder:"Quarterly report",disabled:c}),e.jsx("input",{type:"file",className:"form-control",accept:".pdf,.doc,.docx,.txt",onChange:Fe,disabled:c}),e.jsx("div",{className:"form-text",children:"Files are stored in your AI Media Library."})]})}),e.jsx("div",{className:"col-12 col-xl-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Website URL"}),e.jsx("div",{className:"text-secondary mb-3",children:"Fetch and convert website data into Word."}),e.jsx("label",{className:"form-label",children:"Title (optional)"}),e.jsx("input",{type:"text",className:"form-control mb-2",value:g,onChange:I=>N(I.target.value),placeholder:"Help Center",disabled:v}),e.jsx("label",{className:"form-label",children:"Website URL"}),e.jsx("input",{type:"url",className:"form-control mb-3",value:h,onChange:I=>p(I.target.value),placeholder:"https://example.com/docs",disabled:v||s.items.some(I=>I.type==="word_website_data")}),e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:ye,disabled:v||!h.trim()||s.items.some(I=>I.type==="word_website_data"),children:v?"Importing...":"Import Website"}),s.items.some(I=>I.type==="word_website_data")?e.jsx("div",{className:"form-text mt-2",children:"Already submitted. Delete the existing website data from the table to resubmit."}):null]})}),e.jsx("div",{className:"col-12 col-xl-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Extra Text"}),e.jsx("div",{className:"text-secondary mb-3",children:"Add notes or summaries directly."}),e.jsx("label",{className:"form-label",children:"Title (optional)"}),e.jsx("input",{type:"text",className:"form-control mb-2",value:x,onChange:I=>f(I.target.value),placeholder:"Support notes",disabled:_}),e.jsx("label",{className:"form-label",children:"Content"}),e.jsx("textarea",{className:"form-control mb-3",rows:4,value:b,onChange:I=>k(I.target.value),placeholder:"Paste text to train the assistant.",disabled:_}),e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:ht,disabled:_||!b.trim(),children:_?"Saving...":"Save Text"})]})})]}),e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between mb-3",children:e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:"FAQs"}),e.jsxs("div",{className:"text-secondary",children:[l.remaining," of ",l.limit," remaining"]})]})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("label",{className:"form-label mb-0",children:"Question"}),e.jsxs("div",{className:"text-secondary small",children:["(",S.length,"/",E,")"]})]}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Question",value:S,onChange:I=>F(I.target.value.slice(0,E)),disabled:R,maxLength:E})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("label",{className:"form-label mb-0",children:"Answer"}),e.jsxs("div",{className:"text-secondary small",children:["(",L.length,"/",C,")"]})]}),e.jsx("textarea",{className:"form-control",placeholder:"Answer",value:L,onChange:I=>Q(I.target.value.slice(0,C)),disabled:R,rows:5,maxLength:C})]}),e.jsx("div",{className:"col-6",children:e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:D?G:ft,disabled:R||!S.trim()||!L.trim(),children:R?"Saving...":D?"Save FAQ":"Add FAQ"})}),D?e.jsx("div",{className:"col-6 text-end",children:e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>{te(null),F(""),Q("")},children:"Cancel"})}):null]})}),e.jsxs("div",{className:"col-9",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsxs("div",{className:"text-secondary small",children:["Showing ",he.length," of ",ge.length]}),e.jsx("div",{style:{minWidth:"220px"},children:e.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Search FAQs",value:X,onChange:I=>ke(I.target.value)})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0 faq-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"faq-col-question",children:"Question"}),e.jsx("th",{className:"faq-col-answer",children:"Answer"}),e.jsx("th",{className:"faq-col-actions",children:"Actions"})]})}),e.jsx("tbody",{children:l.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:3,children:"Loading..."})}):he.length?he.map(I=>e.jsxs("tr",{children:[e.jsx("td",{children:I.question}),e.jsx("td",{children:I.answer}),e.jsx("td",{className:"faq-col-actions",children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Z({open:!0,question:I.question,answer:I.answer}),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>{te({id:I.id}),F(I.question),Q(I.answer)},children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>Se(I.id),children:"Delete"})]})})]},I.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,children:X?"No matching FAQs found.":"No FAQs yet."})})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("nav",{"aria-label":"FAQ pagination",children:e.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[e.jsx("li",{className:`page-item ${Ne===1?"disabled":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>Ye(I=>Math.max(1,I-1)),disabled:Ne===1,children:"Prev"})}),Xe(Ne,B).map(I=>e.jsx("li",{className:`page-item ${I===Ne?"active":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>Ye(I),children:I})},I)),e.jsx("li",{className:`page-item ${Ne===B?"disabled":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>Ye(I=>Math.min(B,I+1)),disabled:Ne===B,children:"Next"})})]})})})]})]})]}),A.open?e.jsx("div",{className:"modal-overlay",onClick:()=>y({open:!1,pages:[],total:0,allowed:0,selected:[]}),children:e.jsxs("div",{className:"modal-panel",onClick:I=>I.stopPropagation(),children:[e.jsx("h5",{children:"Select Pages to Import"}),e.jsxs("div",{className:"text-secondary small mb-2",children:[A.total," pages detected. Your plan allows ",A.allowed," pages."]}),e.jsxs("div",{className:"text-secondary small mb-3",children:["Selected ",A.selected.length," / ",A.allowed]}),e.jsx("div",{className:"table-responsive",style:{maxHeight:"320px",overflowY:"auto"},children:e.jsxs("table",{className:"table table-dark table-hover mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Page"}),e.jsx("th",{children:"Type"})]})}),e.jsx("tbody",{children:A.pages.map(I=>{const me=A.selected.includes(I.url),Me=!me&&A.allowed>0&&A.selected.length>=A.allowed;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:me,disabled:Me,onChange:()=>pt(I.url)})}),e.jsx("td",{className:"text-break",children:I.url}),e.jsx("td",{children:eg(I.type)})]},I.url)})})]})}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>y({open:!1,pages:[],total:0,allowed:0,selected:[]}),disabled:v,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Ze,disabled:v||!A.selected.length||A.allowed>0&&A.selected.length>A.allowed,children:v?"Importing...":"Import Selected Pages"})]})]})}):null]})}const zt={getCompanyProfile(){return U("/api/whatsapp-automation/company-profile")},saveCompanyProfile(t){return U("/api/whatsapp-automation/company-profile",{method:"PUT",body:JSON.stringify(t)})},getSettings(){return U("/api/whatsapp-automation/settings")},saveSettings(t){return U("/api/whatsapp-automation/settings",{method:"PUT",body:JSON.stringify(t)})},getRules(){return U("/api/whatsapp-automation/rules")},saveRule(t){return U("/api/whatsapp-automation/rules",{method:"POST",body:JSON.stringify(t)})},deleteRule(t){return U(`/api/whatsapp-automation/rules/${t}`,{method:"DELETE"})},previewReply(t){return U("/api/whatsapp-automation/preview-reply",{method:"POST",body:JSON.stringify(t)})},getCatalogueProducts(){return U("/api/whatsapp-automation/catalogue/products")},getCataloguePage(){return U("/api/whatsapp-automation/catalogue/page")},saveCataloguePage(t){return U("/api/whatsapp-automation/catalogue/page",{method:"PUT",body:JSON.stringify(t)})},saveCatalogueProduct(t){return U("/api/whatsapp-automation/catalogue/products",{method:"POST",body:JSON.stringify(t)})},deleteCatalogueProduct(t){return U(`/api/whatsapp-automation/catalogue/products/${t}`,{method:"DELETE"})},getDigitalCards(t={}){const a=new URLSearchParams;t.q&&a.set("q",t.q),t.page&&a.set("page",String(t.page)),t.pageSize&&a.set("page_size",String(t.pageSize));const s=a.toString();return U(`/api/whatsapp-automation/digital-cards${s?`?${s}`:""}`)},saveDigitalCard(t){return U("/api/whatsapp-automation/digital-cards",{method:"POST",body:JSON.stringify(t)})},checkDigitalCardSlug(t,a){const s=new URLSearchParams;t&&s.set("slug",String(t)),a&&s.set("id",String(a));const n=s.toString();return U(`/api/whatsapp-automation/digital-cards/slug-check${n?`?${n}`:""}`)},getDigitalCard(t){return U(`/api/whatsapp-automation/digital-cards/${t}`)},deleteDigitalCard(t){return U(`/api/whatsapp-automation/digital-cards/${t}`,{method:"DELETE"})}},xd=[{value:"instagram",label:"Instagram",bi:"bi-instagram"},{value:"facebook",label:"Facebook",bi:"bi-facebook"},{value:"youtube",label:"YouTube",bi:"bi-youtube"},{value:"linkedin",label:"LinkedIn",bi:"bi-linkedin"},{value:"x",label:"X / Twitter",bi:"bi-twitter-x"},{value:"whatsapp",label:"WhatsApp",bi:"bi-whatsapp"},{value:"telegram",label:"Telegram",bi:"bi-telegram"},{value:"website",label:"Website",bi:"bi-globe2"}];function ag(t){var a;return((a=xd.find(s=>s.value===t))==null?void 0:a.bi)||"bi-link-45deg"}const Uk={company_name:"",phone:"",whatsapp_number:"",email:"",website:"",address:"",description:"",theme_color:"#22c55e",product_highlights_text:"",social_links_text:"{}",logo_data_url:""};function Ok(){return{id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,type:"preset",icon:"instagram",label:"Instagram",url:"",icon_size:20,custom_icon_data:""}}function sg(t){var s;const a=Array.isArray(t==null?void 0:t.social_links_items)?t.social_links_items:Array.isArray((s=t==null?void 0:t.social_links)==null?void 0:s.items)?t.social_links.items:[];return a.length?a.map((n,l)=>({id:`${Date.now()}-${l}`,type:(n==null?void 0:n.type)==="custom"?"custom":"preset",icon:(n==null?void 0:n.icon)||"website",label:(n==null?void 0:n.label)||(n==null?void 0:n.icon)||"Link",url:(n==null?void 0:n.url)||"",icon_size:Number((n==null?void 0:n.icon_size)||20),custom_icon_data:(n==null?void 0:n.custom_icon_data)||""})):[]}function $k(){const[t,a]=i.useState(!0),[s,n]=i.useState(!1),[l,r]=i.useState(""),[o,u]=i.useState(""),[c,d]=i.useState(Uk),[h,p]=i.useState({digital_card_url:"",catalogue_url:""}),[g,N]=i.useState([]),[v,w]=i.useState("");i.useEffect(()=>{let f=!0;return(async()=>{try{const b=await zt.getCompanyProfile();if(!f)return;const k=(b==null?void 0:b.company_profile)||{};d({company_name:k.company_name||"",phone:k.phone||"",whatsapp_number:k.whatsapp_number||"",email:k.email||"",website:k.website||"",address:k.address||"",description:k.description||"",theme_color:k.theme_color||"#22c55e",product_highlights_text:Array.isArray(k.product_highlights)?k.product_highlights.join(`
`):"",social_links_text:JSON.stringify(k.social_links||{},null,2),logo_data_url:""}),w(k.logo_url||""),N(sg(k)),p({digital_card_url:k.digital_card_url||"",catalogue_url:k.catalogue_url||""}),a(!1)}catch(b){if(!f)return;r((b==null?void 0:b.message)||"Unable to load company profile."),a(!1)}})(),()=>{f=!1}},[]);async function A(){n(!0),r(""),u("");try{const f=g.map(_=>({type:_.type==="custom"?"custom":"preset",icon:String(_.icon||"").trim(),label:String(_.label||"").trim()||String(_.icon||"Link"),url:String(_.url||"").trim(),icon_size:Number(_.icon_size||20),custom_icon_data:_.type==="custom"?String(_.custom_icon_data||""):""})).filter(_=>_.url),b=await zt.saveCompanyProfile({company_name:c.company_name,phone:c.phone,whatsapp_number:c.whatsapp_number,email:c.email,website:c.website,address:c.address,description:c.description,theme_color:c.theme_color,logo_data_url:c.logo_data_url||"",product_highlights:c.product_highlights_text.split(`
`).map(_=>_.trim()).filter(Boolean),social_links_items:f}),k=(b==null?void 0:b.company_profile)||{};w(k.logo_url||v),d(_=>({..._,logo_data_url:""})),N(sg(k)),p({digital_card_url:k.digital_card_url||"",catalogue_url:k.catalogue_url||""}),u("Company profile saved.")}catch(f){r((f==null?void 0:f.message)||"Unable to save company profile.")}finally{n(!1)}}if(t)return e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading company profile..."})]});async function y(f,b){if(!b)return;if(!String(b.type||"").startsWith("image/")){r("Custom icon must be an image file.");return}if(b.size>200*1024){r("Custom icon size must be under 200 KB.");return}const k=await new Promise((_,P)=>{const S=new FileReader;S.onload=()=>_(String(S.result||"")),S.onerror=()=>P(new Error("Unable to read icon file.")),S.readAsDataURL(b)});N(_=>_.map(P=>P.id===f?{...P,custom_icon_data:k}:P)),r("")}async function x(f){if(!f)return;const b=String(f.type||"").toLowerCase();if(!new Set(["image/jpeg","image/jpg","image/png","image/svg+xml"]).has(b)){r("Company logo supports only JPG, PNG, SVG.");return}if(f.size>2*1024*1024){r("Company logo size must be under 2 MB.");return}const _=await new Promise((P,S)=>{const F=new FileReader;F.onload=()=>P(String(F.result||"")),F.onerror=()=>S(new Error("Unable to read company logo.")),F.readAsDataURL(f)});d(P=>({...P,logo_data_url:_})),w(_),r("")}return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsx("h3",{className:"mb-0",children:"Company Profile"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:A,disabled:s,children:s?"Saving...":"Save"})]}),e.jsx("p",{className:"text-secondary",children:"Single company master profile used by WhatsApp Automation, Website Catalogue, and Digital Business Card."}),l?e.jsx("div",{className:"alert alert-danger",children:l}):null,o?e.jsx("div",{className:"alert alert-success",children:o}):null,h.digital_card_url||h.catalogue_url?e.jsxs("div",{className:"alert alert-info",children:["Auto created:"," ",h.digital_card_url?e.jsx("a",{href:h.digital_card_url,target:"_blank",rel:"noreferrer",children:"Digital Card"}):null,h.digital_card_url&&h.catalogue_url?" | ":"",h.catalogue_url?e.jsx("a",{href:h.catalogue_url,target:"_blank",rel:"noreferrer",children:"Catalogue"}):null]}):null,e.jsxs("div",{className:"row g-3",children:[[["company_name","Company Name"],["phone","Phone"],["whatsapp_number","WhatsApp Number"],["email","Email"],["website","Website"]].map(([f,b])=>e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:b}),e.jsx("input",{className:"form-control",value:c[f],onChange:k=>d(_=>({..._,[f]:k.target.value}))})]},f)),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Company Logo (JPG / PNG / SVG)"}),e.jsxs("div",{className:"d-flex align-items-center gap-3",children:[e.jsx("div",{className:"rounded border d-flex align-items-center justify-content-center overflow-hidden",style:{width:64,height:64,background:"rgba(255,255,255,0.04)"},children:v?e.jsx("img",{src:v,alt:"Company logo",style:{width:"100%",height:"100%",objectFit:"contain"}}):e.jsx("i",{className:"bi bi-building",style:{color:"#94a3b8",fontSize:22},"aria-hidden":"true"})}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("input",{type:"file",accept:".jpg,.jpeg,.png,.svg,image/jpeg,image/png,image/svg+xml",className:"form-control",onChange:f=>{var b;return x((b=f.target.files)==null?void 0:b[0])}}),e.jsx("div",{className:"small text-secondary mt-1",children:"Supported: JPG, PNG, SVG (max 2 MB)"})]})]})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Theme Color"}),e.jsx("input",{type:"color",className:"form-control form-control-color",value:c.theme_color,onChange:f=>d(b=>({...b,theme_color:f.target.value}))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Address"}),e.jsx("textarea",{className:"form-control",rows:"2",value:c.address,onChange:f=>d(b=>({...b,address:f.target.value}))})]}),e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-control",rows:"5",value:c.description,onChange:f=>d(b=>({...b,description:f.target.value}))})]}),e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("label",{className:"form-label",children:"Product Highlights (one per line)"}),e.jsx("textarea",{className:"form-control",rows:"5",value:c.product_highlights_text,onChange:f=>d(b=>({...b,product_highlights_text:f.target.value}))})]}),e.jsxs("div",{className:"col-12",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("label",{className:"form-label mb-0",children:"Social Links"}),e.jsxs("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>N(f=>[...f,Ok()]),children:[e.jsx("i",{className:"bi bi-plus-lg me-1","aria-hidden":"true"}),"Add"]})]}),e.jsx("div",{className:"d-flex flex-column gap-2",children:g.length?g.map(f=>e.jsx("div",{className:"card p-2",children:e.jsxs("div",{className:"row g-2 align-items-end",children:[e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("label",{className:"form-label small",children:"Type"}),e.jsxs("select",{className:"form-select form-select-sm",value:f.type,onChange:b=>{const k=b.target.value;N(_=>_.map(P=>P.id===f.id?{...P,type:k}:P))},children:[e.jsx("option",{value:"preset",children:"Preset Icon"}),e.jsx("option",{value:"custom",children:"Custom Icon"})]})]}),f.type==="preset"?e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small",children:"Icon"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("div",{className:"d-inline-flex align-items-center justify-content-center rounded border",style:{width:34,height:34,color:"#22c55e",background:"rgba(34,197,94,0.08)"},title:f.icon,children:e.jsx("i",{className:`bi ${ag(f.icon)}`,"aria-hidden":"true"})}),e.jsx("select",{className:"form-select form-select-sm",value:f.icon,onChange:b=>{const k=b.target.value,_=xd.find(P=>P.value===k);N(P=>P.map(S=>S.id===f.id?{...S,icon:k,label:S.label||(_==null?void 0:_.label)||k}:S))},children:xd.map(b=>e.jsx("option",{value:b.value,children:b.label},b.value))})]})]}):e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small",children:"Custom Icon Upload"}),e.jsx("input",{type:"file",accept:"image/*",className:"form-control form-control-sm",onChange:b=>{var k;return y(f.id,(k=b.target.files)==null?void 0:k[0])}})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("label",{className:"form-label small",children:"Label"}),e.jsx("input",{className:"form-control form-control-sm",value:f.label,onChange:b=>N(k=>k.map(_=>_.id===f.id?{..._,label:b.target.value}:_)),placeholder:"Instagram"})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small",children:"URL"}),e.jsx("input",{className:"form-control form-control-sm",value:f.url,onChange:b=>N(k=>k.map(_=>_.id===f.id?{..._,url:b.target.value}:_)),placeholder:"https://..."})]}),e.jsxs("div",{className:"col-8 col-md-1",children:[e.jsx("label",{className:"form-label small",children:"Size"}),e.jsx("input",{type:"number",min:"12",max:"64",className:"form-control form-control-sm",value:f.icon_size,onChange:b=>N(k=>k.map(_=>_.id===f.id?{..._,icon_size:Number(b.target.value||20)}:_))})]}),e.jsx("div",{className:"col-4 col-md-1 d-grid",children:e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>N(b=>b.filter(k=>k.id!==f.id)),title:"Remove",children:e.jsx("i",{className:"bi bi-trash","aria-hidden":"true"})})}),f.type==="custom"&&f.custom_icon_data?e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"small text-secondary d-flex align-items-center gap-2",children:[e.jsx("span",{children:"Preview:"}),e.jsx("img",{src:f.custom_icon_data,alt:f.label||"custom icon",style:{width:`${f.icon_size}px`,height:`${f.icon_size}px`,objectFit:"contain",borderRadius:"4px"}})]})}):f.type==="preset"?e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"small text-secondary d-flex align-items-center gap-2",children:[e.jsx("span",{children:"Preview:"}),e.jsx("i",{className:`bi ${ag(f.icon)}`,style:{color:"#22c55e",fontSize:`${Math.max(14,Math.min(28,f.icon_size))}px`},"aria-hidden":"true"}),e.jsx("span",{children:f.label||f.icon})]})}):null]})},f.id)):e.jsxs("div",{className:"text-secondary small",children:["No social links added. Click ",e.jsx("strong",{children:"Add"})," to create one."]})}),e.jsx("div",{className:"small text-secondary mt-2",children:"Add multiple links (Instagram, Facebook, etc.). Custom icon uploads are stored in profile JSON and rendered on Digital Card."})]})]})]})}function Ik({subscriptions:t=[]}){const[a,s]=i.useState(!0),[n,l]=i.useState(!1),[r,o]=i.useState(!1),[u,c]=i.useState(""),[d,h]=i.useState(""),[p,g]=i.useState({auto_reply_enabled:!0,welcome_message:""}),[N,v]=i.useState([]),[w,A]=i.useState({id:null,keyword:"",reply_message:"",is_default:!1}),[y,x]=i.useState("Hi"),[f,b]=i.useState(""),[k,_]=i.useState([]);async function P(){s(!0),c("");try{const[C,z]=await Promise.all([zt.getSettings(),zt.getRules()]);g((C==null?void 0:C.settings)||{auto_reply_enabled:!0,welcome_message:""}),v((z==null?void 0:z.rules)||[]),s(!1)}catch(C){c((C==null?void 0:C.message)||"Unable to load WhatsApp automation."),s(!1)}}i.useEffect(()=>{P()},[]),i.useEffect(()=>{let C=!0;async function z(){try{const M=await U("/api/dashboard/summary");if(!C)return;_(Array.isArray(M==null?void 0:M.products)?M.products:[])}catch{C&&_([])}}return z(),()=>{C=!1}},[]);async function S(){l(!0),c(""),h("");try{const C=await zt.saveSettings(p);g((C==null?void 0:C.settings)||p),h("Settings saved.")}catch(C){c((C==null?void 0:C.message)||"Unable to save settings.")}finally{l(!1)}}async function F(){o(!0),c(""),h("");try{await zt.saveRule(w),A({id:null,keyword:"",reply_message:"",is_default:!1});const C=await zt.getRules();v((C==null?void 0:C.rules)||[]),h("Rule saved.")}catch(C){c((C==null?void 0:C.message)||"Unable to save rule.")}finally{o(!1)}}async function L(C){try{await zt.deleteRule(C),v(z=>z.filter(M=>M.id!==C))}catch(z){c((z==null?void 0:z.message)||"Unable to delete rule.")}}async function Q(){try{const C=await zt.previewReply({message:y,is_first_message:!0});b((C==null?void 0:C.reply)||"")}catch(C){c((C==null?void 0:C.message)||"Unable to preview reply.")}}const E=i.useMemo(()=>[...N].sort((C,z)=>(C.sort_order||0)-(z.sort_order||0)),[N]);return a?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading WhatsApp Automation..."})]}):e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h3",{className:"mb-0",children:"Whatsapp Automation"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:S,disabled:n,children:n?"Saving...":"Save Settings"})]}),u?e.jsx("div",{className:"alert alert-danger",children:u}):null,d?e.jsx("div",{className:"alert alert-success",children:d}):null,e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Auto Reply"}),e.jsxs("div",{className:"form-check form-switch mt-2",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:!!p.auto_reply_enabled,onChange:C=>g(z=>({...z,auto_reply_enabled:C.target.checked}))}),e.jsx("label",{className:"form-check-label",children:p.auto_reply_enabled?"Enabled":"Disabled"})]})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label",children:"Welcome Message"}),e.jsx("textarea",{className:"form-control",rows:"5",value:p.welcome_message||"",onChange:C=>g(z=>({...z,welcome_message:C.target.value}))})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label",children:"Automation Preview (Internal Only)"}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("input",{className:"form-control",value:y,onChange:C=>x(C.target.value),placeholder:"Type customer message"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Q,children:"Preview Reply"})]}),f?e.jsx("pre",{className:"mt-2 mb-0 p-2 rounded border",style:{whiteSpace:"pre-wrap"},children:f}):null]})]})]}),e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"mb-3",children:"Keyword Reply Rules"}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Keyword"}),e.jsx("input",{className:"form-control",value:w.keyword,onChange:C=>A(z=>({...z,keyword:C.target.value})),placeholder:"price / support / hello"})]}),e.jsxs("div",{className:"col-12 col-md-8",children:[e.jsx("label",{className:"form-label",children:"Reply Message"}),e.jsx("textarea",{className:"form-control",rows:"2",value:w.reply_message,onChange:C=>A(z=>({...z,reply_message:C.target.value}))})]}),e.jsxs("div",{className:"col-12 d-flex align-items-center gap-3",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:!!w.is_default,onChange:C=>A(z=>({...z,is_default:C.target.checked})),id:"waRuleDefault"}),e.jsx("label",{className:"form-check-label",htmlFor:"waRuleDefault",children:"Set as default fallback rule"})]}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:F,disabled:r,children:r?"Saving...":w.id?"Update Rule":"Add Rule"}),w.id?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>A({id:null,keyword:"",reply_message:"",is_default:!1}),children:"Cancel Edit"}):null]})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"20%"},children:"Keyword"}),e.jsx("th",{style:{width:"56%"},children:"Reply"}),e.jsx("th",{style:{width:"10%"},children:"Default"}),e.jsx("th",{style:{width:"14%"},children:"Action"})]})}),e.jsx("tbody",{children:E.length?E.map(C=>e.jsxs("tr",{children:[e.jsx("td",{children:C.keyword||"-"}),e.jsx("td",{className:"text-secondary",style:{whiteSpace:"normal",wordBreak:"break-word"},children:C.reply_message}),e.jsx("td",{children:C.is_default?e.jsx("span",{className:"badge bg-success",children:"Yes"}):e.jsx("span",{className:"badge bg-secondary",children:"No"})}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-1 justify-content-start flex-nowrap",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>A({id:C.id,keyword:C.keyword||"",reply_message:C.reply_message||"",is_default:!!C.is_default}),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>L(C.id),children:"Delete"})]})})]},C.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-secondary",children:"No rules added yet."})})})]})})]}),e.jsx(Ki,{products:k,subscriptions:t,currentProductKey:"whatsapp-automation"})]})}const ng={id:null,title:"",price:"",description:"",category:"",order_button_enabled:!0,is_active:!0,sort_order:0},Nl=10;function Fk(){const[t,a]=i.useState(!0),[s,n]=i.useState(!1),[l,r]=i.useState(""),[o,u]=i.useState([]),[c,d]=i.useState(null),[h,p]=i.useState(null),[g,N]=i.useState({about_title:"About Us",about_content:"",services_title:"Services",services_content:"",contact_title:"Contact",contact_note:"",is_active:!0}),[v,w]=i.useState(ng),[A,y]=i.useState(""),[x,f]=i.useState(1);async function b(){a(!0);try{const[E,C,z]=await Promise.all([zt.getCatalogueProducts(),zt.getCompanyProfile(),zt.getCataloguePage()]);u((E==null?void 0:E.products)||[]),d((C==null?void 0:C.company_profile)||null);const M=(z==null?void 0:z.catalogue_page)||null;p(M),M&&N({about_title:M.about_title||"About Us",about_content:M.about_content||"",services_title:M.services_title||"Services",services_content:M.services_content||"",contact_title:M.contact_title||"Contact",contact_note:M.contact_note||"",is_active:M.is_active!==!1}),a(!1)}catch(E){r((E==null?void 0:E.message)||"Unable to load catalogue."),a(!1)}}async function k(){n(!0),r("");try{const E=await zt.saveCataloguePage(g);p((E==null?void 0:E.catalogue_page)||null),await b()}catch(E){r((E==null?void 0:E.message)||"Unable to save catalogue sections.")}finally{n(!1)}}i.useEffect(()=>{b()},[]),i.useEffect(()=>{f(1)},[A]);async function _(){var E;n(!0),r("");try{await zt.saveCatalogueProduct(v),w(ng),await b()}catch(C){r(((E=C==null?void 0:C.data)==null?void 0:E.message)||(C==null?void 0:C.message)||"Unable to save catalogue product.")}finally{n(!1)}}async function P(E){try{await zt.deleteCatalogueProduct(E),u(C=>C.filter(z=>z.id!==E))}catch(C){r((C==null?void 0:C.message)||"Unable to delete catalogue product.")}}const S=i.useMemo(()=>{const E=A.trim().toLowerCase();return E?o.filter(C=>[C.title,C.category,C.price,C.description].filter(Boolean).some(z=>String(z).toLowerCase().includes(E))):o},[o,A]),F=Math.max(1,Math.ceil(S.length/Nl)),L=Math.min(x,F),Q=S.slice((L-1)*Nl,L*Nl);return t?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading catalogue..."})]}):e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsx("h3",{className:"mb-0",children:"Website Catalogue"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:_,disabled:s,children:s?"Saving...":v.id?"Update Product":"Add Product"})]}),e.jsxs("div",{className:"text-secondary mb-3",children:["Company Profile linked: ",e.jsx("strong",{children:(c==null?void 0:c.company_name)||"Not set"})]}),c!=null&&c.catalogue_url?e.jsxs("div",{className:"mb-3",children:[e.jsx("a",{className:"btn btn-outline-light btn-sm",href:c.catalogue_url,target:"_blank",rel:"noreferrer",children:"Open Public Catalogue"}),c!=null&&c.digital_card_url?e.jsx("a",{className:"btn btn-outline-light btn-sm ms-2",href:c.digital_card_url,target:"_blank",rel:"noreferrer",children:"Open Digital Card"}):null]}):null,l?e.jsx("div",{className:"alert alert-danger",children:l}):null,e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h4",{className:"mb-0",children:"Catalogue Sections"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:k,disabled:s,children:s?"Saving...":"Save Sections"})]}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"About Section Title"}),e.jsx("input",{className:"form-control",value:g.about_title,onChange:E=>N(C=>({...C,about_title:E.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Services Section Title"}),e.jsx("input",{className:"form-control",value:g.services_title,onChange:E=>N(C=>({...C,services_title:E.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Contact Section Title"}),e.jsx("input",{className:"form-control",value:g.contact_title,onChange:E=>N(C=>({...C,contact_title:E.target.value}))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"About Us Content"}),e.jsx("textarea",{className:"form-control",rows:"3",value:g.about_content,onChange:E=>N(C=>({...C,about_content:E.target.value})),placeholder:"Write about your business..."})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Services (one per line)"}),e.jsx("textarea",{className:"form-control",rows:"4",value:g.services_content,onChange:E=>N(C=>({...C,services_content:E.target.value})),placeholder:`Website Design
WhatsApp Marketing
Support Services`})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Contact Section Intro / Note"}),e.jsx("textarea",{className:"form-control",rows:"2",value:g.contact_note,onChange:E=>N(C=>({...C,contact_note:E.target.value})),placeholder:"Contact information below is auto-loaded from Company Profile."})]}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"small text-secondary",children:["Contact info auto-loads from Company Profile:"," ",(c==null?void 0:c.phone)||"-"," / ",(c==null?void 0:c.whatsapp_number)||"-"," / ",(c==null?void 0:c.email)||"-"]})})]})]}),e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Title"}),e.jsx("input",{className:"form-control",value:v.title,onChange:E=>w(C=>({...C,title:E.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Price"}),e.jsx("input",{className:"form-control",value:v.price,onChange:E=>w(C=>({...C,price:E.target.value})),placeholder:"INR 999"})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Category"}),e.jsx("input",{className:"form-control",value:v.category,onChange:E=>w(C=>({...C,category:E.target.value}))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-control",rows:"3",value:v.description,onChange:E=>w(C=>({...C,description:E.target.value}))})]}),e.jsxs("div",{className:"col-12 d-flex flex-wrap gap-3",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:!!v.order_button_enabled,onChange:E=>w(C=>({...C,order_button_enabled:E.target.checked})),id:"waCatOrderBtn"}),e.jsx("label",{className:"form-check-label",htmlFor:"waCatOrderBtn",children:"Order Button Enabled"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",checked:!!v.is_active,onChange:E=>w(C=>({...C,is_active:E.target.checked})),id:"waCatActive"}),e.jsx("label",{className:"form-check-label",htmlFor:"waCatActive",children:"Active"})]}),e.jsxs("div",{className:"small text-secondary ms-auto",children:["Max entries: ",e.jsx("strong",{children:"50"})," | Current: ",e.jsx("strong",{children:o.length})]})]})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3",children:[e.jsx("h4",{className:"mb-0",children:"Catalogue Products"}),e.jsxs("label",{className:"table-search mb-0",htmlFor:"wa-catalogue-search",children:[e.jsx("i",{className:"bi bi-search","aria-hidden":"true"}),e.jsx("input",{id:"wa-catalogue-search",type:"search",placeholder:"Search products",value:A,onChange:E=>y(E.target.value)})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Price"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"text-end",children:"Action"})]})}),e.jsx("tbody",{children:Q.length?Q.map(E=>e.jsxs("tr",{children:[e.jsx("td",{children:E.title}),e.jsx("td",{children:E.category||"-"}),e.jsx("td",{children:E.price||"-"}),e.jsx("td",{children:E.is_active?e.jsx("span",{className:"badge bg-success",children:"Active"}):e.jsx("span",{className:"badge bg-secondary",children:"Disabled"})}),e.jsxs("td",{className:"text-end d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>w({id:E.id,title:E.title||"",price:E.price||"",description:E.description||"",category:E.category||"",order_button_enabled:!!E.order_button_enabled,is_active:!!E.is_active,sort_order:Number(E.sort_order||0)}),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>P(E.id),children:"Delete"})]})]},E.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"text-secondary",children:"No catalogue products found."})})})]})}),e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mt-2",children:[e.jsxs("small",{className:"text-secondary",children:["Showing ",Q.length?(L-1)*Nl+1:0," to ",(L-1)*Nl+Q.length," of ",S.length]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",disabled:L<=1,onClick:()=>f(E=>Math.max(1,E-1)),children:"Prev"}),e.jsxs("span",{className:"btn btn-outline-light btn-sm disabled",children:["Page ",L," / ",F]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",disabled:L>=F,onClick:()=>f(E=>Math.min(F,E+1)),children:"Next"})]})]})]})]})}const Xs=10,lg=ls,zk=Array.from(new Set(ls.map(t=>t.code))).sort((t,a)=>a.length-t.length);function rg(t){const a=String(t||"").trim();if(!a)return{code:"+91",local:""};const s=a.replace(/\s+/g,""),n=zk.find(l=>s.startsWith(l));return n?{code:n,local:s.slice(n.length)}:{code:"+91",local:s.replace(/^\+/,"")}}function gc(t,a){const s=String(t||"+91").trim()||"+91",n=String(a||"").replace(/[^\d]/g,"");return n?`${s}${n}`:""}function en(t={}){const a=rg(t.phone||""),s=rg(t.whatsapp_number||"");return{id:null,public_slug:t.public_slug||"",card_title:t.card_title||"",person_name:t.person_name||"",role_title:t.role_title||"",phone:t.phone||"",phone_country_code:a.code,phone_local:a.local,whatsapp_number:t.whatsapp_number||"",whatsapp_country_code:s.code,whatsapp_local:s.local,email:t.email||"",website:t.website||"",address:t.address||"",description:t.description||"",theme_color:t.theme_color||"#22c55e",template_style:t.template_style||"design1",custom_domain:t.custom_domain||"",custom_domain_active:!!t.custom_domain_active,logo_image_data:t.logo_image_data||"",hero_banner_image_data:t.hero_banner_image_data||"",logo_size:Number(t.logo_size||96),icon_size_pt:Number(t.icon_size_pt||14),font_size_pt:Number(t.font_size_pt||16),social_links_items:Array.isArray(t.social_links_items)?t.social_links_items:[],is_active:t.is_active!==!1,sort_order:Number(t.sort_order||0)}}function Bk(t){return(t==null?void 0:t.card_title)||(t==null?void 0:t.person_name)||(t==null?void 0:t.public_slug)||"Digital Card"}function Wk(t){const a=String(t||"").trim().toLowerCase();if(!a)return[];const n=(typeof window<"u"?window.location.host:"your-app-domain.com").split(":")[0],l=a.split(".");return l.length>2||a.startsWith("www.")?[{type:"CNAME",host:l[0],value:n,ttl:"Auto"}]:[{type:"A",host:"@",value:"YOUR_SERVER_PUBLIC_IP",ttl:"Auto"},{type:"CNAME",host:"www",value:a,ttl:"Auto"}]}function xc(t,a=180){const s=String(t||"").trim();return s?`https://quickchart.io/qr?format=png&size=${a}&text=${encodeURIComponent(s)}`:""}async function Vk(t){return new Promise((a,s)=>{const n=new FileReader;n.onload=()=>a(String(n.result||"")),n.onerror=()=>s(new Error("Unable to read image file.")),n.readAsDataURL(t)})}function Gk({form:t,company:a}){const s=t.theme_color||(a==null?void 0:a.theme_color)||"#22c55e",n=Array.isArray(t.social_links_items)?t.social_links_items.slice(0,5):[],l=t.template_style||"design1",r=Math.max(8,Number(t.icon_size_pt||14)),o=Math.max(10,Number(t.font_size_pt||16)),u=l==="design2"?{background:"#0f172a",border:`1px solid ${s}`}:l==="design3"?{background:"linear-gradient(180deg,#08111f 0%,#111827 100%)",border:"1px solid rgba(255,255,255,0.12)"}:{};return e.jsxs("div",{className:"card p-0 overflow-hidden",style:u,children:[e.jsx("div",{style:{height:110,background:t.hero_banner_image_data?`center/cover no-repeat url(${t.hero_banner_image_data})`:`linear-gradient(135deg, ${s} 0%, #0f172a 100%)`,borderBottom:"1px solid rgba(255,255,255,0.08)"}}),e.jsxs("div",{className:"p-3 position-relative",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center border border-2",style:{width:88,height:88,marginTop:-54,background:"#0b162b",borderColor:s,overflow:"hidden"},children:t.logo_image_data?e.jsx("img",{src:t.logo_image_data,alt:"Logo",style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx("span",{style:{color:s,fontWeight:700,fontSize:28},children:(t.card_title||t.person_name||(a==null?void 0:a.company_name)||"C").slice(0,1).toUpperCase()})}),e.jsx("h5",{className:"mt-3 mb-1",children:t.person_name||(a==null?void 0:a.company_name)||"Your Name"}),e.jsx("div",{className:"text-secondary small mb-2",style:{fontSize:`${Math.max(10,o-2)}pt`},children:t.role_title||"Business / Professional"}),e.jsx("div",{className:"fw-semibold mb-1",style:{fontSize:`${Math.max(12,o)}pt`},children:t.card_title||(a==null?void 0:a.company_name)||"Company Name"}),e.jsx("div",{className:"small mb-2",children:e.jsx("span",{className:"badge",style:{background:s,color:"#071226"},children:l.replace("design","Design ")})}),e.jsx("p",{className:"text-secondary small mb-3",style:{fontSize:`${Math.max(9,o-3)}pt`},children:t.description||(a==null?void 0:a.description)||"Digital business card preview"}),e.jsxs("div",{className:"d-flex flex-wrap gap-2 mb-3",children:[t.phone?e.jsx("a",{className:"btn btn-sm btn-primary",href:`tel:${t.phone}`,children:"Call"}):null,t.whatsapp_number?e.jsx("a",{className:"btn btn-sm btn-outline-light",href:`https://wa.me/${String(t.whatsapp_number).replace(/\+/g,"")}`,target:"_blank",rel:"noreferrer",children:"WhatsApp"}):null,t.website?e.jsx("a",{className:"btn btn-sm btn-outline-light",href:t.website,target:"_blank",rel:"noreferrer",children:"Website"}):null]}),e.jsxs("div",{className:"d-flex flex-column gap-2 small",style:{fontSize:`${Math.max(9,o-2)}pt`},children:[e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-telephone me-2 text-success",style:{fontSize:`${r}pt`}}),t.phone||"-"]}),e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-whatsapp me-2 text-success",style:{fontSize:`${r}pt`}}),t.whatsapp_number||"-"]}),e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-envelope me-2 text-success",style:{fontSize:`${r}pt`}}),t.email||"-"]}),e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-globe me-2 text-success",style:{fontSize:`${r}pt`}}),t.website||"-"]}),e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-geo-alt me-2 text-success",style:{fontSize:`${r}pt`}}),t.address||"-"]})]}),n.length?e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:n.map((c,d)=>e.jsx("span",{className:"badge bg-dark-subtle text-light border",children:c.label||c.icon||"Link"},`${c.icon}-${d}`))}):null]})]})}function Hk(){const[t,a]=i.useState(!0),[s,n]=i.useState(!1),[l,r]=i.useState(null),[o,u]=i.useState(""),[c,d]=i.useState(""),[h,p]=i.useState(null),[g,N]=i.useState({}),[v,w]=i.useState(null),[A,y]=i.useState([]),[x,f]=i.useState({page:1,page_size:Xs,total_items:0,total_pages:1}),[b,k]=i.useState(""),[_,P]=i.useState(""),[S,F]=i.useState(en()),[L,Q]=i.useState(null),[E,C]=i.useState(!1);async function z({page:T=1,q:Z=_}={}){const se=await zt.getDigitalCards({page:T,pageSize:Xs,q:Z});return y(Array.isArray(se==null?void 0:se.items)?se.items:[]),N((se==null?void 0:se.default_prefill)||{}),w((se==null?void 0:se.limit)||null),f((se==null?void 0:se.pagination)||{page:T,page_size:Xs,total_items:0,total_pages:1}),se}i.useEffect(()=>{let T=!0;return(async()=>{try{const[Z,se]=await Promise.all([zt.getCompanyProfile(),zt.getDigitalCards({page:1,pageSize:Xs})]);if(!T)return;const be=(Z==null?void 0:Z.company_profile)||null;p(be);const ne=Array.isArray(se==null?void 0:se.items)?se.items:[],ae=(se==null?void 0:se.default_prefill)||{};y(ne),N(ae),w((se==null?void 0:se.limit)||null),f((se==null?void 0:se.pagination)||{page:1,page_size:Xs,total_items:ne.length,total_pages:1}),F(ne[0]?en(ne[0]):en(ae)),a(!1)}catch(Z){if(!T)return;u((Z==null?void 0:Z.message)||"Unable to load digital cards."),a(!1)}})(),()=>{T=!1}},[]),i.useEffect(()=>{const T=setTimeout(()=>P(b.trim()),350);return()=>clearTimeout(T)},[b]),i.useEffect(()=>{t||z({page:1,q:_}).catch(T=>u((T==null?void 0:T.message)||"Unable to load digital cards."))},[_]);const M=i.useMemo(()=>v?!!v.can_create:!0,[v]);function R(T,Z){F(se=>({...se,[T]:Z}))}function W(T,Z,se){F(be=>{const ne={...be,[Z]:se},ae=T==="phone"?ne.phone_country_code:ne.whatsapp_country_code,X=T==="phone"?ne.phone_local:ne.whatsapp_local,ke=gc(ae,X);return T==="phone"&&(ne.phone=ke),T==="whatsapp"&&(ne.whatsapp_number=ke),ne})}async function D(T,Z,se){if(Z){if(!String(Z.type||"").startsWith("image/")){u("Please select an image file.");return}if(Z.size>se*1024){u(`Image size must be under ${se} KB.`);return}try{const be=await Vk(Z);R(T,be),u("")}catch(be){u((be==null?void 0:be.message)||"Unable to read selected image.")}}}async function te(){var T,Z;n(!0),u(""),d("");try{const se={...S,phone:gc(S.phone_country_code,S.phone_local),whatsapp_number:gc(S.whatsapp_country_code,S.whatsapp_local),social_links_items:Array.isArray(S.social_links_items)?S.social_links_items:g.social_links_items||[]},be=await zt.saveDigitalCard(se),ne=be==null?void 0:be.item;ne&&F(en(ne)),be!=null&&be.limit&&w(be.limit),await z({page:x.page||1,q:_}),d(S.id?"Digital card updated.":"Digital card created.")}catch(se){(se==null?void 0:se.status)===403&&((T=se==null?void 0:se.data)==null?void 0:T.error)==="addon_required"&&w(se.data.limit||null),u(((Z=se==null?void 0:se.data)==null?void 0:Z.message)||(se==null?void 0:se.message)||"Unable to save digital card.")}finally{n(!1)}}i.useEffect(()=>{const T=String(S.public_slug||"").trim();if(!T){Q(null),C(!1);return}let Z=!1;C(!0);const se=setTimeout(async()=>{try{const be=await zt.checkDigitalCardSlug(T,S.id);if(Z)return;Q(be||null)}catch{if(Z)return;Q(null)}finally{Z||C(!1)}},300);return()=>{Z=!0,clearTimeout(se)}},[S.public_slug,S.id]);async function H(T){if(T!=null&&T.id&&window.confirm(`Delete digital card "${Bk(T)}"?`)){r(T.id),u(""),d("");try{const Z=await zt.deleteDigitalCard(T.id);Z!=null&&Z.limit&&w(Z.limit);const se=A.length===1&&(x.page||1)>1?(x.page||1)-1:x.page||1;await z({page:se,q:_}),F(en(g)),d("Digital card deleted.")}catch(Z){u((Z==null?void 0:Z.message)||"Unable to delete digital card.")}finally{r(null)}}}function O(T){F(en(T)),u(""),d(""),window.scrollTo({top:0,behavior:"smooth"})}function V(){if(!M){u("Extra digital card requires add-on user purchase.");return}F(en(g)),d(""),u("")}if(t)return e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading digital card..."})]});const re=S.public_slug?`/card/${S.public_slug}/`:(h==null?void 0:h.digital_card_url)||"",Y=S.custom_domain?`https://${S.custom_domain}/`:"",ce=Wk(S.custom_domain),ie=x.page||1,ee=x.total_pages||1;return e.jsxs("div",{className:"d-flex flex-column gap-3 p-4",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Digital Business Card"}),e.jsx("p",{className:"text-secondary mb-0",children:"Left side details edit pannunga, right side live preview auto update ."})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsxs("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:V,children:[e.jsx("i",{className:"bi bi-plus-lg me-1"}),"New Card"]}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",disabled:s,onClick:te,children:s?"Saving...":S.id?"Update Card":"Create Card"})]})]}),o?e.jsx("div",{className:"alert alert-danger mb-0",children:o}):null,c?e.jsx("div",{className:"alert alert-success mb-0",children:c}):null,v?e.jsx("div",{className:`alert mb-0 ${v.can_create?"alert-info":"alert-warning"}`,children:e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Digital Card Limit:"})," ",v.used_total,"/",v.allowed_total," used"," ","(",v.included_cards," base + ",v.addon_cards," add-on)",v.can_create?"":" | Extra user digital card create panna add-on user purchase pannunga."]}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:"/my-account/billing/",children:"Manage Add-ons"})]})}):null,e.jsxs("div",{className:"row g-3 align-items-start",children:[e.jsx("div",{className:"col-12 col-xl-7",children:e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-2",children:[e.jsx("h4",{className:"mb-0",children:"Card Details"}),e.jsxs("div",{className:"d-flex gap-2",children:[re?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:re,target:"_blank",rel:"noreferrer",children:"View"}):null,Y?e.jsx("a",{className:"btn btn-outline-success btn-sm",href:Y,target:"_blank",rel:"noreferrer",children:"Custom URL"}):null,e.jsx("a",{className:"btn btn-outline-light btn-sm",href:"/app/whatsapp-automation/dashboard/company-profile",children:"Company Profile"})]})]}),e.jsx("p",{className:"text-secondary small",children:"Default values company profile-la irundhu varum. Here modify pannina individual card-ku save ."}),e.jsxs("div",{className:"row g-3",children:[[["card_title","Card / Company Title"],["person_name","Person Name"],["role_title","Role / Designation"],["email","Email"],["website","Website"],["custom_domain","Custom Domain (optional)"]].map(([T,Z])=>e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:Z}),e.jsx("input",{className:"form-control",value:S[T]||"",onChange:se=>R(T,se.target.value),placeholder:g[T]||""})]},T)),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",style:{maxWidth:220},value:S.phone_country_code||"+91",onChange:T=>W("phone","phone_country_code",T.target.value),children:lg.map(T=>e.jsxs("option",{value:T.code,children:[T.label," ",T.code]},`${T.code}-${T.label}`))}),e.jsx("input",{className:"form-control",value:S.phone_local||"",onChange:T=>W("phone","phone_local",T.target.value),placeholder:"Mobile number",inputMode:"numeric"})]})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"WhatsApp Number"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",style:{maxWidth:220},value:S.whatsapp_country_code||"+91",onChange:T=>W("whatsapp","whatsapp_country_code",T.target.value),children:lg.map(T=>e.jsxs("option",{value:T.code,children:[T.label," ",T.code]},`wa-${T.code}-${T.label}`))}),e.jsx("input",{className:"form-control",value:S.whatsapp_local||"",onChange:T=>W("whatsapp","whatsapp_local",T.target.value),placeholder:"WhatsApp number",inputMode:"numeric"})]})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Public Slug"}),e.jsx("input",{className:"form-control",value:S.public_slug||"",onChange:T=>R("public_slug",T.target.value),placeholder:g.public_slug||"your-card-slug"}),e.jsxs("div",{className:"d-flex align-items-center gap-2 small mt-1",children:[E?e.jsx("span",{className:"text-secondary",children:"Checking..."}):null,!E&&(L!=null&&L.normalized_slug)?e.jsxs("span",{className:L.available?"text-success":"text-warning",children:[L.available?"Available":"Not available",L.normalized_slug!==String(S.public_slug||"").trim()?` | slugify: ${L.normalized_slug}`:""]}):null,!E&&L&&!L.available&&L.suggested_slug?e.jsxs("button",{type:"button",className:"btn btn-outline-light btn-sm py-0 px-2",onClick:()=>R("public_slug",L.suggested_slug),children:["Use ",L.suggested_slug]}):null]})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Theme Color"}),e.jsx("input",{type:"color",className:"form-control form-control-color",value:S.theme_color||"#22c55e",onChange:T=>R("theme_color",T.target.value)})]}),e.jsx("div",{className:"col-12 col-md-8"}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Card Template"}),e.jsxs("select",{className:"form-select",value:S.template_style||"design1",onChange:T=>R("template_style",T.target.value),children:[e.jsx("option",{value:"design1",children:"Design 1"}),e.jsx("option",{value:"design2",children:"Design 2"}),e.jsx("option",{value:"design3",children:"Design 3"})]})]}),e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"form-check mt-4",children:[e.jsx("input",{className:"form-check-input",id:"wa-card-custom-domain-active",type:"checkbox",checked:!!S.custom_domain_active,onChange:T=>R("custom_domain_active",T.target.checked),disabled:!S.custom_domain}),e.jsx("label",{className:"form-check-label",htmlFor:"wa-card-custom-domain-active",children:"Enable custom domain mapping"})]})}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Icon Size (pt)"}),e.jsx("input",{type:"number",min:"8",max:"36",className:"form-control",value:S.icon_size_pt||14,onChange:T=>R("icon_size_pt",T.target.value)})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Font Size (pt)"}),e.jsx("input",{type:"number",min:"10",max:"36",className:"form-control",value:S.font_size_pt||16,onChange:T=>R("font_size_pt",T.target.value)})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Logo Size (px)"}),e.jsx("input",{type:"number",min:"48",max:"180",className:"form-control",value:S.logo_size||96,onChange:T=>R("logo_size",Number(T.target.value||96))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Address"}),e.jsx("textarea",{className:"form-control",rows:"2",value:S.address||"",onChange:T=>R("address",T.target.value)})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Description"}),e.jsx("textarea",{className:"form-control",rows:"3",value:S.description||"",onChange:T=>R("description",T.target.value)})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Profile Logo"}),e.jsx("input",{type:"file",accept:"image/*",className:"form-control",onChange:T=>{var Z;return D("logo_image_data",(Z=T.target.files)==null?void 0:Z[0],500)}}),e.jsx("div",{className:"d-flex gap-2 mt-2",children:S.logo_image_data?e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>R("logo_image_data",""),children:"Remove Logo"}):null})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Hero Banner (small)"}),e.jsx("input",{type:"file",accept:"image/*",className:"form-control",onChange:T=>{var Z;return D("hero_banner_image_data",(Z=T.target.files)==null?void 0:Z[0],1500)}}),e.jsx("div",{className:"d-flex gap-2 mt-2",children:S.hero_banner_image_data?e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>R("hero_banner_image_data",""),children:"Remove Banner"}):null})]}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",id:"wa-card-active",type:"checkbox",checked:!!S.is_active,onChange:T=>R("is_active",T.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"wa-card-active",children:"Active card"})]})}),S.custom_domain?e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 mb-2",children:[e.jsx("h6",{className:"mb-0",children:"Custom URL Mapping"}),e.jsx("span",{className:`badge ${S.custom_domain_active?"bg-success":"bg-warning text-dark"}`,children:S.custom_domain_active?"Mapped (App-side active)":"Pending Activation"})]}),e.jsxs("div",{className:"small text-secondary mb-2",children:["Domain: ",e.jsx("code",{children:S.custom_domain})," "," Card Path: ",e.jsxs("code",{children:["/card/",S.public_slug||"<slug>","/"]})]}),Y?e.jsxs("div",{className:"small mb-3",children:[e.jsx("strong",{children:"Custom URL:"})," ",e.jsx("a",{href:Y,target:"_blank",rel:"noreferrer",children:Y})]}):null,e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm align-middle mb-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Host"}),e.jsx("th",{children:"Value"}),e.jsx("th",{children:"TTL"})]})}),e.jsx("tbody",{children:ce.map((T,Z)=>e.jsxs("tr",{children:[e.jsx("td",{children:T.type}),e.jsx("td",{children:e.jsx("code",{children:T.host})}),e.jsx("td",{children:e.jsx("code",{children:T.value})}),e.jsx("td",{children:T.ttl})]},`${T.type}-${Z}`))})]})}),e.jsx("div",{className:"small text-secondary",children:"DNS set pannitu reverse proxy / SSL configure pannina custom domain-la same digital card view open ."})]})}):null]})]})}),e.jsx("div",{className:"col-12 col-xl-5",children:e.jsx(Gk,{form:S,company:h})})]}),e.jsxs("div",{className:"p-0",children:[e.jsxs("div",{className:"wz-table-toolbar d-flex flex-wrap align-items-center justify-content-between gap-2 mb-2",children:[e.jsx("h4",{className:"mb-0",children:"Created Cards"}),e.jsxs("label",{className:"table-search wz-table-search mb-0",htmlFor:"wa-digital-card-search",children:[e.jsx("i",{className:"bi bi-search","aria-hidden":"true"}),e.jsx("input",{id:"wa-digital-card-search",type:"search",placeholder:"Search cards",value:b,onChange:T=>k(T.target.value)})]})]}),e.jsx("div",{className:"table-responsive wz-data-table-wrap",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle wz-data-table digital-card-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Person"}),e.jsx("th",{children:"Slug"}),e.jsx("th",{children:"Template"}),e.jsx("th",{children:"Custom URL"}),e.jsx("th",{children:"QR"}),e.jsx("th",{children:"Status"}),e.jsx("th",{className:"table-actions",children:"Action"})]})}),e.jsx("tbody",{children:A.length?A.map(T=>e.jsxs("tr",{children:[e.jsx("td",{children:T.card_title||"-"}),e.jsx("td",{children:T.person_name||"-"}),e.jsx("td",{children:e.jsx("code",{children:T.public_slug})}),e.jsx("td",{children:(T.template_style||"design1").replace("design","Design ")}),e.jsx("td",{children:T.custom_url?e.jsxs("div",{className:"d-flex flex-column gap-1",children:[e.jsx("a",{href:T.custom_url,target:"_blank",rel:"noreferrer",children:T.custom_domain}),e.jsx("small",{className:T.custom_domain_active?"text-success":"text-warning",children:T.custom_domain_active?"Active":"Pending"})]}):e.jsx("span",{className:"text-secondary",children:"-"})}),e.jsx("td",{children:T.public_url?e.jsx("a",{href:xc(T.public_url,240),target:"_blank",rel:"noreferrer",title:"Open QR PNG",className:"d-inline-block",children:e.jsx("img",{src:xc(T.public_url,72),alt:"QR",style:{width:44,height:44,borderRadius:6,border:"1px solid rgba(148,163,184,0.25)",background:"#fff",padding:2}})}):e.jsx("span",{className:"text-secondary",children:"-"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${T.is_active?"bg-success":"bg-secondary"}`,children:T.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"table-actions",children:e.jsxs("div",{className:"d-flex flex-wrap gap-1",children:[e.jsx("a",{className:"btn btn-outline-light btn-sm",href:T.public_url,target:"_blank",rel:"noreferrer",children:"View"}),T.public_url?e.jsx("a",{className:"btn btn-outline-warning btn-sm",href:xc(T.public_url,480),target:"_blank",rel:"noreferrer",children:"QR"}):null,T.custom_url?e.jsx("a",{className:"btn btn-outline-success btn-sm",href:T.custom_url,target:"_blank",rel:"noreferrer",children:"URL"}):null,e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",onClick:()=>O(T),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",disabled:l===T.id,onClick:()=>H(T),children:l===T.id?"Deleting...":"Delete"})]})})]},T.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"text-center text-secondary py-4",children:"No digital cards found."})})})]})}),e.jsxs("div",{className:"wz-table-footer d-flex flex-wrap align-items-center justify-content-between gap-2 mt-2",children:[e.jsxs("small",{className:"text-secondary",children:["Showing ",A.length?(ie-1)*Xs+1:0," to ",(ie-1)*Xs+A.length," of ",x.total_items||0]}),e.jsxs("div",{className:"d-flex gap-2 wz-pagination-inline",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",disabled:ie<=1,onClick:()=>z({page:ie-1,q:_}).catch(T=>u((T==null?void 0:T.message)||"Unable to load digital cards.")),children:"Prev"}),e.jsxs("span",{className:"btn btn-outline-light btn-sm disabled",children:["Page ",ie," / ",ee]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",disabled:ie>=ee,onClick:()=>z({page:ie+1,q:_}).catch(T=>u((T==null?void 0:T.message)||"Unable to load digital cards.")),children:"Next"})]})]})]})]})}class qk extends i.Component{constructor(a){super(a),this.state={hasError:!1,error:null,info:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,s){this.setState({info:s}),console.error("UI crash:",a,s)}render(){var a;if(this.state.hasError){const s=((a=this.state.error)==null?void 0:a.message)||"Unexpected error.";return e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-secondary mb-2",children:s}),e.jsx("p",{className:"text-secondary mb-0",children:"Please refresh the page. If this continues, contact support."})]})}return this.props.children}}const Qk=i.lazy(()=>vb(()=>import("./BusinessAutopilotDashboardPage--Em9cE3t.js"),[])),Cn=i.lazy(()=>vb(()=>import("./BusinessAutopilotModulePage-DiIr4ROS.js"),[])),Br={loading:!0,authenticated:!1,user:null,profile:null,archived:!1,allowAppUsage:!0,allowGamingOttUsage:!0,themePrimary:"",themeSecondary:"",sidebarMenuStyle:"default",freePlanPopup:!1,freePlanExpiry:"",dealer:null,dealerOnboarding:null,onboarding:{enabled:!1,state:"active"},readOnly:!1,subscriptions:[]},Jk="wz_brand_theme_override",ig="wz_brand_theme",Kk="wz_brand_theme_prev";function Yk(t){if(typeof document>"u")return;const a=document.documentElement,s=["--color-primary","--color-primary-hover","--color-accent","--color-highlight","--color-accent-rgb","--color-primary-rgb"];if(!t||!t.primary){s.forEach(c=>a.style.removeProperty(c));return}const n=t.primary,l=t.secondary||n,r=c=>{const d=String(c||"").replace("#","").trim();if(d.length===3){const h=parseInt(d[0]+d[0],16),p=parseInt(d[1]+d[1],16),g=parseInt(d[2]+d[2],16);return`${h}, ${p}, ${g}`}if(d.length===6){const h=parseInt(d.slice(0,2),16),p=parseInt(d.slice(2,4),16),g=parseInt(d.slice(4,6),16);return`${h}, ${p}, ${g}`}return""};a.style.setProperty("--color-primary",n),a.style.setProperty("--color-primary-hover",n),a.style.setProperty("--color-accent",l),a.style.setProperty("--color-highlight",l);const o=r(n),u=r(l);o&&a.style.setProperty("--color-primary-rgb",o),u&&a.style.setProperty("--color-accent-rgb",u)}const Zk=[{label:"Dashboard",path:"/",icon:"bi-speedometer2",productOnly:"storage"},{label:"Dashboard",path:"/",icon:"bi-speedometer2",productOnly:"imposition-software"},{label:"Files",path:"/files",icon:"bi-cloud",productOnly:"storage"},{label:"Inbox",path:"/notifications-inbox",icon:"bi-inbox",productOnly:"storage"},{label:"Users",path:"/users",icon:"bi-people",productOnly:"storage",adminOnly:!0},{label:"Users",path:"/users",icon:"bi-people",productOnly:"imposition-software",adminOnly:!0},{label:"Users",path:"/users",icon:"bi-people",productOnly:"business-autopilot-erp",adminOnly:!0},{label:"Dashboard",path:"/",icon:"bi-speedometer2"},{label:"Inbox",path:"/notifications-inbox",icon:"bi-inbox",productOnly:"worksuite"},{label:"Inbox",path:"/notifications-inbox",icon:"bi-inbox",productOnly:"business-autopilot-erp"},{label:"Inbox",path:"/notifications-inbox",icon:"bi-inbox",productOnly:"whatsapp-automation"},{label:"Inbox",path:"/inbox",icon:"bi-chat-dots",productOnly:"ai-chatbot",allowAgent:!0},{label:"Widgets",path:"/widgets",icon:"bi-code-slash",productOnly:"ai-chatbot",adminOnly:!0},{label:"Leads",path:"/leads",icon:"bi-person-lines-fill",productOnly:"ai-chatbot",adminOnly:!0},{label:"Agents",path:"/agents",icon:"bi-people",productOnly:"ai-chatbot",adminOnly:!0},{label:"History",path:"/history",icon:"bi-clock-history",productOnly:"ai-chatbot",adminOnly:!0},{label:"Chat Settings",path:"/chat-settings",icon:"bi-gear",productOnly:"ai-chatbot",adminOnly:!0},{label:"Live Activity",path:"/activity",icon:"bi-activity",productOnly:"worksuite"},{label:"Work Activity Log",path:"/work-activity",icon:"bi-clock-history",productOnly:"worksuite"},{label:"App Usage",path:"/app-usage",icon:"bi-bar-chart-line",requiresAppUsage:!0,productOnly:"worksuite"},{label:"Gaming / OTT Usage",path:"/gaming-ott",icon:"bi-tv",requiresGamingOttUsage:!0,productOnly:"worksuite"},{label:"Screenshots",path:"/screenshots",icon:"bi-camera",productOnly:"worksuite"},{label:"Employees",path:"/employees",icon:"bi-people",productOnly:"worksuite"},{label:"Company Settings",path:"/company",icon:"bi-building",adminOnly:!0,productOnly:"worksuite"},{label:"Privacy Settings",path:"/privacy",icon:"bi-shield-lock",adminOnly:!0,productOnly:"worksuite"},{label:"SaaS Admin",path:"/saas-admin",icon:"bi-grid-1x2",saasAdminOnly:!0},{label:"Dashboard",path:"/",icon:"bi-speedometer2",productOnly:"whatsapp-automation"},{label:"Company Profile",path:"/dashboard/company-profile",icon:"bi-building",productOnly:"whatsapp-automation"},{label:"Whatsapp Automation",path:"/dashboard/whatsapp-automation",icon:"bi-whatsapp",productOnly:"whatsapp-automation"},{label:"Website Catalogue",path:"/dashboard/catalogue",icon:"bi-grid-3x3-gap",productOnly:"whatsapp-automation"},{label:"Digital Business Card",path:"/dashboard/digital-card",icon:"bi-person-vcard",productOnly:"whatsapp-automation"},{label:"CRM",path:"/crm",icon:"bi-people",productOnly:"business-autopilot-erp",moduleKey:"crm"},{label:"HR",path:"/hrm",icon:"bi-person-badge",productOnly:"business-autopilot-erp",moduleKey:"hrm"},{label:"Projects",path:"/projects",icon:"bi-diagram-3",productOnly:"business-autopilot-erp",moduleKey:"projects"},{label:"Accounts",path:"/accounts",icon:"bi-calculator",productOnly:"business-autopilot-erp",moduleKey:"accounts"},{label:"Ticketing",path:"/ticketing",icon:"bi-life-preserver",productOnly:"business-autopilot-erp",moduleKey:"ticketing"},{label:"Inventory",path:"/stocks",icon:"bi-box-seam",productOnly:"business-autopilot-erp",moduleKey:"stocks"},{label:"Billing",path:"/billing",icon:"bi-credit-card",adminOnly:!0},{label:"Plans",path:"/plans",icon:"bi-clipboard-check",adminOnly:!0},{label:"Profile",path:"/profile",icon:"bi-person",adminOnly:!0}],Xk=[{key:"overview",label:"Overview",path:"/saas-admin",icon:"bi-grid-1x2"},{key:"inbox",label:"Inbox",path:"/saas-admin/inbox",icon:"bi-inbox"},{key:"observability",label:"Observability",path:"/saas-admin/observability",icon:"bi-bar-chart"},{key:"products",label:"Products",path:"/saas-admin",hash:"#products",icon:"bi-boxes"},{key:"organizations",label:"Organizations",path:"/saas-admin/organizations",icon:"bi-building"},{key:"server-monitoring",label:"Server Monitoring",path:"/saas-admin/server-monitoring",icon:"bi-cpu"},{key:"referrals",label:"Referrals",path:"/saas-admin/referrals",icon:"bi-people"},{key:"profile",label:"Profile",path:"/saas-admin/profile",icon:"bi-person"},{key:"dj-admin",label:"Back to DJ Admin",path:"/admin/",icon:"bi-arrow-left",external:!0}],eC=[{label:"Dashboard",path:"/dealer-dashboard",icon:"bi-speedometer2"},{label:"Referrals",path:"/dealer-referrals",icon:"bi-people"},{label:"Payouts",path:"/dealer-payouts",icon:"bi-cash-coin"},{label:"Billing",path:"/dealer-billing",icon:"bi-credit-card"},{label:"Plan",path:"/dealer-plan",icon:"bi-clipboard-check"},{label:"Profile",path:"/dealer-profile",icon:"bi-person"}];function Wr({state:t,productPrefix:a,productSlug:s}){var we,I,me,Me,De,et,Qe,bt,ot,Xt,Wt,Vt,kt,J,_e;const{branding:n}=el(),l=((I=(we=n==null?void 0:n.aliases)==null?void 0:we.ui)==null?void 0:I.monitorLabel)||(n==null?void 0:n.displayName)||"Work Suite",r=ua(),o=bs(),[u,c]=i.useState(""),[d,h]=i.useState(!1),[p,g]=i.useState(!1),[N,v]=i.useState([]),[w,A]=i.useState([]),[y,x]=i.useState(!1),[f,b]=i.useState(!1),[k,_]=i.useState(""),[P,S]=i.useState(""),[F,L]=i.useState(()=>typeof window>"u"?"dark":window.localStorage.getItem("wz_theme")==="light"?"light":"dark"),Q=!!((me=t.user)!=null&&me.is_superuser),E=Q||((Me=t.profile)==null?void 0:Me.role)==="superadmin"||((De=t.profile)==null?void 0:De.role)==="super_admin",C=((et=t.profile)==null?void 0:et.role)==="hr_view",z=((Qe=t.profile)==null?void 0:Qe.role)==="superadmin"||((bt=t.profile)==null?void 0:bt.role)==="company_admin"||Q||C,M=((ot=t.profile)==null?void 0:ot.role)==="dealer",R=((Xt=t.profile)==null?void 0:Xt.role)==="ai_chatbot_agent",W=(t.subscriptions||[]).find(K=>K.product_slug==="ai-chatbot"&&(K.status||"").toLowerCase()==="trialing"),D=W!=null&&W.trial_end?Ai(W.trial_end,""):"",te=t.allowAppUsage!==!1,H=t.allowGamingOttUsage!==!1,O=t.themePrimary,V=t.themeSecondary,re=t.sidebarMenuStyle==="compact"?"compact":"default",Y=t.onboarding||{enabled:!1,state:"active"},ce=r.pathname.startsWith("/saas-admin"),ie=s==="worksuite",ee=s==="business-autopilot-erp",T=s==="whatsapp-automation",Z=s==="imposition-software",se=s==="ai-chatbot"?"AI Chatbot":s==="worksuite"?l:s==="storage"?"Online Storage":s==="whatsapp-automation"?"Whatsapp Automation":s==="business-autopilot-erp"?"Business Autopilot ERP":s==="imposition-software"?"Imposition Software":s==="saas-admin"?"SaaS Admin":"Work Zilla",be=i.useMemo(()=>{const K=s==="worksuite"?"monitor":s;return(t.subscriptions||[]).find(We=>We.product_slug===K)||null},[s,t.subscriptions]),ne=String((be==null?void 0:be.status)||"").toLowerCase(),ae=(be==null?void 0:be.trial_end)||(be==null?void 0:be.ends_at)||"",X=ae?Ai(ae,""):"",ke=!!(be&&be.plan_is_free&&(ne==="active"||ne==="trialing")&&X),Ne=r.pathname.startsWith("/saas-admin/products")||r.hash==="#products",Ye=r.pathname.startsWith("/saas-admin/organizations"),Ke=r.pathname.startsWith("/saas-admin/retention-policy"),mt=r.pathname.startsWith("/saas-admin/storage"),Ie=r.pathname.startsWith("/saas-admin/backup-activity"),Xe=r.pathname.startsWith("/saas-admin/server-monitoring"),nt=r.pathname.startsWith("/saas-admin/referrals"),Ae=r.pathname.startsWith("/saas-admin/profile"),ue=r.pathname.startsWith("/saas-admin/observability"),je=r.pathname.startsWith("/saas-admin/inbox"),Ce=r.pathname.startsWith("/saas-admin/billing"),Le=r.pathname==="/saas-admin"&&!Ne&&!Ye&&!Ke&&!mt&&!Ie&&!Xe&&!nt&&!Ae&&!ue&&!je&&!Ce,Fe=a||"",ye=K=>Fe?K==="/"?Fe:`${Fe}${K.startsWith("/")?K:`/${K}`}`:K,Ze=Fe&&r.pathname.startsWith(Fe)?{...r,pathname:r.pathname.slice(Fe.length)||"/"}:r;function pt(K,We){return We.some(Be=>K===Be?!0:K.startsWith(`${Be}/`))}function ht(K){if(!M)return null;const We=t.dealerOnboarding||"active";return We==="active"?null:We==="pending_payment"?pt(K,["/dealer-billing"])?null:"/dealer-billing":We==="needs_payment"&&pt(K,["/dealer-plan","/dealer-bank-transfer"])?null:"/dealer-plan"}function Ge(K){return M?ht(K):Y.enabled?Y.state==="needs_plan"?pt(K,["/plans"])?null:"/plans":Y.state==="needs_payment"?pt(K,["/bank-transfer","/plans"])?null:"/bank-transfer":Y.state==="pending_payment"?pt(K,["/billing"])?null:"/billing":null:null}i.useEffect(()=>{typeof document<"u"&&(document.documentElement.dataset.theme=F,document.documentElement.style.colorScheme=F),typeof window<"u"&&(window.localStorage.setItem("wz_theme",F),window.__WZ_PRODUCT_SLUG__=s)},[F,s]),i.useEffect(()=>{const K={primary:O,secondary:V},We=typeof window<"u"?window.localStorage.getItem(Jk):null;let Be=K;if(We)if(We==="default")Be=null;else try{Be=JSON.parse(We)}catch{Be=K}if(Be&&Be.primary){const ct=JSON.stringify(Be),lt=typeof window<"u"?window.localStorage.getItem(ig):null;lt&&lt!==ct&&typeof window<"u"&&window.localStorage.setItem(Kk,lt),typeof window<"u"&&window.localStorage.setItem(ig,ct)}Yk(Be)},[O,V]),i.useEffect(()=>{if(!ke){h(!1);return}if(typeof window>"u"){h(!0);return}const K=new Date().toISOString().slice(0,10),We=`wz_free_plan_popup_date:${s||"worksuite"}`;if(window.localStorage.getItem(We)===K){h(!1);return}h(!0),window.localStorage.setItem(We,K)},[s,ke]),i.useEffect(()=>{let K=!0;async function We(){if(!ee){K&&(v([]),A([]),x(!1),b(!1),S(""));return}try{const Be=await U("/api/business-autopilot/modules");if(K){const ct=Array.isArray(Be.enabled_modules)?Be.enabled_modules:(Be.modules||[]).filter(lt=>lt.enabled!==!1);v(ct),A(Be.catalog||ct),x(!!Be.can_manage_modules),b(!!Be.can_manage_users),S("")}}catch{K&&(v([]),A([]),x(!1),b(!1),S("Unable to load modules."))}}return We(),()=>{K=!1}},[ee]);const gt=i.useCallback(async(K,We)=>{if(!(!ee||!K)){_(K),S("");try{const Be=await U("/api/business-autopilot/modules",{method:"POST",body:JSON.stringify({module_slug:K,enabled:!!We})}),ct=Array.isArray(Be.enabled_modules)?Be.enabled_modules:(Be.modules||[]).filter(lt=>lt.enabled!==!1);v(ct),A(Be.catalog||ct),x(!!Be.can_manage_modules),b(!!Be.can_manage_users)}catch(Be){S((Be==null?void 0:Be.message)||"Unable to update module.")}finally{_("")}}},[ee]);i.useEffect(()=>{const K=Ge(r.pathname);K&&K!==r.pathname&&o(K,{replace:!0})},[r.pathname,o,Y.enabled,Y.state,t.dealerOnboarding,M]);const ft=M?((Wt=t.user)==null?void 0:Wt.first_name)||((Vt=t.user)==null?void 0:Vt.username):(J=(kt=t.profile)==null?void 0:kt.organization)==null?void 0:J.name,G=C&&ft?`${ft} (HR)`:ft,Se=Zk.filter(K=>K.superuserOnly?Q:s==="storage"&&K.path==="/"&&K.label==="Dashboard"&&!K.productOnly||s==="whatsapp-automation"&&K.path==="/"&&K.label==="Dashboard"&&!K.productOnly||s==="imposition-software"&&K.path==="/"&&K.label==="Dashboard"&&!K.productOnly||K.productOnly&&K.productOnly!==s?!1:ee&&K.moduleKey?N.some(We=>We.slug===K.moduleKey):K.saasAdminOnly?E:K.adminOnly?z:!(K.allowAgent&&!z&&!R)).filter(K=>K.hidden?!1:C?!new Set(["/employees","/company","/privacy","/billing","/plans","/profile"]).has(K.path):!0),ve=i.useMemo(()=>{if(!ee&&!T)return Se;const K=(()=>{const Be=new Set;return Se.filter(ct=>{const lt=`${ct.kind||"link"}|${ct.path||""}|${ct.label||""}`;return Be.has(lt)?!1:(Be.add(lt),!0)})})(),We=T?new Map([["/",0],["/notifications-inbox",1],["/dashboard/company-profile",3],["/dashboard/whatsapp-automation",4],["/dashboard/catalogue",5],["/dashboard/digital-card",6],["/billing",7],["/plans",8],["/profile",9]]):new Map([["/",0],["/notifications-inbox",1],["/crm",2],["/hrm",3],["/projects",4],["/accounts",5],["/ticketing",6],["/stocks",7],["/users",8],["/billing",9],["/plans",10],["/profile",11]]);return[...K].sort((Be,ct)=>{if(T){const $t=new Set(["/","/notifications-inbox"]);if(Be.kind==="section"&&ct.kind!=="section")return $t.has(ct.path)?1:-1;if(ct.kind==="section"&&Be.kind!=="section")return $t.has(Be.path)?-1:1}else{if(Be.kind==="section"&&ct.kind!=="section")return-1;if(ct.kind==="section"&&Be.kind!=="section")return 1}if(Be.kind==="section"&&ct.kind==="section")return 0;const lt=We.has(Be.path)?We.get(Be.path):99,St=We.has(ct.path)?We.get(ct.path):99;return lt!==St?lt-St:Be.label.localeCompare(ct.label)})},[Se,ee,T]),le=eC.filter(K=>{const We=t.dealerOnboarding||"active";return We==="pending_payment"?K.path==="/dealer-billing":We==="needs_payment"?K.path==="/dealer-plan":!0}),xe=Fe,ge=K=>xe?K==="/"?xe:`${xe}${K.startsWith("/")?K:`/${K}`}`:K;function B(){p&&g(!1)}const he=E?"/saas-admin/billing":"/billing";return e.jsxs("div",{className:`app-shell ${ce?"saas-admin":""} ${p?"sidebar-collapsed":""} ${re==="compact"?"sidebar-style-compact":"sidebar-style-default"}`,children:[e.jsxs("aside",{className:"sidebar",children:[e.jsxs("div",{className:"brand",children:[e.jsx("span",{children:"Work Zilla"}),re!=="compact"?e.jsx("span",{children:se}):null]}),e.jsxs("button",{type:"button",className:"sidebar-toggle",onClick:()=>g(K=>!K),"aria-label":p?"Expand sidebar":"Collapse sidebar",children:[e.jsx("i",{className:`bi ${p?"bi-chevron-right":"bi-chevron-left"}`,"aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:p?"Expand sidebar":"Collapse sidebar"})]}),e.jsx("div",{className:"org",children:G||"Organization"}),e.jsxs("nav",{className:"nav",children:[M?le.map(K=>e.jsxs(Xo,{to:ge(K.path),end:K.path==="/dealer-dashboard",title:K.label,onClick:B,className:({isActive:We})=>`nav-link ${We?"active":""}`,children:[K.icon?e.jsx("i",{className:`bi ${K.icon} nav-icon`,"aria-hidden":"true"}):null,e.jsx("span",{children:K.label})]},K.path)):ce?Xk.map(K=>{const We=K.hash?`${K.path}${K.hash}`:K.path;let Be=!1;return K.key==="overview"?Be=Le:K.key==="inbox"?Be=je:K.key==="observability"?Be=ue:K.key==="products"?Be=Ne:K.key==="organizations"?Be=Ye:K.key==="server-monitoring"?Be=Xe:K.key==="retention-policy"?Be=Ke:K.key==="billing"?Be=Ce:K.key==="referrals"?Be=nt:K.key==="profile"&&(Be=Ae),K.external?e.jsxs("a",{href:K.path,className:"nav-link",title:K.label,onClick:B,children:[K.icon?e.jsx("i",{className:`bi ${K.icon} nav-icon`,"aria-hidden":"true"}):null,e.jsx("span",{children:K.label})]},K.key):e.jsxs(Xo,{to:ge(We),title:K.label,onClick:()=>{B(),K.moduleKey==="ticketing"&&window.dispatchEvent(new Event("wz:ticketing-menu-click"))},className:()=>`nav-link ${Be?"active":""}`,children:[K.icon?e.jsx("i",{className:`bi ${K.icon} nav-icon`,"aria-hidden":"true"}):null,e.jsx("span",{children:K.label})]},K.key)}):ve.map(K=>K.kind==="section"?e.jsx("div",{className:"nav-section-label",children:e.jsx("span",{children:K.label})},`section-${K.label}`):e.jsxs(Xo,{to:ge(K.path),end:K.path==="/",onClick:We=>{if(B(),K.moduleKey==="ticketing"&&window.dispatchEvent(new Event("wz:ticketing-menu-click")),K.requiresAppUsage&&!te){We.preventDefault(),c("Upgrade to next plan to access App Usage.");return}K.requiresGamingOttUsage&&!H&&(We.preventDefault(),c("Upgrade to next plan to access Gaming / OTT Usage."))},title:K.label,className:({isActive:We})=>`nav-link ${We?"active":""} ${K.requiresAppUsage&&!te||K.requiresGamingOttUsage&&!H?"disabled":""}`,"aria-disabled":K.requiresAppUsage&&!te||K.requiresGamingOttUsage&&!H?"true":"false",children:[K.icon?e.jsx("i",{className:`bi ${K.icon} nav-icon`,"aria-hidden":"true"}):null,e.jsx("span",{children:K.label})]},K.path)),e.jsxs("a",{className:"nav-link",href:"/auth/logout/",onClick:B,title:"Logout",children:[e.jsx("i",{className:"bi bi-box-arrow-right nav-icon","aria-hidden":"true"}),e.jsx("span",{children:"Logout"})]}),e.jsxs("div",{className:"theme-toggle theme-toggle-inline",children:[e.jsxs("button",{type:"button",className:`theme-btn theme-btn-light ${F==="light"?"active":""}`,onClick:()=>L("light"),children:[e.jsx("i",{className:"bi bi-sun","aria-hidden":"true"}),e.jsx("span",{children:"Light"})]}),e.jsxs("button",{type:"button",className:`theme-btn theme-btn-dark ${F==="dark"?"active":""}`,onClick:()=>L("dark"),children:[e.jsx("i",{className:"bi bi-moon-stars","aria-hidden":"true"}),e.jsx("span",{children:"Dark"})]})]})]})]}),e.jsxs("main",{className:"main",children:[t.archived?e.jsxs("div",{className:"alert alert-danger d-flex align-items-center justify-content-between",children:[e.jsx("div",{children:"Account archived. Renew to restore access."}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:`/app${he}`,children:"Renew Now"})]}):null,s==="ai-chatbot"&&W?e.jsxs("div",{className:"alert alert-warning d-flex align-items-center justify-content-between",children:[e.jsxs("div",{children:["Trial ends on ",e.jsx("strong",{children:D||"soon"}),". Upgrade to keep access."]}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:"/pricing/",children:"Upgrade"})]}):null,u?e.jsxs("div",{className:"alert alert-warning alert-dismissible fade show",children:[u,e.jsx("button",{type:"button",className:"btn-close",onClick:()=>c("")})]}):null,e.jsxs(b_,{location:Ze,children:[e.jsx(Ve,{path:"/",element:M?e.jsx(ze,{to:ye("/dealer-dashboard"),replace:!0}):E?e.jsx(ze,{to:ye("/saas-admin"),replace:!0}):s==="storage"?e.jsx(sk,{subscriptions:t.subscriptions}):s==="ai-chatbot"?e.jsx(Ek,{subscriptions:t.subscriptions}):s==="imposition-software"?e.jsx(lk,{isAdmin:z}):s==="business-autopilot-erp"?e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"card p-3",children:"Loading modules..."}),children:e.jsx(Qk,{modules:N,catalog:w,canManageModules:y,onToggleModule:gt,savingModuleSlug:k,moduleError:P,productBasePath:Fe,subscriptions:t.subscriptions})}):e.jsx(z_,{productSlug:s,subscriptions:t.subscriptions})}),e.jsx(Ve,{path:"/crm",element:ee&&N.some(K=>K.slug==="crm")?e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"card p-3",children:"Loading module..."}),children:e.jsx(Cn,{moduleKey:"crm",title:"CRM"})}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/hrm",element:ee&&N.some(K=>K.slug==="hrm")?e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"card p-3",children:"Loading module..."}),children:e.jsx(Cn,{moduleKey:"hrm",title:"HR"})}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/projects",element:ee&&N.some(K=>K.slug==="projects")?e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"card p-3",children:"Loading module..."}),children:e.jsx(Cn,{moduleKey:"projects",title:"Project Management"})}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/accounts",element:ee&&N.some(K=>K.slug==="accounts")?e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"card p-3",children:"Loading module..."}),children:e.jsx(Cn,{moduleKey:"accounts",title:"Accounts"})}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/ticketing",element:ee&&N.some(K=>K.slug==="ticketing")?e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"card p-3",children:"Loading module..."}),children:e.jsx(Cn,{moduleKey:"ticketing",title:"Ticketing System"})}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/stocks",element:ee&&N.some(K=>K.slug==="stocks")?e.jsx(i.Suspense,{fallback:e.jsx("div",{className:"card p-3",children:"Loading module..."}),children:e.jsx(Cn,{moduleKey:"stocks",title:"Stocks Management"})}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/files",element:s==="storage"?e.jsx(Ff,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/users",element:s==="storage"&&z?e.jsx(tk,{}):s==="imposition-software"&&z?e.jsx(rk,{}):ee&&f?e.jsx(mk,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/activity",element:ie?e.jsx(iS,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/work-activity",element:ie?e.jsx(dS,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/app-usage",element:ie&&te?e.jsx(fS,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/app-urls",element:ie?e.jsx(jS,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/gaming-ott",element:ie&&H?e.jsx(NS,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/employees",element:ie&&!C?e.jsx(K_,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/employees/add",element:ie&&!C?e.jsx(hf,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/employees/:employeeId",element:ie&&!C?e.jsx(Z_,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/employees/:employeeId/edit",element:ie&&!C?e.jsx(hf,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/screenshots",element:ie?e.jsx(tS,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/company",element:ie&&z&&!C?e.jsx(ES,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/privacy",element:ie&&z&&!C?e.jsx(TS,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/company/edit",element:ie&&z&&!C?e.jsx(RS,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/billing",element:z&&!C?Z?e.jsx(ik,{}):e.jsx(QS,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/plans",element:z&&!C?Z?e.jsx(ck,{}):e.jsx(uw,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/profile",element:z&&!C?Z?e.jsx(dk,{}):e.jsx(bw,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dashboard/company-profile",element:s==="whatsapp-automation"?e.jsx($k,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dashboard/whatsapp-automation",element:s==="whatsapp-automation"?e.jsx(Ik,{subscriptions:t.subscriptions}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dashboard/catalogue",element:s==="whatsapp-automation"?e.jsx(Fk,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dashboard/digital-card",element:s==="whatsapp-automation"?e.jsx(Hk,{currentUsername:((_e=t.user)==null?void 0:_e.username)||""}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/notifications-inbox",element:M?e.jsx(ze,{to:ye("/"),replace:!0}):e.jsx(b0,{})}),e.jsx(Ve,{path:"/org-admin/media-library",element:z&&!C?e.jsx(gd,{scope:"org"}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/inbox",element:s==="ai-chatbot"&&(z||R)?e.jsx(fk,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/widgets",element:s==="ai-chatbot"&&z?e.jsx(jk,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/leads",element:s==="ai-chatbot"&&z?e.jsx(_k,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/agents",element:s==="ai-chatbot"&&z?e.jsx(Ck,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/history",element:s==="ai-chatbot"&&z?e.jsx(Tk,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/chat-settings",element:s==="ai-chatbot"&&z?e.jsx(Mk,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dealer-dashboard",element:M?e.jsx(vw,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dealer-referrals",element:M?e.jsx(_w,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dealer-payouts",element:M?e.jsx($w,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dealer-billing",element:M?e.jsx(Rw,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dealer-plan",element:M?e.jsx(Tw,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dealer-profile",element:M?e.jsx(Ew,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/dealer-bank-transfer/:transferId",element:M?e.jsx(Fw,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin",element:E?e.jsx(Bw,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/organizations",element:E?e.jsx(qw,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/observability",element:E?e.jsx(Wb,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/inbox",element:E?e.jsx(d0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/retention-policy",element:E?e.jsx(y0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/storage",element:E?e.jsx(w0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/whatsapp-cloud",element:E?e.jsx(P0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/system-backup-manager",element:E?e.jsx(T0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/media-library",element:E?e.jsx(gd,{scope:"saas"}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/backup-activity",element:E?e.jsx(M0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/server-monitoring",element:E?e.jsx(F0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/server-monitoring/settings",element:E?e.jsx(H0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/server-monitoring/alerts",element:E?e.jsx(Q0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/server-monitoring/:serverId",element:E?e.jsx(V0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/backup-history",element:z?e.jsx(O0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/user/:id",element:s==="storage"&&z?e.jsx(Ff,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/billing",element:E?e.jsx(R0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/organizations/:orgId",element:E?e.jsx(Xw,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/dealers/:dealerId",element:E?e.jsx(Jw,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/referrals",element:E?e.jsx(t0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/profile",element:E?e.jsx(n0,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/products/:slug",element:E?e.jsx(Ef,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/saas-admin/products/:slug/retention-policy",element:E?e.jsx(Ef,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/bank-transfer",element:z?e.jsx(Cf,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"/bank-transfer/:transferId",element:z?e.jsx(Cf,{}):e.jsx(ze,{to:ye("/"),replace:!0})}),e.jsx(Ve,{path:"*",element:e.jsx(ze,{to:ye("/"),replace:!0})})]})]}),d?e.jsx("div",{className:"modal-overlay",onClick:()=>h(!1),children:e.jsxs("div",{className:"modal-panel",onClick:K=>K.stopPropagation(),children:[e.jsxs("h5",{children:["Free Plan Will Expire - ",se]}),e.jsxs("div",{className:"text-secondary mb-2",children:["Your ",e.jsx("strong",{children:se})," free plan will expire on ",e.jsx("strong",{children:X}),". Please choose a paid plan to continue without interruption."]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx(dt,{className:"btn btn-primary",to:ye("/plans"),children:"View Plans"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>h(!1),children:"Later"})]})]})}):null]})}function tC({children:t,getProductRoute:a}){const s=ua(),n=a(s.pathname),l=n?n.slug:"worksuite";return e.jsx($_,{productKey:l,children:t})}function aC(){const t=ua();return i.useEffect(()=>{const a=`/auth/login/?next=${encodeURIComponent(`/app${t.pathname}${t.search}${t.hash}`)}`;window.location.replace(a)},[t.pathname,t.search,t.hash]),e.jsx("div",{className:"page-center",children:e.jsx("div",{className:"panel",children:e.jsx("p",{children:"Redirecting to login..."})})})}function sC(){const[t,a]=i.useState(Br),s=i.useCallback(g=>{typeof window<"u"&&(window.__WZ_READ_ONLY__=!!g.read_only,window.__WZ_ARCHIVED__=!!g.archived),$l(g.org_timezone||"UTC"),a({loading:!1,authenticated:!!g.authenticated,user:g.user||null,profile:g.profile||null,archived:!!g.archived,dealer:g.dealer||null,dealerOnboarding:g.dealer_onboarding||null,allowAppUsage:g.allow_app_usage!==!1,allowGamingOttUsage:g.allow_gaming_ott_usage!==!1,themePrimary:g.theme_primary||"",themeSecondary:g.theme_secondary||"",sidebarMenuStyle:g.sidebar_menu_style==="compact"?"compact":"default",freePlanPopup:!!g.free_plan_popup,freePlanExpiry:g.free_plan_expiry||"",onboarding:g.onboarding||{enabled:!1,state:"active"},readOnly:!!g.read_only,subscriptions:[]})},[]),n=i.useCallback(async()=>{const g=await fetch("/api/auth/subscriptions",{credentials:"include"});if(!g.ok){a(v=>({...v,subscriptions:[]}));return}const N=await g.json();a(v=>({...v,subscriptions:N.subscriptions||[]}))},[]),l=i.useCallback(async()=>{const g=Bb(),N=await fetch("/api/auth/me",{credentials:"include",headers:g?{"X-Browser-Timezone":g}:{}});if(N.status===401){a({...Br,loading:!1});return}if(!N.ok){a({...Br,loading:!1});return}const v=await N.json();s(v),await n()},[s,n]);i.useEffect(()=>{const g=N=>{var w;const v=((w=N==null?void 0:N.detail)==null?void 0:w.style)==="compact"?"compact":"default";a(A=>({...A,sidebarMenuStyle:v}))};return window.addEventListener("wz:sidebar-menu-style-change",g),()=>{window.removeEventListener("wz:sidebar-menu-style-change",g)}},[]),i.useEffect(()=>{let g=!0;async function N(){try{await l()}catch{g&&a({...Br,loading:!1})}}return N(),()=>{g=!1}},[l]);const r=[{prefix:"/work-suite",slug:"worksuite",label:"Work Suite"},{prefix:"/ai-chatbot",slug:"ai-chatbot",label:"AI Chatbot"},{prefix:"/storage",slug:"storage",label:"Online Storage"},{prefix:"/imposition",slug:"imposition-software",label:"Imposition Software"},{prefix:"/business-autopilot",slug:"business-autopilot-erp",label:"Business Autopilot ERP"},{prefix:"/whatsapp-automation",slug:"whatsapp-automation",label:"Whatsapp Automation"},{prefix:"/ai-chat-widget",slug:"ai-chat-widget",label:"AI Chat Widget"},{prefix:"/digital-card",slug:"digital-card",label:"Digital Card"}],o=[{prefix:"/monitor",slug:"worksuite",label:"Work Suite",redirectPrefix:"/work-suite"},{prefix:"/worksuite",slug:"worksuite",label:"Work Suite",redirectPrefix:"/work-suite"}];function u(g){return[...o,...r].find(v=>g===v.prefix||g.startsWith(`${v.prefix}/`))||null}function c(g){const N=g==="worksuite"?"monitor":g;return(t.subscriptions||[]).find(w=>w.product_slug===N)||null}function d(g){const N=c(g);if(!N)return"none";const v=(N.status||"").toLowerCase();if(v==="trialing"){const w=N.trial_end?new Date(N.trial_end):null;return w&&w.getTime()>=Date.now()?"active":"trial_ended"}return v}function h({label:g,status:N,productSlug:v,planIsFree:w}){var E,C;const{branding:A}=el(),y=((C=(E=A==null?void 0:A.aliases)==null?void 0:E.ui)==null?void 0:C.monitorLabel)||(A==null?void 0:A.displayName)||"Work Suite",x=v==="worksuite"?y:g,f=N==="pending",b=N==="rejected",k=N==="expired",_=N==="trial_ended",P=!!(w&&(k||_)),S=f?"Awaiting Admin Approval":b?"Subscription Rejected":_?"Trial Ended":k?"Subscription Expired":"Subscription Required",F=f?"Your payment is under review. You will get access once approved.":b?"Your payment was rejected. Please renew to activate access.":_?"Trial ended. Please upgrade your plan.":k?"Your subscription has expired. Please renew to continue.":"You need an active plan to open this dashboard.",L=f?"View My Account":P?"View Plans":b||k||_?"Renew Plan":"View Pricing",Q=f?"/my-account/":P?`/pricing/?product=${v||"worksuite"}`:b||k?`/my-account/billing/renew/start/?product=${v||"worksuite"}`:"/pricing/";return e.jsx("div",{className:"page-center",children:e.jsxs("div",{className:"panel",children:[e.jsxs("h1",{children:[x," Dashboard"]}),e.jsx("p",{children:S}),e.jsx("div",{className:"text-secondary",children:F}),e.jsx("div",{className:"button-row",children:e.jsx("a",{className:"app-btn app-btn-primary",href:Q,children:L})})]})})}function p(){var P,S,F,L,Q,E;const{branding:g}=el(),N=((S=(P=g==null?void 0:g.aliases)==null?void 0:P.ui)==null?void 0:S.monitorLabel)||(g==null?void 0:g.displayName)||"Work Suite",v=ua(),w=v.pathname.startsWith("/saas-admin"),A=!!((F=t.user)!=null&&F.is_superuser||(L=t.user)!=null&&L.is_staff||((Q=t.profile)==null?void 0:Q.role)==="superadmin"||((E=t.profile)==null?void 0:E.role)==="super_admin"),y=A?"/saas-admin/billing":"/billing";if(w)return A?e.jsx(Wr,{state:t,productPrefix:"",productSlug:"saas-admin"}):e.jsx(ze,{to:"/",replace:!0});if(t.archived&&v.pathname!==y)return e.jsx(ze,{to:y,replace:!0});if(v.pathname==="/"||v.pathname==="")return e.jsx(ze,{to:"/work-suite/",replace:!0});const x=u(v.pathname);if(x!=null&&x.redirectPrefix&&v.pathname.startsWith(x.prefix)){const C=x.redirectPrefix+v.pathname.slice(x.prefix.length);return e.jsx(ze,{to:`${C}${v.search||""}${v.hash||""}`,replace:!0})}const f=x?x.slug:"worksuite",b=x?x.prefix:"";if(f==="whatsapp-automation"&&(v.pathname===b||v.pathname===`${b}/`))return e.jsx(ze,{to:`${b}/dashboard/whatsapp-automation`,replace:!0});const k=c(f),_=d(f);return _!=="active"?f==="business-autopilot-erp"?e.jsx(Wr,{state:t,productPrefix:b,productSlug:f}):f==="storage"&&(_==="trial_ended"||_==="expired")?e.jsx(Wr,{state:t,productPrefix:b,productSlug:f}):e.jsx(h,{label:f==="worksuite"?N:(x==null?void 0:x.label)||"Work Suite",status:_,productSlug:f,planIsFree:k==null?void 0:k.plan_is_free}):e.jsx(Wr,{state:t,productPrefix:b,productSlug:f})}return e.jsx(Ib,{children:e.jsx(k_,{basename:"/app",children:e.jsx(tC,{getProductRoute:u,children:t.loading?e.jsx("div",{className:"page-center",children:e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading dashboard..."})]})}):t.authenticated?e.jsx(qk,{children:e.jsx(p,{})}):e.jsx(aC,{})})})})}bc.createRoot(document.getElementById("root")).render(e.jsx(bg.StrictMode,{children:e.jsx(Ib,{children:e.jsx(sC,{})})}));export{dt as L,Ki as P,st as T,U as a,ls as b,e as j,i as r};
