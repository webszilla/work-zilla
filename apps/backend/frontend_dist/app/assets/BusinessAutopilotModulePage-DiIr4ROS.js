import{b as Ke,j as e,r as m,a as Ee,T as Wt}from"./index-CKlrd696.js";const qe=["India","United States","United Arab Emirates","United Kingdom","Singapore","Australia","Canada"],Jt=Array.from(new Set(Ke.map(i=>String((i==null?void 0:i.label)||"").trim()).filter(Boolean))).sort((i,h)=>{const d=qe.indexOf(i),D=qe.indexOf(h);return d!==-1||D!==-1?d===-1?1:D===-1?-1:d-D:i.localeCompare(h)}),ze=Array.from(new Set(Ke.map(i=>String((i==null?void 0:i.code)||"").trim()).filter(Boolean))).sort((i,h)=>i==="+91"?-1:h==="+91"?1:i.localeCompare(h,void 0,{numeric:!0}));function qt(i){const h=String(i||"").trim();if(!h)return"";const d=Ke.filter(k=>String((k==null?void 0:k.code)||"").trim()===h).map(k=>String((k==null?void 0:k.label)||"").trim()).filter(Boolean);if(!d.length)return"";const D=Array.from(new Set(d));return D.find(k=>qe.includes(k))||D[0]}function zt(i){const h=String(i||"").trim();if(!h)return"";const d=qt(h);return d?`${d} ${h}`:h}const Qe=ze.map(i=>({value:i,label:zt(i)})),Qt={India:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"],"United States":["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],Canada:["Alberta","British Columbia","Manitoba","New Brunswick","Newfoundland and Labrador","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Northwest Territories","Nunavut","Yukon"],Australia:["New South Wales","Victoria","Queensland","Western Australia","South Australia","Tasmania","Australian Capital Territory","Northern Territory"],"United Arab Emirates":["Abu Dhabi","Ajman","Dubai","Fujairah","Ras Al Khaimah","Sharjah","Umm Al Quwain"],"United Kingdom":["England","Scotland","Wales","Northern Ireland"],Singapore:["Central Region","East Region","North Region","North-East Region","West Region"],Malaysia:["Johor","Kedah","Kelantan","Malacca","Negeri Sembilan","Pahang","Penang","Perak","Perlis","Sabah","Sarawak","Selangor","Terengganu","Kuala Lumpur","Labuan","Putrajaya"],"Saudi Arabia":["Riyadh","Makkah","Madinah","Eastern Province","Asir","Tabuk","Qassim","Hail","Jazan","Najran","Al Bahah","Al Jawf","Northern Borders"],"South Africa":["Eastern Cape","Free State","Gauteng","KwaZulu-Natal","Limpopo","Mpumalanga","Northern Cape","North West","Western Cape"],Germany:["Baden-Wurttemberg","Bavaria","Berlin","Brandenburg","Bremen","Hamburg","Hesse","Lower Saxony","Mecklenburg-Vorpommern","North Rhine-Westphalia","Rhineland-Palatinate","Saarland","Saxony","Saxony-Anhalt","Schleswig-Holstein","Thuringia"]};function Zt(i){const h=String(i||"").trim();return Qt[h]||[]}const nt="wz_business_autopilot_projects_module",it="wz_business_autopilot_crm_module",rt="wz_business_autopilot_hr_module",ht="wz_business_autopilot_ticketing_module",De="wz_business_autopilot_stocks_module",_e="wz_business_autopilot_accounts_module",Xt=5;function bt(i){return String(i||"").trim().toLowerCase()}function Kt(i){const h=String(i||"India").trim()||"India",d=bt(h);return d==="india"?{country:h,mode:"gst",templatesLabel:"GST Templates",templateSingular:"GST Template",templateListTitle:"GST Template List",createTitle:"Create GST Template",editTitle:"Edit GST Template",createActionLabel:"Create GST Template",editActionLabel:"Update GST Template",scopeLabel:"Scope",defaultScope:"Intra State",scopeOptions:["Intra State","Inter State","Export"],namePlaceholder:"India GST 18%",notesPlaceholder:"Template notes",cgstLabel:"CGST %",sgstLabel:"SGST %",igstLabel:"IGST %",cessLabel:"CESS %",helperText:"India billing profile detected. GST rule template defaults are enabled."}:d==="united states"||d==="usa"||d==="us"?{country:h,mode:"us_sales_tax",templatesLabel:"Tax Templates",templateSingular:"Tax Template",templateListTitle:"Tax Template List",createTitle:"Create Tax Template",editTitle:"Edit Tax Template",createActionLabel:"Create Tax Template",editActionLabel:"Update Tax Template",scopeLabel:"Jurisdiction",defaultScope:"Same State",scopeOptions:["Same State","Out of State","International"],namePlaceholder:"US Sales Tax",notesPlaceholder:"Tax rule notes",cgstLabel:"State Tax %",sgstLabel:"County/Local Tax %",igstLabel:"Combined Sales Tax %",cessLabel:"Extra Tax %",helperText:"US billing profile detected. Sales-tax style rule labels are shown."}:{country:h,mode:"vat",templatesLabel:"Tax Templates",templateSingular:"Tax Template",templateListTitle:"Tax Template List",createTitle:"Create Tax Template",editTitle:"Edit Tax Template",createActionLabel:"Create Tax Template",editActionLabel:"Update Tax Template",scopeLabel:"Scope",defaultScope:"Domestic",scopeOptions:["Domestic","Cross Border","Export"],namePlaceholder:`${h} VAT`,notesPlaceholder:"VAT / tax rule notes",cgstLabel:"Regional Tax %",sgstLabel:"Local Tax %",igstLabel:"VAT / Main Tax %",cessLabel:"Additional Tax %",helperText:`${h} billing profile detected. VAT/Tax rule labels are shown.`}}const ot={crm:{title:"CRM",subtitle:"Manage leads, deals, and customer follow-ups.",stats:[{label:"Open Leads",value:"24"},{label:"Pipeline Value",value:"INR 8.4L"},{label:"Follow-ups Today",value:"11"}],sections:["Lead pipeline board","Deal stage tracking","Activity timeline","Contact import/export"]},hrm:{title:"HR",subtitle:"Handle employees, attendance, and payroll workflows.",stats:[{label:"Employees",value:"42"},{label:"Attendance Today",value:"89%"},{label:"Pending Leaves",value:"6"}],sections:["Employee directory","Attendance and shifts","Leave approvals","Payroll run setup"]},projects:{title:"Project Management",subtitle:"Track project milestones, tasks, and team delivery."},accounts:{title:"Accounts",subtitle:"Control billing, expenses, GST, and accounting reports.",stats:[{label:"Invoices This Month",value:"126"},{label:"Receivables",value:"INR 3.2L"},{label:"GST Status",value:"Ready"}],sections:["Invoice and billing","Expense tracking","GST reports","Vendor and purchase entries"]},ticketing:{title:"Ticketing System",subtitle:"Track support tickets, priorities, SLA, and team resolution workflows.",stats:[{label:"Open Tickets",value:"18"},{label:"Pending Today",value:"7"},{label:"Avg Resolution",value:"4h 20m"}],sections:["Ticket queue and status board","Priority and SLA tracking","Agent assignment and ownership","Customer issue comments and history"]},stocks:{title:"Inventory",subtitle:"Manage inventory levels, stock movement, reorder alerts, and warehouses.",stats:[{label:"Items In Stock",value:"428"},{label:"Low Stock Alerts",value:"12"},{label:"Warehouses",value:"3"}],sections:["Inventory items master","Stock in / stock out entries","Low-stock reorder alerts","Warehouse-wise quantity tracking"]}},Se={leads:{label:"Leads",itemLabel:"Lead",icon:"bi-person-plus",columns:[{key:"name",label:"Lead Name"},{key:"company",label:"Company"},{key:"phone",label:"Phone"},{key:"stage",label:"Stage"},{key:"status",label:"Status"}],fields:[{key:"name",label:"Lead Name",placeholder:"Enter lead name"},{key:"company",label:"Company",placeholder:"Company / Business name"},{key:"phoneCountryCode",label:"Country Code",type:"select",options:ze,defaultValue:"+91"},{key:"phone",label:"Phone",placeholder:"Mobile number"},{key:"stage",label:"Stage",type:"select",options:["New","Qualified","Proposal"],defaultValue:"New"},{key:"status",label:"Status",type:"select",options:["Open","Closed","Converted"],defaultValue:"Open"}]},contacts:{label:"Contacts",itemLabel:"Contact",icon:"bi-person-lines-fill",columns:[{key:"name",label:"Name"},{key:"company",label:"Company"},{key:"email",label:"Email"},{key:"phone",label:"Phone"},{key:"tag",label:"Tag"}],fields:[{key:"name",label:"Name",placeholder:"Contact name"},{key:"company",label:"Company",placeholder:"Company name"},{key:"email",label:"Email",placeholder:"contact@example.com"},{key:"phoneCountryCode",label:"Country Code",type:"select",options:ze,defaultValue:"+91"},{key:"phone",label:"Phone",placeholder:"Phone number"},{key:"tag",label:"Tag",type:"select",options:["Customer","Prospect","Vendor"],defaultValue:"Customer"}]},deals:{label:"Deals",itemLabel:"Deal",icon:"bi-currency-rupee",columns:[{key:"dealName",label:"Deal Name"},{key:"company",label:"Company"},{key:"stage",label:"Stage"},{key:"amount",label:"Amount"},{key:"status",label:"Status"}],fields:[{key:"dealName",label:"Deal Name",placeholder:"ERP rollout annual contract"},{key:"company",label:"Company",placeholder:"Customer company"},{key:"stage",label:"Stage",type:"select",options:["Discovery","Proposal","Negotiation"],defaultValue:"Discovery"},{key:"amount",label:"Amount",placeholder:"INR amount"},{key:"status",label:"Status",type:"select",options:["Open","Won","Lost"],defaultValue:"Open"}]},followUps:{label:"Follow-ups",itemLabel:"Follow-up",icon:"bi-telephone-forward",columns:[{key:"subject",label:"Subject"},{key:"relatedTo",label:"Related To"},{key:"dueDate",label:"Due Date"},{key:"owner",label:"Owner"},{key:"status",label:"Status"}],fields:[{key:"subject",label:"Subject",placeholder:"Demo callback / pricing follow-up"},{key:"relatedTo",label:"Related To",placeholder:"Lead / Contact / Deal name"},{key:"dueDate",label:"Due Date",type:"date"},{key:"owner",label:"Owner",placeholder:"Sales owner"},{key:"status",label:"Status",type:"select",options:["Pending","Completed","Missed"],defaultValue:"Pending"}]},activities:{label:"Activities",itemLabel:"Activity",icon:"bi-clock-history",columns:[{key:"activityType",label:"Activity Type"},{key:"relatedTo",label:"Related To"},{key:"date",label:"Date"},{key:"owner",label:"Owner"},{key:"notes",label:"Notes"}],fields:[{key:"activityType",label:"Activity Type",placeholder:"Call / Meeting / Demo / Email"},{key:"relatedTo",label:"Related To",placeholder:"Lead / Deal / Contact"},{key:"date",label:"Date",placeholder:"YYYY-MM-DD"},{key:"owner",label:"Owner",placeholder:"User name"},{key:"notes",label:"Notes",placeholder:"Short activity notes"}]},meetings:{label:"Meetings",itemLabel:"Meeting",icon:"bi-calendar-event",columns:[{key:"title",label:"Meeting Title"},{key:"relatedTo",label:"Related To"},{key:"meetingDate",label:"Date"},{key:"meetingTime",label:"Time"},{key:"owner",label:"Owner"},{key:"reminderSummary",label:"Reminder"},{key:"status",label:"Status"}],fields:[{key:"title",label:"Meeting Title",placeholder:"Client demo / Follow-up call"},{key:"companyOrClientName",label:"Company / Client Name",type:"datalist",datalistSource:"crmContacts",placeholder:"Select company / client from contacts"},{key:"relatedTo",label:"Related To",placeholder:"Lead / Contact / Deal / Company"},{key:"meetingDate",label:"Meeting Date",type:"date"},{key:"meetingTime",label:"Meeting Time",type:"time"},{key:"owner",label:"Owner",placeholder:"Sales owner / Team member"},{key:"meetingMode",label:"Meeting Mode",type:"select",options:["Online","Offline","Phone"],defaultValue:"Online"},{key:"reminderChannel",label:"Reminder Channel",type:"multiselect",options:["App Alert","Email","SMS","WhatsApp"],defaultValue:["App Alert"]},{key:"reminderMinutes",label:"Reminder Before (Minutes)",type:"select",options:["5","10","15","30","60","120","1440"],defaultValue:"15"},{key:"status",label:"Status",type:"select",options:["Scheduled","Completed","Rescheduled","Cancelled"],defaultValue:"Scheduled"}]}},ea={leads:[{id:"crm_l1",name:"Ravi Kumar",company:"Ultra HD Prints",phoneCountryCode:"+91",phone:"9876543210",stage:"Qualified",status:"Open"},{id:"crm_l2",name:"Priya N",company:"North India Jewels",phoneCountryCode:"+91",phone:"9123456780",stage:"Proposal",status:"Open"}],contacts:[{id:"crm_c1",name:"Ravi Kumar",company:"Ultra HD Prints",email:"ravi@uhdprints.example",phoneCountryCode:"+91",phone:"9876543210",tag:"Customer"},{id:"crm_c2",name:"Priya N",company:"North India Jewels",email:"priya@nij.example",phoneCountryCode:"+91",phone:"9123456780",tag:"Prospect"}],deals:[{id:"crm_d1",dealName:"POS Billing Setup",company:"Ultra HD Prints",stage:"Negotiation",amount:"85000",status:"Open"},{id:"crm_d2",dealName:"WhatsApp Campaign Suite",company:"North India Jewels",stage:"Proposal",amount:"42000",status:"Open"}],followUps:[{id:"crm_f1",subject:"Demo callback",relatedTo:"Ultra HD Prints",dueDate:"2026-02-25",owner:"GP Prakash",status:"Pending"},{id:"crm_f2",subject:"Pricing confirmation",relatedTo:"North India Jewels",dueDate:"2026-02-25",owner:"GP Prakash",status:"Pending"}],activities:[{id:"crm_a1",activityType:"Call",relatedTo:"Ultra HD Prints",date:"2026-02-24",owner:"GP Prakash",notes:"Discussed rollout scope"},{id:"crm_a2",activityType:"Email",relatedTo:"North India Jewels",date:"2026-02-24",owner:"GP Prakash",notes:"Sent proposal PDF"}],meetings:[{id:"crm_m1",title:"Ultra HD Prints Demo",relatedTo:"Ultra HD Prints",meetingDate:"2026-02-26",meetingTime:"11:00",owner:"GP Prakash",meetingMode:"Online",reminderChannel:"WhatsApp",reminderMinutes:"30",status:"Scheduled",reminderSummary:"WhatsApp • 30 min before"},{id:"crm_m2",title:"North India Jewels Pricing Call",relatedTo:"North India Jewels",meetingDate:"2026-02-27",meetingTime:"16:30",owner:"GP Prakash",meetingMode:"Phone",reminderChannel:"App Alert",reminderMinutes:"15",status:"Scheduled",reminderSummary:"App Alert • 15 min before"}]},Me={projects:{label:"Projects",itemLabel:"Project",columns:[{key:"name",label:"Project Name"},{key:"owner",label:"Owner"},{key:"status",label:"Status"}],fields:[{key:"name",label:"Project Name",placeholder:"Enter project name"},{key:"owner",label:"Owner",placeholder:"Enter owner name"},{key:"status",label:"Status",placeholder:"Active / Planned / Hold"}]},tasks:{label:"Tasks",itemLabel:"Task",columns:[{key:"title",label:"Task"},{key:"assignee",label:"Assign To"},{key:"startDate",label:"Start Date"},{key:"dueDate",label:"Due Date"}],fields:[{key:"title",label:"Task",placeholder:"Enter task title"},{key:"assignee",label:"Assign To",placeholder:"Search user name"},{key:"startDate",label:"Start Date",type:"date"},{key:"dueDate",label:"Due Date",type:"date"}]},milestones:{label:"Milestones",itemLabel:"Milestone",columns:[{key:"title",label:"Milestone"},{key:"project",label:"Project"},{key:"targetDate",label:"Target Date"}],fields:[{key:"title",label:"Milestone",placeholder:"Enter milestone title"},{key:"project",label:"Project",placeholder:"Enter project name"},{key:"targetDate",label:"Target Date",placeholder:"YYYY-MM-DD"}]},team:{label:"Team",itemLabel:"Team Member",columns:[{key:"name",label:"Name"},{key:"role",label:"Role"},{key:"project",label:"Project"}],fields:[{key:"name",label:"Name",placeholder:"Enter member name"},{key:"role",label:"Role",placeholder:"Enter role"},{key:"project",label:"Project",placeholder:"Enter project name"}]}},ta={projects:[{id:"p1",name:"ERP Rollout",owner:"Guru",status:"Active"},{id:"p2",name:"HR Automation",owner:"Nithya",status:"Planned"}],tasks:[{id:"t1",title:"Finalize sprint board",assignee:"Guru",startDate:"2026-02-16",dueDate:"2026-02-20"},{id:"t2",title:"Client approval review",assignee:"Arun",startDate:"2026-02-18",dueDate:"2026-02-22"}],milestones:[{id:"m1",title:"Phase 1 Go-Live",project:"ERP Rollout",targetDate:"2026-03-10"},{id:"m2",title:"Payroll Cutover",project:"HR Automation",targetDate:"2026-03-25"}],team:[{id:"u1",name:"Guru",role:"Project Manager",project:"ERP Rollout"},{id:"u2",name:"Nithya",role:"Business Analyst",project:"HR Automation"}]},$e={employees:{label:"Employees",itemLabel:"Employee",columns:[{key:"name",label:"Name"},{key:"department",label:"Department"},{key:"designation",label:"Employee Role"}],fields:[{key:"name",label:"Name",placeholder:"Select employee from created users"},{key:"department",label:"Department",placeholder:"Auto from user / editable"},{key:"designation",label:"Employee Role",placeholder:"Auto from user / editable"},{key:"dateOfBirth",label:"Date of Birth",type:"date"},{key:"bloodGroup",label:"Blood Group",type:"select",options:["A+","A-","B+","B-","AB+","AB-","O+","O-"]},{key:"fatherName",label:"Father Name",placeholder:"Father name"},{key:"motherName",label:"Mother Name",placeholder:"Mother name"},{key:"maritalStatus",label:"Marital Status",type:"select",options:["Single","Married","Divorced","Widowed"]},{key:"wifeName",label:"Wife Name",placeholder:"Wife name",optional:!0,conditionalOn:{key:"maritalStatus",value:"Married"}},{key:"permanentAddress",label:"Permanent Address",placeholder:"Permanent address",type:"textarea"},{key:"permanentCountry",label:"Permanent Country",placeholder:"Country"},{key:"permanentState",label:"Permanent State",placeholder:"State"},{key:"permanentCity",label:"Permanent City",placeholder:"City"},{key:"permanentPincode",label:"Permanent Pincode",placeholder:"Pincode"},{key:"temporaryAddress",label:"Temporary Address",placeholder:"Temporary address",type:"textarea"},{key:"temporaryCountry",label:"Temporary Country",placeholder:"Country"},{key:"temporaryState",label:"Temporary State",placeholder:"State"},{key:"temporaryCity",label:"Temporary City",placeholder:"City"},{key:"temporaryPincode",label:"Temporary Pincode",placeholder:"Pincode"}]},attendance:{label:"Attendance",itemLabel:"Attendance Entry",columns:[{key:"employee",label:"Employee"},{key:"date",label:"Date"},{key:"inTime",label:"In Time"},{key:"outTime",label:"Out Time"},{key:"workedHours",label:"Worked"},{key:"status",label:"Status"}],fields:[{key:"employee",label:"Employee",placeholder:"Enter employee name"},{key:"date",label:"Date",type:"date"},{key:"entryMode",label:"Entry Side",type:"select",options:["HR Side","User Side"],defaultValue:"HR Side"},{key:"inTime",label:"In Time",type:"time"},{key:"outTime",label:"Out Time",type:"time"},{key:"status",label:"Status",type:"select",options:["Present","Half Day","Leave","Permission"],defaultValue:"Present"},{key:"permissionHours",label:"Permission Hours",placeholder:"e.g. 2",conditionalOn:{key:"status",value:"Permission"}},{key:"notes",label:"Notes",placeholder:"Optional notes",optional:!0}]},leaves:{label:"Leaves",itemLabel:"Leave Request",columns:[{key:"employee",label:"Employee"},{key:"leaveType",label:"Leave Type"},{key:"status",label:"Status"}],fields:[{key:"employee",label:"Employee",placeholder:"Enter employee name"},{key:"leaveType",label:"Leave Type",placeholder:"Sick / Casual / Paid"},{key:"status",label:"Status",placeholder:"Pending / Approved / Rejected"}]},payroll:{label:"Payroll",itemLabel:"Payroll Entry",columns:[{key:"employee",label:"Employee"},{key:"month",label:"Month"},{key:"salary",label:"Net Salary"}],fields:[{key:"employee",label:"Employee",placeholder:"Enter employee name"},{key:"month",label:"Month",placeholder:"YYYY-MM"},{key:"salary",label:"Net Salary",placeholder:"INR amount"}]}},gt={employees:[{id:"e1",name:"Guru",department:"Engineering",designation:"Project Lead"},{id:"e2",name:"Nithya",department:"HR",designation:"HR Executive"}],attendance:[{id:"a1",employee:"Guru",date:"2026-02-19",entryMode:"HR Side",inTime:"09:10",outTime:"18:05",workedHours:"8h 55m",status:"Present",notes:""},{id:"a2",employee:"Nithya",date:"2026-02-19",entryMode:"User Side",inTime:"09:25",outTime:"17:48",workedHours:"8h 23m",status:"Present",notes:""}],leaves:[{id:"l1",employee:"Arun",leaveType:"Sick",status:"Pending"},{id:"l2",employee:"Kiran",leaveType:"Casual",status:"Approved"}],payroll:[{id:"pr1",employee:"Guru",month:"2026-02",salary:"INR 85,000"},{id:"pr2",employee:"Nithya",month:"2026-02",salary:"INR 42,000"}]},aa={mainCategories:{label:"Main Category",itemLabel:"Main Category",columns:[{key:"name",label:"Category Name"},{key:"department",label:"Department"},{key:"sla",label:"SLA"}],fields:[{key:"name",label:"Category Name",placeholder:"Technical Support / Billing"},{key:"department",label:"Department",placeholder:"Support / Accounts / Sales"},{key:"sla",label:"SLA",placeholder:"4h / 8h / 24h"}]},subCategories:{label:"Sub Category",itemLabel:"Sub Category",columns:[{key:"name",label:"Sub Category"},{key:"mainCategory",label:"Main Category"},{key:"priority",label:"Default Priority"}],fields:[{key:"name",label:"Sub Category",placeholder:"Login Issue / Refund / Installation"},{key:"mainCategory",label:"Main Category",placeholder:"Technical Support"},{key:"priority",label:"Default Priority",placeholder:"Low / Medium / High"}]},tickets:{label:"Tickets",itemLabel:"Ticket",columns:[{key:"ticketNo",label:"Ticket No"},{key:"subject",label:"Subject"},{key:"category",label:"Category"},{key:"status",label:"Status"}],fields:[{key:"ticketNo",label:"Ticket No",placeholder:"TK-1001"},{key:"subject",label:"Subject",placeholder:"Customer login issue"},{key:"mainCategory",label:"Category",placeholder:"Select category"},{key:"subCategory",label:"Sub Category",placeholder:"Select sub category"},{key:"status",label:"Status",placeholder:"Open / In Progress / Closed"},{key:"description",label:"Description",type:"textarea",placeholder:"Ticket description / issue details"}]}},sa={mainCategories:[{id:"tm1",name:"Technical Support",department:"Support",sla:"4h"},{id:"tm2",name:"Billing",department:"Accounts",sla:"8h"}],subCategories:[{id:"ts1",name:"Login Issue",mainCategory:"Technical Support",priority:"High"},{id:"ts2",name:"Refund Request",mainCategory:"Billing",priority:"Medium"}],tickets:[{id:"tt1",ticketNo:"TK-1001",subject:"Customer login issue",mainCategory:"Technical Support",subCategory:"Login Issue",category:"Technical Support / Login Issue",status:"Open",description:"Customer unable to login after password reset."},{id:"tt2",ticketNo:"TK-1002",subject:"Refund follow-up",mainCategory:"Billing",subCategory:"Refund Request",category:"Billing / Refund Request",status:"In Progress",description:"Customer requested refund status update."}]},la={items:{label:"Inventory Items",itemLabel:"Inventory Item",columns:[{key:"itemName",label:"Item Name"},{key:"sku",label:"SKU"},{key:"mainCategory",label:"Main Category"},{key:"subCategory",label:"Sub Category"},{key:"qty",label:"Qty"}],fields:[{key:"itemName",label:"Item Name",placeholder:"Dell Laptop 14"},{key:"sku",label:"SKU",placeholder:"DL-14-001"},{key:"mainCategory",label:"Main Category",placeholder:"Type / select main category"},{key:"subCategory",label:"Sub Category",placeholder:"Type / select sub category"},{key:"qty",label:"Qty",placeholder:"25"}]},mainCategories:{label:"Main Category",itemLabel:"Main Category",columns:[{key:"name",label:"Category Name"},{key:"code",label:"Code"},{key:"warehouse",label:"Warehouse"}],fields:[{key:"name",label:"Category Name",placeholder:"Electronics / Stationery / Spares"},{key:"code",label:"Code",placeholder:"ELEC / STAT / SPR"},{key:"warehouse",label:"Warehouse",placeholder:"Main Warehouse"}]},subCategories:{label:"Sub Category",itemLabel:"Sub Category",columns:[{key:"name",label:"Sub Category"},{key:"mainCategory",label:"Main Category"},{key:"reorderLevel",label:"Reorder Level"}],fields:[{key:"name",label:"Sub Category",placeholder:"Laptops / Keyboards / Toners"},{key:"mainCategory",label:"Main Category",placeholder:"Electronics"},{key:"reorderLevel",label:"Reorder Level",placeholder:"10 / 25 / 50"}]}},Ze={mainCategories:[{id:"sm1",name:"Electronics",code:"ELEC",warehouse:"Main Warehouse"},{id:"sm2",name:"Office Supplies",code:"OFF",warehouse:"Store Room"}],subCategories:[{id:"ss1",name:"Laptops",mainCategory:"Electronics",reorderLevel:"5"},{id:"ss2",name:"Printers",mainCategory:"Electronics",reorderLevel:"3"}],items:[{id:"si1",itemName:"Dell Latitude 5440",sku:"DL5440",category:"Electronics / Laptops",qty:"12"},{id:"si2",itemName:"HP LaserJet Pro",sku:"HPLJPRO",category:"Electronics / Printers",qty:"4"}]},we=["Active","Inactive"],ct=["Draft","Sent","Approved","Rejected","Converted"],na=["Draft","Sent","Partially Paid","Paid","Overdue","Cancelled"],mt=["Pending","Partially Paid","Paid","Failed","Refunded"],dt=["Pending","Packed","Shipped","Completed","Cancelled"],ia={customers:[{id:"cust_1",name:"Ultra HD Prints",gstin:"33ABCDE1234F1Z5",phone:"9876543210",email:"accounts@ultrahdprints.example",billingAddress:"No 17, 2nd Cross Street, Venkateswara Nagar"}],itemMasters:[{id:"itm_1",name:"POS Billing Setup",itemType:"Service",sku:"POS-SETUP",hsnSacCode:"998313",unit:"Nos",defaultRate:"24999",taxPercent:"18"},{id:"itm_2",name:"Thermal Printer",itemType:"Product",sku:"THERMAL-PRN",hsnSacCode:"844332",unit:"Nos",defaultRate:"15000",taxPercent:"18"}],gstTemplates:[{id:"gst_1",name:"India GST 18% (Intra State)",taxScope:"Intra State",cgst:"9",sgst:"9",igst:"0",cess:"0",status:"Active",notes:"Default GST for local billing"},{id:"gst_2",name:"India GST 18% (Inter State)",taxScope:"Inter State",cgst:"0",sgst:"0",igst:"18",cess:"0",status:"Active",notes:"Use for interstate billing"}],billingTemplates:[{id:"bt_1",name:"Default GST Invoice Template",docType:"Invoice",gstTemplateId:"gst_1",prefix:"INV",themeColor:"#22c55e",footerNote:"Thank you for your business.",termsText:"Payment due within 7 days.",status:"Active"},{id:"bt_2",name:"Estimate Proposal Template",docType:"Estimate",gstTemplateId:"gst_1",prefix:"EST",themeColor:"#3b82f6",footerNote:"Estimate validity: 15 days.",termsText:"Subject to stock availability.",status:"Active"}],estimates:[{id:"est_1",docNo:"EST-1001",customerName:"Ultra HD Prints",customerGstin:"33ABCDE1234F1Z5",issueDate:"2026-02-20",dueDate:"2026-02-27",status:"Sent",gstTemplateId:"gst_1",billingTemplateId:"bt_2",salesperson:"Guru",billingAddress:"No 17, 2nd Cross Street, Venkateswara Nagar",notes:"Quote includes installation support.",termsText:"Advance 50% before order confirmation.",items:[{id:"eli_1",description:"Thermal Printer",qty:"2",rate:"15000",taxPercent:"18"},{id:"eli_2",description:"Barcode Scanner",qty:"4",rate:"3500",taxPercent:"18"}]}],invoices:[{id:"inv_1",docNo:"INV-1001",customerName:"Ultra HD Prints",customerGstin:"33ABCDE1234F1Z5",issueDate:"2026-02-24",dueDate:"2026-03-03",status:"Draft",gstTemplateId:"gst_1",billingTemplateId:"bt_1",salesperson:"Guru",billingAddress:"No 17, 2nd Cross Street, Venkateswara Nagar",notes:"Thanks for your business.",termsText:"Due on receipt.",items:[{id:"ili_1",description:"POS Billing Setup",qty:"1",rate:"24999",taxPercent:"18"}]}]};function ue(i){const h=Number(i||0);return Number.isFinite(h)?h:0}function Le(i){return`INR ${ue(i).toLocaleString("en-IN",{maximumFractionDigits:2})}`}function Xe(i){return ue(i==null?void 0:i.cgst)+ue(i==null?void 0:i.sgst)+ue(i==null?void 0:i.igst)+ue(i==null?void 0:i.cess)}function Pe(){return{id:`line_${Date.now()}_${Math.random().toString(36).slice(2,7)}`,itemMasterId:"",inventoryItemId:"",description:"",qty:"1",rate:"",taxPercent:""}}function ve(i="invoice"){const h=i==="estimate"?"EST":"INV",d=new Date().toISOString().slice(0,10);return{id:"",docNo:`${h}-${Date.now().toString().slice(-6)}`,customerName:"",customerGstin:"",issueDate:d,dueDate:d,status:"Draft",gstTemplateId:"",billingTemplateId:"",salesperson:"",billingAddress:"",notes:"",termsText:"",paymentStatus:i==="invoice"?"Pending":"",deliveryStatus:i==="invoice"?"Pending":"",inventoryCommitted:!1,items:[Pe()]}}function Fe(i,h){const d=(h||[]).find(W=>W.id===i.gstTemplateId),D=d?Xe(d):0,x=Array.isArray(i==null?void 0:i.items)?i.items:[];let k=0,K=0;return x.forEach(W=>{const J=ue(W.qty),le=ue(W.rate),te=J*le,ne=ue(W.taxPercent||D);k+=te,K+=te*(ne/100)}),{subtotal:k,taxTotal:K,grandTotal:k+K}}function be(i){return i.reduce((h,d)=>(d.type==="multiselect"?h[d.key]=Array.isArray(d.defaultValue)?[...d.defaultValue]:[]:h[d.key]=d.defaultValue??"",h),{})}function ra(i){return i&&typeof i=="object"&&Object.keys(Me).every(h=>Array.isArray(i[h]))}function oa(i){return i&&typeof i=="object"&&Object.keys($e).every(h=>Array.isArray(i[h]))}function ca(i){return i&&typeof i=="object"&&Object.keys(Se).every(h=>Array.isArray(i[h]))}function ma(i,h){return i&&typeof i=="object"&&Object.keys(h).every(d=>Array.isArray(i[d]))}function We(i){return i&&typeof i=="object"&&Array.isArray(i.customers)&&Array.isArray(i.itemMasters)&&Array.isArray(i.gstTemplates)&&Array.isArray(i.billingTemplates)&&Array.isArray(i.estimates)&&Array.isArray(i.invoices)}function je(i){const h=String(i||"").trim();if(!h)return"-";const d=h.match(/^(\d{1,2}):(\d{2})$/);if(!d)return h;let D=Number(d[1]);const x=d[2];if(!Number.isFinite(D))return h;const k=D>=12?"PM":"AM";return D=D%12||12,`${D}:${x} ${k}`}function ut(){return new Date().toISOString().slice(0,10)}function pt(){const i=new Date,h=String(i.getHours()).padStart(2,"0"),d=String(i.getMinutes()).padStart(2,"0");return`${h}:${d}`}function Je(i,h){const d=String(i||"").trim(),D=String(h||"").trim(),x=te=>{const ne=te.match(/^(\d{1,2}):(\d{2})$/);if(!ne)return null;const he=Number(ne[1]),M=Number(ne[2]);return!Number.isFinite(he)||!Number.isFinite(M)?null:he*60+M},k=x(d),K=x(D);if(k===null||K===null||K<k)return"";const W=K-k,J=Math.floor(W/60),le=W%60;return!J&&!le?"0h 0m":`${J}h ${le}m`}function ge({title:i,badgeLabel:h="",rows:d=[],columns:D=[],renderCells:x,renderActions:k,noRowsText:K="No rows found.",searchPlaceholder:W="Search",searchBy:J,pageSize:le=Xt,withoutOuterCard:te=!1,headerBottom:ne=null,enableExport:he=!1,exportFileName:M="table-data",exportCellValue:z,actionHeaderStyle:H=null,actionCellStyle:Z=null}){const[b,A]=m.useState(""),[q,$]=m.useState(1),I=m.useMemo(()=>{const f=String(b||"").trim().toLowerCase();return f?d.filter(C=>(typeof J=="function"?String(J(C)||""):Object.values(C||{}).join(" ")).toLowerCase().includes(f)):d},[d,J,b]),G=I.length,oe=Math.max(1,Math.ceil(G/le)),ce=Math.min(q,oe),V=(ce-1)*le,re=I.slice(V,V+le),c=G?V+1:0,P=G?V+re.length:0;m.useEffect(()=>{$(1)},[b,d.length]),m.useEffect(()=>{q>oe&&$(oe)},[q,oe]);function B(f,C){if(typeof z=="function")return String(z(f,C)??"");const F=f==null?void 0:f[C.key];if(F==null)return"";if(typeof F=="object")try{return JSON.stringify(F)}catch{return String(F)}return String(F)}function O(){const f=D.map(j=>String(j.label||j.key||"")),C=j=>{const U=String(j??"");return/[",\n]/.test(U)?`"${U.replace(/"/g,'""')}"`:U},F=[f.map(C).join(","),...I.map(j=>D.map(U=>C(B(j,U))).join(","))],R=new Blob([`\uFEFF${F.join(`
`)}`],{type:"text/csv;charset=utf-8;"}),ie=URL.createObjectURL(R),o=document.createElement("a");o.href=ie,o.download=`${M}.csv`,document.body.appendChild(o),o.click(),o.remove(),URL.revokeObjectURL(ie)}function E(){const f=window.open("","_blank","width=1000,height=700");if(!f){window.alert("Popup blocked. Please allow popups to export PDF.");return}const C=o=>String(o??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),F=D.map(o=>`<th>${C(o.label||o.key||"")}</th>`).join(""),R=I.length?I.map(o=>`<tr>${D.map(U=>`<td>${C(B(o,U))}</td>`).join("")}</tr>`).join(""):`<tr><td colspan="${D.length}">No rows found.</td></tr>`;f.document.write(`
      <!doctype html>
      <html>
        <head>
          <title>${C(i)} - Export</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 24px; color: #111; }
            h2 { margin: 0 0 12px 0; font-size: 20px; }
            p { margin: 0 0 12px 0; color: #555; font-size: 12px; }
            table { width: 100%; border-collapse: collapse; }
            th, td { border: 1px solid #ccc; padding: 8px; text-align: left; font-size: 12px; vertical-align: top; }
            th { background: #f1f1f1; }
          </style>
        </head>
        <body>
          <h2>${C(i)}</h2>
          <p>Exported ${C(new Date().toLocaleString())}</p>
          <table>
            <thead><tr>${F}</tr></thead>
            <tbody>${R}</tbody>
          </table>
        </body>
      </html>
    `),f.document.close();const ie=()=>{try{f.focus(),f.print()}catch{}};f.onload=()=>{f.setTimeout(ie,250)},f.setTimeout(ie,500)}const T=e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-end gap-2",children:[h?e.jsx("span",{className:"badge bg-secondary table-count-badge",children:h}):null,he?e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-success",onClick:O,children:[e.jsx("i",{className:"bi bi-file-earmark-excel me-1","aria-hidden":"true"}),"Excel"]}),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:E,children:[e.jsx("i",{className:"bi bi-file-earmark-pdf me-1","aria-hidden":"true"}),"PDF"]})]}):null,e.jsxs("label",{className:"table-search mb-0",children:[e.jsx("i",{className:"bi bi-search","aria-hidden":"true"}),e.jsx("input",{type:"search",placeholder:W,value:b,onChange:f=>A(f.target.value)})]})]});return e.jsxs("div",{className:te?"":"card p-3",children:[e.jsxs("div",{className:`d-flex flex-wrap align-items-center justify-content-between gap-2 ${ne?"mb-2":"mb-3"}`,children:[e.jsx("h6",{className:"mb-0",children:i}),ne?null:T]}),ne?e.jsxs("div",{className:"d-flex flex-wrap align-items-start justify-content-between gap-2 mb-3",children:[e.jsx("div",{className:"flex-grow-1",style:{minWidth:"320px"},children:ne}),T]}):null,e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-borderless align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[D.map(f=>e.jsx("th",{className:f.headerClassName||"",style:f.thStyle||void 0,children:f.label},f.key||f.label)),k?e.jsx("th",{className:"text-end",style:H||void 0,children:"Action"}):null]})}),e.jsx("tbody",{children:re.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:D.length+(k?1:0),className:"text-secondary",children:K})}):re.map((f,C)=>e.jsxs("tr",{children:[x(f).map((F,R)=>(()=>{const ie=D[R]||{};return e.jsx("td",{className:ie.cellClassName||"",style:{backgroundColor:C%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)",...ie.tdStyle||{}},children:F},`${f.id||"row"}-${R}`)})()),k?e.jsx("td",{className:"text-end",style:{backgroundColor:C%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)",...Z||{}},children:k(f)}):null]},f.id||f.key||JSON.stringify(f)))})]})}),e.jsxs("div",{className:"table-footer mt-2",children:[e.jsxs("div",{className:"table-info",children:["Showing ",c," to ",P," of ",G," entries"]}),e.jsx(Wt,{page:ce,totalPages:oe,onPageChange:$,showPageLinks:!0,showPageLabel:!1,maxPageLinks:5})]})]})}function da(){const i=["leads","contacts","deals","followUps","meetings","activities"],[h,d]=m.useState(ea),[D,x]=m.useState(i[0]),[k,K]=m.useState(()=>{const c=new Date;return new Date(c.getFullYear(),c.getMonth(),1)}),[W,J]=m.useState(null),[le,te]=m.useState("all"),[ne,he]=m.useState("all"),[M,z]=m.useState(()=>Object.fromEntries(Object.entries(Se).map(([c,P])=>[c,be(P.fields)]))),[H,Z]=m.useState(()=>Object.fromEntries(Object.keys(Se).map(c=>[c,""])));m.useEffect(()=>{try{const c=window.localStorage.getItem(it);if(!c)return;const P=JSON.parse(c);ca(P)&&d(P)}catch{}},[]),m.useEffect(()=>{window.localStorage.setItem(it,JSON.stringify(h))},[h]),m.useEffect(()=>{D!=="meetings"&&J(null)},[D]);const b=m.useMemo(()=>{const c=h.leads||[],P=h.deals||[],B=h.followUps||[],O=c.filter(C=>!["closed","converted"].includes(String(C.status||"").toLowerCase())).length,E=P.filter(C=>!["won","lost","closed"].includes(String(C.status||"").toLowerCase())).reduce((C,F)=>C+ue(F.amount),0),T=new Date().toISOString().slice(0,10),f=B.filter(C=>{if(String(C.dueDate||"")!==T)return!1;const F=String(C.status||"").toLowerCase();return F!=="done"&&F!=="completed"}).length;return[{label:"Open Leads",value:String(O),icon:"bi-person-plus"},{label:"Pipeline Value",value:`INR ${E.toLocaleString("en-IN")}`,icon:"bi-graph-up-arrow"},{label:"Follow-ups Today",value:String(f),icon:"bi-telephone-forward"}]},[h]);function A(c,P,B){z(O=>({...O,[c]:{...O[c],[P]:B}}))}function q(c){Z(P=>({...P,[c]:""})),z(P=>({...P,[c]:be(Se[c].fields)}))}function $(c,P){Z(O=>({...O,[c]:P.id}));const B={};Se[c].fields.forEach(O=>{const E=P[O.key];O.type==="multiselect"?Array.isArray(E)?B[O.key]=E:typeof E=="string"&&E.trim()?B[O.key]=E.split(",").map(T=>T.trim()).filter(Boolean):Array.isArray(O.defaultValue)?B[O.key]=[...O.defaultValue]:B[O.key]=[]:B[O.key]=E??O.defaultValue??""}),z(O=>({...O,[c]:B}))}function I(c,P){d(B=>({...B,[c]:(B[c]||[]).filter(O=>O.id!==P)})),H[c]===P&&q(c)}function G(c,P){P.preventDefault();const B=Se[c],O=M[c]||{};if(B.fields.some(C=>C.type==="multiselect"?!Array.isArray(O[C.key])||O[C.key].length===0:!String(O[C.key]||"").trim()))return;const T={};if(B.fields.forEach(C=>{C.type==="multiselect"?T[C.key]=Array.isArray(O[C.key])?O[C.key].map(F=>String(F).trim()).filter(Boolean):[]:T[C.key]=String(O[C.key]||"").trim()}),c==="meetings"){const C=Array.isArray(T.reminderChannel)?T.reminderChannel:[T.reminderChannel].filter(Boolean);T.reminderSummary=`${C.join(", ")} • ${T.reminderMinutes} min before`}const f=H[c];d(C=>{const F=C[c]||[];return f?{...C,[c]:F.map(R=>R.id===f?{...R,...T}:R)}:{...C,[c]:[{id:`${c}_${Date.now()}`,...T},...F]}}),q(c)}const oe=m.useMemo(()=>{const c=h.meetings||[],P=new Date(k.getFullYear(),k.getMonth(),1),B=new Date(k.getFullYear(),k.getMonth()+1,0),O=(P.getDay()+6)%7,E=new Date(P);E.setDate(P.getDate()-O);const T=[];for(let f=0;f<42;f+=1){const C=new Date(E);C.setDate(E.getDate()+f);const F=C.toISOString().slice(0,10);T.push({isoDate:F,day:C.getDate(),inMonth:C>=P&&C<=B,meetings:c.filter(R=>String(R.meetingDate||"")===F).sort((R,ie)=>String(R.meetingTime||"").localeCompare(String(ie.meetingTime||"")))})}return{monthLabel:P.toLocaleString("en-US",{month:"long",year:"numeric"}),cells:T}},[k,h.meetings]);function ce(c){K(P=>new Date(P.getFullYear(),P.getMonth()+c,1))}function V(c){J(c)}function re(){J(null)}return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"CRM"}),e.jsx("p",{className:"text-secondary mb-3",children:"Manage leads, contacts, deals, follow-ups, and activity timeline in one page."}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:i.map(c=>{const P=Se[c],B=Array.isArray(h[c])?h[c].length:0;return e.jsxs("button",{type:"button",className:`btn btn-sm ${D===c?"btn-success":"btn-outline-light"}`,onClick:()=>x(c),children:[P.label," (",B,")"]},`crm-tab-${c}`)})})]}),D==="leads"?e.jsx("div",{className:"row g-3",children:b.map(c=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsx("div",{className:"stat-icon stat-icon-primary mb-2",children:e.jsx("i",{className:`bi ${c.icon}`,"aria-hidden":"true"})}),e.jsx("div",{className:"text-secondary small",children:c.label}),e.jsx("h5",{className:"mb-0 mt-1",children:c.value})]})},c.label))}):null,i.filter(c=>c===D).map(c=>{const P=Se[c],B=h[c]||[],O=[{key:"all",label:"All"},{key:"open",label:"Open"},{key:"closed",label:"Closed"},{key:"converted",label:"Converted"}],E=[{key:"all",label:"All"},{key:"scheduled",label:"Scheduled"},{key:"completed",label:"Completed"},{key:"rescheduled",label:"Rescheduled"},{key:"cancelled",label:"Cancelled"}],T=c==="leads"?B.filter(o=>le==="all"?!0:String(o.status||"").trim().toLowerCase()===le):c==="meetings"?B.filter(o=>ne==="all"?!0:String(o.status||"").trim().toLowerCase()===ne):B,f=c==="leads"?O.reduce((o,j)=>(o[j.key]=j.key==="all"?B.length:B.filter(U=>String(U.status||"").trim().toLowerCase()===j.key).length,o),{}):{},C=c==="meetings"?E.reduce((o,j)=>(o[j.key]=j.key==="all"?B.length:B.filter(U=>String(U.status||"").trim().toLowerCase()===j.key).length,o),{}):{},F=M[c]||{},R=H[c]||"",ie=P.fields.some(o=>o.key==="phoneCountryCode");return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:R?`Edit ${P.itemLabel}`:`Create ${P.itemLabel}`}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:o=>G(c,o),children:[e.jsx("div",{className:"row g-3",children:P.fields.map(o=>e.jsxs(m.Fragment,{children:[ie&&o.key==="phoneCountryCode"?null:e.jsxs("div",{className:c==="leads"?o.key==="name"||o.key==="company"||o.key==="phone"?"col-12 col-md-6 col-xl-3":o.key==="stage"||o.key==="status"?"col-12 col-md-6 col-xl-1":"col-12 col-md-6 col-xl-4":c==="activities"?o.key==="activityType"||o.key==="relatedTo"||o.key==="date"||o.key==="owner"?"col-12 col-md-6 col-xl-2":o.key==="notes"?"col-12 col-md-6 col-xl-3":"col-12 col-md-6 col-xl-4":c==="contacts"?o.key==="name"||o.key==="company"||o.key==="email"?"col-12 col-md-6 col-xl-2":o.key==="phone"?"col-12 col-md-6 col-xl-3":o.key==="tag"?"col-12 col-md-6 col-xl-2":"col-12 col-md-6 col-xl-4":c==="deals"?o.key==="dealName"||o.key==="company"?"col-12 col-md-6 col-xl-3":o.key==="stage"?"col-12 col-md-6 col-xl-1":o.key==="amount"||o.key==="status"?"col-12 col-md-6 col-xl-2":"col-12 col-md-6 col-xl-4":c==="followUps"?o.key==="subject"||o.key==="relatedTo"?"col-12 col-md-6 col-xl-3":o.key==="dueDate"||o.key==="owner"?"col-12 col-md-6 col-xl-2":o.key==="status"?"col-12 col-md-6 col-xl-1":"col-12 col-md-6 col-xl-4":c==="meetings"?o.key==="title"||o.key==="companyOrClientName"?"col-12 col-md-6 col-xl-3":o.key==="relatedTo"||o.key==="meetingDate"||o.key==="meetingTime"?"col-12 col-md-6 col-xl-2":o.key==="owner"?"col-12 col-md-6 col-xl-3":o.key==="meetingMode"||o.key==="reminderChannel"||o.key==="reminderMinutes"||o.key==="status"?"col-12 col-md-6 col-xl-2":"col-12 col-md-6 col-xl-4":"col-12 col-md-6 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:o.label}),ie&&o.key==="phone"?e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",style:{maxWidth:c==="leads"||c==="contacts"?"120px":"220px"},value:F.phoneCountryCode||"+91",onChange:j=>A(c,"phoneCountryCode",j.target.value),children:Qe.map(j=>e.jsx("option",{value:j.value,children:j.label},`contact-phone-code-${j.value}`))}),e.jsx("input",{type:"text",className:"form-control",placeholder:o.placeholder,value:F.phone||"",onChange:j=>A(c,"phone",j.target.value)})]}):o.type==="datalist"?e.jsxs(m.Fragment,{children:[e.jsx("input",{type:"text",list:`${c}-${o.key}-datalist`,className:"form-control datalist-readable-input",placeholder:o.placeholder,value:F[o.key]||"",onChange:j=>A(c,o.key,j.target.value)}),e.jsx("datalist",{id:`${c}-${o.key}-datalist`,children:o.datalistSource==="crmContacts"?(h.contacts||[]).flatMap(j=>{const U=[];return String(j.name||"").trim()&&U.push(j.name.trim()),String(j.company||"").trim()&&U.push(j.company.trim()),U}).filter((j,U,me)=>me.indexOf(j)===U).map(j=>e.jsx("option",{value:j},`${c}-${o.key}-${j}`)):null})]}):o.type==="multiselect"?e.jsx("select",{className:"form-select",multiple:!0,size:1,value:Array.isArray(F[o.key])?F[o.key]:[],onChange:j=>{const U=Array.from(j.target.selectedOptions).map(me=>me.value);A(c,o.key,U)},children:(o.options||[]).map(j=>e.jsx("option",{value:j,children:j},j))}):o.type==="select"?e.jsxs("select",{className:"form-select",value:F[o.key]||o.defaultValue||"",onChange:j=>A(c,o.key,j.target.value),children:[e.jsxs("option",{value:"",children:["Select ",o.label]}),(o.options||[]).map(j=>e.jsx("option",{value:j,children:j},j))]}):o.type==="date"||o.type==="time"?e.jsx("input",{type:o.type,className:"form-control",value:F[o.key]||"",onChange:j=>A(c,o.key,j.target.value)}):e.jsx("input",{type:"text",className:"form-control",placeholder:o.placeholder,value:F[o.key]||"",onChange:j=>A(c,o.key,j.target.value)})]},`${c}-${o.key}`),(c==="leads"||c==="deals"||c==="followUps"||c==="meetings"||c==="activities")&&(o.key==="status"||c==="activities"&&o.key==="notes")?e.jsx("div",{className:c==="leads"||c==="deals"||c==="followUps"||c==="activities"||c==="meetings"?"col-12 col-md-6 col-xl-1 d-flex align-items-end":"col-12 col-md-6 col-xl-4 d-flex align-items-end",children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap w-100",children:[e.jsx("button",{type:"submit",className:`btn btn-success btn-sm ${["leads","contacts","deals","followUps","meetings","activities"].includes(c)?"single-row-form-submit-btn":""}`,children:R?"Update":"Create"}),R?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>q(c),children:"Cancel"}):null]})}):null,c==="contacts"&&o.key==="tag"?e.jsx("div",{className:"col-12 col-md-6 col-xl-1 d-flex align-items-end",children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap w-100",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm single-row-form-submit-btn",children:R?"Update":"Create"}),R?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>q(c),children:"Cancel"}):null]})}):null]},`${c}-${o.key}`))}),c!=="leads"&&c!=="contacts"&&c!=="deals"&&c!=="followUps"&&c!=="meetings"&&c!=="activities"?e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:R?"Update":"Create"}),R?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>q(c),children:"Cancel"}):null]}):null]})]}),e.jsx(ge,{title:`${P.label} List`,badgeLabel:`${T.length} items`,rows:T,columns:P.columns,withoutOuterCard:!0,searchPlaceholder:`Search ${P.label.toLowerCase()}`,noRowsText:`No ${P.label.toLowerCase()} yet.`,enableExport:!0,exportFileName:`crm-${P.label.toLowerCase().replace(/\s+/g,"-")}`,headerBottom:c==="leads"?e.jsxs("div",{className:"d-flex flex-column gap-2",children:[e.jsx("div",{className:"d-flex flex-wrap gap-2",children:O.map(o=>e.jsxs("button",{type:"button",className:`btn btn-sm ${le===o.key?"btn-success":"btn-outline-light"}`,onClick:()=>te(o.key),children:[o.label," (",f[o.key]||0,")"]},`lead-status-tab-${o.key}`))}),e.jsx("div",{className:"small text-secondary",children:"Closed and converted leads older than 180 days will be automatically deleted."})]}):c==="meetings"?e.jsx("div",{className:"d-flex flex-wrap gap-2",children:E.map(o=>e.jsxs("button",{type:"button",className:`btn btn-sm ${ne===o.key?"btn-success":"btn-outline-light"}`,onClick:()=>he(o.key),children:[o.label," (",C[o.key]||0,")"]},`meeting-status-tab-${o.key}`))}):null,searchBy:o=>P.columns.map(j=>o[j.key]||"").join(" "),exportCellValue:(o,j)=>{if(j.key==="phone"){const U=String(o.phone||"").trim();return U?`${String(o.phoneCountryCode||"+91").trim()} ${U}`:""}if(c==="meetings"&&j.key==="meetingTime")return je(o[j.key]);if(j.key==="reminderSummary"){const U=Array.isArray(o.reminderChannel)?o.reminderChannel.join(", "):String(o.reminderChannel||"");return o.reminderSummary||`${U} ${o.reminderMinutes?`• ${o.reminderMinutes} min before`:""}`.trim()}return o[j.key]||""},renderCells:o=>P.columns.map(j=>{if(j.key==="phone"){const U=String(o.phone||"").trim();return U?`${String(o.phoneCountryCode||"+91").trim()} ${U}`:"-"}return c==="meetings"&&j.key==="meetingTime"?je(o[j.key]):o[j.key]||"-"}),renderActions:o=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>$(c,o),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>I(c,o.id),children:"Delete"})]})}),c==="meetings"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1",children:"Meeting Schedule Calendar"}),e.jsx("div",{className:"small text-secondary",children:"Click a meeting label to view reminder and schedule details."})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:()=>ce(-1),children:e.jsx("i",{className:"bi bi-chevron-left","aria-hidden":"true"})}),e.jsx("div",{className:"small fw-semibold px-2",children:oe.monthLabel}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:()=>ce(1),children:e.jsx("i",{className:"bi bi-chevron-right","aria-hidden":"true"})})]})]}),e.jsxs("div",{className:"mb-2",style:{display:"grid",gridTemplateColumns:"repeat(7, minmax(0, 1fr))",gap:"8px"},children:[["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(o=>e.jsx("div",{className:"small text-secondary text-center fw-semibold py-1",children:o},o)),oe.cells.map(o=>e.jsxs("div",{style:{minHeight:"84px",border:"1px solid rgba(255,255,255,0.08)",borderRadius:"10px",padding:"8px",backgroundColor:o.inMonth?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.01)",opacity:o.inMonth?1:.55},children:[e.jsx("div",{className:"small fw-semibold mb-1",children:o.day}),e.jsxs("div",{className:"d-flex flex-column gap-1",children:[o.meetings.slice(0,3).map(j=>e.jsxs("button",{type:"button",className:"btn btn-success btn-sm text-start",style:{fontSize:"0.7rem",lineHeight:1.2,padding:"3px 6px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:`${je(j.meetingTime)} ${j.title||""}`,onClick:()=>V(j),children:[je(j.meetingTime)," ",j.title||"Meeting"]},j.id)),o.meetings.length>3?e.jsxs("div",{className:"small text-secondary",children:["+",o.meetings.length-3," more"]}):null]})]},o.isoDate))]})]}):null]},c)}),W?e.jsx("div",{role:"dialog","aria-modal":"true",className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.65)",zIndex:1050,padding:"1rem"},onClick:re,children:e.jsxs("div",{className:"card p-3",style:{width:"min(560px, 100%)"},onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-3 mb-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:W.title||"Meeting"}),e.jsx("div",{className:"small text-secondary",children:W.relatedTo||"-"})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:re,children:e.jsx("i",{className:"bi bi-x-lg","aria-hidden":"true"})})]}),e.jsxs("div",{className:"row g-3 small",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Date"}),e.jsx("div",{className:"fw-semibold",children:W.meetingDate||"-"})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Time"}),e.jsx("div",{className:"fw-semibold",children:je(W.meetingTime)})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Owner"}),e.jsx("div",{className:"fw-semibold",children:W.owner||"-"})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Meeting Mode"}),e.jsx("div",{className:"fw-semibold",children:W.meetingMode||"-"})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Reminder"}),e.jsx("div",{className:"fw-semibold",children:W.reminderSummary||`${Array.isArray(W.reminderChannel)?W.reminderChannel.join(", "):W.reminderChannel||"-"} • ${W.reminderMinutes||"-"} min before`})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Status"}),e.jsx("div",{className:"fw-semibold",children:W.status||"-"})]})]})]})}):null]})}function ua(){const[i,h]=m.useState("projects"),[d,D]=m.useState(ta),[x,k]=m.useState(be(Me.projects.fields)),[K,W]=m.useState("");m.useEffect(()=>{try{const b=window.localStorage.getItem(nt);if(!b)return;const A=JSON.parse(b);ra(A)&&D(A)}catch{}},[]),m.useEffect(()=>{window.localStorage.setItem(nt,JSON.stringify(d))},[d]),m.useEffect(()=>{W(""),k(be(Me[i].fields))},[i]);const J=Me[i],le=d[i]||[],te=new Set(["projects"]),ne=m.useMemo(()=>{const b=(d.projects||[]).filter($=>$.status.toLowerCase()==="active").length,A=(d.tasks||[]).length,q=(d.tasks||[]).filter($=>{const I=Date.parse($.dueDate);return Number.isFinite(I)&&I<Date.now()}).length;return[{label:"Active Projects",value:String(b),icon:"bi-diagram-3"},{label:"Tasks",value:String(A),icon:"bi-list-check"},{label:"Overdue Tasks",value:String(q),icon:"bi-exclamation-triangle"}]},[d]);function he(b,A){k(q=>{const $={...q,[b]:A};return i==="attendance"&&b==="status"&&A!=="Permission"&&($.permissionHours=""),$})}function M(b){W(b.id);const A={};J.fields.forEach(q=>{A[q.key]=b[q.key]||q.defaultValue||""}),k(A)}function z(){W(""),k(be(J.fields))}function H(b){D(A=>({...A,[i]:(A[i]||[]).filter(q=>q.id!==b)})),K===b&&z()}function Z(b){if(b.preventDefault(),J.fields.filter(I=>{const G=I.conditionalOn;return G?String(x[G.key]||"").trim()===String(G.value||"").trim():!0}).some(I=>!String(x[I.key]||"").trim()))return;const $={};J.fields.forEach(I=>{$[I.key]=String(x[I.key]).trim()}),i==="attendance"&&$.status!=="Permission"&&($.permissionHours=""),D(I=>{const G=I[i]||[];return K?{...I,[i]:G.map(oe=>oe.id===K?{...oe,...$}:oe)}:{...I,[i]:[{id:`${i}_${Date.now()}`,...$},...G]}}),z()}return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"Project Management"}),e.jsx("p",{className:"text-secondary mb-3",children:"Track project milestones, tasks, and team delivery."}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:Object.entries(Me).map(([b,A])=>e.jsx("button",{type:"button",className:`btn btn-sm ${i===b?"btn-success":"btn-outline-light"}`,onClick:()=>h(b),children:A.label},b))})]}),e.jsx("div",{className:"row g-3",children:ne.map(b=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsx("div",{className:"stat-icon stat-icon-primary mb-2",children:e.jsx("i",{className:`bi ${b.icon||"bi-grid"}`,"aria-hidden":"true"})}),e.jsx("div",{className:"text-secondary small",children:b.label}),e.jsx("h5",{className:"mb-0 mt-1",children:b.value})]})},b.label))}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:K?`Edit ${J.itemLabel}`:`Create ${J.itemLabel}`}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:Z,children:[e.jsxs("div",{className:"row g-3",children:[J.fields.map(b=>(()=>{const A=b.conditionalOn;if(!(!A||String(x[A.key]||"").trim()===String(A.value||"").trim()))return null;const $=i==="projects";return e.jsxs("div",{className:$?b.key==="projectName"||b.key==="owner"?"col-12 col-md-6 col-xl-4":b.key==="status"?"col-12 col-md-6 col-xl-3":"col-12 col-md-4":"col-12 col-md-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:b.label}),b.type==="select"?e.jsxs("select",{className:"form-select",value:x[b.key]||b.defaultValue||"",onChange:I=>he(b.key,I.target.value),children:[e.jsxs("option",{value:"",children:["Select ",b.label]}),(b.options||[]).map(I=>e.jsx("option",{value:I,children:I},I))]}):e.jsx("input",{type:b.type||"text",className:"form-control",placeholder:b.placeholder,value:x[b.key]||"",onChange:I=>he(b.key,I.target.value)})]},b.key)})()),te.has(i)?e.jsx("div",{className:"col-12 col-md-6 col-xl-1 d-flex align-items-end",children:e.jsx("div",{className:"w-100 d-flex gap-2 flex-wrap",children:e.jsx("button",{type:"submit",className:"btn btn-success btn-sm single-row-form-submit-btn",children:K?"Update":"Create"})})}):null]}),te.has(i)?null:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:K?"Update":"Create"}),K?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:z,children:"Cancel"}):null]})]})]}),e.jsx(ge,{title:J.label,badgeLabel:`${le.length} items`,rows:le,columns:J.columns,withoutOuterCard:i==="projects",searchPlaceholder:`Search ${J.label.toLowerCase()}`,noRowsText:`No ${J.label.toLowerCase()} yet.`,searchBy:b=>J.columns.map(A=>b[A.key]||"").join(" "),renderCells:b=>J.columns.map(A=>b[A.key]||"-"),renderActions:b=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>M(b),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>H(b.id),children:"Delete"})]})})]})}function pa(){const[i,h]=m.useState("employees"),[d,D]=m.useState(gt),[x,k]=m.useState(be($e.employees.fields)),[K,W]=m.useState([]),[J,le]=m.useState(""),[te,ne]=m.useState(""),[he,M]=m.useState(!1),[z,H]=m.useState({open:!1,employee:"",date:"",source:"User Side",outTime:"",completedTasks:"",taskNotes:"",mode:"edit"}),[Z,b]=m.useState({open:!1,rowId:"",employee:"",date:"",notes:""}),[A,q]=m.useState(""),[$,I]=m.useState("");m.useEffect(()=>{try{const l=window.localStorage.getItem(rt);if(!l)return;const g=JSON.parse(l);oa(g)&&D(g)}catch{}},[]),m.useEffect(()=>{const l=()=>{const g=String(window.location.hash||"").replace(/^#/,"").trim().toLowerCase();g==="attendance"?h("attendance"):(g==="employees"||g==="leaves"||g==="payroll")&&h(g)};return l(),window.addEventListener("hashchange",l),()=>{window.removeEventListener("hashchange",l)}},[]),m.useEffect(()=>{window.localStorage.setItem(rt,JSON.stringify(d))},[d]),m.useEffect(()=>{let l=!1;async function g(){try{const n=await Ee("/api/business-autopilot/users");if(l)return;W(Array.isArray(n==null?void 0:n.users)?n.users:[])}catch{l||W([])}}return g(),()=>{l=!0}},[]),m.useEffect(()=>{le("");const l=be($e[i].fields);i==="attendance"&&(l.date=ut()),k(l)},[i]);const G=$e[i],oe=m.useMemo(()=>i!=="attendance"?G.columns:(G.columns||[]).map(l=>l.key==="date"?{...l,thStyle:{width:"140px",minWidth:"140px",whiteSpace:"nowrap"},tdStyle:{width:"140px",minWidth:"140px",whiteSpace:"nowrap"}}:l.key==="inTime"||l.key==="outTime"?{...l,thStyle:{width:"120px",minWidth:"120px",whiteSpace:"nowrap"},tdStyle:{width:"120px",minWidth:"120px",whiteSpace:"nowrap"}}:l),[i,G.columns]),ce=d[i]||[],V=ut(),re=m.useMemo(()=>Array.from(new Set((d.employees||[]).map(l=>String(l.name||"").trim()).filter(Boolean))),[d.employees]),c=m.useMemo(()=>Array.from(new Set((K||[]).map(l=>String((l==null?void 0:l.name)||"").trim()).filter(Boolean))),[K]),P=m.useMemo(()=>{const l=new Map;return(K||[]).forEach(g=>{const n=String((g==null?void 0:g.name)||"").trim().toLowerCase();n&&l.set(n,g)}),l},[K]),B=m.useMemo(()=>{if(i!=="attendance")return[];const l=String(x.employee||"").trim().toLowerCase();return(l?re.filter(n=>n.toLowerCase().includes(l)):re).slice(0,8)},[i,re,x.employee]),O=m.useMemo(()=>{const g=(Array.isArray(d.attendance)?d.attendance:[]).map(Q=>String((Q==null?void 0:Q.date)||"").trim()).filter(Q=>/^\d{4}-\d{2}-\d{2}$/.test(Q)).sort();if(!g.length){const Q=new Date;return{minYear:Q.getFullYear(),maxYear:Q.getFullYear(),minMonthByYear:new Map([[String(Q.getFullYear()),Q.getMonth()+1]]),maxMonthByYear:new Map([[String(Q.getFullYear()),Q.getMonth()+1]])}}const n=g[0],s=g[g.length-1],p=Number(n.slice(0,4)),S=Number(s.slice(0,4)),w=new Map,_=new Map;return g.forEach(Q=>{const ae=Q.slice(0,4),pe=Number(Q.slice(5,7));(!w.has(ae)||pe<w.get(ae))&&w.set(ae,pe),(!_.has(ae)||pe>_.get(ae))&&_.set(ae,pe)}),{minYear:p,maxYear:S,minMonthByYear:w,maxMonthByYear:_}},[d.attendance]),E=m.useMemo(()=>{const l=[];for(let g=O.minYear;g<=O.maxYear;g+=1)l.push(String(g));return l},[O]),T=m.useMemo(()=>{const l=String(A||"");if(!l)return[];const g=O.minMonthByYear.get(l)||1,n=O.maxMonthByYear.get(l)||12,s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=[];for(let S=g;S<=n;S+=1)p.push({value:String(S).padStart(2,"0"),label:s[S-1]||String(S)});return p},[O,A]);m.useEffect(()=>{te&&re.includes(te)||ne(re[0]||"")},[re,te]),m.useEffect(()=>{const l=E;l.length&&q(g=>g&&l.includes(g)?g:l[0])},[E]),m.useEffect(()=>{const l=T;l.length&&I(g=>g&&l.some(n=>n.value===g)?g:l[0].value)},[T]);const f=m.useMemo(()=>{const l=(d.employees||[]).length,g=(d.attendance||[]).filter(s=>String(s.status||"").toLowerCase().includes("present")).length,n=(d.leaves||[]).filter(s=>String(s.status||"").toLowerCase()==="pending").length;return[{label:"Employees",value:String(l),icon:"bi-people"},{label:"Attendance Today",value:String(g),icon:"bi-calendar-check"},{label:"Pending Leaves",value:String(n),icon:"bi-hourglass-split"}]},[d]);function C(l,g){k(n=>{const s={...n,[l]:g};if(i==="employees"&&l==="name"){const p=P.get(String(g||"").trim().toLowerCase());p&&(s.department=String(p.department||s.department||"").trim(),s.designation=String(p.employee_role||s.designation||"").trim())}return i==="attendance"&&l==="status"&&g!=="Permission"&&(s.permissionHours=""),i==="attendance"&&l==="entryMode"&&g==="User Side"&&(s.inTime="",s.outTime=""),s})}function F(l){le(l.id);const g={};G.fields.forEach(n=>{g[n.key]=l[n.key]||n.defaultValue||""}),k(g)}function R(){le(""),k(be(G.fields))}function ie(l){D(g=>({...g,[i]:(g[i]||[]).filter(n=>n.id!==l)})),J===l&&R()}function o(l){if(l.preventDefault(),G.fields.filter(p=>{const S=p.conditionalOn;return S?String(x[S.key]||"").trim()===String(S.value||"").trim():!0}).some(p=>!p.optional&&!String(x[p.key]||"").trim()))return;const s={};G.fields.forEach(p=>{s[p.key]=String(x[p.key]).trim()}),i==="attendance"&&(s.date=s.date||V,s.entryMode=s.entryMode||"HR Side",s.status!=="Permission"&&(s.permissionHours=""),s.workedHours=Je(s.inTime,s.outTime),s.completedTasks=String(s.completedTasks||"").trim(),s.taskNotes=String(s.taskNotes||"").trim()),D(p=>{const S=p[i]||[];return J?{...p,[i]:S.map(w=>w.id===J?{...w,...s}:w)}:{...p,[i]:[{id:`${i}_${Date.now()}`,...s},...S]}}),R()}function j({employee:l,date:g=V,patch:n={}}){const s=String(l||"").trim(),p=String(g||V).trim()||V;s&&D(S=>{const w=S.attendance||[],_=w.findIndex(pe=>String(pe.employee||"").trim()===s&&String(pe.date||"").trim()===p),ae={..._>=0?w[_]:{id:`attendance_${Date.now()}`,employee:s,date:p,entryMode:"User Side",inTime:"",outTime:"",workedHours:"",status:"Present",permissionHours:"",notes:"",completedTasks:"",taskNotes:""},...n};return ae.workedHours=Je(ae.inTime,ae.outTime),ae.status!=="Permission"&&(ae.permissionHours=""),_>=0?{...S,attendance:w.map((pe,Te)=>Te===_?ae:pe)}:{...S,attendance:[ae,...w]}})}function U(l,g,n="User Side"){const s=String(g||"").trim();if(!s)return;const p=pt();if(l==="out"){const S=(d.attendance||[]).find(w=>String(w.employee||"").trim()===s&&String(w.date||"").trim()===V);H({open:!0,employee:s,date:V,source:n,outTime:p,completedTasks:String((S==null?void 0:S.completedTasks)||"").trim(),taskNotes:String((S==null?void 0:S.taskNotes)||"").trim(),mode:"punchOut"});return}j({employee:s,date:V,patch:l==="in"?{entryMode:n,inTime:p,status:"Present"}:{entryMode:n,outTime:p,status:"Present"}})}function me(l){H({open:!0,employee:String((l==null?void 0:l.employee)||"").trim(),date:String((l==null?void 0:l.date)||V).trim()||V,source:String((l==null?void 0:l.entryMode)||"HR Side").trim()||"HR Side",outTime:String((l==null?void 0:l.outTime)||"").trim(),completedTasks:String((l==null?void 0:l.completedTasks)||"").trim(),taskNotes:String((l==null?void 0:l.taskNotes)||"").trim(),mode:"edit"})}function ye(){H(l=>({...l,open:!1}))}function Ne(l){l.preventDefault();const g=String(z.employee||"").trim(),n=String(z.date||V).trim()||V;if(!g)return;const s={completedTasks:String(z.completedTasks||"").trim(),taskNotes:String(z.taskNotes||"").trim()};z.mode==="punchOut"&&(s.entryMode=z.source||"User Side",s.outTime=z.outTime||pt(),s.status="Present"),j({employee:g,date:n,patch:s}),ye()}const X=m.useMemo(()=>(d.attendance||[]).find(l=>String(l.employee||"").trim()===String(te||"").trim()&&String(l.date||"").trim()===V)||null,[d.attendance,te,V]),Ce=m.useMemo(()=>i!=="attendance"?ce:(ce||[]).filter(l=>{const g=String((l==null?void 0:l.date)||"");return/^\d{4}-\d{2}-\d{2}$/.test(g)?!(A&&g.slice(0,4)!==A||$&&g.slice(5,7)!==$):!0}),[i,ce,A,$]);function Y(l){b({open:!0,rowId:String((l==null?void 0:l.id)||""),employee:String((l==null?void 0:l.employee)||"").trim(),date:String((l==null?void 0:l.date)||V).trim()||V,notes:String((l==null?void 0:l.notes)||"").trim()})}function xe(){b(l=>({...l,open:!1}))}function ke(l){l.preventDefault();const g=String(Z.rowId||"").trim();if(!g)return;const n=String(Z.notes||"").trim();D(s=>({...s,attendance:(s.attendance||[]).map(p=>String(p.id||"")===g?{...p,notes:n}:p)})),xe()}return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"HR"}),e.jsx("p",{className:"text-secondary mb-3",children:"Handle employees, attendance, leave approvals, and payroll."}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:Object.entries($e).map(([l,g])=>e.jsx("button",{type:"button",className:`btn btn-sm ${i===l?"btn-success":"btn-outline-light"}`,onClick:()=>h(l),children:g.label},l))})]}),i==="employees"?e.jsx("div",{className:"row g-3",children:f.map(l=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsx("div",{className:"stat-icon stat-icon-primary mb-2",children:e.jsx("i",{className:`bi ${l.icon||"bi-bar-chart"}`,"aria-hidden":"true"})}),e.jsx("div",{className:"text-secondary small",children:l.label}),e.jsx("h5",{className:"mb-0 mt-1",children:l.value})]})},l.label))}):null,e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:J?`Edit ${G.itemLabel}`:`Create ${G.itemLabel}`}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:o,children:[e.jsx("div",{className:"row g-3",children:G.fields.map(l=>(()=>{const g=l.conditionalOn;return!g||String(x[g.key]||"").trim()===String(g.value||"").trim()?e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:l.label}),i==="attendance"&&l.key==="employee"?e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{type:"text",className:"form-control",autoComplete:"off",placeholder:l.placeholder,value:x[l.key]||"",onFocus:()=>M(!0),onBlur:()=>window.setTimeout(()=>M(!1),120),onChange:s=>{C(l.key,s.target.value),M(!0)}}),he&&B.length?e.jsx("div",{className:"position-absolute start-0 end-0 mt-1 border rounded shadow-sm",style:{zIndex:30,background:"#081528",borderColor:"rgba(255,255,255,0.16)",maxHeight:"220px",overflowY:"auto"},children:B.map(s=>e.jsx("button",{type:"button",className:"w-100 text-start border-0 bg-transparent px-3 py-2",style:{color:"#e9eef8"},onMouseDown:p=>{p.preventDefault(),C(l.key,s),M(!1)},children:s},`attendance-emp-suggest-${s}`))}):null]}):i==="employees"&&l.key==="name"?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",className:"form-control datalist-readable-input",list:"hr-employee-user-list",autoComplete:"off",placeholder:l.placeholder,value:x[l.key]||"",onChange:s=>C(l.key,s.target.value)}),e.jsx("datalist",{id:"hr-employee-user-list",children:c.map(s=>e.jsx("option",{value:s},`hr-user-name-${s}`))})]}):l.type==="select"?e.jsxs("select",{className:"form-select",value:x[l.key]||l.defaultValue||"",onChange:s=>C(l.key,s.target.value),children:[e.jsxs("option",{value:"",children:["Select ",l.label]}),(l.options||[]).map(s=>e.jsx("option",{value:s,children:s},s))]}):l.type==="textarea"?e.jsx("textarea",{className:"form-control",rows:3,placeholder:l.placeholder,value:x[l.key]||"",onChange:s=>C(l.key,s.target.value)}):e.jsx("input",{type:l.type||"text",className:"form-control",placeholder:l.placeholder,value:x[l.key]||"",onChange:s=>C(l.key,s.target.value)})]},l.key):null})())}),i==="attendance"?e.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[e.jsx("span",{className:"small text-secondary",children:"User Login Attendance:"}),e.jsx("button",{type:"button",className:"btn btn-outline-success btn-sm",disabled:!String(x.employee||"").trim(),onClick:()=>U("in",x.employee,"User Side"),children:"Attendance In"}),e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",disabled:!String(x.employee||"").trim(),onClick:()=>U("out",x.employee,"User Side"),children:"Attendance Out"}),e.jsx("span",{className:"small text-secondary",children:"Selected employee + today date record will update."})]}):null,e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:J?"Update":"Create"}),J?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:R,children:"Cancel"}):null]})]})]}),i==="attendance"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-2",children:[e.jsx("h6",{className:"mb-0",children:"My Attendance (HR)"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("label",{className:"small text-secondary mb-0",children:"Employee"}),e.jsxs("select",{className:"form-select form-select-sm",style:{minWidth:"180px"},value:te,onChange:l=>ne(l.target.value),children:[e.jsx("option",{value:"",children:"Select Employee"}),re.map(l=>e.jsx("option",{value:l,children:l},`my-attendance-${l}`))]})]})]}),e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("div",{className:"small text-secondary",children:"Date"}),e.jsx("div",{className:"fw-semibold",children:V})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("div",{className:"small text-secondary",children:"In Time"}),e.jsx("div",{className:"fw-semibold",children:je(X==null?void 0:X.inTime)})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("div",{className:"small text-secondary",children:"Out Time"}),e.jsx("div",{className:"fw-semibold",children:je(X==null?void 0:X.outTime)})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("div",{className:"small text-secondary",children:"Worked"}),e.jsx("div",{className:"fw-semibold",children:(X==null?void 0:X.workedHours)||"-"})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("div",{className:"small text-secondary",children:"Status"}),e.jsx("div",{className:"fw-semibold",children:(X==null?void 0:X.status)==="Permission"&&(X!=null&&X.permissionHours)?`Permission (${X.permissionHours} hrs)`:(X==null?void 0:X.status)||"-"})]}),e.jsx("div",{className:"col-12 col-md-2",children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-success btn-sm w-100",disabled:!te,onClick:()=>U("in",te,"HR Self"),children:"In"}),e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm w-100",disabled:!te,onClick:()=>U("out",te,"HR Self"),children:"Out"})]})})]})]}):null,e.jsx(ge,{title:G.label,badgeLabel:`${(i==="attendance"?Ce:ce).length} items`,rows:i==="attendance"?Ce:ce,columns:oe,withoutOuterCard:["attendance","leaves","payroll"].includes(i),headerBottom:i==="attendance"?e.jsxs("div",{className:"d-flex flex-wrap align-items-end gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Year"}),e.jsx("select",{className:"form-select form-select-sm",value:A,onChange:l=>q(l.target.value),style:{minWidth:"110px"},children:E.map(l=>e.jsx("option",{value:l,children:l},`attendance-year-${l}`))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Month"}),e.jsx("select",{className:"form-select form-select-sm",value:$,onChange:l=>I(l.target.value),style:{minWidth:"120px"},children:T.map(l=>e.jsx("option",{value:l.value,children:l.label},`attendance-month-${l.value}`))})]})]}):null,actionHeaderStyle:i==="attendance"?{minWidth:"260px",whiteSpace:"nowrap"}:null,actionCellStyle:i==="attendance"?{minWidth:"260px",whiteSpace:"nowrap"}:null,searchPlaceholder:`Search ${G.label.toLowerCase()}`,noRowsText:`No ${G.label.toLowerCase()} yet.`,searchBy:l=>G.columns.map(g=>l[g.key]||"").join(" "),renderCells:l=>G.columns.map(g=>{if(i==="attendance"&&(g.key==="inTime"||g.key==="outTime"))return je(l[g.key]);if(i==="attendance"&&g.key==="workedHours")return l.workedHours||Je(l.inTime,l.outTime)||"-";if(i==="attendance"&&g.key==="status"){const n=String(l.status||"").trim();return n==="Permission"&&String(l.permissionHours||"").trim()?`Permission (${String(l.permissionHours).trim()} hrs)`:l.entryMode?`${n||"-"}${l.entryMode?` (${l.entryMode})`:""}`:n||"-"}return l[g.key]||"-"}),renderActions:l=>e.jsxs("div",{className:"d-inline-flex gap-2 flex-nowrap",children:[i==="attendance"?(()=>{const g=!!String((l==null?void 0:l.completedTasks)||"").trim();return e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:`btn btn-sm ${g?"btn-primary":"btn-secondary"}`,onClick:()=>me(l),children:"Task"}),e.jsx("button",{type:"button",className:`btn btn-sm ${String((l==null?void 0:l.notes)||"").trim()?"btn-outline-primary":"btn-outline-secondary"}`,onClick:()=>Y(l),children:"Notes"})]})})():null,e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>F(l),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>ie(l.id),children:"Delete"})]})}),i==="attendance"&&z.open?e.jsx("div",{role:"dialog","aria-modal":"true",className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.65)",zIndex:1050,padding:"1rem"},onClick:ye,children:e.jsxs("div",{className:"card p-3",style:{width:"min(700px, 100%)"},onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-3 mb-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:z.mode==="punchOut"?"Attendance Out - Completed Tasks":"Completed Work Tasks"}),e.jsxs("div",{className:"small text-secondary",children:[z.employee||"-"," • ",z.date||V,z.mode==="punchOut"&&z.outTime?` • Out Time ${je(z.outTime)}`:""]})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:ye,children:e.jsx("i",{className:"bi bi-x-lg","aria-hidden":"true"})})]}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:Ne,children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Completed Work Task List"}),e.jsx("textarea",{className:"form-control",rows:5,placeholder:"Enter completed tasks (one line per task / summary details)",value:z.completedTasks,onChange:l=>H(g=>({...g,completedTasks:l.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Notes (Optional)"}),e.jsx("textarea",{className:"form-control",rows:3,placeholder:"Blockers / pending follow-up / handover notes",value:z.taskNotes,onChange:l=>H(g=>({...g,taskNotes:l.target.value}))})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:z.mode==="punchOut"?"Save & Attendance Out":"Save Task Details"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:ye,children:"Cancel"})]})]})]})}):null,i==="attendance"&&Z.open?e.jsx("div",{role:"dialog","aria-modal":"true",className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.65)",zIndex:1050,padding:"1rem"},onClick:xe,children:e.jsxs("div",{className:"card p-3",style:{width:"min(640px, 100%)"},onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-3 mb-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:"Attendance Notes / Queries"}),e.jsxs("div",{className:"small text-secondary",children:[Z.employee||"-"," • ",Z.date||"-"]})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:xe,children:e.jsx("i",{className:"bi bi-x-lg","aria-hidden":"true"})})]}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:ke,children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Notes / Queries"}),e.jsx("textarea",{className:"form-control",rows:6,placeholder:"Add notes, queries, clarifications, pending items...",value:Z.notes,onChange:l=>b(g=>({...g,notes:l.target.value}))})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:"Save Notes"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:xe,children:"Cancel"})]})]})]})}):null]})}function yt({heading:i,subtitle:h,tabConfig:d,defaultData:D,storageKey:x,statsBuilder:k,statIcons:K=[],defaultActiveTab:W=""}){const le=Object.keys(d)[0],te=!!(d!=null&&d.mainCategories&&(d!=null&&d.subCategories)),he=Object.prototype.hasOwnProperty.call(d||{},W)?W:te&&(le==="mainCategories"||le==="subCategories")?"categories":le,[M,z]=m.useState(he),[H,Z]=m.useState(D),[b,A]=m.useState(be(d[le].fields)),[q,$]=m.useState(""),[I,G]=m.useState(()=>te?{mainCategories:be(d.mainCategories.fields),subCategories:be(d.subCategories.fields)}:{mainCategories:{},subCategories:{}}),[oe,ce]=m.useState({mainCategories:"",subCategories:""}),[V,re]=m.useState(""),[c,P]=m.useState([]);m.useEffect(()=>{try{const n=window.localStorage.getItem(x);if(!n)return;const s=JSON.parse(n);ma(s,d)&&Z(s)}catch{}},[x,d]),m.useEffect(()=>{window.localStorage.setItem(x,JSON.stringify(H))},[H,x]),m.useEffect(()=>{let n=!0;return Object.values(d).some(p=>Array.isArray(p==null?void 0:p.fields)&&p.fields.some(S=>S.key==="department"))?((async()=>{try{const p=await Ee("/api/business-autopilot/departments");if(!n)return;const w=(Array.isArray(p==null?void 0:p.departments)?p.departments:[]).map(_=>String((_==null?void 0:_.name)||"").trim()).filter(Boolean);P(Array.from(new Set(w)))}catch{n&&P([])}})(),()=>{n=!1}):()=>{n=!1}},[d]),m.useEffect(()=>{$(""),M!=="categories"&&A(be(d[M].fields))},[M,d]),m.useEffect(()=>{if(!(d!=null&&d.tickets))return;const n=()=>{z("tickets"),$("")};return window.addEventListener("wz:ticketing-menu-click",n),()=>window.removeEventListener("wz:ticketing-menu-click",n)},[d]);const B=m.useMemo(()=>te?[...Object.entries(d).filter(([s])=>s!=="mainCategories"&&s!=="subCategories").map(([s,p])=>({key:s,label:p.label})),{key:"categories",label:"Category"}]:Object.entries(d).map(([s,p])=>({key:s,label:p.label})),[te,d]),O=m.useMemo(()=>Object.prototype.hasOwnProperty.call(d||{},"overview"),[d]),E=M==="categories"?null:d[M],T=M==="categories"?[]:H[M]||[],f=x===De&&M==="items",C=x===ht&&M==="tickets",F=m.useMemo(()=>Array.from(new Set((H.mainCategories||[]).map(n=>String((n==null?void 0:n.name)||"").trim()).filter(Boolean))),[H.mainCategories]),R=m.useMemo(()=>{const n=String(b.mainCategory||"").trim().toLowerCase();return Array.from(new Set((H.subCategories||[]).filter(s=>n?String((s==null?void 0:s.mainCategory)||"").trim().toLowerCase()===n:!0).map(s=>String((s==null?void 0:s.name)||"").trim()).filter(Boolean)))},[b.mainCategory,H.subCategories]),ie=m.useMemo(()=>Array.from(new Set((H.mainCategories||[]).map(n=>String((n==null?void 0:n.name)||"").trim()).filter(Boolean))),[H.mainCategories]),o=m.useMemo(()=>{const n=String(b.mainCategory||"").trim().toLowerCase();return Array.from(new Set((H.subCategories||[]).filter(s=>n?String((s==null?void 0:s.mainCategory)||"").trim().toLowerCase()===n:!0).map(s=>String((s==null?void 0:s.name)||"").trim()).filter(Boolean)))},[b.mainCategory,H.subCategories]),j=m.useMemo(()=>k(H),[H,k]),U=m.useMemo(()=>{if(M!=="tasks")return[];const n=[...(H.team||[]).map(s=>s==null?void 0:s.name),...(H.tasks||[]).map(s=>s==null?void 0:s.assignee),...(H.projects||[]).map(s=>s==null?void 0:s.owner),...(gt.employees||[]).map(s=>s==null?void 0:s.name)].map(s=>String(s||"").trim()).filter(Boolean);return Array.from(new Set(n)).sort((s,p)=>s.localeCompare(p))},[M,H]);function me(n,s){A(p=>({...p,[n]:s}))}function ye(n){$(n.id);const s={};E.fields.forEach(p=>{if(C&&(p.key==="mainCategory"||p.key==="subCategory")){const[S="",w=""]=String(n.category||"").split("/").map(_=>String(_||"").trim());s.mainCategory=n.mainCategory||S||"",s.subCategory=n.subCategory||w||"";return}if(f&&(p.key==="mainCategory"||p.key==="subCategory")){const[S="",w=""]=String(n.category||"").split("/").map(_=>String(_||"").trim());s.mainCategory=n.mainCategory||S||"",s.subCategory=n.subCategory||w||"";return}s[p.key]=n[p.key]||""}),A(s)}function Ne(){$(""),A(be(E.fields))}function X(n){Z(s=>({...s,[M]:(s[M]||[]).filter(p=>p.id!==n)})),q===n&&Ne()}function Ce(n){if(n.preventDefault(),E.fields.some(S=>!String(b[S.key]||"").trim()))return;const p={};if(E.fields.forEach(S=>{p[S.key]=String(b[S.key]).trim()}),f){const S=String(p.mainCategory||"").trim(),w=String(p.subCategory||"").trim();p.mainCategory=S,p.subCategory=w,p.category=[S,w].filter(Boolean).join(" / ")}if(C){const S=String(p.mainCategory||"").trim(),w=String(p.subCategory||"").trim();p.mainCategory=S,p.subCategory=w,p.category=[S,w].filter(Boolean).join(" / ")}Z(S=>{const w=S[M]||[];return q?{...S,[M]:w.map(_=>_.id===q?{..._,...p}:_)}:{...S,[M]:[{id:`${M}_${Date.now()}`,...p},...w]}}),Ne()}function Y(n,s,p){G(S=>({...S,[n]:{...S[n]||{},[s]:p}}))}function xe(n,s){const p=d[n];if(!p)return;const S={};p.fields.forEach(w=>{S[w.key]=s[w.key]||""}),ce(w=>({...w,[n]:s.id||""})),G(w=>({...w,[n]:S}))}function ke(n){const s=d[n];s&&(ce(p=>({...p,[n]:""})),G(p=>({...p,[n]:be(s.fields)})))}function l(n,s){Z(p=>({...p,[n]:(p[n]||[]).filter(S=>S.id!==s)})),oe[n]===s&&ke(n)}function g(n,s){n.preventDefault();const p=d[s];if(!p)return;const S=I[s]||{};if(p.fields.some(ae=>!String(S[ae.key]||"").trim()))return;const _={};p.fields.forEach(ae=>{_[ae.key]=String(S[ae.key]||"").trim()});const Q=oe[s];Z(ae=>{const pe=ae[s]||[];return Q?(re(""),{...ae,[s]:pe.map(Te=>Te.id===Q?{...Te,..._}:Te)}):pe.length>=100?(re(`${p.label}: Maximum 100 entries are allowed.`),ae):(re(""),{...ae,[s]:[{id:`${s}_${Date.now()}`,..._},...pe]})}),ke(s)}return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:i}),e.jsx("p",{className:"text-secondary mb-3",children:h}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:B.map(({key:n,label:s})=>e.jsx("button",{type:"button",className:`btn btn-sm ${M===n?"btn-success":"btn-outline-light"}`,onClick:()=>z(n),children:s},n))})]}),M!=="categories"&&O&&M==="overview"?e.jsx("div",{className:"row g-3",children:j.map((n,s)=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsx("div",{className:"stat-icon stat-icon-primary mb-2",children:e.jsx("i",{className:`bi ${K[s]||"bi-grid"}`,"aria-hidden":"true"})}),e.jsx("div",{className:"text-secondary small",children:n.label}),e.jsx("h5",{className:"mb-0 mt-1",children:n.value})]})},n.label))}):null,M==="categories"?e.jsxs("div",{children:[e.jsx("h5",{className:"mb-2",children:"Category"}),e.jsx("p",{className:"text-secondary small mb-2",children:"Maximum 100 entries are allowed for Main Category and Sub Category."}),V?e.jsx("div",{className:"alert alert-warning py-2 mb-3",children:V}):null,e.jsx("div",{className:"row g-3",children:["mainCategories","subCategories"].map(n=>{const s=d[n],p=H[n]||[],S=I[n]||{},w=oe[n];return e.jsx("div",{className:"col-12 col-xl-6",children:e.jsxs("div",{className:"h-100 d-flex flex-column gap-3",children:[e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:w?`Edit ${s.itemLabel}`:`Create ${s.itemLabel}`}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:_=>g(_,n),children:[e.jsx("div",{className:"row g-3",children:s.fields.map(_=>e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:_.label}),x===De&&n==="subCategories"&&_.key==="mainCategory"?e.jsxs("select",{className:"form-select",value:S[_.key]||"",onChange:Q=>Y(n,_.key,Q.target.value),children:[e.jsx("option",{value:"",children:"Select Main Category"}),F.map(Q=>e.jsx("option",{value:Q,children:Q},`stock-sub-main-${Q}`))]}):e.jsx("input",{type:_.type||"text",className:"form-control",placeholder:_.placeholder,value:S[_.key]||"",onChange:Q=>Y(n,_.key,Q.target.value)})]},`${n}-${_.key}`))}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm single-row-form-submit-btn",children:w?"Update":"Create"}),w?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm single-row-form-submit-btn",onClick:()=>ke(n),children:"Cancel"}):null]})]})]}),e.jsx(ge,{title:`${s.label} List`,badgeLabel:`${p.length} items`,rows:p,columns:s.columns,withoutOuterCard:!0,pageSize:5,searchPlaceholder:`Search ${s.label.toLowerCase()}`,noRowsText:`No ${s.label.toLowerCase()} added yet.`,searchBy:_=>s.columns.map(Q=>_[Q.key]||"").join(" "),renderCells:_=>s.columns.map(Q=>_[Q.key]||"-"),renderActions:_=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>xe(n,_),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>l(n,_.id),children:"Delete"})]})})]})},`category-panel-${n}`)})})]}):null,M!=="categories"&&M!=="tickets"&&!f?e.jsx(ge,{title:`${E.label} List`,badgeLabel:`${T.length} items`,rows:T,columns:E.columns,withoutOuterCard:M==="mainCategories"||M==="items",searchPlaceholder:`Search ${E.label.toLowerCase()}`,noRowsText:`No ${E.label.toLowerCase()} added yet.`,searchBy:n=>E.columns.map(s=>n[s.key]||"").join(" "),renderCells:n=>E.columns.map(s=>{if(f&&s.key==="mainCategory"){const[p=""]=String(n.category||"").split("/").map(S=>String(S||"").trim());return n.mainCategory||p||"-"}if(f&&s.key==="subCategory"){const[,p=""]=String(n.category||"").split("/").map(S=>String(S||"").trim());return n.subCategory||p||"-"}return n[s.key]||"-"}),renderActions:n=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>ye(n),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>X(n.id),children:"Delete"})]})}):null,M!=="categories"?e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:q?`Edit ${E.itemLabel}`:`Create ${E.itemLabel}`}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:Ce,children:[e.jsxs("div",{className:"row g-3",children:[E.fields.map(n=>e.jsxs("div",{className:f?{itemName:"col-12 col-md-6 col-xl-2",sku:"col-12 col-md-6 col-xl-2",mainCategory:"col-12 col-md-6 col-xl-3",subCategory:"col-12 col-md-6 col-xl-3",qty:"col-12 col-md-3 col-xl-1"}[n.key]||"col-12 col-md-6 col-xl-2":C&&{ticketNo:"col-12 col-md-6 col-xl-2",subject:"col-12 col-md-6 col-xl-3",mainCategory:"col-12 col-md-6 col-xl-2",subCategory:"col-12 col-md-6 col-xl-2",status:"col-12 col-md-6 col-xl-2",description:"col-12"}[n.key]||"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:n.label}),n.key==="department"&&c.length?e.jsxs("select",{className:"form-select",value:b[n.key]||"",onChange:s=>me(n.key,s.target.value),children:[e.jsx("option",{value:"",children:"Select Department"}),c.map(s=>e.jsx("option",{value:s,children:s},s)),b[n.key]&&!c.includes(b[n.key])?e.jsx("option",{value:b[n.key],children:b[n.key]}):null]}):C&&n.key==="mainCategory"?e.jsxs("select",{className:"form-select",value:b[n.key]||"",onChange:s=>{me(n.key,s.target.value),A(p=>({...p,subCategory:""}))},children:[e.jsx("option",{value:"",children:"Select Category"}),ie.map(s=>e.jsx("option",{value:s,children:s},`ticket-main-${s}`))]}):C&&n.key==="subCategory"?e.jsxs("select",{className:"form-select",value:b[n.key]||"",onChange:s=>me(n.key,s.target.value),children:[e.jsx("option",{value:"",children:"Select Sub Category"}),o.map(s=>e.jsx("option",{value:s,children:s},`ticket-sub-${s}`))]}):n.type==="textarea"?e.jsx("textarea",{className:"form-control",rows:3,placeholder:n.placeholder,value:b[n.key]||"",onChange:s=>me(n.key,s.target.value)}):M==="tasks"&&n.key==="assignee"?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",className:"form-control",list:"project-task-assign-to-list",placeholder:n.placeholder,value:b[n.key]||"",onChange:s=>me(n.key,s.target.value)}),e.jsx("datalist",{id:"project-task-assign-to-list",children:U.map(s=>e.jsx("option",{value:s},`task-assign-${s}`))})]}):f&&n.key==="mainCategory"?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",className:"form-control datalist-readable-input inventory-category-datalist",list:"inventory-main-category-list",placeholder:n.placeholder,value:b[n.key]||"",onChange:s=>{me(n.key,s.target.value),A(p=>({...p,subCategory:""}))}}),e.jsx("datalist",{id:"inventory-main-category-list",children:F.map(s=>e.jsx("option",{value:s},`inventory-main-${s}`))})]}):f&&n.key==="subCategory"?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",className:"form-control datalist-readable-input inventory-category-datalist",list:"inventory-sub-category-list",placeholder:n.placeholder,value:b[n.key]||"",onChange:s=>me(n.key,s.target.value)}),e.jsx("datalist",{id:"inventory-sub-category-list",children:R.map(s=>e.jsx("option",{value:s},`inventory-sub-${s}`))})]}):e.jsx("input",{type:n.type||"text",className:"form-control",placeholder:n.placeholder,value:b[n.key]||"",onChange:s=>me(n.key,s.target.value)})]},n.key)),f?e.jsx("div",{className:"col-12 col-md-9 col-xl-1 d-flex align-items-end",children:e.jsxs("div",{className:"d-flex gap-2 w-100 flex-xl-column",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm w-100 single-row-form-submit-btn",children:q?"Update":"Create"}),q?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm w-100 single-row-form-submit-btn",onClick:Ne,children:"Cancel"}):null]})}):null]}),f?null:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:q?"Update":"Create"}),q?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Ne,children:"Cancel"}):null]})]})]}):null,f?e.jsx(ge,{title:`${E.label} List`,badgeLabel:`${T.length} items`,rows:T,columns:E.columns,withoutOuterCard:!0,searchPlaceholder:`Search ${E.label.toLowerCase()}`,noRowsText:`No ${E.label.toLowerCase()} added yet.`,searchBy:n=>E.columns.map(s=>n[s.key]||"").join(" "),renderCells:n=>E.columns.map(s=>{if(s.key==="mainCategory"){const[p=""]=String(n.category||"").split("/").map(S=>String(S||"").trim());return n.mainCategory||p||"-"}if(s.key==="subCategory"){const[,p=""]=String(n.category||"").split("/").map(S=>String(S||"").trim());return n.subCategory||p||"-"}return n[s.key]||"-"}),renderActions:n=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>ye(n),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>X(n.id),children:"Delete"})]})}):null,M==="tickets"?e.jsx(ge,{title:`${E.label} List`,badgeLabel:`${T.length} items`,rows:T,columns:E.columns,withoutOuterCard:!0,pageSize:15,searchPlaceholder:`Search ${E.label.toLowerCase()}`,noRowsText:`No ${E.label.toLowerCase()} added yet.`,searchBy:n=>E.columns.map(s=>n[s.key]||"").join(" "),renderCells:n=>E.columns.map(s=>n[s.key]||"-"),renderActions:n=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>ye(n),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>X(n.id),children:"Delete"})]})}):null]})}function ha(){const i=m.useMemo(()=>h=>{const d=(h.tickets||[]).filter(k=>String(k.status||"").toLowerCase()!=="closed").length,D=(h.tickets||[]).filter(k=>String(k.status||"").toLowerCase().includes("progress")||String(k.status||"").toLowerCase()==="open").length,x=(h.mainCategories||[]).length+(h.subCategories||[]).length;return[{label:"Open Tickets",value:String(d)},{label:"Pending Today",value:String(D)},{label:"Categories",value:String(x)}]},[]);return e.jsx(yt,{heading:"Ticketing System",subtitle:"Create main/sub categories and manage tickets with create, edit, and delete actions.",tabConfig:aa,defaultData:sa,storageKey:ht,statsBuilder:i,statIcons:["bi-life-preserver","bi-hourglass-split","bi-tags"],defaultActiveTab:"tickets"})}function ba(){const i=m.useMemo(()=>h=>{const d=(h.items||[]).length,D=(h.items||[]).filter(k=>Number(k.qty||0)>0&&Number(k.qty||0)<=5).length,x=(h.mainCategories||[]).length+(h.subCategories||[]).length;return[{label:"Inventory Items",value:String(d)},{label:"Low Stock Alerts",value:String(D)},{label:"Categories",value:String(x)}]},[]);return e.jsx(yt,{heading:"Inventory",subtitle:"Create main/sub categories and manage inventory items with create, edit, and delete actions.",tabConfig:la,defaultData:Ze,storageKey:De,statsBuilder:i,statIcons:["bi-box-seam","bi-exclamation-triangle","bi-diagram-3"]})}function ga(){const[i,h]=m.useState("overview"),[d,D]=m.useState("invoice"),[x,k]=m.useState(ia),[K,W]=m.useState("India"),[J,le]=m.useState(!0),[te,ne]=m.useState("Loading..."),[he,M]=m.useState(""),z=m.useRef(!1),H=m.useRef(null),[Z,b]=m.useState({id:"",name:"",taxScope:"Intra State",cgst:"",sgst:"",igst:"",cess:"",status:"Active",notes:""}),[A,q]=m.useState(""),[$,I]=m.useState({id:"",name:"",docType:"Invoice",gstTemplateId:"",prefix:"",invStartFrom:"",themeColor:"#22c55e",companyLogoDataUrl:"",companyLogoName:"",footerNote:"",termsText:"",status:"Active"}),[G,oe]=m.useState(""),[ce,V]=m.useState(ve("estimate")),[re,c]=m.useState(ve("invoice")),[P,B]=m.useState(""),[O,E]=m.useState(""),[T,f]=m.useState({id:"",companyName:"",clientName:"",name:"",gstin:"",phoneCountryCode:"+91",phone:"",additionalPhones:[],email:"",additionalEmails:[],billingAddress:"",shippingAddress:"",country:"India",state:"",city:"",pincode:""}),[C,F]=m.useState(""),[R,ie]=m.useState({id:"",name:"",itemType:"Product",sku:"",hsnSacCode:"",unit:"Nos",defaultRate:"",taxPercent:""}),[o,j]=m.useState(""),[U,me]=m.useState("Product"),[ye,Ne]=m.useState([]),[X,Ce]=m.useState(()=>{try{const t=window.localStorage.getItem(De),a=t?JSON.parse(t):null;return a&&typeof a=="object"?a:Ze}catch{return Ze}}),Y=m.useMemo(()=>Kt(K),[K]),xe=m.useMemo(()=>bt(K)==="india",[K]);m.useEffect(()=>{let t=!0;return(async()=>{le(!0),M("");try{const a=await Ee("/api/business-autopilot/accounts/workspace");if(!t)return;const r=a==null?void 0:a.data;if(We(r))k(r),window.localStorage.setItem(_e,JSON.stringify(r)),ne("Synced from server");else try{const u=window.localStorage.getItem(_e);if(u){const y=JSON.parse(u);We(y)&&(k(y),ne("Loaded local cache"))}}catch{}}catch(a){if(!t)return;try{const r=window.localStorage.getItem(_e);if(r){const u=JSON.parse(r);We(u)&&(k(u),ne("Loaded local cache"))}}catch{}M((a==null?void 0:a.message)||"Unable to sync accounts workspace.")}finally{t&&(z.current=!0,le(!1))}})(),()=>{t=!1}},[]),m.useEffect(()=>{function t(){try{const a=window.localStorage.getItem(De);if(!a)return;const r=JSON.parse(a);r&&typeof r=="object"&&Ce(r)}catch{}}return window.addEventListener("storage",t),()=>window.removeEventListener("storage",t)},[]),m.useEffect(()=>{A||b(t=>!(!String(t.id||"").trim()&&!String(t.name||"").trim()&&!String(t.cgst||"").trim()&&!String(t.sgst||"").trim()&&!String(t.igst||"").trim()&&!String(t.cess||"").trim()&&!String(t.notes||"").trim())||String(t.taxScope||"")===String(Y.defaultScope||"")?t:{...t,taxScope:Y.defaultScope})},[A,Y.defaultScope]),m.useEffect(()=>{let t=!0;return(async()=>{var a;try{const r=await Ee("/api/dashboard/billing-profile");if(!t)return;const u=String(((a=r==null?void 0:r.profile)==null?void 0:a.country)||"").trim();u&&W(u)}catch{}})(),()=>{t=!1}},[]),m.useEffect(()=>{if(window.localStorage.setItem(_e,JSON.stringify(x)),!!z.current)return H.current&&window.clearTimeout(H.current),ne("Saving..."),H.current=window.setTimeout(async()=>{try{await Ee("/api/business-autopilot/accounts/workspace",{method:"PUT",body:JSON.stringify({data:x})}),M(""),ne("Saved to server")}catch(t){M((t==null?void 0:t.message)||"Server save failed"),ne("Save failed")}},450),()=>{H.current&&window.clearTimeout(H.current)}},[x]),m.useEffect(()=>{let t=!0;return(async()=>{try{const a=await Ee("/api/business-autopilot/users");if(!t)return;Ne(Array.isArray(a==null?void 0:a.users)?a.users:[])}catch{t&&Ne([])}})(),()=>{t=!1}},[]);const ke=m.useMemo(()=>(x.gstTemplates||[]).filter(t=>String(t.status||"").toLowerCase()==="active"),[x.gstTemplates]),l=m.useMemo(()=>{const t=x.invoices||[],a=x.estimates||[],r=x.gstTemplates||[],u=t.filter(y=>!["paid","cancelled"].includes(String(y.status||"").toLowerCase())).reduce((y,L)=>y+Fe(L,r).grandTotal,0);return[{label:"Invoices",value:String(t.length),icon:"bi-receipt-cutoff"},{label:"Estimates",value:String(a.length),icon:"bi-file-earmark-text"},{label:"Receivables",value:Le(u),icon:"bi-cash-coin"},{label:Y.templatesLabel,value:String(r.length),icon:"bi-file-earmark-ruled"}]},[x,Y.templatesLabel]),g=x.customers||[];x.itemMasters;const n=m.useMemo(()=>(x.itemMasters||[]).filter(t=>String((t==null?void 0:t.itemType)||"Product")===U),[x.itemMasters,U]),s=m.useMemo(()=>Array.isArray(X==null?void 0:X.items)?X.items:[],[X]),p=m.useMemo(()=>new Map(s.map(t=>[String(t.id||""),t])),[s]),S=Zt(String(T.country||"India"));function w(t={}){const a=String(t.phone||"").trim(),r=String(t.email||"").trim(),u=Array.isArray(t.phoneList)?t.phoneList:[],y=Array.isArray(t.emailList)?t.emailList:[];return{id:t.id||"",companyName:t.companyName||t.name||"",clientName:t.clientName||"",name:t.name||t.companyName||t.clientName||"",gstin:t.gstin||"",phoneCountryCode:t.phoneCountryCode||"+91",phone:t.phone||"",additionalPhones:u.length?u.slice(1).map(L=>({countryCode:L.countryCode||"+91",number:L.number||""})):a?[]:[],email:t.email||"",additionalEmails:y.length?y.slice(1).map(L=>L||""):r?[]:[],billingAddress:t.billingAddress||"",shippingAddress:t.shippingAddress||"",country:t.country||"India",state:t.state||"",city:t.city||"",pincode:t.pincode||""}}function _(t={}){const a=[];return String(t.phone||"").trim()&&a.push(`${t.phoneCountryCode||"+91"} ${t.phone}`.trim()),Array.isArray(t.phoneList)&&t.phoneList.forEach((r,u)=>{u!==0&&String((r==null?void 0:r.number)||"").trim()&&a.push(`${r.countryCode||"+91"} ${r.number}`.trim())}),!a.length&&Array.isArray(t.additionalPhones)&&t.additionalPhones.forEach(r=>{String((r==null?void 0:r.number)||"").trim()&&a.push(`${r.countryCode||"+91"} ${r.number}`.trim())}),a.filter(Boolean)}function Q(t={}){const a=[];return String(t.email||"").trim()&&a.push(String(t.email).trim()),Array.isArray(t.emailList)&&t.emailList.forEach((r,u)=>{u!==0&&String(r||"").trim()&&a.push(String(r).trim())}),!a.length&&Array.isArray(t.additionalEmails)&&t.additionalEmails.forEach(r=>{String(r||"").trim()&&a.push(String(r).trim())}),a.filter(Boolean)}function ae(){q(""),b({id:"",name:"",taxScope:Y.defaultScope,cgst:"",sgst:"",igst:"",cess:"",status:"Active",notes:""})}function pe(){var t;oe(""),I({id:"",name:"",docType:"Invoice",gstTemplateId:((t=ke[0])==null?void 0:t.id)||"",prefix:"",invStartFrom:"",themeColor:"#22c55e",companyLogoDataUrl:"",companyLogoName:"",footerNote:"",termsText:"",status:"Active"})}function Te(t){if(!t||!String(t.type||"").startsWith("image/"))return;const a=new FileReader;a.onload=()=>{const r=typeof a.result=="string"?a.result:"";I(u=>({...u,companyLogoDataUrl:r,companyLogoName:t.name||"company-logo"}))},a.readAsDataURL(t)}function xt(t){if(t.preventDefault(),!Z.name.trim())return;const a={...Z,name:Z.name.trim(),notes:Z.notes.trim()};k(r=>{const u=r.gstTemplates||[];return A?{...r,gstTemplates:u.map(y=>y.id===A?{...y,...a}:y)}:{...r,gstTemplates:[{...a,id:`gst_${Date.now()}`},...u]}}),ae()}function ft(t){q(t.id),b({...t}),h("gst")}function Nt(t){k(a=>({...a,gstTemplates:(a.gstTemplates||[]).filter(r=>r.id!==t),billingTemplates:(a.billingTemplates||[]).map(r=>r.gstTemplateId===t?{...r,gstTemplateId:""}:r),estimates:(a.estimates||[]).map(r=>r.gstTemplateId===t?{...r,gstTemplateId:""}:r),invoices:(a.invoices||[]).map(r=>r.gstTemplateId===t?{...r,gstTemplateId:""}:r)})),A===t&&ae()}function jt(t,a){k(r=>({...r,gstTemplates:(r.gstTemplates||[]).map(u=>u.id===t?{...u,status:a}:u)}))}function vt(t){if(t.preventDefault(),!$.name.trim())return;const a={...$,name:$.name.trim(),footerNote:$.footerNote.trim(),termsText:$.termsText.trim()};k(r=>{const u=r.billingTemplates||[];return G?{...r,billingTemplates:u.map(y=>y.id===G?{...y,...a}:y)}:{...r,billingTemplates:[{...a,id:`bt_${Date.now()}`},...u]}}),pe()}function St(t){oe(t.id),I({...t}),h("templates")}function Ct(t){k(a=>({...a,billingTemplates:(a.billingTemplates||[]).filter(r=>r.id!==t),estimates:(a.estimates||[]).map(r=>r.billingTemplateId===t?{...r,billingTemplateId:""}:r),invoices:(a.invoices||[]).map(r=>r.billingTemplateId===t?{...r,billingTemplateId:""}:r)})),G===t&&pe()}function kt(t,a){k(r=>({...r,billingTemplates:(r.billingTemplates||[]).map(u=>u.id===t?{...u,status:a}:u)}))}function Ue(){F(""),f({id:"",companyName:"",clientName:"",name:"",gstin:"",phoneCountryCode:"+91",phone:"",additionalPhones:[],email:"",additionalEmails:[],billingAddress:"",shippingAddress:"",country:"India",state:"",city:"",pincode:""})}function Tt(t){t.preventDefault();const a=String(T.companyName||T.name||"").trim();if(!a)return;const r=String(T.clientName||"").trim(),u=String(T.phone||"").trim(),y=String(T.email||"").trim(),L=(T.additionalPhones||[]).map(se=>({countryCode:String(se.countryCode||"+91").trim()||"+91",number:String(se.number||"").trim()})).filter(se=>se.number),v=(T.additionalEmails||[]).map(se=>String(se||"").trim()).filter(Boolean),ee={...T,companyName:a,clientName:r,name:a,gstin:String(T.gstin||"").trim(),phoneCountryCode:String(T.phoneCountryCode||"+91").trim()||"+91",phone:u,email:y,additionalPhones:L,additionalEmails:v,phoneList:[...u?[{countryCode:String(T.phoneCountryCode||"+91").trim()||"+91",number:u}]:[],...L],emailList:[y,...v].filter(Boolean),billingAddress:String(T.billingAddress||"").trim(),shippingAddress:String(T.shippingAddress||"").trim(),country:String(T.country||"").trim(),state:String(T.state||"").trim(),city:String(T.city||"").trim(),pincode:String(T.pincode||"").trim()};k(se=>{const Oe=se.customers||[];return C?{...se,customers:Oe.map(N=>N.id===C?{...N,...ee}:N)}:{...se,customers:[{...ee,id:`cust_${Date.now()}`},...Oe]}}),Ue()}function At(t){F(t.id),f(w(t)),h("customers")}function Pt(t){k(a=>({...a,customers:(a.customers||[]).filter(r=>r.id!==t)})),C===t&&Ue()}function Be(){j(""),ie({id:"",name:"",itemType:"Product",sku:"",hsnSacCode:"",unit:"Nos",defaultRate:"",taxPercent:""})}function Lt(t){if(t.preventDefault(),!String(R.name||"").trim())return;const a={...R,name:String(R.name||"").trim(),itemType:String(R.itemType||"Product").trim()||"Product",sku:String(R.sku||"").trim(),hsnSacCode:String(R.hsnSacCode||"").trim(),unit:String(R.unit||"").trim(),defaultRate:String(R.defaultRate||"").trim(),taxPercent:String(R.taxPercent||"").trim()};k(r=>{const u=r.itemMasters||[];return o?{...r,itemMasters:u.map(y=>y.id===o?{...y,...a}:y)}:{...r,itemMasters:[{...a,id:`itm_${Date.now()}`},...u]}}),Be()}function Et(t){j(t.id),ie({...t,itemType:t.itemType||"Product",hsnSacCode:t.hsnSacCode||""}),me(String(t.itemType||"Product")),h("items")}function Dt(t){k(a=>({...a,itemMasters:(a.itemMasters||[]).filter(r=>r.id!==t)})),o===t&&Be()}function It(t){Ce(t);try{window.localStorage.setItem(De,JSON.stringify(t))}catch{}}function Mt(t=[],a=""){const r=new Map;return(t||[]).forEach(u=>{if(!u||a&&u.id===a)return;const y=String(u.deliveryStatus||"").toLowerCase(),L=String(u.status||"").toLowerCase();y==="completed"||L==="cancelled"||(u.items||[]).forEach(v=>{const ee=String((v==null?void 0:v.inventoryItemId)||"").trim();if(!ee)return;const se=ue(v==null?void 0:v.qty);se<=0||r.set(ee,(r.get(ee)||0)+se)})}),r}const $t=m.useMemo(()=>Mt(x.invoices||[]),[x.invoices]);function Ge(t,a=null,r=""){const u=p.get(String(t||"")),y=ue(u==null?void 0:u.qty);let L=ue($t.get(String(t||""))||0);return a&&Array.isArray(a.items)&&a.items.forEach(v=>{String((v==null?void 0:v.inventoryItemId)||"")===String(t||"")&&(r&&String((v==null?void 0:v.id)||"")!==String(r)||(L-=ue(v==null?void 0:v.qty)))}),Math.max(0,y-Math.max(0,L))}function Ot(t,a,r){const u=String(r||"").trim();if(!u){Ie(t,a,"inventoryItemId","");return}const y=s.find(v=>String((v==null?void 0:v.id)||"")===u||String((v==null?void 0:v.itemName)||"").trim()===u);if(!y)return;(t==="estimate"?V:c)(v=>({...v,items:(v.items||[]).map(ee=>ee.id===a?{...ee,inventoryItemId:y.id,description:y.itemName||ee.description||""}:ee)}))}function He(t,a){if(!a||String(a.deliveryStatus||"").toLowerCase()!=="completed"||a.inventoryCommitted)return a;if(String((t==null?void 0:t.deliveryStatus)||"").toLowerCase()==="completed"&&(t!=null&&t.inventoryCommitted))return{...a,inventoryCommitted:!0};if(!X||!Array.isArray(X.items))return{...a,inventoryCommitted:!0};const u=new Map;if((a.items||[]).forEach(L=>{const v=String((L==null?void 0:L.inventoryItemId)||"").trim();if(!v)return;const ee=ue(L==null?void 0:L.qty);ee<=0||u.set(v,(u.get(v)||0)+ee)}),!u.size)return{...a,inventoryCommitted:!0};const y={...X,items:(X.items||[]).map(L=>{const v=String((L==null?void 0:L.id)||""),ee=ue(u.get(v)||0);if(!ee)return L;const se=ue(L==null?void 0:L.qty);return{...L,qty:String(Math.max(0,se-ee))}})};return It(y),{...a,inventoryCommitted:!0}}function Rt(t,a){const r=`/api/business-autopilot/accounts/documents/${t}/${encodeURIComponent(a)}/print`;window.open(r,"_blank","noopener,noreferrer")}function et(t,a,r){if(t==="estimate"){V(u=>({...u,[a]:r}));return}c(u=>({...u,[a]:r}))}function _t(t){if(t==="estimate"){V(a=>({...a,items:[...a.items||[],Pe()]}));return}c(a=>({...a,items:[...a.items||[],Pe()]}))}function Ie(t,a,r,u){(t==="estimate"?V:c)(L=>({...L,items:(L.items||[]).map(v=>v.id===a?{...v,[r]:u}:v)}))}function wt(t,a){(t==="estimate"?V:c)(u=>{const y=(u.items||[]).filter(L=>L.id!==a);return{...u,items:y.length?y:[Pe()]}})}function tt(t,a){a.preventDefault();const r=t==="estimate"?ce:re;if(!String(r.customerName||"").trim())return;const u={...r,customerName:String(r.customerName||"").trim(),customerGstin:String(r.customerGstin||"").trim(),billingAddress:String(r.billingAddress||"").trim(),salesperson:String(r.salesperson||"").trim(),notes:String(r.notes||"").trim(),termsText:String(r.termsText||"").trim(),paymentStatus:t==="invoice"?String(r.paymentStatus||"Pending").trim():"",deliveryStatus:t==="invoice"?String(r.deliveryStatus||"Pending").trim():"",inventoryCommitted:t==="invoice"?!!r.inventoryCommitted:!1,items:(r.items||[]).map(v=>({...v,itemMasterId:v.itemMasterId||"",inventoryItemId:v.inventoryItemId||"",description:String(v.description||"").trim(),qty:String(v.qty||"").trim(),rate:String(v.rate||"").trim(),taxPercent:String(v.taxPercent||"").trim()})).filter(v=>v.description||v.qty||v.rate)};u.items.length||(u.items=[Pe()]);const y=t==="estimate"?"estimates":"invoices",L=t==="estimate"?P:O;k(v=>{const ee=v[y]||[];if(L)return t==="invoice"?{...v,[y]:ee.map(se=>se.id!==L?se:He(se,{...se,...u}))}:{...v,[y]:ee.map(se=>se.id===L?{...se,...u}:se)};if(t==="invoice"){const se=He(null,{...u,id:`${t}_${Date.now()}`});return{...v,[y]:[se,...ee]}}return{...v,[y]:[{...u,id:`${t}_${Date.now()}`},...ee]}}),t==="estimate"?(B(""),V(ve("estimate"))):(E(""),c(ve("invoice")))}function Ft(t,a){const r={...a,items:(a.items&&a.items.length?a.items:[Pe()]).map(u=>({id:u.id||Pe().id,itemMasterId:u.itemMasterId||"",inventoryItemId:u.inventoryItemId||"",description:u.description||"",qty:String(u.qty??""),rate:String(u.rate??""),taxPercent:String(u.taxPercent??"")})),paymentStatus:t==="invoice"?a.paymentStatus||"Pending":a.paymentStatus||"",deliveryStatus:t==="invoice"?a.deliveryStatus||"Pending":a.deliveryStatus||"",inventoryCommitted:!!a.inventoryCommitted};if(t==="estimate"){B(a.id),V(r),h("estimates");return}E(a.id),c(r),h("invoices")}function Ut(t,a){const r=t==="estimate"?"estimates":"invoices";k(u=>({...u,[r]:(u[r]||[]).filter(y=>y.id!==a)})),t==="estimate"&&P===a&&(B(""),V(ve("estimate"))),t==="invoice"&&O===a&&(E(""),c(ve("invoice")))}function Bt(t,a,r){const u=t==="estimate"?"estimates":"invoices";k(y=>({...y,[u]:(y[u]||[]).map(L=>L.id===a?{...L,status:r}:L)}))}function Gt(t,a){k(r=>({...r,invoices:(r.invoices||[]).map(u=>u.id===t?{...u,paymentStatus:a}:u)}))}function Ht(t,a){k(r=>({...r,invoices:(r.invoices||[]).map(u=>u.id!==t?u:He(u,{...u,deliveryStatus:a}))}))}function at(t){var a;return((a=(x.gstTemplates||[]).find(r=>r.id===t))==null?void 0:a.name)||"-"}const Vt=m.useMemo(()=>Fe(ce,x.gstTemplates||[]),[ce,x.gstTemplates]),Yt=m.useMemo(()=>Fe(re,x.gstTemplates||[]),[re,x.gstTemplates]);function st({kind:t,form:a,setField:r,totals:u,onSave:y,onCancelEdit:L,editingId:v}){const ee=t==="estimate"?"Estimate":"Invoice",se=(x.billingTemplates||[]).filter(N=>String(N.docType||"").toLowerCase()===ee.toLowerCase()),Oe=(ye||[]).filter(N=>!!(N!=null&&N.name)).map(N=>N.name);return e.jsxs("div",{children:[e.jsx("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3",children:e.jsx("h6",{className:"mb-0",children:v?`Edit ${ee}`:`Create ${ee}`})}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:y,children:[e.jsx("div",{className:"p-0",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Client / Company Name"}),e.jsx("input",{className:"form-control datalist-readable-input",list:`${t}-client-company-list`,value:a.customerName||"",onChange:N=>{const fe=N.target.value;r("customerName",fe);const Ae=(x.customers||[]).find(de=>`${de.companyName||de.name||""}${de.clientName?` (${de.clientName})`:""}`===fe||(de.companyName||de.name||"")===fe);Ae&&(r("customerName",Ae.companyName||Ae.name||""),r("customerGstin",Ae.gstin||""),r("billingAddress",Ae.billingAddress||""))},placeholder:"Search client / company"}),e.jsx("datalist",{id:`${t}-client-company-list`,children:g.map(N=>e.jsx("option",{value:`${N.companyName||N.name||""}${N.clientName?` (${N.clientName})`:""}`},`${t}-${N.id}`))})]}),e.jsxs("div",{className:"col-12 col-xl-1",children:[e.jsxs("label",{className:"form-label small text-secondary mb-1",children:[ee," No"]}),e.jsx("input",{className:"form-control",value:a.docNo||"",onChange:N=>r("docNo",N.target.value),placeholder:t==="estimate"?"EST-1001":"INV-1001"})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Sales Person"}),e.jsx("input",{className:"form-control datalist-readable-input",list:`${t}-salesperson-list`,value:a.salesperson||"",onChange:N=>r("salesperson",N.target.value),placeholder:"Select Sales Person"}),e.jsx("datalist",{id:`${t}-salesperson-list`,children:Oe.map(N=>e.jsx("option",{value:N},`${t}-sales-${N}`))})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Issue Date"}),e.jsx("input",{type:"date",className:"form-control",value:a.issueDate||"",onChange:N=>r("issueDate",N.target.value)})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Due Date"}),e.jsx("input",{type:"date",className:"form-control",value:a.dueDate||"",onChange:N=>r("dueDate",N.target.value)})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:Y.templateSingular}),e.jsxs("select",{className:"form-select",value:a.gstTemplateId||"",onChange:N=>r("gstTemplateId",N.target.value),children:[e.jsx("option",{value:"",children:`Select ${Y.templateSingular}`}),(x.gstTemplates||[]).map(N=>e.jsxs("option",{value:N.id,children:[N.name," (",Xe(N),"%)"]},N.id))]})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Billing Template"}),e.jsxs("select",{className:"form-select",value:a.billingTemplateId||"",onChange:N=>r("billingTemplateId",N.target.value),children:[e.jsx("option",{value:"",children:"Select Billing Template"}),se.map(N=>e.jsx("option",{value:N.id,children:N.name},N.id))]})]}),t==="invoice"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Payment Status"}),e.jsx("select",{className:"form-select",value:a.paymentStatus||"Pending",onChange:N=>r("paymentStatus",N.target.value),children:mt.map(N=>e.jsx("option",{value:N,children:N},`inv-pay-${N}`))})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Delivery Status"}),e.jsx("select",{className:"form-select",value:a.deliveryStatus||"Pending",onChange:N=>r("deliveryStatus",N.target.value),children:dt.map(N=>e.jsx("option",{value:N,children:N},`inv-del-${N}`))})]})]}):null]})}),e.jsxs("div",{className:"card p-3 border",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h6",{className:"mb-0",children:"Item Table"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>_t(t),children:"Add Row"})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-borderless align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{minWidth:220},children:"Item Details"}),e.jsx("th",{style:{width:110},children:"Qty"}),e.jsx("th",{style:{width:140},children:"Rate"}),e.jsx("th",{style:{width:130},children:"Tax %"}),e.jsx("th",{style:{width:160},children:"Amount"}),e.jsx("th",{className:"text-end",style:{width:100},children:"Action"})]})}),e.jsx("tbody",{children:(a.items||[]).map((N,fe)=>{const Ae=ue(N.qty)*ue(N.rate);return e.jsxs("tr",{children:[e.jsxs("td",{style:{backgroundColor:fe%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:[e.jsx("input",{className:"form-control datalist-readable-input",list:`${t}-inventory-item-list-${N.id}`,value:N.description||"",onChange:de=>{const Re=de.target.value;Ie(t,N.id,"description",Re);const lt=s.find(Ye=>`${Ye.itemName||""} (Available: ${Ge(Ye.id,a,N.id)})`===Re||String(Ye.itemName||"")===Re);lt&&Ot(t,N.id,lt.id)},placeholder:"Type or click to select an item"}),e.jsx("datalist",{id:`${t}-inventory-item-list-${N.id}`,children:s.map(de=>e.jsx("option",{value:`${de.itemName||""} (Available: ${Ge(de.id,a,N.id)})`},`${t}-inventory-${de.id}`))}),N.inventoryItemId?e.jsxs("div",{className:"small text-secondary mt-1",children:["Available Qty: ",Ge(N.inventoryItemId,a,N.id)]}):null]}),e.jsx("td",{style:{backgroundColor:fe%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:e.jsx("input",{className:"form-control",value:N.qty||"",onChange:de=>Ie(t,N.id,"qty",de.target.value),placeholder:"1"})}),e.jsx("td",{style:{backgroundColor:fe%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:e.jsx("input",{className:"form-control",value:N.rate||"",onChange:de=>Ie(t,N.id,"rate",de.target.value),placeholder:"0.00"})}),e.jsx("td",{style:{backgroundColor:fe%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:e.jsx("input",{className:"form-control",value:N.taxPercent||"",onChange:de=>Ie(t,N.id,"taxPercent",de.target.value),placeholder:"Auto"})}),e.jsx("td",{className:"fw-semibold",style:{backgroundColor:fe%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:Le(Ae)}),e.jsx("td",{className:"text-end",style:{backgroundColor:fe%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>wt(t,N.id),children:"Delete"})})]},N.id)})})]})})]}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-xl-7",children:e.jsxs("div",{className:"h-100",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Customer Notes"}),e.jsx("textarea",{className:"form-control mb-3",rows:"3",value:a.notes||"",onChange:N=>r("notes",N.target.value),placeholder:"Notes visible on document"}),e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Terms & Conditions"}),e.jsx("textarea",{className:"form-control",rows:"3",value:a.termsText||"",onChange:N=>r("termsText",N.target.value),placeholder:"Terms and conditions"})]})}),e.jsx("div",{className:"col-12 col-xl-5",children:e.jsxs("div",{className:"card p-3 h-100 border",children:[e.jsx("h6",{className:"mb-3",children:"Summary"}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-secondary",children:"Sub Total"}),e.jsx("strong",{children:Le(u.subtotal)})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-secondary",children:"GST / Tax"}),e.jsx("strong",{children:Le(u.taxTotal)})]}),e.jsxs("div",{className:"d-flex justify-content-between pt-2 border-top",children:[e.jsx("span",{className:"fw-semibold",children:"Total"}),e.jsx("strong",{children:Le(u.grandTotal)})]})]})})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:v?`Update ${ee}`:`Create ${ee}`}),v?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:L,children:"Cancel Edit"}):null]})]})]})}function Ve({kind:t,rows:a,statusOptions:r}){const u=x.gstTemplates||[];return e.jsx(ge,{title:t==="estimate"?"Estimate List":"Invoice List",badgeLabel:`${a.length} items`,rows:a,withoutOuterCard:i==="overview"||t==="invoice"&&i==="invoices"||t==="estimate"&&i==="estimates",columns:[{key:"docNo",label:t==="estimate"?"Estimate No":"Invoice No"},{key:"customerName",label:"Customer"},{key:"issueDate",label:"Date"},{key:"dueDate",label:"Due Date"},{key:"total",label:"Total"},{key:"gstTemplateId",label:Y.templateSingular},...t==="invoice"?[{key:"paymentStatus",label:"Payment Status"},{key:"deliveryStatus",label:"Delivery Status"}]:[],{key:"status",label:"Status"}],searchPlaceholder:`Search ${t}s`,noRowsText:"No records yet.",searchBy:y=>[y.docNo,y.customerName,y.status,y.issueDate,y.dueDate].join(" "),renderCells:y=>{const L=Fe(y,u);return[e.jsx("span",{className:"fw-semibold",children:y.docNo||"-"}),y.customerName||"-",y.issueDate||"-",y.dueDate||"-",Le(L.grandTotal),at(y.gstTemplateId),...t==="invoice"?[e.jsx("select",{className:"form-select form-select-sm",value:y.paymentStatus||"Pending",onChange:v=>Gt(y.id,v.target.value),children:mt.map(v=>e.jsx("option",{value:v,children:v},`${y.id}-pay-${v}`))}),e.jsx("select",{className:"form-select form-select-sm",value:y.deliveryStatus||"Pending",onChange:v=>Ht(y.id,v.target.value),children:dt.map(v=>e.jsx("option",{value:v,children:v},`${y.id}-delivery-${v}`))})]:[],e.jsx("select",{className:"form-select form-select-sm",value:y.status||r[0],onChange:v=>Bt(t,y.id,v.target.value),children:r.map(v=>e.jsx("option",{value:v,children:v},v))})]},renderActions:y=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:()=>Rt(t,y.id),children:"Print / PDF"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>Ft(t,y),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>Ut(t,y.id),children:"Delete"})]})})}return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[J?e.jsx("div",{className:"card p-3 text-secondary",children:"Loading accounts workspace..."}):null,e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"Accounts"}),e.jsx("p",{className:"text-secondary mb-3",children:"Complete billing workflow with GST templates, billing templates, estimates, invoices, and status updates."}),he?e.jsx("div",{className:"d-flex flex-wrap align-items-center gap-2 mb-2",children:e.jsx("span",{className:"small text-danger",children:he})}):null,e.jsx("div",{className:"d-flex flex-wrap gap-2",children:[{key:"overview",label:"Overview"},{key:"invoices",label:"Invoices"},{key:"estimates",label:"Estimates"},{key:"gst",label:Y.templatesLabel},{key:"templates",label:"Billing Templates"},{key:"customers",label:"Customers"},{key:"items",label:"Items"}].map(t=>e.jsx("button",{type:"button",className:`btn btn-sm ${i===t.key?"btn-success":"btn-outline-light"}`,onClick:()=>h(t.key),children:t.label},t.key))})]}),i==="overview"?e.jsx("div",{className:"row g-3",children:l.map(t=>e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsx("div",{className:"stat-icon stat-icon-primary mb-2",children:e.jsx("i",{className:`bi ${t.icon||"bi-grid"}`,"aria-hidden":"true"})}),e.jsx("div",{className:"text-secondary small",children:t.label}),e.jsx("h5",{className:"mb-0 mt-1",children:t.value})]})},t.label))}):null,i==="overview"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${d==="invoice"?"btn-success":"btn-outline-light"}`,onClick:()=>D("invoice"),children:"Invoice List"}),e.jsx("button",{type:"button",className:`btn btn-sm ${d==="estimate"?"btn-success":"btn-outline-light"}`,onClick:()=>D("estimate"),children:"Estimate List"})]}),e.jsx("div",{children:d==="invoice"?e.jsx(Ve,{kind:"invoice",rows:x.invoices||[],statusOptions:na}):e.jsx(Ve,{kind:"estimate",rows:x.estimates||[],statusOptions:ct})})]}):null,i==="gst"?e.jsxs(e.Fragment,{children:[e.jsx(ge,{title:Y.templateListTitle,badgeLabel:`${(x.gstTemplates||[]).length} templates`,rows:x.gstTemplates||[],columns:[{key:"name",label:"Template Name"},{key:"taxScope",label:Y.scopeLabel},{key:"cgst",label:Y.cgstLabel.replace(" %","")},{key:"sgst",label:Y.sgstLabel.replace(" %","")},{key:"igst",label:Y.igstLabel.replace(" %","")},{key:"cess",label:Y.cessLabel.replace(" %","")},{key:"total",label:"Total"},{key:"status",label:"Status"}],searchPlaceholder:`Search ${Y.templatesLabel.toLowerCase()}`,noRowsText:`No ${Y.templatesLabel.toLowerCase()} yet.`,searchBy:t=>[t.name,t.taxScope,t.status,t.notes].join(" "),renderCells:t=>[e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:t.name}),e.jsx("div",{className:"small text-secondary",children:t.notes||"-"})]}),t.taxScope,`${t.cgst}%`,`${t.sgst}%`,`${t.igst}%`,`${t.cess}%`,`${Xe(t)}%`,e.jsx("select",{className:"form-select form-select-sm",value:t.status||"Active",onChange:a=>jt(t.id,a.target.value),children:we.map(a=>e.jsx("option",{value:a,children:a},a))})],renderActions:t=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>ft(t),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>Nt(t.id),children:"Delete"})]})}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-1",children:A?Y.editTitle:Y.createTitle}),e.jsx("div",{className:"small text-secondary mb-3",children:Y.helperText}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:xt,children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Template Name"}),e.jsx("input",{className:"form-control",value:Z.name||"",onChange:t=>b(a=>({...a,name:t.target.value})),placeholder:Y.namePlaceholder})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:Y.scopeLabel}),e.jsx("select",{className:"form-select",value:Z.taxScope||Y.defaultScope,onChange:t=>b(a=>({...a,taxScope:t.target.value})),children:Array.from(new Set([...Y.scopeOptions||[],String(Z.taxScope||"").trim()].filter(Boolean))).map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"col-6 col-md-3 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:Y.cgstLabel}),e.jsx("input",{className:"form-control",value:Z.cgst||"",onChange:t=>b(a=>({...a,cgst:t.target.value}))})]}),e.jsxs("div",{className:"col-6 col-md-3 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:Y.sgstLabel}),e.jsx("input",{className:"form-control",value:Z.sgst||"",onChange:t=>b(a=>({...a,sgst:t.target.value}))})]}),e.jsxs("div",{className:"col-6 col-md-3 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:Y.igstLabel}),e.jsx("input",{className:"form-control",value:Z.igst||"",onChange:t=>b(a=>({...a,igst:t.target.value}))})]}),e.jsxs("div",{className:"col-6 col-md-3 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:Y.cessLabel}),e.jsx("input",{className:"form-control",value:Z.cess||"",onChange:t=>b(a=>({...a,cess:t.target.value}))})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Status"}),e.jsx("select",{className:"form-select",value:Z.status||"Active",onChange:t=>b(a=>({...a,status:t.target.value})),children:we.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Notes"}),e.jsx("textarea",{className:"form-control",rows:"2",value:Z.notes||"",onChange:t=>b(a=>({...a,notes:t.target.value})),placeholder:Y.notesPlaceholder})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:A?Y.editActionLabel:Y.createActionLabel}),A?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:ae,children:"Cancel"}):null]})]})]})]}):null,i==="customers"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:C?"Edit Customer":"Create Customer"}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:Tt,children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Company Name"}),e.jsx("input",{className:"form-control",value:T.companyName||"",onChange:t=>f(a=>({...a,companyName:t.target.value,name:t.target.value})),placeholder:"Company name"})]}),e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Client Name"}),e.jsx("input",{className:"form-control",value:T.clientName||"",onChange:t=>f(a=>({...a,clientName:t.target.value})),placeholder:"Client / Contact person"})]}),e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"GSTIN"}),e.jsx("input",{className:"form-control",value:T.gstin||"",onChange:t=>f(a=>({...a,gstin:t.target.value})),placeholder:"GSTIN"})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Phone Number"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("select",{className:"form-select",style:{maxWidth:"220px"},value:T.phoneCountryCode||"+91",onChange:t=>f(a=>({...a,phoneCountryCode:t.target.value})),children:Qe.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("input",{className:"form-control",value:T.phone||"",onChange:t=>f(a=>({...a,phone:t.target.value})),placeholder:"Phone number"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",title:"Add Contact Number",onClick:()=>f(t=>({...t,additionalPhones:[...t.additionalPhones||[],{countryCode:"+91",number:""}]})),children:"+"})]})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Email ID"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("input",{className:"form-control",value:T.email||"",onChange:t=>f(a=>({...a,email:t.target.value})),placeholder:"Primary email"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",title:"Add Email ID",onClick:()=>f(t=>({...t,additionalEmails:[...t.additionalEmails||[],""]})),children:"+"})]})]}),e.jsx("div",{className:"col-12 col-xl-6",children:(T.additionalEmails||[]).map((t,a)=>e.jsxs("div",{className:"d-flex gap-2 mb-2",children:[e.jsx("input",{className:"form-control",value:t||"",placeholder:"Additional email ID",onChange:r=>f(u=>({...u,additionalEmails:(u.additionalEmails||[]).map((y,L)=>L===a?r.target.value:y)}))}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>f(r=>({...r,additionalEmails:(r.additionalEmails||[]).filter((u,y)=>y!==a)})),children:"x"})]},`email-${a}`))}),e.jsx("div",{className:"col-12",children:(T.additionalPhones||[]).map((t,a)=>e.jsxs("div",{className:"d-flex gap-2 mb-2",children:[e.jsx("select",{className:"form-select",style:{maxWidth:"220px"},value:t.countryCode||"+91",onChange:r=>f(u=>({...u,additionalPhones:(u.additionalPhones||[]).map((y,L)=>L===a?{...y,countryCode:r.target.value}:y)})),children:Qe.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))}),e.jsx("input",{className:"form-control",value:t.number||"",placeholder:"Additional contact number",onChange:r=>f(u=>({...u,additionalPhones:(u.additionalPhones||[]).map((y,L)=>L===a?{...y,number:r.target.value}:y)}))}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>f(r=>({...r,additionalPhones:(r.additionalPhones||[]).filter((u,y)=>y!==a)})),children:"x"})]},`phone-${a}`))}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Billing Address"}),e.jsx("textarea",{className:"form-control",rows:"2",value:T.billingAddress||"",onChange:t=>f(a=>({...a,billingAddress:t.target.value})),placeholder:"Billing address"})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Shipping Address"}),e.jsx("textarea",{className:"form-control",rows:"2",value:T.shippingAddress||"",onChange:t=>f(a=>({...a,shippingAddress:t.target.value})),placeholder:"Shipping address"})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Country"}),e.jsx("select",{className:"form-select",value:T.country||"India",onChange:t=>f(a=>({...a,country:t.target.value,state:""})),children:Jt.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"State"}),S.length?e.jsxs("select",{className:"form-select",value:T.state||"",onChange:t=>f(a=>({...a,state:t.target.value})),children:[e.jsx("option",{value:"",children:"Select State"}),S.map(t=>e.jsx("option",{value:t,children:t},t))]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{className:"form-control",list:"baerp-state-options",value:T.state||"",onChange:t=>f(a=>({...a,state:t.target.value})),placeholder:"State / Province / Region"}),e.jsx("datalist",{id:"baerp-state-options",children:S.map(t=>e.jsx("option",{value:t},t))})]})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"City"}),e.jsx("input",{className:"form-control",value:T.city||"",onChange:t=>f(a=>({...a,city:t.target.value})),placeholder:"City"})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Pincode"}),e.jsx("input",{className:"form-control",value:T.pincode||"",onChange:t=>f(a=>({...a,pincode:t.target.value})),placeholder:"Pincode"})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:C?"Update Customer":"Create Customer"}),C?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Ue,children:"Cancel"}):null]})]})]}),e.jsx(ge,{title:"Client List",badgeLabel:`${(x.customers||[]).length} clients`,rows:x.customers||[],columns:[{key:"companyName",label:"Company Name"},{key:"clientName",label:"Client Name"},{key:"gstin",label:"GSTIN"},{key:"phones",label:"Contact Number"},{key:"emails",label:"Email ID"},{key:"location",label:"Location"}],searchPlaceholder:"Search clients",noRowsText:"No clients yet.",searchBy:t=>[t.companyName||t.name,t.clientName,t.gstin,..._(t),...Q(t),t.country,t.state,t.city,t.pincode].join(" "),renderCells:t=>[e.jsx("span",{className:"fw-semibold",children:t.companyName||t.name||"-"}),t.clientName||"-",t.gstin||"-",e.jsx("span",{style:{whiteSpace:"normal"},children:_(t).join(", ")||"-"}),e.jsx("span",{style:{whiteSpace:"normal"},children:Q(t).join(", ")||"-"}),e.jsx("span",{style:{whiteSpace:"normal"},children:[t.city,t.state,t.country,t.pincode].filter(Boolean).join(", ")||"-"})],renderActions:t=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>At(t),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>Pt(t.id),children:"Delete"})]})})]}):null,i==="items"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:o?"Edit Item Master":"Create Item Master"}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:Lt,children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Item Name"}),e.jsx("input",{className:"form-control",value:R.name||"",onChange:t=>ie(a=>({...a,name:t.target.value})),placeholder:"Item name"})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Type"}),e.jsxs("select",{className:"form-select",value:R.itemType||"Product",onChange:t=>ie(a=>({...a,itemType:t.target.value})),children:[e.jsx("option",{value:"Product",children:"Product"}),e.jsx("option",{value:"Service",children:"Service"})]})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"SKU"}),e.jsx("input",{className:"form-control",value:R.sku||"",onChange:t=>ie(a=>({...a,sku:t.target.value})),placeholder:"SKU"})]}),xe?e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:String(R.itemType||"Product")==="Service"?"SAC Code":"HSN Code"}),e.jsx("input",{className:"form-control",value:R.hsnSacCode||"",onChange:t=>ie(a=>({...a,hsnSacCode:t.target.value})),placeholder:String(R.itemType||"Product")==="Service"?"SAC":"HSN"})]}):null,e.jsxs("div",{className:"col-12 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Unit"}),e.jsx("input",{className:"form-control",value:R.unit||"",onChange:t=>ie(a=>({...a,unit:t.target.value})),placeholder:"Nos"})]}),e.jsxs("div",{className:"col-12 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Default Rate"}),e.jsx("input",{className:"form-control",value:R.defaultRate||"",onChange:t=>ie(a=>({...a,defaultRate:t.target.value})),placeholder:"0.00"})]}),e.jsxs("div",{className:"col-12 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Tax %"}),e.jsx("input",{className:"form-control",value:R.taxPercent||"",onChange:t=>ie(a=>({...a,taxPercent:t.target.value})),placeholder:"18"})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:o?"Update Item":"Create Item"}),o?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Be,children:"Cancel"}):null]})]})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${U==="Product"?"btn-success":"btn-outline-light"}`,onClick:()=>me("Product"),children:"Products"}),e.jsx("button",{type:"button",className:`btn btn-sm ${U==="Service"?"btn-success":"btn-outline-light"}`,onClick:()=>me("Service"),children:"Service"})]}),e.jsx(ge,{title:`Item Master List (${U})`,badgeLabel:`${n.length} items`,rows:n,withoutOuterCard:!0,columns:[{key:"name",label:"Item Name"},{key:"itemType",label:"Type"},{key:"sku",label:"SKU"},...xe?[{key:"hsnSacCode",label:"HSN / SAC"}]:[],{key:"unit",label:"Unit"},{key:"defaultRate",label:"Default Rate"},{key:"taxPercent",label:"Tax %"}],searchPlaceholder:`Search ${String(U).toLowerCase()} items`,noRowsText:`No ${String(U).toLowerCase()} item masters yet.`,searchBy:t=>[t.name,t.itemType,t.sku,t.hsnSacCode,t.unit,t.defaultRate,t.taxPercent].join(" "),renderCells:t=>[e.jsx("span",{className:"fw-semibold",children:t.name||"-"}),t.itemType||"Product",t.sku||"-",...xe?[t.hsnSacCode||"-"]:[],t.unit||"-",t.defaultRate||"-",t.taxPercent||"-"],renderActions:t=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>Et(t),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>Dt(t.id),children:"Delete"})]})})]}):null,i==="templates"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsx("h6",{className:"mb-0",children:G?"Edit Billing Template":"Create Billing Template"}),e.jsx("span",{className:"badge bg-dark border",children:"GST Template option included"})]}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:vt,children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Template Name"}),e.jsx("input",{className:"form-control",value:$.name||"",onChange:t=>I(a=>({...a,name:t.target.value})),placeholder:"Default GST Invoice Template"})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Document Type"}),e.jsxs("select",{className:"form-select",value:$.docType||"Invoice",onChange:t=>I(a=>({...a,docType:t.target.value})),children:[e.jsx("option",{value:"Invoice",children:"Invoice"}),e.jsx("option",{value:"Estimate",children:"Estimate"})]})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"GST Template"}),e.jsxs("select",{className:"form-select",value:$.gstTemplateId||"",onChange:t=>I(a=>({...a,gstTemplateId:t.target.value})),children:[e.jsx("option",{value:"",children:"Select GST Template"}),(x.gstTemplates||[]).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Prefix"}),e.jsx("input",{className:"form-control",value:$.prefix||"",onChange:t=>I(a=>({...a,prefix:t.target.value})),placeholder:"INV"})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Inv Start From"}),e.jsx("input",{type:"number",min:"1",step:"1",className:"form-control",value:$.invStartFrom||"",onChange:t=>I(a=>({...a,invStartFrom:t.target.value})),placeholder:"1001"})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Color"}),e.jsx("input",{type:"color",className:"form-control form-control-color w-100",value:$.themeColor||"#22c55e",onChange:t=>I(a=>({...a,themeColor:t.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Status"}),e.jsx("select",{className:"form-select",value:$.status||"Active",onChange:t=>I(a=>({...a,status:t.target.value})),children:we.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Company Logo"}),e.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[e.jsx("input",{type:"file",accept:"image/*",className:"form-control form-control-sm",onChange:t=>{var a;return Te((a=t.target.files)==null?void 0:a[0])}}),$.companyLogoDataUrl?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:$.companyLogoDataUrl,alt:"Company logo preview",style:{width:36,height:36,objectFit:"contain",borderRadius:6,border:"1px solid var(--bs-border-color)"}}),e.jsx("span",{className:"small text-secondary text-truncate",style:{maxWidth:180},children:$.companyLogoName||"logo"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>I(t=>({...t,companyLogoDataUrl:"",companyLogoName:""})),children:"Remove"})]}):null]})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Footer Note"}),e.jsx("input",{className:"form-control",value:$.footerNote||"",onChange:t=>I(a=>({...a,footerNote:t.target.value})),placeholder:"Thank you for your business"})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Terms Text"}),e.jsx("input",{className:"form-control",value:$.termsText||"",onChange:t=>I(a=>({...a,termsText:t.target.value})),placeholder:"Payment terms and conditions"})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:G?"Update Billing Template":"Create Billing Template"}),G?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:pe,children:"Cancel"}):null]})]})]}),e.jsx(ge,{title:"Billing Template List",badgeLabel:`${(x.billingTemplates||[]).length} templates`,rows:x.billingTemplates||[],withoutOuterCard:!0,columns:[{key:"name",label:"Template"},{key:"docType",label:"Type"},{key:"gstTemplateId",label:"GST Template"},{key:"companyLogoDataUrl",label:"Logo"},{key:"prefix",label:"Prefix"},{key:"themeColor",label:"Theme"},{key:"status",label:"Status"}],searchPlaceholder:"Search billing templates",noRowsText:"No billing templates yet.",searchBy:t=>[t.name,t.docType,t.prefix,t.status,t.footerNote].join(" "),renderCells:t=>[e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:t.name}),e.jsx("div",{className:"small text-secondary",children:t.footerNote||"-"})]}),t.docType,at(t.gstTemplateId),t.companyLogoDataUrl?e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("img",{src:t.companyLogoDataUrl,alt:t.companyLogoName||"Company logo",style:{width:28,height:28,objectFit:"contain",borderRadius:4,border:"1px solid var(--bs-border-color)"}}),e.jsx("span",{className:"small text-secondary",children:t.companyLogoName||"Logo"})]}):e.jsx("span",{className:"small text-secondary",children:"No logo"}),t.prefix||"-",e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{style:{width:14,height:14,borderRadius:4,background:t.themeColor||"#22c55e",display:"inline-block"}}),e.jsx("span",{children:t.themeColor||"-"})]}),e.jsx("select",{className:"form-select form-select-sm",value:t.status||"Active",onChange:a=>kt(t.id,a.target.value),children:we.map(a=>e.jsx("option",{value:a,children:a},a))})],renderActions:t=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>St(t),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>Ct(t.id),children:"Delete"})]})})]}):null,i==="estimates"?e.jsxs(e.Fragment,{children:[e.jsx(Ve,{kind:"estimate",rows:x.estimates||[],statusOptions:ct}),e.jsx(st,{kind:"estimate",form:ce,setField:(t,a)=>et("estimate",t,a),totals:Vt,onSave:t=>tt("estimate",t),onCancelEdit:()=>{B(""),V(ve("estimate"))},editingId:P})]}):null,i==="invoices"?e.jsx(e.Fragment,{children:e.jsx(st,{kind:"invoice",form:re,setField:(t,a)=>et("invoice",t,a),totals:Yt,onSave:t=>tt("invoice",t),onCancelEdit:()=>{E(""),c(ve("invoice"))},editingId:O})}):null]})}function ya({heading:i,moduleData:h}){return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:i}),e.jsx("p",{className:"text-secondary mb-0",children:h.subtitle})]}),e.jsx("div",{className:"row g-3",children:(h.stats||[]).map(d=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("div",{className:"text-secondary small",children:d.label}),e.jsx("h5",{className:"mb-0 mt-1",children:d.value})]})},d.label))}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:"Enabled Features"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:(h.sections||[]).map(d=>e.jsxs("div",{className:"d-flex align-items-center justify-content-between border rounded px-2 py-2",children:[e.jsx("span",{children:d}),e.jsx("span",{className:"badge bg-success",children:"Ready"})]},d))})]})]})}function Na({moduleKey:i="crm",title:h}){const d=ot[i]||ot.crm,D=h||d.title;return i==="crm"?e.jsx(da,{}):i==="projects"?e.jsx(ua,{}):i==="hrm"?e.jsx(pa,{}):i==="ticketing"?e.jsx(ha,{}):i==="stocks"?e.jsx(ba,{}):i==="accounts"?e.jsx(ga,{}):e.jsx(ya,{heading:D,moduleData:d})}export{Na as default};
