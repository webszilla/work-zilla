function Wj(t,a){for(var s=0;s<a.length;s++){const n=a[s];if(typeof n!="string"&&!Array.isArray(n)){for(const l in n)if(l!=="default"&&!(l in t)){const r=Object.getOwnPropertyDescriptor(n,l);r&&Object.defineProperty(t,l,r.get?r:{enumerable:!0,get:()=>n[l]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))n(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function s(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(l){if(l.ep)return;l.ep=!0;const r=s(l);fetch(l.href,r)}})();function Vj(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ip={exports:{}},mi={},op={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bl=Symbol.for("react.element"),Gj=Symbol.for("react.portal"),Hj=Symbol.for("react.fragment"),Qj=Symbol.for("react.strict_mode"),qj=Symbol.for("react.profiler"),Yj=Symbol.for("react.provider"),Kj=Symbol.for("react.context"),Jj=Symbol.for("react.forward_ref"),Zj=Symbol.for("react.suspense"),Xj=Symbol.for("react.memo"),eb=Symbol.for("react.lazy"),gh=Symbol.iterator;function tb(t){return t===null||typeof t!="object"?null:(t=gh&&t[gh]||t["@@iterator"],typeof t=="function"?t:null)}var cp={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dp=Object.assign,up={};function Wn(t,a,s){this.props=t,this.context=a,this.refs=up,this.updater=s||cp}Wn.prototype.isReactComponent={};Wn.prototype.setState=function(t,a){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,a,"setState")};Wn.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function mp(){}mp.prototype=Wn.prototype;function Qc(t,a,s){this.props=t,this.context=a,this.refs=up,this.updater=s||cp}var qc=Qc.prototype=new mp;qc.constructor=Qc;dp(qc,Wn.prototype);qc.isPureReactComponent=!0;var jh=Array.isArray,hp=Object.prototype.hasOwnProperty,Yc={current:null},fp={key:!0,ref:!0,__self:!0,__source:!0};function pp(t,a,s){var n,l={},r=null,i=null;if(a!=null)for(n in a.ref!==void 0&&(i=a.ref),a.key!==void 0&&(r=""+a.key),a)hp.call(a,n)&&!fp.hasOwnProperty(n)&&(l[n]=a[n]);var u=arguments.length-2;if(u===1)l.children=s;else if(1<u){for(var c=Array(u),m=0;m<u;m++)c[m]=arguments[m+2];l.children=c}if(t&&t.defaultProps)for(n in u=t.defaultProps,u)l[n]===void 0&&(l[n]=u[n]);return{$$typeof:Bl,type:t,key:r,ref:i,props:l,_owner:Yc.current}}function ab(t,a){return{$$typeof:Bl,type:t.type,key:a,ref:t.ref,props:t.props,_owner:t._owner}}function Kc(t){return typeof t=="object"&&t!==null&&t.$$typeof===Bl}function sb(t){var a={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(s){return a[s]})}var bh=/\/+/g;function lo(t,a){return typeof t=="object"&&t!==null&&t.key!=null?sb(""+t.key):a.toString(36)}function kr(t,a,s,n,l){var r=typeof t;(r==="undefined"||r==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(r){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Bl:case Gj:i=!0}}if(i)return i=t,l=l(i),t=n===""?"."+lo(i,0):n,jh(l)?(s="",t!=null&&(s=t.replace(bh,"$&/")+"/"),kr(l,a,s,"",function(m){return m})):l!=null&&(Kc(l)&&(l=ab(l,s+(!l.key||i&&i.key===l.key?"":(""+l.key).replace(bh,"$&/")+"/")+t)),a.push(l)),1;if(i=0,n=n===""?".":n+":",jh(t))for(var u=0;u<t.length;u++){r=t[u];var c=n+lo(r,u);i+=kr(r,a,s,c,l)}else if(c=tb(t),typeof c=="function")for(t=c.call(t),u=0;!(r=t.next()).done;)r=r.value,c=n+lo(r,u++),i+=kr(r,a,s,c,l);else if(r==="object")throw a=String(t),Error("Objects are not valid as a React child (found: "+(a==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":a)+"). If you meant to render a collection of children, use an array instead.");return i}function tr(t,a,s){if(t==null)return t;var n=[],l=0;return kr(t,n,"","",function(r){return a.call(s,r,l++)}),n}function nb(t){if(t._status===-1){var a=t._result;a=a(),a.then(function(s){(t._status===0||t._status===-1)&&(t._status=1,t._result=s)},function(s){(t._status===0||t._status===-1)&&(t._status=2,t._result=s)}),t._status===-1&&(t._status=0,t._result=a)}if(t._status===1)return t._result.default;throw t._result}var Zt={current:null},Pr={transition:null},lb={ReactCurrentDispatcher:Zt,ReactCurrentBatchConfig:Pr,ReactCurrentOwner:Yc};function xp(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:tr,forEach:function(t,a,s){tr(t,function(){a.apply(this,arguments)},s)},count:function(t){var a=0;return tr(t,function(){a++}),a},toArray:function(t){return tr(t,function(a){return a})||[]},only:function(t){if(!Kc(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Xe.Component=Wn;Xe.Fragment=Hj;Xe.Profiler=qj;Xe.PureComponent=Qc;Xe.StrictMode=Qj;Xe.Suspense=Zj;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lb;Xe.act=xp;Xe.cloneElement=function(t,a,s){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=dp({},t.props),l=t.key,r=t.ref,i=t._owner;if(a!=null){if(a.ref!==void 0&&(r=a.ref,i=Yc.current),a.key!==void 0&&(l=""+a.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in a)hp.call(a,c)&&!fp.hasOwnProperty(c)&&(n[c]=a[c]===void 0&&u!==void 0?u[c]:a[c])}var c=arguments.length-2;if(c===1)n.children=s;else if(1<c){u=Array(c);for(var m=0;m<c;m++)u[m]=arguments[m+2];n.children=u}return{$$typeof:Bl,type:t.type,key:l,ref:r,props:n,_owner:i}};Xe.createContext=function(t){return t={$$typeof:Kj,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Yj,_context:t},t.Consumer=t};Xe.createElement=pp;Xe.createFactory=function(t){var a=pp.bind(null,t);return a.type=t,a};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(t){return{$$typeof:Jj,render:t}};Xe.isValidElement=Kc;Xe.lazy=function(t){return{$$typeof:eb,_payload:{_status:-1,_result:t},_init:nb}};Xe.memo=function(t,a){return{$$typeof:Xj,type:t,compare:a===void 0?null:a}};Xe.startTransition=function(t){var a=Pr.transition;Pr.transition={};try{t()}finally{Pr.transition=a}};Xe.unstable_act=xp;Xe.useCallback=function(t,a){return Zt.current.useCallback(t,a)};Xe.useContext=function(t){return Zt.current.useContext(t)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(t){return Zt.current.useDeferredValue(t)};Xe.useEffect=function(t,a){return Zt.current.useEffect(t,a)};Xe.useId=function(){return Zt.current.useId()};Xe.useImperativeHandle=function(t,a,s){return Zt.current.useImperativeHandle(t,a,s)};Xe.useInsertionEffect=function(t,a){return Zt.current.useInsertionEffect(t,a)};Xe.useLayoutEffect=function(t,a){return Zt.current.useLayoutEffect(t,a)};Xe.useMemo=function(t,a){return Zt.current.useMemo(t,a)};Xe.useReducer=function(t,a,s){return Zt.current.useReducer(t,a,s)};Xe.useRef=function(t){return Zt.current.useRef(t)};Xe.useState=function(t){return Zt.current.useState(t)};Xe.useSyncExternalStore=function(t,a,s){return Zt.current.useSyncExternalStore(t,a,s)};Xe.useTransition=function(){return Zt.current.useTransition()};Xe.version="18.3.1";op.exports=Xe;var o=op.exports;const gp=Vj(o),rb=Wj({__proto__:null,default:gp},[o]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ib=o,ob=Symbol.for("react.element"),cb=Symbol.for("react.fragment"),db=Object.prototype.hasOwnProperty,ub=ib.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,mb={key:!0,ref:!0,__self:!0,__source:!0};function jp(t,a,s){var n,l={},r=null,i=null;s!==void 0&&(r=""+s),a.key!==void 0&&(r=""+a.key),a.ref!==void 0&&(i=a.ref);for(n in a)db.call(a,n)&&!mb.hasOwnProperty(n)&&(l[n]=a[n]);if(t&&t.defaultProps)for(n in a=t.defaultProps,a)l[n]===void 0&&(l[n]=a[n]);return{$$typeof:ob,type:t,key:r,ref:i,props:l,_owner:ub.current}}mi.Fragment=cb;mi.jsx=jp;mi.jsxs=jp;ip.exports=mi;var e=ip.exports,Yo={},bp={exports:{}},ga={},yp={exports:{}},vp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function a(T,H){var I=T.length;T.push(H);e:for(;0<I;){var S=I-1>>>1,k=T[S];if(0<l(k,H))T[S]=H,T[I]=k,I=S;else break e}}function s(T){return T.length===0?null:T[0]}function n(T){if(T.length===0)return null;var H=T[0],I=T.pop();if(I!==H){T[0]=I;e:for(var S=0,k=T.length,M=k>>>1;S<M;){var A=2*(S+1)-1,F=T[A],te=A+1,Y=T[te];if(0>l(F,I))te<k&&0>l(Y,F)?(T[S]=Y,T[te]=I,S=te):(T[S]=F,T[A]=I,S=A);else if(te<k&&0>l(Y,I))T[S]=Y,T[te]=I,S=te;else break e}}return H}function l(T,H){var I=T.sortIndex-H.sortIndex;return I!==0?I:T.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;t.unstable_now=function(){return r.now()}}else{var i=Date,u=i.now();t.unstable_now=function(){return i.now()-u}}var c=[],m=[],x=1,f=null,j=3,N=!1,v=!1,_=!1,C=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function p(T){for(var H=s(m);H!==null;){if(H.callback===null)n(m);else if(H.startTime<=T)n(m),H.sortIndex=H.expirationTime,a(c,H);else break;H=s(m)}}function b(T){if(_=!1,p(T),!v)if(s(c)!==null)v=!0,K(P);else{var H=s(m);H!==null&&O(b,H.startTime-T)}}function P(T,H){v=!1,_&&(_=!1,y(L),L=-1),N=!0;var I=j;try{for(p(H),f=s(c);f!==null&&(!(f.expirationTime>H)||T&&!w());){var S=f.callback;if(typeof S=="function"){f.callback=null,j=f.priorityLevel;var k=S(f.expirationTime<=H);H=t.unstable_now(),typeof k=="function"?f.callback=k:f===s(c)&&n(c),p(H)}else n(c);f=s(c)}if(f!==null)var M=!0;else{var A=s(m);A!==null&&O(b,A.startTime-H),M=!1}return M}finally{f=null,j=I,N=!1}}var $=!1,E=null,L=-1,V=5,U=-1;function w(){return!(t.unstable_now()-U<V)}function Q(){if(E!==null){var T=t.unstable_now();U=T;var H=!0;try{H=E(!0,T)}finally{H?J():($=!1,E=null)}}else $=!1}var J;if(typeof h=="function")J=function(){h(Q)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,re=me.port2;me.port1.onmessage=Q,J=function(){re.postMessage(null)}}else J=function(){C(Q,0)};function K(T){E=T,$||($=!0,J())}function O(T,H){L=C(function(){T(t.unstable_now())},H)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(T){T.callback=null},t.unstable_continueExecution=function(){v||N||(v=!0,K(P))},t.unstable_forceFrameRate=function(T){0>T||125<T?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<T?Math.floor(1e3/T):5},t.unstable_getCurrentPriorityLevel=function(){return j},t.unstable_getFirstCallbackNode=function(){return s(c)},t.unstable_next=function(T){switch(j){case 1:case 2:case 3:var H=3;break;default:H=j}var I=j;j=H;try{return T()}finally{j=I}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(T,H){switch(T){case 1:case 2:case 3:case 4:case 5:break;default:T=3}var I=j;j=T;try{return H()}finally{j=I}},t.unstable_scheduleCallback=function(T,H,I){var S=t.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?S+I:S):I=S,T){case 1:var k=-1;break;case 2:k=250;break;case 5:k=1073741823;break;case 4:k=1e4;break;default:k=5e3}return k=I+k,T={id:x++,callback:H,priorityLevel:T,startTime:I,expirationTime:k,sortIndex:-1},I>S?(T.sortIndex=I,a(m,T),s(c)===null&&T===s(m)&&(_?(y(L),L=-1):_=!0,O(b,I-S))):(T.sortIndex=k,a(c,T),v||N||(v=!0,K(P))),T},t.unstable_shouldYield=w,t.unstable_wrapCallback=function(T){var H=j;return function(){var I=j;j=H;try{return T.apply(this,arguments)}finally{j=I}}}})(vp);yp.exports=vp;var hb=yp.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fb=o,xa=hb;function ge(t){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+t,s=1;s<arguments.length;s++)a+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+t+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Np=new Set,_l={};function an(t,a){Mn(t,a),Mn(t+"Capture",a)}function Mn(t,a){for(_l[t]=a,t=0;t<a.length;t++)Np.add(a[t])}var is=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ko=Object.prototype.hasOwnProperty,pb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,yh={},vh={};function xb(t){return Ko.call(vh,t)?!0:Ko.call(yh,t)?!1:pb.test(t)?vh[t]=!0:(yh[t]=!0,!1)}function gb(t,a,s,n){if(s!==null&&s.type===0)return!1;switch(typeof a){case"function":case"symbol":return!0;case"boolean":return n?!1:s!==null?!s.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function jb(t,a,s,n){if(a===null||typeof a>"u"||gb(t,a,s,n))return!0;if(n)return!1;if(s!==null)switch(s.type){case 3:return!a;case 4:return a===!1;case 5:return isNaN(a);case 6:return isNaN(a)||1>a}return!1}function Xt(t,a,s,n,l,r,i){this.acceptsBooleans=a===2||a===3||a===4,this.attributeName=n,this.attributeNamespace=l,this.mustUseProperty=s,this.propertyName=t,this.type=a,this.sanitizeURL=r,this.removeEmptyString=i}var Bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Bt[t]=new Xt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var a=t[0];Bt[a]=new Xt(a,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Bt[t]=new Xt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Bt[t]=new Xt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Bt[t]=new Xt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Bt[t]=new Xt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Bt[t]=new Xt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Bt[t]=new Xt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Bt[t]=new Xt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Jc=/[\-:]([a-z])/g;function Zc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var a=t.replace(Jc,Zc);Bt[a]=new Xt(a,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var a=t.replace(Jc,Zc);Bt[a]=new Xt(a,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var a=t.replace(Jc,Zc);Bt[a]=new Xt(a,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Bt[t]=new Xt(t,1,!1,t.toLowerCase(),null,!1,!1)});Bt.xlinkHref=new Xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Bt[t]=new Xt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xc(t,a,s,n){var l=Bt.hasOwnProperty(a)?Bt[a]:null;(l!==null?l.type!==0:n||!(2<a.length)||a[0]!=="o"&&a[0]!=="O"||a[1]!=="n"&&a[1]!=="N")&&(jb(a,s,l,n)&&(s=null),n||l===null?xb(a)&&(s===null?t.removeAttribute(a):t.setAttribute(a,""+s)):l.mustUseProperty?t[l.propertyName]=s===null?l.type===3?!1:"":s:(a=l.attributeName,n=l.attributeNamespace,s===null?t.removeAttribute(a):(l=l.type,s=l===3||l===4&&s===!0?"":""+s,n?t.setAttributeNS(n,a,s):t.setAttribute(a,s))))}var us=fb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ar=Symbol.for("react.element"),gn=Symbol.for("react.portal"),jn=Symbol.for("react.fragment"),ed=Symbol.for("react.strict_mode"),Jo=Symbol.for("react.profiler"),_p=Symbol.for("react.provider"),Sp=Symbol.for("react.context"),td=Symbol.for("react.forward_ref"),Zo=Symbol.for("react.suspense"),Xo=Symbol.for("react.suspense_list"),ad=Symbol.for("react.memo"),bs=Symbol.for("react.lazy"),wp=Symbol.for("react.offscreen"),Nh=Symbol.iterator;function Jn(t){return t===null||typeof t!="object"?null:(t=Nh&&t[Nh]||t["@@iterator"],typeof t=="function"?t:null)}var bt=Object.assign,ro;function cl(t){if(ro===void 0)try{throw Error()}catch(s){var a=s.stack.trim().match(/\n( *(at )?)/);ro=a&&a[1]||""}return`
`+ro+t}var io=!1;function oo(t,a){if(!t||io)return"";io=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(m){var n=m}Reflect.construct(t,[],a)}else{try{a.call()}catch(m){n=m}t.call(a.prototype)}else{try{throw Error()}catch(m){n=m}t()}}catch(m){if(m&&n&&typeof m.stack=="string"){for(var l=m.stack.split(`
`),r=n.stack.split(`
`),i=l.length-1,u=r.length-1;1<=i&&0<=u&&l[i]!==r[u];)u--;for(;1<=i&&0<=u;i--,u--)if(l[i]!==r[u]){if(i!==1||u!==1)do if(i--,u--,0>u||l[i]!==r[u]){var c=`
`+l[i].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=i&&0<=u);break}}}finally{io=!1,Error.prepareStackTrace=s}return(t=t?t.displayName||t.name:"")?cl(t):""}function bb(t){switch(t.tag){case 5:return cl(t.type);case 16:return cl("Lazy");case 13:return cl("Suspense");case 19:return cl("SuspenseList");case 0:case 2:case 15:return t=oo(t.type,!1),t;case 11:return t=oo(t.type.render,!1),t;case 1:return t=oo(t.type,!0),t;default:return""}}function ec(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case jn:return"Fragment";case gn:return"Portal";case Jo:return"Profiler";case ed:return"StrictMode";case Zo:return"Suspense";case Xo:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Sp:return(t.displayName||"Context")+".Consumer";case _p:return(t._context.displayName||"Context")+".Provider";case td:var a=t.render;return t=t.displayName,t||(t=a.displayName||a.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case ad:return a=t.displayName||null,a!==null?a:ec(t.type)||"Memo";case bs:a=t._payload,t=t._init;try{return ec(t(a))}catch{}}return null}function yb(t){var a=t.type;switch(t.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=a.render,t=t.displayName||t.name||"",a.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ec(a);case 8:return a===ed?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function Ms(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Cp(t){var a=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function vb(t){var a=Cp(t)?"checked":"value",s=Object.getOwnPropertyDescriptor(t.constructor.prototype,a),n=""+t[a];if(!t.hasOwnProperty(a)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var l=s.get,r=s.set;return Object.defineProperty(t,a,{configurable:!0,get:function(){return l.call(this)},set:function(i){n=""+i,r.call(this,i)}}),Object.defineProperty(t,a,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[a]}}}}function sr(t){t._valueTracker||(t._valueTracker=vb(t))}function kp(t){if(!t)return!1;var a=t._valueTracker;if(!a)return!0;var s=a.getValue(),n="";return t&&(n=Cp(t)?t.checked?"true":"false":t.value),t=n,t!==s?(a.setValue(t),!0):!1}function Fr(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function tc(t,a){var s=a.checked;return bt({},a,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??t._wrapperState.initialChecked})}function _h(t,a){var s=a.defaultValue==null?"":a.defaultValue,n=a.checked!=null?a.checked:a.defaultChecked;s=Ms(a.value!=null?a.value:s),t._wrapperState={initialChecked:n,initialValue:s,controlled:a.type==="checkbox"||a.type==="radio"?a.checked!=null:a.value!=null}}function Pp(t,a){a=a.checked,a!=null&&Xc(t,"checked",a,!1)}function ac(t,a){Pp(t,a);var s=Ms(a.value),n=a.type;if(s!=null)n==="number"?(s===0&&t.value===""||t.value!=s)&&(t.value=""+s):t.value!==""+s&&(t.value=""+s);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}a.hasOwnProperty("value")?sc(t,a.type,s):a.hasOwnProperty("defaultValue")&&sc(t,a.type,Ms(a.defaultValue)),a.checked==null&&a.defaultChecked!=null&&(t.defaultChecked=!!a.defaultChecked)}function Sh(t,a,s){if(a.hasOwnProperty("value")||a.hasOwnProperty("defaultValue")){var n=a.type;if(!(n!=="submit"&&n!=="reset"||a.value!==void 0&&a.value!==null))return;a=""+t._wrapperState.initialValue,s||a===t.value||(t.value=a),t.defaultValue=a}s=t.name,s!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,s!==""&&(t.name=s)}function sc(t,a,s){(a!=="number"||Fr(t.ownerDocument)!==t)&&(s==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+s&&(t.defaultValue=""+s))}var dl=Array.isArray;function Tn(t,a,s,n){if(t=t.options,a){a={};for(var l=0;l<s.length;l++)a["$"+s[l]]=!0;for(s=0;s<t.length;s++)l=a.hasOwnProperty("$"+t[s].value),t[s].selected!==l&&(t[s].selected=l),l&&n&&(t[s].defaultSelected=!0)}else{for(s=""+Ms(s),a=null,l=0;l<t.length;l++){if(t[l].value===s){t[l].selected=!0,n&&(t[l].defaultSelected=!0);return}a!==null||t[l].disabled||(a=t[l])}a!==null&&(a.selected=!0)}}function nc(t,a){if(a.dangerouslySetInnerHTML!=null)throw Error(ge(91));return bt({},a,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function wh(t,a){var s=a.value;if(s==null){if(s=a.children,a=a.defaultValue,s!=null){if(a!=null)throw Error(ge(92));if(dl(s)){if(1<s.length)throw Error(ge(93));s=s[0]}a=s}a==null&&(a=""),s=a}t._wrapperState={initialValue:Ms(s)}}function Tp(t,a){var s=Ms(a.value),n=Ms(a.defaultValue);s!=null&&(s=""+s,s!==t.value&&(t.value=s),a.defaultValue==null&&t.defaultValue!==s&&(t.defaultValue=s)),n!=null&&(t.defaultValue=""+n)}function Ch(t){var a=t.textContent;a===t._wrapperState.initialValue&&a!==""&&a!==null&&(t.value=a)}function Ep(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lc(t,a){return t==null||t==="http://www.w3.org/1999/xhtml"?Ep(a):t==="http://www.w3.org/2000/svg"&&a==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var nr,Ap=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(a,s,n,l){MSApp.execUnsafeLocalFunction(function(){return t(a,s,n,l)})}:t}(function(t,a){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=a;else{for(nr=nr||document.createElement("div"),nr.innerHTML="<svg>"+a.valueOf().toString()+"</svg>",a=nr.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;a.firstChild;)t.appendChild(a.firstChild)}});function Sl(t,a){if(a){var s=t.firstChild;if(s&&s===t.lastChild&&s.nodeType===3){s.nodeValue=a;return}}t.textContent=a}var fl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nb=["Webkit","ms","Moz","O"];Object.keys(fl).forEach(function(t){Nb.forEach(function(a){a=a+t.charAt(0).toUpperCase()+t.substring(1),fl[a]=fl[t]})});function Dp(t,a,s){return a==null||typeof a=="boolean"||a===""?"":s||typeof a!="number"||a===0||fl.hasOwnProperty(t)&&fl[t]?(""+a).trim():a+"px"}function Lp(t,a){t=t.style;for(var s in a)if(a.hasOwnProperty(s)){var n=s.indexOf("--")===0,l=Dp(s,a[s],n);s==="float"&&(s="cssFloat"),n?t.setProperty(s,l):t[s]=l}}var _b=bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function rc(t,a){if(a){if(_b[t]&&(a.children!=null||a.dangerouslySetInnerHTML!=null))throw Error(ge(137,t));if(a.dangerouslySetInnerHTML!=null){if(a.children!=null)throw Error(ge(60));if(typeof a.dangerouslySetInnerHTML!="object"||!("__html"in a.dangerouslySetInnerHTML))throw Error(ge(61))}if(a.style!=null&&typeof a.style!="object")throw Error(ge(62))}}function ic(t,a){if(t.indexOf("-")===-1)return typeof a.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var oc=null;function sd(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var cc=null,En=null,An=null;function kh(t){if(t=Gl(t)){if(typeof cc!="function")throw Error(ge(280));var a=t.stateNode;a&&(a=gi(a),cc(t.stateNode,t.type,a))}}function Rp(t){En?An?An.push(t):An=[t]:En=t}function Mp(){if(En){var t=En,a=An;if(An=En=null,kh(t),a)for(t=0;t<a.length;t++)kh(a[t])}}function $p(t,a){return t(a)}function Up(){}var co=!1;function Op(t,a,s){if(co)return t(a,s);co=!0;try{return $p(t,a,s)}finally{co=!1,(En!==null||An!==null)&&(Up(),Mp())}}function wl(t,a){var s=t.stateNode;if(s===null)return null;var n=gi(s);if(n===null)return null;s=n[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(s&&typeof s!="function")throw Error(ge(231,a,typeof s));return s}var dc=!1;if(is)try{var Zn={};Object.defineProperty(Zn,"passive",{get:function(){dc=!0}}),window.addEventListener("test",Zn,Zn),window.removeEventListener("test",Zn,Zn)}catch{dc=!1}function Sb(t,a,s,n,l,r,i,u,c){var m=Array.prototype.slice.call(arguments,3);try{a.apply(s,m)}catch(x){this.onError(x)}}var pl=!1,zr=null,Br=!1,uc=null,wb={onError:function(t){pl=!0,zr=t}};function Cb(t,a,s,n,l,r,i,u,c){pl=!1,zr=null,Sb.apply(wb,arguments)}function kb(t,a,s,n,l,r,i,u,c){if(Cb.apply(this,arguments),pl){if(pl){var m=zr;pl=!1,zr=null}else throw Error(ge(198));Br||(Br=!0,uc=m)}}function sn(t){var a=t,s=t;if(t.alternate)for(;a.return;)a=a.return;else{t=a;do a=t,a.flags&4098&&(s=a.return),t=a.return;while(t)}return a.tag===3?s:null}function Ip(t){if(t.tag===13){var a=t.memoizedState;if(a===null&&(t=t.alternate,t!==null&&(a=t.memoizedState)),a!==null)return a.dehydrated}return null}function Ph(t){if(sn(t)!==t)throw Error(ge(188))}function Pb(t){var a=t.alternate;if(!a){if(a=sn(t),a===null)throw Error(ge(188));return a!==t?null:t}for(var s=t,n=a;;){var l=s.return;if(l===null)break;var r=l.alternate;if(r===null){if(n=l.return,n!==null){s=n;continue}break}if(l.child===r.child){for(r=l.child;r;){if(r===s)return Ph(l),t;if(r===n)return Ph(l),a;r=r.sibling}throw Error(ge(188))}if(s.return!==n.return)s=l,n=r;else{for(var i=!1,u=l.child;u;){if(u===s){i=!0,s=l,n=r;break}if(u===n){i=!0,n=l,s=r;break}u=u.sibling}if(!i){for(u=r.child;u;){if(u===s){i=!0,s=r,n=l;break}if(u===n){i=!0,n=r,s=l;break}u=u.sibling}if(!i)throw Error(ge(189))}}if(s.alternate!==n)throw Error(ge(190))}if(s.tag!==3)throw Error(ge(188));return s.stateNode.current===s?t:a}function Fp(t){return t=Pb(t),t!==null?zp(t):null}function zp(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var a=zp(t);if(a!==null)return a;t=t.sibling}return null}var Bp=xa.unstable_scheduleCallback,Th=xa.unstable_cancelCallback,Tb=xa.unstable_shouldYield,Eb=xa.unstable_requestPaint,St=xa.unstable_now,Ab=xa.unstable_getCurrentPriorityLevel,nd=xa.unstable_ImmediatePriority,Wp=xa.unstable_UserBlockingPriority,Wr=xa.unstable_NormalPriority,Db=xa.unstable_LowPriority,Vp=xa.unstable_IdlePriority,hi=null,Za=null;function Lb(t){if(Za&&typeof Za.onCommitFiberRoot=="function")try{Za.onCommitFiberRoot(hi,t,void 0,(t.current.flags&128)===128)}catch{}}var Ia=Math.clz32?Math.clz32:$b,Rb=Math.log,Mb=Math.LN2;function $b(t){return t>>>=0,t===0?32:31-(Rb(t)/Mb|0)|0}var lr=64,rr=4194304;function ul(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vr(t,a){var s=t.pendingLanes;if(s===0)return 0;var n=0,l=t.suspendedLanes,r=t.pingedLanes,i=s&268435455;if(i!==0){var u=i&~l;u!==0?n=ul(u):(r&=i,r!==0&&(n=ul(r)))}else i=s&~l,i!==0?n=ul(i):r!==0&&(n=ul(r));if(n===0)return 0;if(a!==0&&a!==n&&!(a&l)&&(l=n&-n,r=a&-a,l>=r||l===16&&(r&4194240)!==0))return a;if(n&4&&(n|=s&16),a=t.entangledLanes,a!==0)for(t=t.entanglements,a&=n;0<a;)s=31-Ia(a),l=1<<s,n|=t[s],a&=~l;return n}function Ub(t,a){switch(t){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ob(t,a){for(var s=t.suspendedLanes,n=t.pingedLanes,l=t.expirationTimes,r=t.pendingLanes;0<r;){var i=31-Ia(r),u=1<<i,c=l[i];c===-1?(!(u&s)||u&n)&&(l[i]=Ub(u,a)):c<=a&&(t.expiredLanes|=u),r&=~u}}function mc(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Gp(){var t=lr;return lr<<=1,!(lr&4194240)&&(lr=64),t}function uo(t){for(var a=[],s=0;31>s;s++)a.push(t);return a}function Wl(t,a,s){t.pendingLanes|=a,a!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,a=31-Ia(a),t[a]=s}function Ib(t,a){var s=t.pendingLanes&~a;t.pendingLanes=a,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=a,t.mutableReadLanes&=a,t.entangledLanes&=a,a=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<s;){var l=31-Ia(s),r=1<<l;a[l]=0,n[l]=-1,t[l]=-1,s&=~r}}function ld(t,a){var s=t.entangledLanes|=a;for(t=t.entanglements;s;){var n=31-Ia(s),l=1<<n;l&a|t[n]&a&&(t[n]|=a),s&=~l}}var ct=0;function Hp(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Qp,rd,qp,Yp,Kp,hc=!1,ir=[],Cs=null,ks=null,Ps=null,Cl=new Map,kl=new Map,vs=[],Fb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Eh(t,a){switch(t){case"focusin":case"focusout":Cs=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":Ps=null;break;case"pointerover":case"pointerout":Cl.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":kl.delete(a.pointerId)}}function Xn(t,a,s,n,l,r){return t===null||t.nativeEvent!==r?(t={blockedOn:a,domEventName:s,eventSystemFlags:n,nativeEvent:r,targetContainers:[l]},a!==null&&(a=Gl(a),a!==null&&rd(a)),t):(t.eventSystemFlags|=n,a=t.targetContainers,l!==null&&a.indexOf(l)===-1&&a.push(l),t)}function zb(t,a,s,n,l){switch(a){case"focusin":return Cs=Xn(Cs,t,a,s,n,l),!0;case"dragenter":return ks=Xn(ks,t,a,s,n,l),!0;case"mouseover":return Ps=Xn(Ps,t,a,s,n,l),!0;case"pointerover":var r=l.pointerId;return Cl.set(r,Xn(Cl.get(r)||null,t,a,s,n,l)),!0;case"gotpointercapture":return r=l.pointerId,kl.set(r,Xn(kl.get(r)||null,t,a,s,n,l)),!0}return!1}function Jp(t){var a=Hs(t.target);if(a!==null){var s=sn(a);if(s!==null){if(a=s.tag,a===13){if(a=Ip(s),a!==null){t.blockedOn=a,Kp(t.priority,function(){qp(s)});return}}else if(a===3&&s.stateNode.current.memoizedState.isDehydrated){t.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Tr(t){if(t.blockedOn!==null)return!1;for(var a=t.targetContainers;0<a.length;){var s=fc(t.domEventName,t.eventSystemFlags,a[0],t.nativeEvent);if(s===null){s=t.nativeEvent;var n=new s.constructor(s.type,s);oc=n,s.target.dispatchEvent(n),oc=null}else return a=Gl(s),a!==null&&rd(a),t.blockedOn=s,!1;a.shift()}return!0}function Ah(t,a,s){Tr(t)&&s.delete(a)}function Bb(){hc=!1,Cs!==null&&Tr(Cs)&&(Cs=null),ks!==null&&Tr(ks)&&(ks=null),Ps!==null&&Tr(Ps)&&(Ps=null),Cl.forEach(Ah),kl.forEach(Ah)}function el(t,a){t.blockedOn===a&&(t.blockedOn=null,hc||(hc=!0,xa.unstable_scheduleCallback(xa.unstable_NormalPriority,Bb)))}function Pl(t){function a(l){return el(l,t)}if(0<ir.length){el(ir[0],t);for(var s=1;s<ir.length;s++){var n=ir[s];n.blockedOn===t&&(n.blockedOn=null)}}for(Cs!==null&&el(Cs,t),ks!==null&&el(ks,t),Ps!==null&&el(Ps,t),Cl.forEach(a),kl.forEach(a),s=0;s<vs.length;s++)n=vs[s],n.blockedOn===t&&(n.blockedOn=null);for(;0<vs.length&&(s=vs[0],s.blockedOn===null);)Jp(s),s.blockedOn===null&&vs.shift()}var Dn=us.ReactCurrentBatchConfig,Gr=!0;function Wb(t,a,s,n){var l=ct,r=Dn.transition;Dn.transition=null;try{ct=1,id(t,a,s,n)}finally{ct=l,Dn.transition=r}}function Vb(t,a,s,n){var l=ct,r=Dn.transition;Dn.transition=null;try{ct=4,id(t,a,s,n)}finally{ct=l,Dn.transition=r}}function id(t,a,s,n){if(Gr){var l=fc(t,a,s,n);if(l===null)vo(t,a,n,Hr,s),Eh(t,n);else if(zb(l,t,a,s,n))n.stopPropagation();else if(Eh(t,n),a&4&&-1<Fb.indexOf(t)){for(;l!==null;){var r=Gl(l);if(r!==null&&Qp(r),r=fc(t,a,s,n),r===null&&vo(t,a,n,Hr,s),r===l)break;l=r}l!==null&&n.stopPropagation()}else vo(t,a,n,null,s)}}var Hr=null;function fc(t,a,s,n){if(Hr=null,t=sd(n),t=Hs(t),t!==null)if(a=sn(t),a===null)t=null;else if(s=a.tag,s===13){if(t=Ip(a),t!==null)return t;t=null}else if(s===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;t=null}else a!==t&&(t=null);return Hr=t,null}function Zp(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ab()){case nd:return 1;case Wp:return 4;case Wr:case Db:return 16;case Vp:return 536870912;default:return 16}default:return 16}}var _s=null,od=null,Er=null;function Xp(){if(Er)return Er;var t,a=od,s=a.length,n,l="value"in _s?_s.value:_s.textContent,r=l.length;for(t=0;t<s&&a[t]===l[t];t++);var i=s-t;for(n=1;n<=i&&a[s-n]===l[r-n];n++);return Er=l.slice(t,1<n?1-n:void 0)}function Ar(t){var a=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&a===13&&(t=13)):t=a,t===10&&(t=13),32<=t||t===13?t:0}function or(){return!0}function Dh(){return!1}function ja(t){function a(s,n,l,r,i){this._reactName=s,this._targetInst=l,this.type=n,this.nativeEvent=r,this.target=i,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(s=t[u],this[u]=s?s(r):r[u]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?or:Dh,this.isPropagationStopped=Dh,this}return bt(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=or)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=or)},persist:function(){},isPersistent:or}),a}var Vn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cd=ja(Vn),Vl=bt({},Vn,{view:0,detail:0}),Gb=ja(Vl),mo,ho,tl,fi=bt({},Vl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dd,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==tl&&(tl&&t.type==="mousemove"?(mo=t.screenX-tl.screenX,ho=t.screenY-tl.screenY):ho=mo=0,tl=t),mo)},movementY:function(t){return"movementY"in t?t.movementY:ho}}),Lh=ja(fi),Hb=bt({},fi,{dataTransfer:0}),Qb=ja(Hb),qb=bt({},Vl,{relatedTarget:0}),fo=ja(qb),Yb=bt({},Vn,{animationName:0,elapsedTime:0,pseudoElement:0}),Kb=ja(Yb),Jb=bt({},Vn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Zb=ja(Jb),Xb=bt({},Vn,{data:0}),Rh=ja(Xb),ey={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ty={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ay={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sy(t){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(t):(t=ay[t])?!!a[t]:!1}function dd(){return sy}var ny=bt({},Vl,{key:function(t){if(t.key){var a=ey[t.key]||t.key;if(a!=="Unidentified")return a}return t.type==="keypress"?(t=Ar(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ty[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dd,charCode:function(t){return t.type==="keypress"?Ar(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ar(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ly=ja(ny),ry=bt({},fi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mh=ja(ry),iy=bt({},Vl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dd}),oy=ja(iy),cy=bt({},Vn,{propertyName:0,elapsedTime:0,pseudoElement:0}),dy=ja(cy),uy=bt({},fi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),my=ja(uy),hy=[9,13,27,32],ud=is&&"CompositionEvent"in window,xl=null;is&&"documentMode"in document&&(xl=document.documentMode);var fy=is&&"TextEvent"in window&&!xl,ex=is&&(!ud||xl&&8<xl&&11>=xl),$h=" ",Uh=!1;function tx(t,a){switch(t){case"keyup":return hy.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ax(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var bn=!1;function py(t,a){switch(t){case"compositionend":return ax(a);case"keypress":return a.which!==32?null:(Uh=!0,$h);case"textInput":return t=a.data,t===$h&&Uh?null:t;default:return null}}function xy(t,a){if(bn)return t==="compositionend"||!ud&&tx(t,a)?(t=Xp(),Er=od=_s=null,bn=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return ex&&a.locale!=="ko"?null:a.data;default:return null}}var gy={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Oh(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a==="input"?!!gy[t.type]:a==="textarea"}function sx(t,a,s,n){Rp(n),a=Qr(a,"onChange"),0<a.length&&(s=new cd("onChange","change",null,s,n),t.push({event:s,listeners:a}))}var gl=null,Tl=null;function jy(t){fx(t,0)}function pi(t){var a=Nn(t);if(kp(a))return t}function by(t,a){if(t==="change")return a}var nx=!1;if(is){var po;if(is){var xo="oninput"in document;if(!xo){var Ih=document.createElement("div");Ih.setAttribute("oninput","return;"),xo=typeof Ih.oninput=="function"}po=xo}else po=!1;nx=po&&(!document.documentMode||9<document.documentMode)}function Fh(){gl&&(gl.detachEvent("onpropertychange",lx),Tl=gl=null)}function lx(t){if(t.propertyName==="value"&&pi(Tl)){var a=[];sx(a,Tl,t,sd(t)),Op(jy,a)}}function yy(t,a,s){t==="focusin"?(Fh(),gl=a,Tl=s,gl.attachEvent("onpropertychange",lx)):t==="focusout"&&Fh()}function vy(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return pi(Tl)}function Ny(t,a){if(t==="click")return pi(a)}function _y(t,a){if(t==="input"||t==="change")return pi(a)}function Sy(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var za=typeof Object.is=="function"?Object.is:Sy;function El(t,a){if(za(t,a))return!0;if(typeof t!="object"||t===null||typeof a!="object"||a===null)return!1;var s=Object.keys(t),n=Object.keys(a);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var l=s[n];if(!Ko.call(a,l)||!za(t[l],a[l]))return!1}return!0}function zh(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Bh(t,a){var s=zh(t);t=0;for(var n;s;){if(s.nodeType===3){if(n=t+s.textContent.length,t<=a&&n>=a)return{node:s,offset:a-t};t=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=zh(s)}}function rx(t,a){return t&&a?t===a?!0:t&&t.nodeType===3?!1:a&&a.nodeType===3?rx(t,a.parentNode):"contains"in t?t.contains(a):t.compareDocumentPosition?!!(t.compareDocumentPosition(a)&16):!1:!1}function ix(){for(var t=window,a=Fr();a instanceof t.HTMLIFrameElement;){try{var s=typeof a.contentWindow.location.href=="string"}catch{s=!1}if(s)t=a.contentWindow;else break;a=Fr(t.document)}return a}function md(t){var a=t&&t.nodeName&&t.nodeName.toLowerCase();return a&&(a==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||a==="textarea"||t.contentEditable==="true")}function wy(t){var a=ix(),s=t.focusedElem,n=t.selectionRange;if(a!==s&&s&&s.ownerDocument&&rx(s.ownerDocument.documentElement,s)){if(n!==null&&md(s)){if(a=n.start,t=n.end,t===void 0&&(t=a),"selectionStart"in s)s.selectionStart=a,s.selectionEnd=Math.min(t,s.value.length);else if(t=(a=s.ownerDocument||document)&&a.defaultView||window,t.getSelection){t=t.getSelection();var l=s.textContent.length,r=Math.min(n.start,l);n=n.end===void 0?r:Math.min(n.end,l),!t.extend&&r>n&&(l=n,n=r,r=l),l=Bh(s,r);var i=Bh(s,n);l&&i&&(t.rangeCount!==1||t.anchorNode!==l.node||t.anchorOffset!==l.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(a=a.createRange(),a.setStart(l.node,l.offset),t.removeAllRanges(),r>n?(t.addRange(a),t.extend(i.node,i.offset)):(a.setEnd(i.node,i.offset),t.addRange(a)))}}for(a=[],t=s;t=t.parentNode;)t.nodeType===1&&a.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<a.length;s++)t=a[s],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Cy=is&&"documentMode"in document&&11>=document.documentMode,yn=null,pc=null,jl=null,xc=!1;function Wh(t,a,s){var n=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;xc||yn==null||yn!==Fr(n)||(n=yn,"selectionStart"in n&&md(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),jl&&El(jl,n)||(jl=n,n=Qr(pc,"onSelect"),0<n.length&&(a=new cd("onSelect","select",null,a,s),t.push({event:a,listeners:n}),a.target=yn)))}function cr(t,a){var s={};return s[t.toLowerCase()]=a.toLowerCase(),s["Webkit"+t]="webkit"+a,s["Moz"+t]="moz"+a,s}var vn={animationend:cr("Animation","AnimationEnd"),animationiteration:cr("Animation","AnimationIteration"),animationstart:cr("Animation","AnimationStart"),transitionend:cr("Transition","TransitionEnd")},go={},ox={};is&&(ox=document.createElement("div").style,"AnimationEvent"in window||(delete vn.animationend.animation,delete vn.animationiteration.animation,delete vn.animationstart.animation),"TransitionEvent"in window||delete vn.transitionend.transition);function xi(t){if(go[t])return go[t];if(!vn[t])return t;var a=vn[t],s;for(s in a)if(a.hasOwnProperty(s)&&s in ox)return go[t]=a[s];return t}var cx=xi("animationend"),dx=xi("animationiteration"),ux=xi("animationstart"),mx=xi("transitionend"),hx=new Map,Vh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Us(t,a){hx.set(t,a),an(a,[t])}for(var jo=0;jo<Vh.length;jo++){var bo=Vh[jo],ky=bo.toLowerCase(),Py=bo[0].toUpperCase()+bo.slice(1);Us(ky,"on"+Py)}Us(cx,"onAnimationEnd");Us(dx,"onAnimationIteration");Us(ux,"onAnimationStart");Us("dblclick","onDoubleClick");Us("focusin","onFocus");Us("focusout","onBlur");Us(mx,"onTransitionEnd");Mn("onMouseEnter",["mouseout","mouseover"]);Mn("onMouseLeave",["mouseout","mouseover"]);Mn("onPointerEnter",["pointerout","pointerover"]);Mn("onPointerLeave",["pointerout","pointerover"]);an("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));an("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));an("onBeforeInput",["compositionend","keypress","textInput","paste"]);an("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));an("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));an("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ml="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ty=new Set("cancel close invalid load scroll toggle".split(" ").concat(ml));function Gh(t,a,s){var n=t.type||"unknown-event";t.currentTarget=s,kb(n,a,void 0,t),t.currentTarget=null}function fx(t,a){a=(a&4)!==0;for(var s=0;s<t.length;s++){var n=t[s],l=n.event;n=n.listeners;e:{var r=void 0;if(a)for(var i=n.length-1;0<=i;i--){var u=n[i],c=u.instance,m=u.currentTarget;if(u=u.listener,c!==r&&l.isPropagationStopped())break e;Gh(l,u,m),r=c}else for(i=0;i<n.length;i++){if(u=n[i],c=u.instance,m=u.currentTarget,u=u.listener,c!==r&&l.isPropagationStopped())break e;Gh(l,u,m),r=c}}}if(Br)throw t=uc,Br=!1,uc=null,t}function ut(t,a){var s=a[vc];s===void 0&&(s=a[vc]=new Set);var n=t+"__bubble";s.has(n)||(px(a,t,2,!1),s.add(n))}function yo(t,a,s){var n=0;a&&(n|=4),px(s,t,n,a)}var dr="_reactListening"+Math.random().toString(36).slice(2);function Al(t){if(!t[dr]){t[dr]=!0,Np.forEach(function(s){s!=="selectionchange"&&(Ty.has(s)||yo(s,!1,t),yo(s,!0,t))});var a=t.nodeType===9?t:t.ownerDocument;a===null||a[dr]||(a[dr]=!0,yo("selectionchange",!1,a))}}function px(t,a,s,n){switch(Zp(a)){case 1:var l=Wb;break;case 4:l=Vb;break;default:l=id}s=l.bind(null,a,s,t),l=void 0,!dc||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(l=!0),n?l!==void 0?t.addEventListener(a,s,{capture:!0,passive:l}):t.addEventListener(a,s,!0):l!==void 0?t.addEventListener(a,s,{passive:l}):t.addEventListener(a,s,!1)}function vo(t,a,s,n,l){var r=n;if(!(a&1)&&!(a&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var u=n.stateNode.containerInfo;if(u===l||u.nodeType===8&&u.parentNode===l)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===l||c.nodeType===8&&c.parentNode===l))return;i=i.return}for(;u!==null;){if(i=Hs(u),i===null)return;if(c=i.tag,c===5||c===6){n=r=i;continue e}u=u.parentNode}}n=n.return}Op(function(){var m=r,x=sd(s),f=[];e:{var j=hx.get(t);if(j!==void 0){var N=cd,v=t;switch(t){case"keypress":if(Ar(s)===0)break e;case"keydown":case"keyup":N=ly;break;case"focusin":v="focus",N=fo;break;case"focusout":v="blur",N=fo;break;case"beforeblur":case"afterblur":N=fo;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=Lh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=Qb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=oy;break;case cx:case dx:case ux:N=Kb;break;case mx:N=dy;break;case"scroll":N=Gb;break;case"wheel":N=my;break;case"copy":case"cut":case"paste":N=Zb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=Mh}var _=(a&4)!==0,C=!_&&t==="scroll",y=_?j!==null?j+"Capture":null:j;_=[];for(var h=m,p;h!==null;){p=h;var b=p.stateNode;if(p.tag===5&&b!==null&&(p=b,y!==null&&(b=wl(h,y),b!=null&&_.push(Dl(h,b,p)))),C)break;h=h.return}0<_.length&&(j=new N(j,v,null,s,x),f.push({event:j,listeners:_}))}}if(!(a&7)){e:{if(j=t==="mouseover"||t==="pointerover",N=t==="mouseout"||t==="pointerout",j&&s!==oc&&(v=s.relatedTarget||s.fromElement)&&(Hs(v)||v[os]))break e;if((N||j)&&(j=x.window===x?x:(j=x.ownerDocument)?j.defaultView||j.parentWindow:window,N?(v=s.relatedTarget||s.toElement,N=m,v=v?Hs(v):null,v!==null&&(C=sn(v),v!==C||v.tag!==5&&v.tag!==6)&&(v=null)):(N=null,v=m),N!==v)){if(_=Lh,b="onMouseLeave",y="onMouseEnter",h="mouse",(t==="pointerout"||t==="pointerover")&&(_=Mh,b="onPointerLeave",y="onPointerEnter",h="pointer"),C=N==null?j:Nn(N),p=v==null?j:Nn(v),j=new _(b,h+"leave",N,s,x),j.target=C,j.relatedTarget=p,b=null,Hs(x)===m&&(_=new _(y,h+"enter",v,s,x),_.target=p,_.relatedTarget=C,b=_),C=b,N&&v)t:{for(_=N,y=v,h=0,p=_;p;p=fn(p))h++;for(p=0,b=y;b;b=fn(b))p++;for(;0<h-p;)_=fn(_),h--;for(;0<p-h;)y=fn(y),p--;for(;h--;){if(_===y||y!==null&&_===y.alternate)break t;_=fn(_),y=fn(y)}_=null}else _=null;N!==null&&Hh(f,j,N,_,!1),v!==null&&C!==null&&Hh(f,C,v,_,!0)}}e:{if(j=m?Nn(m):window,N=j.nodeName&&j.nodeName.toLowerCase(),N==="select"||N==="input"&&j.type==="file")var P=by;else if(Oh(j))if(nx)P=_y;else{P=vy;var $=yy}else(N=j.nodeName)&&N.toLowerCase()==="input"&&(j.type==="checkbox"||j.type==="radio")&&(P=Ny);if(P&&(P=P(t,m))){sx(f,P,s,x);break e}$&&$(t,j,m),t==="focusout"&&($=j._wrapperState)&&$.controlled&&j.type==="number"&&sc(j,"number",j.value)}switch($=m?Nn(m):window,t){case"focusin":(Oh($)||$.contentEditable==="true")&&(yn=$,pc=m,jl=null);break;case"focusout":jl=pc=yn=null;break;case"mousedown":xc=!0;break;case"contextmenu":case"mouseup":case"dragend":xc=!1,Wh(f,s,x);break;case"selectionchange":if(Cy)break;case"keydown":case"keyup":Wh(f,s,x)}var E;if(ud)e:{switch(t){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else bn?tx(t,s)&&(L="onCompositionEnd"):t==="keydown"&&s.keyCode===229&&(L="onCompositionStart");L&&(ex&&s.locale!=="ko"&&(bn||L!=="onCompositionStart"?L==="onCompositionEnd"&&bn&&(E=Xp()):(_s=x,od="value"in _s?_s.value:_s.textContent,bn=!0)),$=Qr(m,L),0<$.length&&(L=new Rh(L,t,null,s,x),f.push({event:L,listeners:$}),E?L.data=E:(E=ax(s),E!==null&&(L.data=E)))),(E=fy?py(t,s):xy(t,s))&&(m=Qr(m,"onBeforeInput"),0<m.length&&(x=new Rh("onBeforeInput","beforeinput",null,s,x),f.push({event:x,listeners:m}),x.data=E))}fx(f,a)})}function Dl(t,a,s){return{instance:t,listener:a,currentTarget:s}}function Qr(t,a){for(var s=a+"Capture",n=[];t!==null;){var l=t,r=l.stateNode;l.tag===5&&r!==null&&(l=r,r=wl(t,s),r!=null&&n.unshift(Dl(t,r,l)),r=wl(t,a),r!=null&&n.push(Dl(t,r,l))),t=t.return}return n}function fn(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Hh(t,a,s,n,l){for(var r=a._reactName,i=[];s!==null&&s!==n;){var u=s,c=u.alternate,m=u.stateNode;if(c!==null&&c===n)break;u.tag===5&&m!==null&&(u=m,l?(c=wl(s,r),c!=null&&i.unshift(Dl(s,c,u))):l||(c=wl(s,r),c!=null&&i.push(Dl(s,c,u)))),s=s.return}i.length!==0&&t.push({event:a,listeners:i})}var Ey=/\r\n?/g,Ay=/\u0000|\uFFFD/g;function Qh(t){return(typeof t=="string"?t:""+t).replace(Ey,`
`).replace(Ay,"")}function ur(t,a,s){if(a=Qh(a),Qh(t)!==a&&s)throw Error(ge(425))}function qr(){}var gc=null,jc=null;function bc(t,a){return t==="textarea"||t==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var yc=typeof setTimeout=="function"?setTimeout:void 0,Dy=typeof clearTimeout=="function"?clearTimeout:void 0,qh=typeof Promise=="function"?Promise:void 0,Ly=typeof queueMicrotask=="function"?queueMicrotask:typeof qh<"u"?function(t){return qh.resolve(null).then(t).catch(Ry)}:yc;function Ry(t){setTimeout(function(){throw t})}function No(t,a){var s=a,n=0;do{var l=s.nextSibling;if(t.removeChild(s),l&&l.nodeType===8)if(s=l.data,s==="/$"){if(n===0){t.removeChild(l),Pl(a);return}n--}else s!=="$"&&s!=="$?"&&s!=="$!"||n++;s=l}while(s);Pl(a)}function Ts(t){for(;t!=null;t=t.nextSibling){var a=t.nodeType;if(a===1||a===3)break;if(a===8){if(a=t.data,a==="$"||a==="$!"||a==="$?")break;if(a==="/$")return null}}return t}function Yh(t){t=t.previousSibling;for(var a=0;t;){if(t.nodeType===8){var s=t.data;if(s==="$"||s==="$!"||s==="$?"){if(a===0)return t;a--}else s==="/$"&&a++}t=t.previousSibling}return null}var Gn=Math.random().toString(36).slice(2),Ja="__reactFiber$"+Gn,Ll="__reactProps$"+Gn,os="__reactContainer$"+Gn,vc="__reactEvents$"+Gn,My="__reactListeners$"+Gn,$y="__reactHandles$"+Gn;function Hs(t){var a=t[Ja];if(a)return a;for(var s=t.parentNode;s;){if(a=s[os]||s[Ja]){if(s=a.alternate,a.child!==null||s!==null&&s.child!==null)for(t=Yh(t);t!==null;){if(s=t[Ja])return s;t=Yh(t)}return a}t=s,s=t.parentNode}return null}function Gl(t){return t=t[Ja]||t[os],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Nn(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ge(33))}function gi(t){return t[Ll]||null}var Nc=[],_n=-1;function Os(t){return{current:t}}function mt(t){0>_n||(t.current=Nc[_n],Nc[_n]=null,_n--)}function dt(t,a){_n++,Nc[_n]=t.current,t.current=a}var $s={},Qt=Os($s),ra=Os(!1),Js=$s;function $n(t,a){var s=t.type.contextTypes;if(!s)return $s;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===a)return n.__reactInternalMemoizedMaskedChildContext;var l={},r;for(r in s)l[r]=a[r];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=l),l}function ia(t){return t=t.childContextTypes,t!=null}function Yr(){mt(ra),mt(Qt)}function Kh(t,a,s){if(Qt.current!==$s)throw Error(ge(168));dt(Qt,a),dt(ra,s)}function xx(t,a,s){var n=t.stateNode;if(a=a.childContextTypes,typeof n.getChildContext!="function")return s;n=n.getChildContext();for(var l in n)if(!(l in a))throw Error(ge(108,yb(t)||"Unknown",l));return bt({},s,n)}function Kr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||$s,Js=Qt.current,dt(Qt,t),dt(ra,ra.current),!0}function Jh(t,a,s){var n=t.stateNode;if(!n)throw Error(ge(169));s?(t=xx(t,a,Js),n.__reactInternalMemoizedMergedChildContext=t,mt(ra),mt(Qt),dt(Qt,t)):mt(ra),dt(ra,s)}var ss=null,ji=!1,_o=!1;function gx(t){ss===null?ss=[t]:ss.push(t)}function Uy(t){ji=!0,gx(t)}function Is(){if(!_o&&ss!==null){_o=!0;var t=0,a=ct;try{var s=ss;for(ct=1;t<s.length;t++){var n=s[t];do n=n(!0);while(n!==null)}ss=null,ji=!1}catch(l){throw ss!==null&&(ss=ss.slice(t+1)),Bp(nd,Is),l}finally{ct=a,_o=!1}}return null}var Sn=[],wn=0,Jr=null,Zr=0,wa=[],Ca=0,Zs=null,ns=1,ls="";function Vs(t,a){Sn[wn++]=Zr,Sn[wn++]=Jr,Jr=t,Zr=a}function jx(t,a,s){wa[Ca++]=ns,wa[Ca++]=ls,wa[Ca++]=Zs,Zs=t;var n=ns;t=ls;var l=32-Ia(n)-1;n&=~(1<<l),s+=1;var r=32-Ia(a)+l;if(30<r){var i=l-l%5;r=(n&(1<<i)-1).toString(32),n>>=i,l-=i,ns=1<<32-Ia(a)+l|s<<l|n,ls=r+t}else ns=1<<r|s<<l|n,ls=t}function hd(t){t.return!==null&&(Vs(t,1),jx(t,1,0))}function fd(t){for(;t===Jr;)Jr=Sn[--wn],Sn[wn]=null,Zr=Sn[--wn],Sn[wn]=null;for(;t===Zs;)Zs=wa[--Ca],wa[Ca]=null,ls=wa[--Ca],wa[Ca]=null,ns=wa[--Ca],wa[Ca]=null}var pa=null,fa=null,ft=!1,Oa=null;function bx(t,a){var s=ka(5,null,null,0);s.elementType="DELETED",s.stateNode=a,s.return=t,a=t.deletions,a===null?(t.deletions=[s],t.flags|=16):a.push(s)}function Zh(t,a){switch(t.tag){case 5:var s=t.type;return a=a.nodeType!==1||s.toLowerCase()!==a.nodeName.toLowerCase()?null:a,a!==null?(t.stateNode=a,pa=t,fa=Ts(a.firstChild),!0):!1;case 6:return a=t.pendingProps===""||a.nodeType!==3?null:a,a!==null?(t.stateNode=a,pa=t,fa=null,!0):!1;case 13:return a=a.nodeType!==8?null:a,a!==null?(s=Zs!==null?{id:ns,overflow:ls}:null,t.memoizedState={dehydrated:a,treeContext:s,retryLane:1073741824},s=ka(18,null,null,0),s.stateNode=a,s.return=t,t.child=s,pa=t,fa=null,!0):!1;default:return!1}}function _c(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Sc(t){if(ft){var a=fa;if(a){var s=a;if(!Zh(t,a)){if(_c(t))throw Error(ge(418));a=Ts(s.nextSibling);var n=pa;a&&Zh(t,a)?bx(n,s):(t.flags=t.flags&-4097|2,ft=!1,pa=t)}}else{if(_c(t))throw Error(ge(418));t.flags=t.flags&-4097|2,ft=!1,pa=t}}}function Xh(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;pa=t}function mr(t){if(t!==pa)return!1;if(!ft)return Xh(t),ft=!0,!1;var a;if((a=t.tag!==3)&&!(a=t.tag!==5)&&(a=t.type,a=a!=="head"&&a!=="body"&&!bc(t.type,t.memoizedProps)),a&&(a=fa)){if(_c(t))throw yx(),Error(ge(418));for(;a;)bx(t,a),a=Ts(a.nextSibling)}if(Xh(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ge(317));e:{for(t=t.nextSibling,a=0;t;){if(t.nodeType===8){var s=t.data;if(s==="/$"){if(a===0){fa=Ts(t.nextSibling);break e}a--}else s!=="$"&&s!=="$!"&&s!=="$?"||a++}t=t.nextSibling}fa=null}}else fa=pa?Ts(t.stateNode.nextSibling):null;return!0}function yx(){for(var t=fa;t;)t=Ts(t.nextSibling)}function Un(){fa=pa=null,ft=!1}function pd(t){Oa===null?Oa=[t]:Oa.push(t)}var Oy=us.ReactCurrentBatchConfig;function al(t,a,s){if(t=s.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(ge(309));var n=s.stateNode}if(!n)throw Error(ge(147,t));var l=n,r=""+t;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===r?a.ref:(a=function(i){var u=l.refs;i===null?delete u[r]:u[r]=i},a._stringRef=r,a)}if(typeof t!="string")throw Error(ge(284));if(!s._owner)throw Error(ge(290,t))}return t}function hr(t,a){throw t=Object.prototype.toString.call(a),Error(ge(31,t==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":t))}function ef(t){var a=t._init;return a(t._payload)}function vx(t){function a(y,h){if(t){var p=y.deletions;p===null?(y.deletions=[h],y.flags|=16):p.push(h)}}function s(y,h){if(!t)return null;for(;h!==null;)a(y,h),h=h.sibling;return null}function n(y,h){for(y=new Map;h!==null;)h.key!==null?y.set(h.key,h):y.set(h.index,h),h=h.sibling;return y}function l(y,h){return y=Ls(y,h),y.index=0,y.sibling=null,y}function r(y,h,p){return y.index=p,t?(p=y.alternate,p!==null?(p=p.index,p<h?(y.flags|=2,h):p):(y.flags|=2,h)):(y.flags|=1048576,h)}function i(y){return t&&y.alternate===null&&(y.flags|=2),y}function u(y,h,p,b){return h===null||h.tag!==6?(h=Eo(p,y.mode,b),h.return=y,h):(h=l(h,p),h.return=y,h)}function c(y,h,p,b){var P=p.type;return P===jn?x(y,h,p.props.children,b,p.key):h!==null&&(h.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===bs&&ef(P)===h.type)?(b=l(h,p.props),b.ref=al(y,h,p),b.return=y,b):(b=Or(p.type,p.key,p.props,null,y.mode,b),b.ref=al(y,h,p),b.return=y,b)}function m(y,h,p,b){return h===null||h.tag!==4||h.stateNode.containerInfo!==p.containerInfo||h.stateNode.implementation!==p.implementation?(h=Ao(p,y.mode,b),h.return=y,h):(h=l(h,p.children||[]),h.return=y,h)}function x(y,h,p,b,P){return h===null||h.tag!==7?(h=Ks(p,y.mode,b,P),h.return=y,h):(h=l(h,p),h.return=y,h)}function f(y,h,p){if(typeof h=="string"&&h!==""||typeof h=="number")return h=Eo(""+h,y.mode,p),h.return=y,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case ar:return p=Or(h.type,h.key,h.props,null,y.mode,p),p.ref=al(y,null,h),p.return=y,p;case gn:return h=Ao(h,y.mode,p),h.return=y,h;case bs:var b=h._init;return f(y,b(h._payload),p)}if(dl(h)||Jn(h))return h=Ks(h,y.mode,p,null),h.return=y,h;hr(y,h)}return null}function j(y,h,p,b){var P=h!==null?h.key:null;if(typeof p=="string"&&p!==""||typeof p=="number")return P!==null?null:u(y,h,""+p,b);if(typeof p=="object"&&p!==null){switch(p.$$typeof){case ar:return p.key===P?c(y,h,p,b):null;case gn:return p.key===P?m(y,h,p,b):null;case bs:return P=p._init,j(y,h,P(p._payload),b)}if(dl(p)||Jn(p))return P!==null?null:x(y,h,p,b,null);hr(y,p)}return null}function N(y,h,p,b,P){if(typeof b=="string"&&b!==""||typeof b=="number")return y=y.get(p)||null,u(h,y,""+b,P);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ar:return y=y.get(b.key===null?p:b.key)||null,c(h,y,b,P);case gn:return y=y.get(b.key===null?p:b.key)||null,m(h,y,b,P);case bs:var $=b._init;return N(y,h,p,$(b._payload),P)}if(dl(b)||Jn(b))return y=y.get(p)||null,x(h,y,b,P,null);hr(h,b)}return null}function v(y,h,p,b){for(var P=null,$=null,E=h,L=h=0,V=null;E!==null&&L<p.length;L++){E.index>L?(V=E,E=null):V=E.sibling;var U=j(y,E,p[L],b);if(U===null){E===null&&(E=V);break}t&&E&&U.alternate===null&&a(y,E),h=r(U,h,L),$===null?P=U:$.sibling=U,$=U,E=V}if(L===p.length)return s(y,E),ft&&Vs(y,L),P;if(E===null){for(;L<p.length;L++)E=f(y,p[L],b),E!==null&&(h=r(E,h,L),$===null?P=E:$.sibling=E,$=E);return ft&&Vs(y,L),P}for(E=n(y,E);L<p.length;L++)V=N(E,y,L,p[L],b),V!==null&&(t&&V.alternate!==null&&E.delete(V.key===null?L:V.key),h=r(V,h,L),$===null?P=V:$.sibling=V,$=V);return t&&E.forEach(function(w){return a(y,w)}),ft&&Vs(y,L),P}function _(y,h,p,b){var P=Jn(p);if(typeof P!="function")throw Error(ge(150));if(p=P.call(p),p==null)throw Error(ge(151));for(var $=P=null,E=h,L=h=0,V=null,U=p.next();E!==null&&!U.done;L++,U=p.next()){E.index>L?(V=E,E=null):V=E.sibling;var w=j(y,E,U.value,b);if(w===null){E===null&&(E=V);break}t&&E&&w.alternate===null&&a(y,E),h=r(w,h,L),$===null?P=w:$.sibling=w,$=w,E=V}if(U.done)return s(y,E),ft&&Vs(y,L),P;if(E===null){for(;!U.done;L++,U=p.next())U=f(y,U.value,b),U!==null&&(h=r(U,h,L),$===null?P=U:$.sibling=U,$=U);return ft&&Vs(y,L),P}for(E=n(y,E);!U.done;L++,U=p.next())U=N(E,y,L,U.value,b),U!==null&&(t&&U.alternate!==null&&E.delete(U.key===null?L:U.key),h=r(U,h,L),$===null?P=U:$.sibling=U,$=U);return t&&E.forEach(function(Q){return a(y,Q)}),ft&&Vs(y,L),P}function C(y,h,p,b){if(typeof p=="object"&&p!==null&&p.type===jn&&p.key===null&&(p=p.props.children),typeof p=="object"&&p!==null){switch(p.$$typeof){case ar:e:{for(var P=p.key,$=h;$!==null;){if($.key===P){if(P=p.type,P===jn){if($.tag===7){s(y,$.sibling),h=l($,p.props.children),h.return=y,y=h;break e}}else if($.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===bs&&ef(P)===$.type){s(y,$.sibling),h=l($,p.props),h.ref=al(y,$,p),h.return=y,y=h;break e}s(y,$);break}else a(y,$);$=$.sibling}p.type===jn?(h=Ks(p.props.children,y.mode,b,p.key),h.return=y,y=h):(b=Or(p.type,p.key,p.props,null,y.mode,b),b.ref=al(y,h,p),b.return=y,y=b)}return i(y);case gn:e:{for($=p.key;h!==null;){if(h.key===$)if(h.tag===4&&h.stateNode.containerInfo===p.containerInfo&&h.stateNode.implementation===p.implementation){s(y,h.sibling),h=l(h,p.children||[]),h.return=y,y=h;break e}else{s(y,h);break}else a(y,h);h=h.sibling}h=Ao(p,y.mode,b),h.return=y,y=h}return i(y);case bs:return $=p._init,C(y,h,$(p._payload),b)}if(dl(p))return v(y,h,p,b);if(Jn(p))return _(y,h,p,b);hr(y,p)}return typeof p=="string"&&p!==""||typeof p=="number"?(p=""+p,h!==null&&h.tag===6?(s(y,h.sibling),h=l(h,p),h.return=y,y=h):(s(y,h),h=Eo(p,y.mode,b),h.return=y,y=h),i(y)):s(y,h)}return C}var On=vx(!0),Nx=vx(!1),Xr=Os(null),ei=null,Cn=null,xd=null;function gd(){xd=Cn=ei=null}function jd(t){var a=Xr.current;mt(Xr),t._currentValue=a}function wc(t,a,s){for(;t!==null;){var n=t.alternate;if((t.childLanes&a)!==a?(t.childLanes|=a,n!==null&&(n.childLanes|=a)):n!==null&&(n.childLanes&a)!==a&&(n.childLanes|=a),t===s)break;t=t.return}}function Ln(t,a){ei=t,xd=Cn=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&a&&(la=!0),t.firstContext=null)}function Ta(t){var a=t._currentValue;if(xd!==t)if(t={context:t,memoizedValue:a,next:null},Cn===null){if(ei===null)throw Error(ge(308));Cn=t,ei.dependencies={lanes:0,firstContext:t}}else Cn=Cn.next=t;return a}var Qs=null;function bd(t){Qs===null?Qs=[t]:Qs.push(t)}function _x(t,a,s,n){var l=a.interleaved;return l===null?(s.next=s,bd(a)):(s.next=l.next,l.next=s),a.interleaved=s,cs(t,n)}function cs(t,a){t.lanes|=a;var s=t.alternate;for(s!==null&&(s.lanes|=a),s=t,t=t.return;t!==null;)t.childLanes|=a,s=t.alternate,s!==null&&(s.childLanes|=a),s=t,t=t.return;return s.tag===3?s.stateNode:null}var ys=!1;function yd(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Sx(t,a){t=t.updateQueue,a.updateQueue===t&&(a.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function rs(t,a){return{eventTime:t,lane:a,tag:0,payload:null,callback:null,next:null}}function Es(t,a,s){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,nt&2){var l=n.pending;return l===null?a.next=a:(a.next=l.next,l.next=a),n.pending=a,cs(t,s)}return l=n.interleaved,l===null?(a.next=a,bd(n)):(a.next=l.next,l.next=a),n.interleaved=a,cs(t,s)}function Dr(t,a,s){if(a=a.updateQueue,a!==null&&(a=a.shared,(s&4194240)!==0)){var n=a.lanes;n&=t.pendingLanes,s|=n,a.lanes=s,ld(t,s)}}function tf(t,a){var s=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,s===n)){var l=null,r=null;if(s=s.firstBaseUpdate,s!==null){do{var i={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};r===null?l=r=i:r=r.next=i,s=s.next}while(s!==null);r===null?l=r=a:r=r.next=a}else l=r=a;s={baseState:n.baseState,firstBaseUpdate:l,lastBaseUpdate:r,shared:n.shared,effects:n.effects},t.updateQueue=s;return}t=s.lastBaseUpdate,t===null?s.firstBaseUpdate=a:t.next=a,s.lastBaseUpdate=a}function ti(t,a,s,n){var l=t.updateQueue;ys=!1;var r=l.firstBaseUpdate,i=l.lastBaseUpdate,u=l.shared.pending;if(u!==null){l.shared.pending=null;var c=u,m=c.next;c.next=null,i===null?r=m:i.next=m,i=c;var x=t.alternate;x!==null&&(x=x.updateQueue,u=x.lastBaseUpdate,u!==i&&(u===null?x.firstBaseUpdate=m:u.next=m,x.lastBaseUpdate=c))}if(r!==null){var f=l.baseState;i=0,x=m=c=null,u=r;do{var j=u.lane,N=u.eventTime;if((n&j)===j){x!==null&&(x=x.next={eventTime:N,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var v=t,_=u;switch(j=a,N=s,_.tag){case 1:if(v=_.payload,typeof v=="function"){f=v.call(N,f,j);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=_.payload,j=typeof v=="function"?v.call(N,f,j):v,j==null)break e;f=bt({},f,j);break e;case 2:ys=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,j=l.effects,j===null?l.effects=[u]:j.push(u))}else N={eventTime:N,lane:j,tag:u.tag,payload:u.payload,callback:u.callback,next:null},x===null?(m=x=N,c=f):x=x.next=N,i|=j;if(u=u.next,u===null){if(u=l.shared.pending,u===null)break;j=u,u=j.next,j.next=null,l.lastBaseUpdate=j,l.shared.pending=null}}while(!0);if(x===null&&(c=f),l.baseState=c,l.firstBaseUpdate=m,l.lastBaseUpdate=x,a=l.shared.interleaved,a!==null){l=a;do i|=l.lane,l=l.next;while(l!==a)}else r===null&&(l.shared.lanes=0);en|=i,t.lanes=i,t.memoizedState=f}}function af(t,a,s){if(t=a.effects,a.effects=null,t!==null)for(a=0;a<t.length;a++){var n=t[a],l=n.callback;if(l!==null){if(n.callback=null,n=s,typeof l!="function")throw Error(ge(191,l));l.call(n)}}}var Hl={},Xa=Os(Hl),Rl=Os(Hl),Ml=Os(Hl);function qs(t){if(t===Hl)throw Error(ge(174));return t}function vd(t,a){switch(dt(Ml,a),dt(Rl,t),dt(Xa,Hl),t=a.nodeType,t){case 9:case 11:a=(a=a.documentElement)?a.namespaceURI:lc(null,"");break;default:t=t===8?a.parentNode:a,a=t.namespaceURI||null,t=t.tagName,a=lc(a,t)}mt(Xa),dt(Xa,a)}function In(){mt(Xa),mt(Rl),mt(Ml)}function wx(t){qs(Ml.current);var a=qs(Xa.current),s=lc(a,t.type);a!==s&&(dt(Rl,t),dt(Xa,s))}function Nd(t){Rl.current===t&&(mt(Xa),mt(Rl))}var xt=Os(0);function ai(t){for(var a=t;a!==null;){if(a.tag===13){var s=a.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var So=[];function _d(){for(var t=0;t<So.length;t++)So[t]._workInProgressVersionPrimary=null;So.length=0}var Lr=us.ReactCurrentDispatcher,wo=us.ReactCurrentBatchConfig,Xs=0,gt=null,Et=null,Mt=null,si=!1,bl=!1,$l=0,Iy=0;function Vt(){throw Error(ge(321))}function Sd(t,a){if(a===null)return!1;for(var s=0;s<a.length&&s<t.length;s++)if(!za(t[s],a[s]))return!1;return!0}function wd(t,a,s,n,l,r){if(Xs=r,gt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,Lr.current=t===null||t.memoizedState===null?Wy:Vy,t=s(n,l),bl){r=0;do{if(bl=!1,$l=0,25<=r)throw Error(ge(301));r+=1,Mt=Et=null,a.updateQueue=null,Lr.current=Gy,t=s(n,l)}while(bl)}if(Lr.current=ni,a=Et!==null&&Et.next!==null,Xs=0,Mt=Et=gt=null,si=!1,a)throw Error(ge(300));return t}function Cd(){var t=$l!==0;return $l=0,t}function Ka(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mt===null?gt.memoizedState=Mt=t:Mt=Mt.next=t,Mt}function Ea(){if(Et===null){var t=gt.alternate;t=t!==null?t.memoizedState:null}else t=Et.next;var a=Mt===null?gt.memoizedState:Mt.next;if(a!==null)Mt=a,Et=t;else{if(t===null)throw Error(ge(310));Et=t,t={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},Mt===null?gt.memoizedState=Mt=t:Mt=Mt.next=t}return Mt}function Ul(t,a){return typeof a=="function"?a(t):a}function Co(t){var a=Ea(),s=a.queue;if(s===null)throw Error(ge(311));s.lastRenderedReducer=t;var n=Et,l=n.baseQueue,r=s.pending;if(r!==null){if(l!==null){var i=l.next;l.next=r.next,r.next=i}n.baseQueue=l=r,s.pending=null}if(l!==null){r=l.next,n=n.baseState;var u=i=null,c=null,m=r;do{var x=m.lane;if((Xs&x)===x)c!==null&&(c=c.next={lane:0,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null}),n=m.hasEagerState?m.eagerState:t(n,m.action);else{var f={lane:x,action:m.action,hasEagerState:m.hasEagerState,eagerState:m.eagerState,next:null};c===null?(u=c=f,i=n):c=c.next=f,gt.lanes|=x,en|=x}m=m.next}while(m!==null&&m!==r);c===null?i=n:c.next=u,za(n,a.memoizedState)||(la=!0),a.memoizedState=n,a.baseState=i,a.baseQueue=c,s.lastRenderedState=n}if(t=s.interleaved,t!==null){l=t;do r=l.lane,gt.lanes|=r,en|=r,l=l.next;while(l!==t)}else l===null&&(s.lanes=0);return[a.memoizedState,s.dispatch]}function ko(t){var a=Ea(),s=a.queue;if(s===null)throw Error(ge(311));s.lastRenderedReducer=t;var n=s.dispatch,l=s.pending,r=a.memoizedState;if(l!==null){s.pending=null;var i=l=l.next;do r=t(r,i.action),i=i.next;while(i!==l);za(r,a.memoizedState)||(la=!0),a.memoizedState=r,a.baseQueue===null&&(a.baseState=r),s.lastRenderedState=r}return[r,n]}function Cx(){}function kx(t,a){var s=gt,n=Ea(),l=a(),r=!za(n.memoizedState,l);if(r&&(n.memoizedState=l,la=!0),n=n.queue,kd(Ex.bind(null,s,n,t),[t]),n.getSnapshot!==a||r||Mt!==null&&Mt.memoizedState.tag&1){if(s.flags|=2048,Ol(9,Tx.bind(null,s,n,l,a),void 0,null),$t===null)throw Error(ge(349));Xs&30||Px(s,a,l)}return l}function Px(t,a,s){t.flags|=16384,t={getSnapshot:a,value:s},a=gt.updateQueue,a===null?(a={lastEffect:null,stores:null},gt.updateQueue=a,a.stores=[t]):(s=a.stores,s===null?a.stores=[t]:s.push(t))}function Tx(t,a,s,n){a.value=s,a.getSnapshot=n,Ax(a)&&Dx(t)}function Ex(t,a,s){return s(function(){Ax(a)&&Dx(t)})}function Ax(t){var a=t.getSnapshot;t=t.value;try{var s=a();return!za(t,s)}catch{return!0}}function Dx(t){var a=cs(t,1);a!==null&&Fa(a,t,1,-1)}function sf(t){var a=Ka();return typeof t=="function"&&(t=t()),a.memoizedState=a.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ul,lastRenderedState:t},a.queue=t,t=t.dispatch=By.bind(null,gt,t),[a.memoizedState,t]}function Ol(t,a,s,n){return t={tag:t,create:a,destroy:s,deps:n,next:null},a=gt.updateQueue,a===null?(a={lastEffect:null,stores:null},gt.updateQueue=a,a.lastEffect=t.next=t):(s=a.lastEffect,s===null?a.lastEffect=t.next=t:(n=s.next,s.next=t,t.next=n,a.lastEffect=t)),t}function Lx(){return Ea().memoizedState}function Rr(t,a,s,n){var l=Ka();gt.flags|=t,l.memoizedState=Ol(1|a,s,void 0,n===void 0?null:n)}function bi(t,a,s,n){var l=Ea();n=n===void 0?null:n;var r=void 0;if(Et!==null){var i=Et.memoizedState;if(r=i.destroy,n!==null&&Sd(n,i.deps)){l.memoizedState=Ol(a,s,r,n);return}}gt.flags|=t,l.memoizedState=Ol(1|a,s,r,n)}function nf(t,a){return Rr(8390656,8,t,a)}function kd(t,a){return bi(2048,8,t,a)}function Rx(t,a){return bi(4,2,t,a)}function Mx(t,a){return bi(4,4,t,a)}function $x(t,a){if(typeof a=="function")return t=t(),a(t),function(){a(null)};if(a!=null)return t=t(),a.current=t,function(){a.current=null}}function Ux(t,a,s){return s=s!=null?s.concat([t]):null,bi(4,4,$x.bind(null,a,t),s)}function Pd(){}function Ox(t,a){var s=Ea();a=a===void 0?null:a;var n=s.memoizedState;return n!==null&&a!==null&&Sd(a,n[1])?n[0]:(s.memoizedState=[t,a],t)}function Ix(t,a){var s=Ea();a=a===void 0?null:a;var n=s.memoizedState;return n!==null&&a!==null&&Sd(a,n[1])?n[0]:(t=t(),s.memoizedState=[t,a],t)}function Fx(t,a,s){return Xs&21?(za(s,a)||(s=Gp(),gt.lanes|=s,en|=s,t.baseState=!0),a):(t.baseState&&(t.baseState=!1,la=!0),t.memoizedState=s)}function Fy(t,a){var s=ct;ct=s!==0&&4>s?s:4,t(!0);var n=wo.transition;wo.transition={};try{t(!1),a()}finally{ct=s,wo.transition=n}}function zx(){return Ea().memoizedState}function zy(t,a,s){var n=Ds(t);if(s={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null},Bx(t))Wx(a,s);else if(s=_x(t,a,s,n),s!==null){var l=Jt();Fa(s,t,n,l),Vx(s,a,n)}}function By(t,a,s){var n=Ds(t),l={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null};if(Bx(t))Wx(a,l);else{var r=t.alternate;if(t.lanes===0&&(r===null||r.lanes===0)&&(r=a.lastRenderedReducer,r!==null))try{var i=a.lastRenderedState,u=r(i,s);if(l.hasEagerState=!0,l.eagerState=u,za(u,i)){var c=a.interleaved;c===null?(l.next=l,bd(a)):(l.next=c.next,c.next=l),a.interleaved=l;return}}catch{}finally{}s=_x(t,a,l,n),s!==null&&(l=Jt(),Fa(s,t,n,l),Vx(s,a,n))}}function Bx(t){var a=t.alternate;return t===gt||a!==null&&a===gt}function Wx(t,a){bl=si=!0;var s=t.pending;s===null?a.next=a:(a.next=s.next,s.next=a),t.pending=a}function Vx(t,a,s){if(s&4194240){var n=a.lanes;n&=t.pendingLanes,s|=n,a.lanes=s,ld(t,s)}}var ni={readContext:Ta,useCallback:Vt,useContext:Vt,useEffect:Vt,useImperativeHandle:Vt,useInsertionEffect:Vt,useLayoutEffect:Vt,useMemo:Vt,useReducer:Vt,useRef:Vt,useState:Vt,useDebugValue:Vt,useDeferredValue:Vt,useTransition:Vt,useMutableSource:Vt,useSyncExternalStore:Vt,useId:Vt,unstable_isNewReconciler:!1},Wy={readContext:Ta,useCallback:function(t,a){return Ka().memoizedState=[t,a===void 0?null:a],t},useContext:Ta,useEffect:nf,useImperativeHandle:function(t,a,s){return s=s!=null?s.concat([t]):null,Rr(4194308,4,$x.bind(null,a,t),s)},useLayoutEffect:function(t,a){return Rr(4194308,4,t,a)},useInsertionEffect:function(t,a){return Rr(4,2,t,a)},useMemo:function(t,a){var s=Ka();return a=a===void 0?null:a,t=t(),s.memoizedState=[t,a],t},useReducer:function(t,a,s){var n=Ka();return a=s!==void 0?s(a):a,n.memoizedState=n.baseState=a,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:a},n.queue=t,t=t.dispatch=zy.bind(null,gt,t),[n.memoizedState,t]},useRef:function(t){var a=Ka();return t={current:t},a.memoizedState=t},useState:sf,useDebugValue:Pd,useDeferredValue:function(t){return Ka().memoizedState=t},useTransition:function(){var t=sf(!1),a=t[0];return t=Fy.bind(null,t[1]),Ka().memoizedState=t,[a,t]},useMutableSource:function(){},useSyncExternalStore:function(t,a,s){var n=gt,l=Ka();if(ft){if(s===void 0)throw Error(ge(407));s=s()}else{if(s=a(),$t===null)throw Error(ge(349));Xs&30||Px(n,a,s)}l.memoizedState=s;var r={value:s,getSnapshot:a};return l.queue=r,nf(Ex.bind(null,n,r,t),[t]),n.flags|=2048,Ol(9,Tx.bind(null,n,r,s,a),void 0,null),s},useId:function(){var t=Ka(),a=$t.identifierPrefix;if(ft){var s=ls,n=ns;s=(n&~(1<<32-Ia(n)-1)).toString(32)+s,a=":"+a+"R"+s,s=$l++,0<s&&(a+="H"+s.toString(32)),a+=":"}else s=Iy++,a=":"+a+"r"+s.toString(32)+":";return t.memoizedState=a},unstable_isNewReconciler:!1},Vy={readContext:Ta,useCallback:Ox,useContext:Ta,useEffect:kd,useImperativeHandle:Ux,useInsertionEffect:Rx,useLayoutEffect:Mx,useMemo:Ix,useReducer:Co,useRef:Lx,useState:function(){return Co(Ul)},useDebugValue:Pd,useDeferredValue:function(t){var a=Ea();return Fx(a,Et.memoizedState,t)},useTransition:function(){var t=Co(Ul)[0],a=Ea().memoizedState;return[t,a]},useMutableSource:Cx,useSyncExternalStore:kx,useId:zx,unstable_isNewReconciler:!1},Gy={readContext:Ta,useCallback:Ox,useContext:Ta,useEffect:kd,useImperativeHandle:Ux,useInsertionEffect:Rx,useLayoutEffect:Mx,useMemo:Ix,useReducer:ko,useRef:Lx,useState:function(){return ko(Ul)},useDebugValue:Pd,useDeferredValue:function(t){var a=Ea();return Et===null?a.memoizedState=t:Fx(a,Et.memoizedState,t)},useTransition:function(){var t=ko(Ul)[0],a=Ea().memoizedState;return[t,a]},useMutableSource:Cx,useSyncExternalStore:kx,useId:zx,unstable_isNewReconciler:!1};function $a(t,a){if(t&&t.defaultProps){a=bt({},a),t=t.defaultProps;for(var s in t)a[s]===void 0&&(a[s]=t[s]);return a}return a}function Cc(t,a,s,n){a=t.memoizedState,s=s(n,a),s=s==null?a:bt({},a,s),t.memoizedState=s,t.lanes===0&&(t.updateQueue.baseState=s)}var yi={isMounted:function(t){return(t=t._reactInternals)?sn(t)===t:!1},enqueueSetState:function(t,a,s){t=t._reactInternals;var n=Jt(),l=Ds(t),r=rs(n,l);r.payload=a,s!=null&&(r.callback=s),a=Es(t,r,l),a!==null&&(Fa(a,t,l,n),Dr(a,t,l))},enqueueReplaceState:function(t,a,s){t=t._reactInternals;var n=Jt(),l=Ds(t),r=rs(n,l);r.tag=1,r.payload=a,s!=null&&(r.callback=s),a=Es(t,r,l),a!==null&&(Fa(a,t,l,n),Dr(a,t,l))},enqueueForceUpdate:function(t,a){t=t._reactInternals;var s=Jt(),n=Ds(t),l=rs(s,n);l.tag=2,a!=null&&(l.callback=a),a=Es(t,l,n),a!==null&&(Fa(a,t,n,s),Dr(a,t,n))}};function lf(t,a,s,n,l,r,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,r,i):a.prototype&&a.prototype.isPureReactComponent?!El(s,n)||!El(l,r):!0}function Gx(t,a,s){var n=!1,l=$s,r=a.contextType;return typeof r=="object"&&r!==null?r=Ta(r):(l=ia(a)?Js:Qt.current,n=a.contextTypes,r=(n=n!=null)?$n(t,l):$s),a=new a(s,r),t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=yi,t.stateNode=a,a._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=l,t.__reactInternalMemoizedMaskedChildContext=r),a}function rf(t,a,s,n){t=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(s,n),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(s,n),a.state!==t&&yi.enqueueReplaceState(a,a.state,null)}function kc(t,a,s,n){var l=t.stateNode;l.props=s,l.state=t.memoizedState,l.refs={},yd(t);var r=a.contextType;typeof r=="object"&&r!==null?l.context=Ta(r):(r=ia(a)?Js:Qt.current,l.context=$n(t,r)),l.state=t.memoizedState,r=a.getDerivedStateFromProps,typeof r=="function"&&(Cc(t,a,r,s),l.state=t.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(a=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),a!==l.state&&yi.enqueueReplaceState(l,l.state,null),ti(t,s,l,n),l.state=t.memoizedState),typeof l.componentDidMount=="function"&&(t.flags|=4194308)}function Fn(t,a){try{var s="",n=a;do s+=bb(n),n=n.return;while(n);var l=s}catch(r){l=`
Error generating stack: `+r.message+`
`+r.stack}return{value:t,source:a,stack:l,digest:null}}function Po(t,a,s){return{value:t,source:null,stack:s??null,digest:a??null}}function Pc(t,a){try{console.error(a.value)}catch(s){setTimeout(function(){throw s})}}var Hy=typeof WeakMap=="function"?WeakMap:Map;function Hx(t,a,s){s=rs(-1,s),s.tag=3,s.payload={element:null};var n=a.value;return s.callback=function(){ri||(ri=!0,Oc=n),Pc(t,a)},s}function Qx(t,a,s){s=rs(-1,s),s.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var l=a.value;s.payload=function(){return n(l)},s.callback=function(){Pc(t,a)}}var r=t.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(s.callback=function(){Pc(t,a),typeof n!="function"&&(As===null?As=new Set([this]):As.add(this));var i=a.stack;this.componentDidCatch(a.value,{componentStack:i!==null?i:""})}),s}function of(t,a,s){var n=t.pingCache;if(n===null){n=t.pingCache=new Hy;var l=new Set;n.set(a,l)}else l=n.get(a),l===void 0&&(l=new Set,n.set(a,l));l.has(s)||(l.add(s),t=rv.bind(null,t,a,s),a.then(t,t))}function cf(t){do{var a;if((a=t.tag===13)&&(a=t.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return t;t=t.return}while(t!==null);return null}function df(t,a,s,n,l){return t.mode&1?(t.flags|=65536,t.lanes=l,t):(t===a?t.flags|=65536:(t.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(a=rs(-1,1),a.tag=2,Es(s,a,1))),s.lanes|=1),t)}var Qy=us.ReactCurrentOwner,la=!1;function Kt(t,a,s,n){a.child=t===null?Nx(a,null,s,n):On(a,t.child,s,n)}function uf(t,a,s,n,l){s=s.render;var r=a.ref;return Ln(a,l),n=wd(t,a,s,n,r,l),s=Cd(),t!==null&&!la?(a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~l,ds(t,a,l)):(ft&&s&&hd(a),a.flags|=1,Kt(t,a,n,l),a.child)}function mf(t,a,s,n,l){if(t===null){var r=s.type;return typeof r=="function"&&!$d(r)&&r.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(a.tag=15,a.type=r,qx(t,a,r,n,l)):(t=Or(s.type,null,n,a,a.mode,l),t.ref=a.ref,t.return=a,a.child=t)}if(r=t.child,!(t.lanes&l)){var i=r.memoizedProps;if(s=s.compare,s=s!==null?s:El,s(i,n)&&t.ref===a.ref)return ds(t,a,l)}return a.flags|=1,t=Ls(r,n),t.ref=a.ref,t.return=a,a.child=t}function qx(t,a,s,n,l){if(t!==null){var r=t.memoizedProps;if(El(r,n)&&t.ref===a.ref)if(la=!1,a.pendingProps=n=r,(t.lanes&l)!==0)t.flags&131072&&(la=!0);else return a.lanes=t.lanes,ds(t,a,l)}return Tc(t,a,s,n,l)}function Yx(t,a,s){var n=a.pendingProps,l=n.children,r=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(a.mode&1))a.memoizedState={baseLanes:0,cachePool:null,transitions:null},dt(Pn,ha),ha|=s;else{if(!(s&1073741824))return t=r!==null?r.baseLanes|s:s,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:t,cachePool:null,transitions:null},a.updateQueue=null,dt(Pn,ha),ha|=t,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=r!==null?r.baseLanes:s,dt(Pn,ha),ha|=n}else r!==null?(n=r.baseLanes|s,a.memoizedState=null):n=s,dt(Pn,ha),ha|=n;return Kt(t,a,l,s),a.child}function Kx(t,a){var s=a.ref;(t===null&&s!==null||t!==null&&t.ref!==s)&&(a.flags|=512,a.flags|=2097152)}function Tc(t,a,s,n,l){var r=ia(s)?Js:Qt.current;return r=$n(a,r),Ln(a,l),s=wd(t,a,s,n,r,l),n=Cd(),t!==null&&!la?(a.updateQueue=t.updateQueue,a.flags&=-2053,t.lanes&=~l,ds(t,a,l)):(ft&&n&&hd(a),a.flags|=1,Kt(t,a,s,l),a.child)}function hf(t,a,s,n,l){if(ia(s)){var r=!0;Kr(a)}else r=!1;if(Ln(a,l),a.stateNode===null)Mr(t,a),Gx(a,s,n),kc(a,s,n,l),n=!0;else if(t===null){var i=a.stateNode,u=a.memoizedProps;i.props=u;var c=i.context,m=s.contextType;typeof m=="object"&&m!==null?m=Ta(m):(m=ia(s)?Js:Qt.current,m=$n(a,m));var x=s.getDerivedStateFromProps,f=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(u!==n||c!==m)&&rf(a,i,n,m),ys=!1;var j=a.memoizedState;i.state=j,ti(a,n,i,l),c=a.memoizedState,u!==n||j!==c||ra.current||ys?(typeof x=="function"&&(Cc(a,s,x,n),c=a.memoizedState),(u=ys||lf(a,s,u,n,j,c,m))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(a.flags|=4194308)):(typeof i.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=n,a.memoizedState=c),i.props=n,i.state=c,i.context=m,n=u):(typeof i.componentDidMount=="function"&&(a.flags|=4194308),n=!1)}else{i=a.stateNode,Sx(t,a),u=a.memoizedProps,m=a.type===a.elementType?u:$a(a.type,u),i.props=m,f=a.pendingProps,j=i.context,c=s.contextType,typeof c=="object"&&c!==null?c=Ta(c):(c=ia(s)?Js:Qt.current,c=$n(a,c));var N=s.getDerivedStateFromProps;(x=typeof N=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(u!==f||j!==c)&&rf(a,i,n,c),ys=!1,j=a.memoizedState,i.state=j,ti(a,n,i,l);var v=a.memoizedState;u!==f||j!==v||ra.current||ys?(typeof N=="function"&&(Cc(a,s,N,n),v=a.memoizedState),(m=ys||lf(a,s,m,n,j,v,c)||!1)?(x||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,c)),typeof i.componentDidUpdate=="function"&&(a.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof i.componentDidUpdate!="function"||u===t.memoizedProps&&j===t.memoizedState||(a.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&j===t.memoizedState||(a.flags|=1024),a.memoizedProps=n,a.memoizedState=v),i.props=n,i.state=v,i.context=c,n=m):(typeof i.componentDidUpdate!="function"||u===t.memoizedProps&&j===t.memoizedState||(a.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&j===t.memoizedState||(a.flags|=1024),n=!1)}return Ec(t,a,s,n,r,l)}function Ec(t,a,s,n,l,r){Kx(t,a);var i=(a.flags&128)!==0;if(!n&&!i)return l&&Jh(a,s,!1),ds(t,a,r);n=a.stateNode,Qy.current=a;var u=i&&typeof s.getDerivedStateFromError!="function"?null:n.render();return a.flags|=1,t!==null&&i?(a.child=On(a,t.child,null,r),a.child=On(a,null,u,r)):Kt(t,a,u,r),a.memoizedState=n.state,l&&Jh(a,s,!0),a.child}function Jx(t){var a=t.stateNode;a.pendingContext?Kh(t,a.pendingContext,a.pendingContext!==a.context):a.context&&Kh(t,a.context,!1),vd(t,a.containerInfo)}function ff(t,a,s,n,l){return Un(),pd(l),a.flags|=256,Kt(t,a,s,n),a.child}var Ac={dehydrated:null,treeContext:null,retryLane:0};function Dc(t){return{baseLanes:t,cachePool:null,transitions:null}}function Zx(t,a,s){var n=a.pendingProps,l=xt.current,r=!1,i=(a.flags&128)!==0,u;if((u=i)||(u=t!==null&&t.memoizedState===null?!1:(l&2)!==0),u?(r=!0,a.flags&=-129):(t===null||t.memoizedState!==null)&&(l|=1),dt(xt,l&1),t===null)return Sc(a),t=a.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(a.mode&1?t.data==="$!"?a.lanes=8:a.lanes=1073741824:a.lanes=1,null):(i=n.children,t=n.fallback,r?(n=a.mode,r=a.child,i={mode:"hidden",children:i},!(n&1)&&r!==null?(r.childLanes=0,r.pendingProps=i):r=_i(i,n,0,null),t=Ks(t,n,s,null),r.return=a,t.return=a,r.sibling=t,a.child=r,a.child.memoizedState=Dc(s),a.memoizedState=Ac,t):Td(a,i));if(l=t.memoizedState,l!==null&&(u=l.dehydrated,u!==null))return qy(t,a,i,n,u,l,s);if(r){r=n.fallback,i=a.mode,l=t.child,u=l.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&a.child!==l?(n=a.child,n.childLanes=0,n.pendingProps=c,a.deletions=null):(n=Ls(l,c),n.subtreeFlags=l.subtreeFlags&14680064),u!==null?r=Ls(u,r):(r=Ks(r,i,s,null),r.flags|=2),r.return=a,n.return=a,n.sibling=r,a.child=n,n=r,r=a.child,i=t.child.memoizedState,i=i===null?Dc(s):{baseLanes:i.baseLanes|s,cachePool:null,transitions:i.transitions},r.memoizedState=i,r.childLanes=t.childLanes&~s,a.memoizedState=Ac,n}return r=t.child,t=r.sibling,n=Ls(r,{mode:"visible",children:n.children}),!(a.mode&1)&&(n.lanes=s),n.return=a,n.sibling=null,t!==null&&(s=a.deletions,s===null?(a.deletions=[t],a.flags|=16):s.push(t)),a.child=n,a.memoizedState=null,n}function Td(t,a){return a=_i({mode:"visible",children:a},t.mode,0,null),a.return=t,t.child=a}function fr(t,a,s,n){return n!==null&&pd(n),On(a,t.child,null,s),t=Td(a,a.pendingProps.children),t.flags|=2,a.memoizedState=null,t}function qy(t,a,s,n,l,r,i){if(s)return a.flags&256?(a.flags&=-257,n=Po(Error(ge(422))),fr(t,a,i,n)):a.memoizedState!==null?(a.child=t.child,a.flags|=128,null):(r=n.fallback,l=a.mode,n=_i({mode:"visible",children:n.children},l,0,null),r=Ks(r,l,i,null),r.flags|=2,n.return=a,r.return=a,n.sibling=r,a.child=n,a.mode&1&&On(a,t.child,null,i),a.child.memoizedState=Dc(i),a.memoizedState=Ac,r);if(!(a.mode&1))return fr(t,a,i,null);if(l.data==="$!"){if(n=l.nextSibling&&l.nextSibling.dataset,n)var u=n.dgst;return n=u,r=Error(ge(419)),n=Po(r,n,void 0),fr(t,a,i,n)}if(u=(i&t.childLanes)!==0,la||u){if(n=$t,n!==null){switch(i&-i){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(n.suspendedLanes|i)?0:l,l!==0&&l!==r.retryLane&&(r.retryLane=l,cs(t,l),Fa(n,t,l,-1))}return Md(),n=Po(Error(ge(421))),fr(t,a,i,n)}return l.data==="$?"?(a.flags|=128,a.child=t.child,a=iv.bind(null,t),l._reactRetry=a,null):(t=r.treeContext,fa=Ts(l.nextSibling),pa=a,ft=!0,Oa=null,t!==null&&(wa[Ca++]=ns,wa[Ca++]=ls,wa[Ca++]=Zs,ns=t.id,ls=t.overflow,Zs=a),a=Td(a,n.children),a.flags|=4096,a)}function pf(t,a,s){t.lanes|=a;var n=t.alternate;n!==null&&(n.lanes|=a),wc(t.return,a,s)}function To(t,a,s,n,l){var r=t.memoizedState;r===null?t.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:l}:(r.isBackwards=a,r.rendering=null,r.renderingStartTime=0,r.last=n,r.tail=s,r.tailMode=l)}function Xx(t,a,s){var n=a.pendingProps,l=n.revealOrder,r=n.tail;if(Kt(t,a,n.children,s),n=xt.current,n&2)n=n&1|2,a.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=a.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&pf(t,s,a);else if(t.tag===19)pf(t,s,a);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===a)break e;for(;t.sibling===null;){if(t.return===null||t.return===a)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(dt(xt,n),!(a.mode&1))a.memoizedState=null;else switch(l){case"forwards":for(s=a.child,l=null;s!==null;)t=s.alternate,t!==null&&ai(t)===null&&(l=s),s=s.sibling;s=l,s===null?(l=a.child,a.child=null):(l=s.sibling,s.sibling=null),To(a,!1,l,s,r);break;case"backwards":for(s=null,l=a.child,a.child=null;l!==null;){if(t=l.alternate,t!==null&&ai(t)===null){a.child=l;break}t=l.sibling,l.sibling=s,s=l,l=t}To(a,!0,s,null,r);break;case"together":To(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Mr(t,a){!(a.mode&1)&&t!==null&&(t.alternate=null,a.alternate=null,a.flags|=2)}function ds(t,a,s){if(t!==null&&(a.dependencies=t.dependencies),en|=a.lanes,!(s&a.childLanes))return null;if(t!==null&&a.child!==t.child)throw Error(ge(153));if(a.child!==null){for(t=a.child,s=Ls(t,t.pendingProps),a.child=s,s.return=a;t.sibling!==null;)t=t.sibling,s=s.sibling=Ls(t,t.pendingProps),s.return=a;s.sibling=null}return a.child}function Yy(t,a,s){switch(a.tag){case 3:Jx(a),Un();break;case 5:wx(a);break;case 1:ia(a.type)&&Kr(a);break;case 4:vd(a,a.stateNode.containerInfo);break;case 10:var n=a.type._context,l=a.memoizedProps.value;dt(Xr,n._currentValue),n._currentValue=l;break;case 13:if(n=a.memoizedState,n!==null)return n.dehydrated!==null?(dt(xt,xt.current&1),a.flags|=128,null):s&a.child.childLanes?Zx(t,a,s):(dt(xt,xt.current&1),t=ds(t,a,s),t!==null?t.sibling:null);dt(xt,xt.current&1);break;case 19:if(n=(s&a.childLanes)!==0,t.flags&128){if(n)return Xx(t,a,s);a.flags|=128}if(l=a.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),dt(xt,xt.current),n)break;return null;case 22:case 23:return a.lanes=0,Yx(t,a,s)}return ds(t,a,s)}var eg,Lc,tg,ag;eg=function(t,a){for(var s=a.child;s!==null;){if(s.tag===5||s.tag===6)t.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};Lc=function(){};tg=function(t,a,s,n){var l=t.memoizedProps;if(l!==n){t=a.stateNode,qs(Xa.current);var r=null;switch(s){case"input":l=tc(t,l),n=tc(t,n),r=[];break;case"select":l=bt({},l,{value:void 0}),n=bt({},n,{value:void 0}),r=[];break;case"textarea":l=nc(t,l),n=nc(t,n),r=[];break;default:typeof l.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=qr)}rc(s,n);var i;s=null;for(m in l)if(!n.hasOwnProperty(m)&&l.hasOwnProperty(m)&&l[m]!=null)if(m==="style"){var u=l[m];for(i in u)u.hasOwnProperty(i)&&(s||(s={}),s[i]="")}else m!=="dangerouslySetInnerHTML"&&m!=="children"&&m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(_l.hasOwnProperty(m)?r||(r=[]):(r=r||[]).push(m,null));for(m in n){var c=n[m];if(u=l!=null?l[m]:void 0,n.hasOwnProperty(m)&&c!==u&&(c!=null||u!=null))if(m==="style")if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(s||(s={}),s[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(s||(s={}),s[i]=c[i])}else s||(r||(r=[]),r.push(m,s)),s=c;else m==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(r=r||[]).push(m,c)):m==="children"?typeof c!="string"&&typeof c!="number"||(r=r||[]).push(m,""+c):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&(_l.hasOwnProperty(m)?(c!=null&&m==="onScroll"&&ut("scroll",t),r||u===c||(r=[])):(r=r||[]).push(m,c))}s&&(r=r||[]).push("style",s);var m=r;(a.updateQueue=m)&&(a.flags|=4)}};ag=function(t,a,s,n){s!==n&&(a.flags|=4)};function sl(t,a){if(!ft)switch(t.tailMode){case"hidden":a=t.tail;for(var s=null;a!==null;)a.alternate!==null&&(s=a),a=a.sibling;s===null?t.tail=null:s.sibling=null;break;case"collapsed":s=t.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?a||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Gt(t){var a=t.alternate!==null&&t.alternate.child===t.child,s=0,n=0;if(a)for(var l=t.child;l!==null;)s|=l.lanes|l.childLanes,n|=l.subtreeFlags&14680064,n|=l.flags&14680064,l.return=t,l=l.sibling;else for(l=t.child;l!==null;)s|=l.lanes|l.childLanes,n|=l.subtreeFlags,n|=l.flags,l.return=t,l=l.sibling;return t.subtreeFlags|=n,t.childLanes=s,a}function Ky(t,a,s){var n=a.pendingProps;switch(fd(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gt(a),null;case 1:return ia(a.type)&&Yr(),Gt(a),null;case 3:return n=a.stateNode,In(),mt(ra),mt(Qt),_d(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(mr(a)?a.flags|=4:t===null||t.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,Oa!==null&&(zc(Oa),Oa=null))),Lc(t,a),Gt(a),null;case 5:Nd(a);var l=qs(Ml.current);if(s=a.type,t!==null&&a.stateNode!=null)tg(t,a,s,n,l),t.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!n){if(a.stateNode===null)throw Error(ge(166));return Gt(a),null}if(t=qs(Xa.current),mr(a)){n=a.stateNode,s=a.type;var r=a.memoizedProps;switch(n[Ja]=a,n[Ll]=r,t=(a.mode&1)!==0,s){case"dialog":ut("cancel",n),ut("close",n);break;case"iframe":case"object":case"embed":ut("load",n);break;case"video":case"audio":for(l=0;l<ml.length;l++)ut(ml[l],n);break;case"source":ut("error",n);break;case"img":case"image":case"link":ut("error",n),ut("load",n);break;case"details":ut("toggle",n);break;case"input":_h(n,r),ut("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!r.multiple},ut("invalid",n);break;case"textarea":wh(n,r),ut("invalid",n)}rc(s,r),l=null;for(var i in r)if(r.hasOwnProperty(i)){var u=r[i];i==="children"?typeof u=="string"?n.textContent!==u&&(r.suppressHydrationWarning!==!0&&ur(n.textContent,u,t),l=["children",u]):typeof u=="number"&&n.textContent!==""+u&&(r.suppressHydrationWarning!==!0&&ur(n.textContent,u,t),l=["children",""+u]):_l.hasOwnProperty(i)&&u!=null&&i==="onScroll"&&ut("scroll",n)}switch(s){case"input":sr(n),Sh(n,r,!0);break;case"textarea":sr(n),Ch(n);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(n.onclick=qr)}n=l,a.updateQueue=n,n!==null&&(a.flags|=4)}else{i=l.nodeType===9?l:l.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Ep(s)),t==="http://www.w3.org/1999/xhtml"?s==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(s,{is:n.is}):(t=i.createElement(s),s==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,s),t[Ja]=a,t[Ll]=n,eg(t,a,!1,!1),a.stateNode=t;e:{switch(i=ic(s,n),s){case"dialog":ut("cancel",t),ut("close",t),l=n;break;case"iframe":case"object":case"embed":ut("load",t),l=n;break;case"video":case"audio":for(l=0;l<ml.length;l++)ut(ml[l],t);l=n;break;case"source":ut("error",t),l=n;break;case"img":case"image":case"link":ut("error",t),ut("load",t),l=n;break;case"details":ut("toggle",t),l=n;break;case"input":_h(t,n),l=tc(t,n),ut("invalid",t);break;case"option":l=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},l=bt({},n,{value:void 0}),ut("invalid",t);break;case"textarea":wh(t,n),l=nc(t,n),ut("invalid",t);break;default:l=n}rc(s,l),u=l;for(r in u)if(u.hasOwnProperty(r)){var c=u[r];r==="style"?Lp(t,c):r==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Ap(t,c)):r==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&Sl(t,c):typeof c=="number"&&Sl(t,""+c):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(_l.hasOwnProperty(r)?c!=null&&r==="onScroll"&&ut("scroll",t):c!=null&&Xc(t,r,c,i))}switch(s){case"input":sr(t),Sh(t,n,!1);break;case"textarea":sr(t),Ch(t);break;case"option":n.value!=null&&t.setAttribute("value",""+Ms(n.value));break;case"select":t.multiple=!!n.multiple,r=n.value,r!=null?Tn(t,!!n.multiple,r,!1):n.defaultValue!=null&&Tn(t,!!n.multiple,n.defaultValue,!0);break;default:typeof l.onClick=="function"&&(t.onclick=qr)}switch(s){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(a.flags|=4)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Gt(a),null;case 6:if(t&&a.stateNode!=null)ag(t,a,t.memoizedProps,n);else{if(typeof n!="string"&&a.stateNode===null)throw Error(ge(166));if(s=qs(Ml.current),qs(Xa.current),mr(a)){if(n=a.stateNode,s=a.memoizedProps,n[Ja]=a,(r=n.nodeValue!==s)&&(t=pa,t!==null))switch(t.tag){case 3:ur(n.nodeValue,s,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ur(n.nodeValue,s,(t.mode&1)!==0)}r&&(a.flags|=4)}else n=(s.nodeType===9?s:s.ownerDocument).createTextNode(n),n[Ja]=a,a.stateNode=n}return Gt(a),null;case 13:if(mt(xt),n=a.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ft&&fa!==null&&a.mode&1&&!(a.flags&128))yx(),Un(),a.flags|=98560,r=!1;else if(r=mr(a),n!==null&&n.dehydrated!==null){if(t===null){if(!r)throw Error(ge(318));if(r=a.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(ge(317));r[Ja]=a}else Un(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;Gt(a),r=!1}else Oa!==null&&(zc(Oa),Oa=null),r=!0;if(!r)return a.flags&65536?a:null}return a.flags&128?(a.lanes=s,a):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(a.child.flags|=8192,a.mode&1&&(t===null||xt.current&1?At===0&&(At=3):Md())),a.updateQueue!==null&&(a.flags|=4),Gt(a),null);case 4:return In(),Lc(t,a),t===null&&Al(a.stateNode.containerInfo),Gt(a),null;case 10:return jd(a.type._context),Gt(a),null;case 17:return ia(a.type)&&Yr(),Gt(a),null;case 19:if(mt(xt),r=a.memoizedState,r===null)return Gt(a),null;if(n=(a.flags&128)!==0,i=r.rendering,i===null)if(n)sl(r,!1);else{if(At!==0||t!==null&&t.flags&128)for(t=a.child;t!==null;){if(i=ai(t),i!==null){for(a.flags|=128,sl(r,!1),n=i.updateQueue,n!==null&&(a.updateQueue=n,a.flags|=4),a.subtreeFlags=0,n=s,s=a.child;s!==null;)r=s,t=n,r.flags&=14680066,i=r.alternate,i===null?(r.childLanes=0,r.lanes=t,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=i.childLanes,r.lanes=i.lanes,r.child=i.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=i.memoizedProps,r.memoizedState=i.memoizedState,r.updateQueue=i.updateQueue,r.type=i.type,t=i.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),s=s.sibling;return dt(xt,xt.current&1|2),a.child}t=t.sibling}r.tail!==null&&St()>zn&&(a.flags|=128,n=!0,sl(r,!1),a.lanes=4194304)}else{if(!n)if(t=ai(i),t!==null){if(a.flags|=128,n=!0,s=t.updateQueue,s!==null&&(a.updateQueue=s,a.flags|=4),sl(r,!0),r.tail===null&&r.tailMode==="hidden"&&!i.alternate&&!ft)return Gt(a),null}else 2*St()-r.renderingStartTime>zn&&s!==1073741824&&(a.flags|=128,n=!0,sl(r,!1),a.lanes=4194304);r.isBackwards?(i.sibling=a.child,a.child=i):(s=r.last,s!==null?s.sibling=i:a.child=i,r.last=i)}return r.tail!==null?(a=r.tail,r.rendering=a,r.tail=a.sibling,r.renderingStartTime=St(),a.sibling=null,s=xt.current,dt(xt,n?s&1|2:s&1),a):(Gt(a),null);case 22:case 23:return Rd(),n=a.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(a.flags|=8192),n&&a.mode&1?ha&1073741824&&(Gt(a),a.subtreeFlags&6&&(a.flags|=8192)):Gt(a),null;case 24:return null;case 25:return null}throw Error(ge(156,a.tag))}function Jy(t,a){switch(fd(a),a.tag){case 1:return ia(a.type)&&Yr(),t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 3:return In(),mt(ra),mt(Qt),_d(),t=a.flags,t&65536&&!(t&128)?(a.flags=t&-65537|128,a):null;case 5:return Nd(a),null;case 13:if(mt(xt),t=a.memoizedState,t!==null&&t.dehydrated!==null){if(a.alternate===null)throw Error(ge(340));Un()}return t=a.flags,t&65536?(a.flags=t&-65537|128,a):null;case 19:return mt(xt),null;case 4:return In(),null;case 10:return jd(a.type._context),null;case 22:case 23:return Rd(),null;case 24:return null;default:return null}}var pr=!1,Ht=!1,Zy=typeof WeakSet=="function"?WeakSet:Set,De=null;function kn(t,a){var s=t.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(n){vt(t,a,n)}else s.current=null}function Rc(t,a,s){try{s()}catch(n){vt(t,a,n)}}var xf=!1;function Xy(t,a){if(gc=Gr,t=ix(),md(t)){if("selectionStart"in t)var s={start:t.selectionStart,end:t.selectionEnd};else e:{s=(s=t.ownerDocument)&&s.defaultView||window;var n=s.getSelection&&s.getSelection();if(n&&n.rangeCount!==0){s=n.anchorNode;var l=n.anchorOffset,r=n.focusNode;n=n.focusOffset;try{s.nodeType,r.nodeType}catch{s=null;break e}var i=0,u=-1,c=-1,m=0,x=0,f=t,j=null;t:for(;;){for(var N;f!==s||l!==0&&f.nodeType!==3||(u=i+l),f!==r||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(N=f.firstChild)!==null;)j=f,f=N;for(;;){if(f===t)break t;if(j===s&&++m===l&&(u=i),j===r&&++x===n&&(c=i),(N=f.nextSibling)!==null)break;f=j,j=f.parentNode}f=N}s=u===-1||c===-1?null:{start:u,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(jc={focusedElem:t,selectionRange:s},Gr=!1,De=a;De!==null;)if(a=De,t=a.child,(a.subtreeFlags&1028)!==0&&t!==null)t.return=a,De=t;else for(;De!==null;){a=De;try{var v=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var _=v.memoizedProps,C=v.memoizedState,y=a.stateNode,h=y.getSnapshotBeforeUpdate(a.elementType===a.type?_:$a(a.type,_),C);y.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var p=a.stateNode.containerInfo;p.nodeType===1?p.textContent="":p.nodeType===9&&p.documentElement&&p.removeChild(p.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ge(163))}}catch(b){vt(a,a.return,b)}if(t=a.sibling,t!==null){t.return=a.return,De=t;break}De=a.return}return v=xf,xf=!1,v}function yl(t,a,s){var n=a.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var l=n=n.next;do{if((l.tag&t)===t){var r=l.destroy;l.destroy=void 0,r!==void 0&&Rc(a,s,r)}l=l.next}while(l!==n)}}function vi(t,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var s=a=a.next;do{if((s.tag&t)===t){var n=s.create;s.destroy=n()}s=s.next}while(s!==a)}}function Mc(t){var a=t.ref;if(a!==null){var s=t.stateNode;switch(t.tag){case 5:t=s;break;default:t=s}typeof a=="function"?a(t):a.current=t}}function sg(t){var a=t.alternate;a!==null&&(t.alternate=null,sg(a)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(a=t.stateNode,a!==null&&(delete a[Ja],delete a[Ll],delete a[vc],delete a[My],delete a[$y])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function ng(t){return t.tag===5||t.tag===3||t.tag===4}function gf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||ng(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function $c(t,a,s){var n=t.tag;if(n===5||n===6)t=t.stateNode,a?s.nodeType===8?s.parentNode.insertBefore(t,a):s.insertBefore(t,a):(s.nodeType===8?(a=s.parentNode,a.insertBefore(t,s)):(a=s,a.appendChild(t)),s=s._reactRootContainer,s!=null||a.onclick!==null||(a.onclick=qr));else if(n!==4&&(t=t.child,t!==null))for($c(t,a,s),t=t.sibling;t!==null;)$c(t,a,s),t=t.sibling}function Uc(t,a,s){var n=t.tag;if(n===5||n===6)t=t.stateNode,a?s.insertBefore(t,a):s.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Uc(t,a,s),t=t.sibling;t!==null;)Uc(t,a,s),t=t.sibling}var Ft=null,Ua=!1;function gs(t,a,s){for(s=s.child;s!==null;)lg(t,a,s),s=s.sibling}function lg(t,a,s){if(Za&&typeof Za.onCommitFiberUnmount=="function")try{Za.onCommitFiberUnmount(hi,s)}catch{}switch(s.tag){case 5:Ht||kn(s,a);case 6:var n=Ft,l=Ua;Ft=null,gs(t,a,s),Ft=n,Ua=l,Ft!==null&&(Ua?(t=Ft,s=s.stateNode,t.nodeType===8?t.parentNode.removeChild(s):t.removeChild(s)):Ft.removeChild(s.stateNode));break;case 18:Ft!==null&&(Ua?(t=Ft,s=s.stateNode,t.nodeType===8?No(t.parentNode,s):t.nodeType===1&&No(t,s),Pl(t)):No(Ft,s.stateNode));break;case 4:n=Ft,l=Ua,Ft=s.stateNode.containerInfo,Ua=!0,gs(t,a,s),Ft=n,Ua=l;break;case 0:case 11:case 14:case 15:if(!Ht&&(n=s.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){l=n=n.next;do{var r=l,i=r.destroy;r=r.tag,i!==void 0&&(r&2||r&4)&&Rc(s,a,i),l=l.next}while(l!==n)}gs(t,a,s);break;case 1:if(!Ht&&(kn(s,a),n=s.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=s.memoizedProps,n.state=s.memoizedState,n.componentWillUnmount()}catch(u){vt(s,a,u)}gs(t,a,s);break;case 21:gs(t,a,s);break;case 22:s.mode&1?(Ht=(n=Ht)||s.memoizedState!==null,gs(t,a,s),Ht=n):gs(t,a,s);break;default:gs(t,a,s)}}function jf(t){var a=t.updateQueue;if(a!==null){t.updateQueue=null;var s=t.stateNode;s===null&&(s=t.stateNode=new Zy),a.forEach(function(n){var l=ov.bind(null,t,n);s.has(n)||(s.add(n),n.then(l,l))})}}function Da(t,a){var s=a.deletions;if(s!==null)for(var n=0;n<s.length;n++){var l=s[n];try{var r=t,i=a,u=i;e:for(;u!==null;){switch(u.tag){case 5:Ft=u.stateNode,Ua=!1;break e;case 3:Ft=u.stateNode.containerInfo,Ua=!0;break e;case 4:Ft=u.stateNode.containerInfo,Ua=!0;break e}u=u.return}if(Ft===null)throw Error(ge(160));lg(r,i,l),Ft=null,Ua=!1;var c=l.alternate;c!==null&&(c.return=null),l.return=null}catch(m){vt(l,a,m)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)rg(a,t),a=a.sibling}function rg(t,a){var s=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Da(a,t),qa(t),n&4){try{yl(3,t,t.return),vi(3,t)}catch(_){vt(t,t.return,_)}try{yl(5,t,t.return)}catch(_){vt(t,t.return,_)}}break;case 1:Da(a,t),qa(t),n&512&&s!==null&&kn(s,s.return);break;case 5:if(Da(a,t),qa(t),n&512&&s!==null&&kn(s,s.return),t.flags&32){var l=t.stateNode;try{Sl(l,"")}catch(_){vt(t,t.return,_)}}if(n&4&&(l=t.stateNode,l!=null)){var r=t.memoizedProps,i=s!==null?s.memoizedProps:r,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&r.type==="radio"&&r.name!=null&&Pp(l,r),ic(u,i);var m=ic(u,r);for(i=0;i<c.length;i+=2){var x=c[i],f=c[i+1];x==="style"?Lp(l,f):x==="dangerouslySetInnerHTML"?Ap(l,f):x==="children"?Sl(l,f):Xc(l,x,f,m)}switch(u){case"input":ac(l,r);break;case"textarea":Tp(l,r);break;case"select":var j=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!r.multiple;var N=r.value;N!=null?Tn(l,!!r.multiple,N,!1):j!==!!r.multiple&&(r.defaultValue!=null?Tn(l,!!r.multiple,r.defaultValue,!0):Tn(l,!!r.multiple,r.multiple?[]:"",!1))}l[Ll]=r}catch(_){vt(t,t.return,_)}}break;case 6:if(Da(a,t),qa(t),n&4){if(t.stateNode===null)throw Error(ge(162));l=t.stateNode,r=t.memoizedProps;try{l.nodeValue=r}catch(_){vt(t,t.return,_)}}break;case 3:if(Da(a,t),qa(t),n&4&&s!==null&&s.memoizedState.isDehydrated)try{Pl(a.containerInfo)}catch(_){vt(t,t.return,_)}break;case 4:Da(a,t),qa(t);break;case 13:Da(a,t),qa(t),l=t.child,l.flags&8192&&(r=l.memoizedState!==null,l.stateNode.isHidden=r,!r||l.alternate!==null&&l.alternate.memoizedState!==null||(Dd=St())),n&4&&jf(t);break;case 22:if(x=s!==null&&s.memoizedState!==null,t.mode&1?(Ht=(m=Ht)||x,Da(a,t),Ht=m):Da(a,t),qa(t),n&8192){if(m=t.memoizedState!==null,(t.stateNode.isHidden=m)&&!x&&t.mode&1)for(De=t,x=t.child;x!==null;){for(f=De=x;De!==null;){switch(j=De,N=j.child,j.tag){case 0:case 11:case 14:case 15:yl(4,j,j.return);break;case 1:kn(j,j.return);var v=j.stateNode;if(typeof v.componentWillUnmount=="function"){n=j,s=j.return;try{a=n,v.props=a.memoizedProps,v.state=a.memoizedState,v.componentWillUnmount()}catch(_){vt(n,s,_)}}break;case 5:kn(j,j.return);break;case 22:if(j.memoizedState!==null){yf(f);continue}}N!==null?(N.return=j,De=N):yf(f)}x=x.sibling}e:for(x=null,f=t;;){if(f.tag===5){if(x===null){x=f;try{l=f.stateNode,m?(r=l.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(u=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=Dp("display",i))}catch(_){vt(t,t.return,_)}}}else if(f.tag===6){if(x===null)try{f.stateNode.nodeValue=m?"":f.memoizedProps}catch(_){vt(t,t.return,_)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;x===f&&(x=null),f=f.return}x===f&&(x=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Da(a,t),qa(t),n&4&&jf(t);break;case 21:break;default:Da(a,t),qa(t)}}function qa(t){var a=t.flags;if(a&2){try{e:{for(var s=t.return;s!==null;){if(ng(s)){var n=s;break e}s=s.return}throw Error(ge(160))}switch(n.tag){case 5:var l=n.stateNode;n.flags&32&&(Sl(l,""),n.flags&=-33);var r=gf(t);Uc(t,r,l);break;case 3:case 4:var i=n.stateNode.containerInfo,u=gf(t);$c(t,u,i);break;default:throw Error(ge(161))}}catch(c){vt(t,t.return,c)}t.flags&=-3}a&4096&&(t.flags&=-4097)}function ev(t,a,s){De=t,ig(t)}function ig(t,a,s){for(var n=(t.mode&1)!==0;De!==null;){var l=De,r=l.child;if(l.tag===22&&n){var i=l.memoizedState!==null||pr;if(!i){var u=l.alternate,c=u!==null&&u.memoizedState!==null||Ht;u=pr;var m=Ht;if(pr=i,(Ht=c)&&!m)for(De=l;De!==null;)i=De,c=i.child,i.tag===22&&i.memoizedState!==null?vf(l):c!==null?(c.return=i,De=c):vf(l);for(;r!==null;)De=r,ig(r),r=r.sibling;De=l,pr=u,Ht=m}bf(t)}else l.subtreeFlags&8772&&r!==null?(r.return=l,De=r):bf(t)}}function bf(t){for(;De!==null;){var a=De;if(a.flags&8772){var s=a.alternate;try{if(a.flags&8772)switch(a.tag){case 0:case 11:case 15:Ht||vi(5,a);break;case 1:var n=a.stateNode;if(a.flags&4&&!Ht)if(s===null)n.componentDidMount();else{var l=a.elementType===a.type?s.memoizedProps:$a(a.type,s.memoizedProps);n.componentDidUpdate(l,s.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var r=a.updateQueue;r!==null&&af(a,r,n);break;case 3:var i=a.updateQueue;if(i!==null){if(s=null,a.child!==null)switch(a.child.tag){case 5:s=a.child.stateNode;break;case 1:s=a.child.stateNode}af(a,i,s)}break;case 5:var u=a.stateNode;if(s===null&&a.flags&4){s=u;var c=a.memoizedProps;switch(a.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(a.memoizedState===null){var m=a.alternate;if(m!==null){var x=m.memoizedState;if(x!==null){var f=x.dehydrated;f!==null&&Pl(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ge(163))}Ht||a.flags&512&&Mc(a)}catch(j){vt(a,a.return,j)}}if(a===t){De=null;break}if(s=a.sibling,s!==null){s.return=a.return,De=s;break}De=a.return}}function yf(t){for(;De!==null;){var a=De;if(a===t){De=null;break}var s=a.sibling;if(s!==null){s.return=a.return,De=s;break}De=a.return}}function vf(t){for(;De!==null;){var a=De;try{switch(a.tag){case 0:case 11:case 15:var s=a.return;try{vi(4,a)}catch(c){vt(a,s,c)}break;case 1:var n=a.stateNode;if(typeof n.componentDidMount=="function"){var l=a.return;try{n.componentDidMount()}catch(c){vt(a,l,c)}}var r=a.return;try{Mc(a)}catch(c){vt(a,r,c)}break;case 5:var i=a.return;try{Mc(a)}catch(c){vt(a,i,c)}}}catch(c){vt(a,a.return,c)}if(a===t){De=null;break}var u=a.sibling;if(u!==null){u.return=a.return,De=u;break}De=a.return}}var tv=Math.ceil,li=us.ReactCurrentDispatcher,Ed=us.ReactCurrentOwner,Pa=us.ReactCurrentBatchConfig,nt=0,$t=null,wt=null,zt=0,ha=0,Pn=Os(0),At=0,Il=null,en=0,Ni=0,Ad=0,vl=null,na=null,Dd=0,zn=1/0,as=null,ri=!1,Oc=null,As=null,xr=!1,Ss=null,ii=0,Nl=0,Ic=null,$r=-1,Ur=0;function Jt(){return nt&6?St():$r!==-1?$r:$r=St()}function Ds(t){return t.mode&1?nt&2&&zt!==0?zt&-zt:Oy.transition!==null?(Ur===0&&(Ur=Gp()),Ur):(t=ct,t!==0||(t=window.event,t=t===void 0?16:Zp(t.type)),t):1}function Fa(t,a,s,n){if(50<Nl)throw Nl=0,Ic=null,Error(ge(185));Wl(t,s,n),(!(nt&2)||t!==$t)&&(t===$t&&(!(nt&2)&&(Ni|=s),At===4&&Ns(t,zt)),oa(t,n),s===1&&nt===0&&!(a.mode&1)&&(zn=St()+500,ji&&Is()))}function oa(t,a){var s=t.callbackNode;Ob(t,a);var n=Vr(t,t===$t?zt:0);if(n===0)s!==null&&Th(s),t.callbackNode=null,t.callbackPriority=0;else if(a=n&-n,t.callbackPriority!==a){if(s!=null&&Th(s),a===1)t.tag===0?Uy(Nf.bind(null,t)):gx(Nf.bind(null,t)),Ly(function(){!(nt&6)&&Is()}),s=null;else{switch(Hp(n)){case 1:s=nd;break;case 4:s=Wp;break;case 16:s=Wr;break;case 536870912:s=Vp;break;default:s=Wr}s=pg(s,og.bind(null,t))}t.callbackPriority=a,t.callbackNode=s}}function og(t,a){if($r=-1,Ur=0,nt&6)throw Error(ge(327));var s=t.callbackNode;if(Rn()&&t.callbackNode!==s)return null;var n=Vr(t,t===$t?zt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||a)a=oi(t,n);else{a=n;var l=nt;nt|=2;var r=dg();($t!==t||zt!==a)&&(as=null,zn=St()+500,Ys(t,a));do try{nv();break}catch(u){cg(t,u)}while(!0);gd(),li.current=r,nt=l,wt!==null?a=0:($t=null,zt=0,a=At)}if(a!==0){if(a===2&&(l=mc(t),l!==0&&(n=l,a=Fc(t,l))),a===1)throw s=Il,Ys(t,0),Ns(t,n),oa(t,St()),s;if(a===6)Ns(t,n);else{if(l=t.current.alternate,!(n&30)&&!av(l)&&(a=oi(t,n),a===2&&(r=mc(t),r!==0&&(n=r,a=Fc(t,r))),a===1))throw s=Il,Ys(t,0),Ns(t,n),oa(t,St()),s;switch(t.finishedWork=l,t.finishedLanes=n,a){case 0:case 1:throw Error(ge(345));case 2:Gs(t,na,as);break;case 3:if(Ns(t,n),(n&130023424)===n&&(a=Dd+500-St(),10<a)){if(Vr(t,0)!==0)break;if(l=t.suspendedLanes,(l&n)!==n){Jt(),t.pingedLanes|=t.suspendedLanes&l;break}t.timeoutHandle=yc(Gs.bind(null,t,na,as),a);break}Gs(t,na,as);break;case 4:if(Ns(t,n),(n&4194240)===n)break;for(a=t.eventTimes,l=-1;0<n;){var i=31-Ia(n);r=1<<i,i=a[i],i>l&&(l=i),n&=~r}if(n=l,n=St()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*tv(n/1960))-n,10<n){t.timeoutHandle=yc(Gs.bind(null,t,na,as),n);break}Gs(t,na,as);break;case 5:Gs(t,na,as);break;default:throw Error(ge(329))}}}return oa(t,St()),t.callbackNode===s?og.bind(null,t):null}function Fc(t,a){var s=vl;return t.current.memoizedState.isDehydrated&&(Ys(t,a).flags|=256),t=oi(t,a),t!==2&&(a=na,na=s,a!==null&&zc(a)),t}function zc(t){na===null?na=t:na.push.apply(na,t)}function av(t){for(var a=t;;){if(a.flags&16384){var s=a.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var n=0;n<s.length;n++){var l=s[n],r=l.getSnapshot;l=l.value;try{if(!za(r(),l))return!1}catch{return!1}}}if(s=a.child,a.subtreeFlags&16384&&s!==null)s.return=a,a=s;else{if(a===t)break;for(;a.sibling===null;){if(a.return===null||a.return===t)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ns(t,a){for(a&=~Ad,a&=~Ni,t.suspendedLanes|=a,t.pingedLanes&=~a,t=t.expirationTimes;0<a;){var s=31-Ia(a),n=1<<s;t[s]=-1,a&=~n}}function Nf(t){if(nt&6)throw Error(ge(327));Rn();var a=Vr(t,0);if(!(a&1))return oa(t,St()),null;var s=oi(t,a);if(t.tag!==0&&s===2){var n=mc(t);n!==0&&(a=n,s=Fc(t,n))}if(s===1)throw s=Il,Ys(t,0),Ns(t,a),oa(t,St()),s;if(s===6)throw Error(ge(345));return t.finishedWork=t.current.alternate,t.finishedLanes=a,Gs(t,na,as),oa(t,St()),null}function Ld(t,a){var s=nt;nt|=1;try{return t(a)}finally{nt=s,nt===0&&(zn=St()+500,ji&&Is())}}function tn(t){Ss!==null&&Ss.tag===0&&!(nt&6)&&Rn();var a=nt;nt|=1;var s=Pa.transition,n=ct;try{if(Pa.transition=null,ct=1,t)return t()}finally{ct=n,Pa.transition=s,nt=a,!(nt&6)&&Is()}}function Rd(){ha=Pn.current,mt(Pn)}function Ys(t,a){t.finishedWork=null,t.finishedLanes=0;var s=t.timeoutHandle;if(s!==-1&&(t.timeoutHandle=-1,Dy(s)),wt!==null)for(s=wt.return;s!==null;){var n=s;switch(fd(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Yr();break;case 3:In(),mt(ra),mt(Qt),_d();break;case 5:Nd(n);break;case 4:In();break;case 13:mt(xt);break;case 19:mt(xt);break;case 10:jd(n.type._context);break;case 22:case 23:Rd()}s=s.return}if($t=t,wt=t=Ls(t.current,null),zt=ha=a,At=0,Il=null,Ad=Ni=en=0,na=vl=null,Qs!==null){for(a=0;a<Qs.length;a++)if(s=Qs[a],n=s.interleaved,n!==null){s.interleaved=null;var l=n.next,r=s.pending;if(r!==null){var i=r.next;r.next=l,n.next=i}s.pending=n}Qs=null}return t}function cg(t,a){do{var s=wt;try{if(gd(),Lr.current=ni,si){for(var n=gt.memoizedState;n!==null;){var l=n.queue;l!==null&&(l.pending=null),n=n.next}si=!1}if(Xs=0,Mt=Et=gt=null,bl=!1,$l=0,Ed.current=null,s===null||s.return===null){At=1,Il=a,wt=null;break}e:{var r=t,i=s.return,u=s,c=a;if(a=zt,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var m=c,x=u,f=x.tag;if(!(x.mode&1)&&(f===0||f===11||f===15)){var j=x.alternate;j?(x.updateQueue=j.updateQueue,x.memoizedState=j.memoizedState,x.lanes=j.lanes):(x.updateQueue=null,x.memoizedState=null)}var N=cf(i);if(N!==null){N.flags&=-257,df(N,i,u,r,a),N.mode&1&&of(r,m,a),a=N,c=m;var v=a.updateQueue;if(v===null){var _=new Set;_.add(c),a.updateQueue=_}else v.add(c);break e}else{if(!(a&1)){of(r,m,a),Md();break e}c=Error(ge(426))}}else if(ft&&u.mode&1){var C=cf(i);if(C!==null){!(C.flags&65536)&&(C.flags|=256),df(C,i,u,r,a),pd(Fn(c,u));break e}}r=c=Fn(c,u),At!==4&&(At=2),vl===null?vl=[r]:vl.push(r),r=i;do{switch(r.tag){case 3:r.flags|=65536,a&=-a,r.lanes|=a;var y=Hx(r,c,a);tf(r,y);break e;case 1:u=c;var h=r.type,p=r.stateNode;if(!(r.flags&128)&&(typeof h.getDerivedStateFromError=="function"||p!==null&&typeof p.componentDidCatch=="function"&&(As===null||!As.has(p)))){r.flags|=65536,a&=-a,r.lanes|=a;var b=Qx(r,u,a);tf(r,b);break e}}r=r.return}while(r!==null)}mg(s)}catch(P){a=P,wt===s&&s!==null&&(wt=s=s.return);continue}break}while(!0)}function dg(){var t=li.current;return li.current=ni,t===null?ni:t}function Md(){(At===0||At===3||At===2)&&(At=4),$t===null||!(en&268435455)&&!(Ni&268435455)||Ns($t,zt)}function oi(t,a){var s=nt;nt|=2;var n=dg();($t!==t||zt!==a)&&(as=null,Ys(t,a));do try{sv();break}catch(l){cg(t,l)}while(!0);if(gd(),nt=s,li.current=n,wt!==null)throw Error(ge(261));return $t=null,zt=0,At}function sv(){for(;wt!==null;)ug(wt)}function nv(){for(;wt!==null&&!Tb();)ug(wt)}function ug(t){var a=fg(t.alternate,t,ha);t.memoizedProps=t.pendingProps,a===null?mg(t):wt=a,Ed.current=null}function mg(t){var a=t;do{var s=a.alternate;if(t=a.return,a.flags&32768){if(s=Jy(s,a),s!==null){s.flags&=32767,wt=s;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{At=6,wt=null;return}}else if(s=Ky(s,a,ha),s!==null){wt=s;return}if(a=a.sibling,a!==null){wt=a;return}wt=a=t}while(a!==null);At===0&&(At=5)}function Gs(t,a,s){var n=ct,l=Pa.transition;try{Pa.transition=null,ct=1,lv(t,a,s,n)}finally{Pa.transition=l,ct=n}return null}function lv(t,a,s,n){do Rn();while(Ss!==null);if(nt&6)throw Error(ge(327));s=t.finishedWork;var l=t.finishedLanes;if(s===null)return null;if(t.finishedWork=null,t.finishedLanes=0,s===t.current)throw Error(ge(177));t.callbackNode=null,t.callbackPriority=0;var r=s.lanes|s.childLanes;if(Ib(t,r),t===$t&&(wt=$t=null,zt=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||xr||(xr=!0,pg(Wr,function(){return Rn(),null})),r=(s.flags&15990)!==0,s.subtreeFlags&15990||r){r=Pa.transition,Pa.transition=null;var i=ct;ct=1;var u=nt;nt|=4,Ed.current=null,Xy(t,s),rg(s,t),wy(jc),Gr=!!gc,jc=gc=null,t.current=s,ev(s),Eb(),nt=u,ct=i,Pa.transition=r}else t.current=s;if(xr&&(xr=!1,Ss=t,ii=l),r=t.pendingLanes,r===0&&(As=null),Lb(s.stateNode),oa(t,St()),a!==null)for(n=t.onRecoverableError,s=0;s<a.length;s++)l=a[s],n(l.value,{componentStack:l.stack,digest:l.digest});if(ri)throw ri=!1,t=Oc,Oc=null,t;return ii&1&&t.tag!==0&&Rn(),r=t.pendingLanes,r&1?t===Ic?Nl++:(Nl=0,Ic=t):Nl=0,Is(),null}function Rn(){if(Ss!==null){var t=Hp(ii),a=Pa.transition,s=ct;try{if(Pa.transition=null,ct=16>t?16:t,Ss===null)var n=!1;else{if(t=Ss,Ss=null,ii=0,nt&6)throw Error(ge(331));var l=nt;for(nt|=4,De=t.current;De!==null;){var r=De,i=r.child;if(De.flags&16){var u=r.deletions;if(u!==null){for(var c=0;c<u.length;c++){var m=u[c];for(De=m;De!==null;){var x=De;switch(x.tag){case 0:case 11:case 15:yl(8,x,r)}var f=x.child;if(f!==null)f.return=x,De=f;else for(;De!==null;){x=De;var j=x.sibling,N=x.return;if(sg(x),x===m){De=null;break}if(j!==null){j.return=N,De=j;break}De=N}}}var v=r.alternate;if(v!==null){var _=v.child;if(_!==null){v.child=null;do{var C=_.sibling;_.sibling=null,_=C}while(_!==null)}}De=r}}if(r.subtreeFlags&2064&&i!==null)i.return=r,De=i;else e:for(;De!==null;){if(r=De,r.flags&2048)switch(r.tag){case 0:case 11:case 15:yl(9,r,r.return)}var y=r.sibling;if(y!==null){y.return=r.return,De=y;break e}De=r.return}}var h=t.current;for(De=h;De!==null;){i=De;var p=i.child;if(i.subtreeFlags&2064&&p!==null)p.return=i,De=p;else e:for(i=h;De!==null;){if(u=De,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:vi(9,u)}}catch(P){vt(u,u.return,P)}if(u===i){De=null;break e}var b=u.sibling;if(b!==null){b.return=u.return,De=b;break e}De=u.return}}if(nt=l,Is(),Za&&typeof Za.onPostCommitFiberRoot=="function")try{Za.onPostCommitFiberRoot(hi,t)}catch{}n=!0}return n}finally{ct=s,Pa.transition=a}}return!1}function _f(t,a,s){a=Fn(s,a),a=Hx(t,a,1),t=Es(t,a,1),a=Jt(),t!==null&&(Wl(t,1,a),oa(t,a))}function vt(t,a,s){if(t.tag===3)_f(t,t,s);else for(;a!==null;){if(a.tag===3){_f(a,t,s);break}else if(a.tag===1){var n=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(As===null||!As.has(n))){t=Fn(s,t),t=Qx(a,t,1),a=Es(a,t,1),t=Jt(),a!==null&&(Wl(a,1,t),oa(a,t));break}}a=a.return}}function rv(t,a,s){var n=t.pingCache;n!==null&&n.delete(a),a=Jt(),t.pingedLanes|=t.suspendedLanes&s,$t===t&&(zt&s)===s&&(At===4||At===3&&(zt&130023424)===zt&&500>St()-Dd?Ys(t,0):Ad|=s),oa(t,a)}function hg(t,a){a===0&&(t.mode&1?(a=rr,rr<<=1,!(rr&130023424)&&(rr=4194304)):a=1);var s=Jt();t=cs(t,a),t!==null&&(Wl(t,a,s),oa(t,s))}function iv(t){var a=t.memoizedState,s=0;a!==null&&(s=a.retryLane),hg(t,s)}function ov(t,a){var s=0;switch(t.tag){case 13:var n=t.stateNode,l=t.memoizedState;l!==null&&(s=l.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ge(314))}n!==null&&n.delete(a),hg(t,s)}var fg;fg=function(t,a,s){if(t!==null)if(t.memoizedProps!==a.pendingProps||ra.current)la=!0;else{if(!(t.lanes&s)&&!(a.flags&128))return la=!1,Yy(t,a,s);la=!!(t.flags&131072)}else la=!1,ft&&a.flags&1048576&&jx(a,Zr,a.index);switch(a.lanes=0,a.tag){case 2:var n=a.type;Mr(t,a),t=a.pendingProps;var l=$n(a,Qt.current);Ln(a,s),l=wd(null,a,n,t,l,s);var r=Cd();return a.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,ia(n)?(r=!0,Kr(a)):r=!1,a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,yd(a),l.updater=yi,a.stateNode=l,l._reactInternals=a,kc(a,n,t,s),a=Ec(null,a,n,!0,r,s)):(a.tag=0,ft&&r&&hd(a),Kt(null,a,l,s),a=a.child),a;case 16:n=a.elementType;e:{switch(Mr(t,a),t=a.pendingProps,l=n._init,n=l(n._payload),a.type=n,l=a.tag=dv(n),t=$a(n,t),l){case 0:a=Tc(null,a,n,t,s);break e;case 1:a=hf(null,a,n,t,s);break e;case 11:a=uf(null,a,n,t,s);break e;case 14:a=mf(null,a,n,$a(n.type,t),s);break e}throw Error(ge(306,n,""))}return a;case 0:return n=a.type,l=a.pendingProps,l=a.elementType===n?l:$a(n,l),Tc(t,a,n,l,s);case 1:return n=a.type,l=a.pendingProps,l=a.elementType===n?l:$a(n,l),hf(t,a,n,l,s);case 3:e:{if(Jx(a),t===null)throw Error(ge(387));n=a.pendingProps,r=a.memoizedState,l=r.element,Sx(t,a),ti(a,n,null,s);var i=a.memoizedState;if(n=i.element,r.isDehydrated)if(r={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},a.updateQueue.baseState=r,a.memoizedState=r,a.flags&256){l=Fn(Error(ge(423)),a),a=ff(t,a,n,s,l);break e}else if(n!==l){l=Fn(Error(ge(424)),a),a=ff(t,a,n,s,l);break e}else for(fa=Ts(a.stateNode.containerInfo.firstChild),pa=a,ft=!0,Oa=null,s=Nx(a,null,n,s),a.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Un(),n===l){a=ds(t,a,s);break e}Kt(t,a,n,s)}a=a.child}return a;case 5:return wx(a),t===null&&Sc(a),n=a.type,l=a.pendingProps,r=t!==null?t.memoizedProps:null,i=l.children,bc(n,l)?i=null:r!==null&&bc(n,r)&&(a.flags|=32),Kx(t,a),Kt(t,a,i,s),a.child;case 6:return t===null&&Sc(a),null;case 13:return Zx(t,a,s);case 4:return vd(a,a.stateNode.containerInfo),n=a.pendingProps,t===null?a.child=On(a,null,n,s):Kt(t,a,n,s),a.child;case 11:return n=a.type,l=a.pendingProps,l=a.elementType===n?l:$a(n,l),uf(t,a,n,l,s);case 7:return Kt(t,a,a.pendingProps,s),a.child;case 8:return Kt(t,a,a.pendingProps.children,s),a.child;case 12:return Kt(t,a,a.pendingProps.children,s),a.child;case 10:e:{if(n=a.type._context,l=a.pendingProps,r=a.memoizedProps,i=l.value,dt(Xr,n._currentValue),n._currentValue=i,r!==null)if(za(r.value,i)){if(r.children===l.children&&!ra.current){a=ds(t,a,s);break e}}else for(r=a.child,r!==null&&(r.return=a);r!==null;){var u=r.dependencies;if(u!==null){i=r.child;for(var c=u.firstContext;c!==null;){if(c.context===n){if(r.tag===1){c=rs(-1,s&-s),c.tag=2;var m=r.updateQueue;if(m!==null){m=m.shared;var x=m.pending;x===null?c.next=c:(c.next=x.next,x.next=c),m.pending=c}}r.lanes|=s,c=r.alternate,c!==null&&(c.lanes|=s),wc(r.return,s,a),u.lanes|=s;break}c=c.next}}else if(r.tag===10)i=r.type===a.type?null:r.child;else if(r.tag===18){if(i=r.return,i===null)throw Error(ge(341));i.lanes|=s,u=i.alternate,u!==null&&(u.lanes|=s),wc(i,s,a),i=r.sibling}else i=r.child;if(i!==null)i.return=r;else for(i=r;i!==null;){if(i===a){i=null;break}if(r=i.sibling,r!==null){r.return=i.return,i=r;break}i=i.return}r=i}Kt(t,a,l.children,s),a=a.child}return a;case 9:return l=a.type,n=a.pendingProps.children,Ln(a,s),l=Ta(l),n=n(l),a.flags|=1,Kt(t,a,n,s),a.child;case 14:return n=a.type,l=$a(n,a.pendingProps),l=$a(n.type,l),mf(t,a,n,l,s);case 15:return qx(t,a,a.type,a.pendingProps,s);case 17:return n=a.type,l=a.pendingProps,l=a.elementType===n?l:$a(n,l),Mr(t,a),a.tag=1,ia(n)?(t=!0,Kr(a)):t=!1,Ln(a,s),Gx(a,n,l),kc(a,n,l,s),Ec(null,a,n,!0,t,s);case 19:return Xx(t,a,s);case 22:return Yx(t,a,s)}throw Error(ge(156,a.tag))};function pg(t,a){return Bp(t,a)}function cv(t,a,s,n){this.tag=t,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ka(t,a,s,n){return new cv(t,a,s,n)}function $d(t){return t=t.prototype,!(!t||!t.isReactComponent)}function dv(t){if(typeof t=="function")return $d(t)?1:0;if(t!=null){if(t=t.$$typeof,t===td)return 11;if(t===ad)return 14}return 2}function Ls(t,a){var s=t.alternate;return s===null?(s=ka(t.tag,a,t.key,t.mode),s.elementType=t.elementType,s.type=t.type,s.stateNode=t.stateNode,s.alternate=t,t.alternate=s):(s.pendingProps=a,s.type=t.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=t.flags&14680064,s.childLanes=t.childLanes,s.lanes=t.lanes,s.child=t.child,s.memoizedProps=t.memoizedProps,s.memoizedState=t.memoizedState,s.updateQueue=t.updateQueue,a=t.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},s.sibling=t.sibling,s.index=t.index,s.ref=t.ref,s}function Or(t,a,s,n,l,r){var i=2;if(n=t,typeof t=="function")$d(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case jn:return Ks(s.children,l,r,a);case ed:i=8,l|=8;break;case Jo:return t=ka(12,s,a,l|2),t.elementType=Jo,t.lanes=r,t;case Zo:return t=ka(13,s,a,l),t.elementType=Zo,t.lanes=r,t;case Xo:return t=ka(19,s,a,l),t.elementType=Xo,t.lanes=r,t;case wp:return _i(s,l,r,a);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _p:i=10;break e;case Sp:i=9;break e;case td:i=11;break e;case ad:i=14;break e;case bs:i=16,n=null;break e}throw Error(ge(130,t==null?t:typeof t,""))}return a=ka(i,s,a,l),a.elementType=t,a.type=n,a.lanes=r,a}function Ks(t,a,s,n){return t=ka(7,t,n,a),t.lanes=s,t}function _i(t,a,s,n){return t=ka(22,t,n,a),t.elementType=wp,t.lanes=s,t.stateNode={isHidden:!1},t}function Eo(t,a,s){return t=ka(6,t,null,a),t.lanes=s,t}function Ao(t,a,s){return a=ka(4,t.children!==null?t.children:[],t.key,a),a.lanes=s,a.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},a}function uv(t,a,s,n,l){this.tag=a,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=uo(0),this.expirationTimes=uo(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=uo(0),this.identifierPrefix=n,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Ud(t,a,s,n,l,r,i,u,c){return t=new uv(t,a,s,u,c),a===1?(a=1,r===!0&&(a|=8)):a=0,r=ka(3,null,null,a),t.current=r,r.stateNode=t,r.memoizedState={element:n,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},yd(r),t}function mv(t,a,s){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:gn,key:n==null?null:""+n,children:t,containerInfo:a,implementation:s}}function xg(t){if(!t)return $s;t=t._reactInternals;e:{if(sn(t)!==t||t.tag!==1)throw Error(ge(170));var a=t;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(ia(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(ge(171))}if(t.tag===1){var s=t.type;if(ia(s))return xx(t,s,a)}return a}function gg(t,a,s,n,l,r,i,u,c){return t=Ud(s,n,!0,t,l,r,i,u,c),t.context=xg(null),s=t.current,n=Jt(),l=Ds(s),r=rs(n,l),r.callback=a??null,Es(s,r,l),t.current.lanes=l,Wl(t,l,n),oa(t,n),t}function Si(t,a,s,n){var l=a.current,r=Jt(),i=Ds(l);return s=xg(s),a.context===null?a.context=s:a.pendingContext=s,a=rs(r,i),a.payload={element:t},n=n===void 0?null:n,n!==null&&(a.callback=n),t=Es(l,a,i),t!==null&&(Fa(t,l,i,r),Dr(t,l,i)),i}function ci(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Sf(t,a){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var s=t.retryLane;t.retryLane=s!==0&&s<a?s:a}}function Od(t,a){Sf(t,a),(t=t.alternate)&&Sf(t,a)}function hv(){return null}var jg=typeof reportError=="function"?reportError:function(t){console.error(t)};function Id(t){this._internalRoot=t}wi.prototype.render=Id.prototype.render=function(t){var a=this._internalRoot;if(a===null)throw Error(ge(409));Si(t,a,null,null)};wi.prototype.unmount=Id.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var a=t.containerInfo;tn(function(){Si(null,t,null,null)}),a[os]=null}};function wi(t){this._internalRoot=t}wi.prototype.unstable_scheduleHydration=function(t){if(t){var a=Yp();t={blockedOn:null,target:t,priority:a};for(var s=0;s<vs.length&&a!==0&&a<vs[s].priority;s++);vs.splice(s,0,t),s===0&&Jp(t)}};function Fd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ci(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function wf(){}function fv(t,a,s,n,l){if(l){if(typeof n=="function"){var r=n;n=function(){var m=ci(i);r.call(m)}}var i=gg(a,n,t,0,null,!1,!1,"",wf);return t._reactRootContainer=i,t[os]=i.current,Al(t.nodeType===8?t.parentNode:t),tn(),i}for(;l=t.lastChild;)t.removeChild(l);if(typeof n=="function"){var u=n;n=function(){var m=ci(c);u.call(m)}}var c=Ud(t,0,!1,null,null,!1,!1,"",wf);return t._reactRootContainer=c,t[os]=c.current,Al(t.nodeType===8?t.parentNode:t),tn(function(){Si(a,c,s,n)}),c}function ki(t,a,s,n,l){var r=s._reactRootContainer;if(r){var i=r;if(typeof l=="function"){var u=l;l=function(){var c=ci(i);u.call(c)}}Si(a,i,t,l)}else i=fv(s,a,t,l,n);return ci(i)}Qp=function(t){switch(t.tag){case 3:var a=t.stateNode;if(a.current.memoizedState.isDehydrated){var s=ul(a.pendingLanes);s!==0&&(ld(a,s|1),oa(a,St()),!(nt&6)&&(zn=St()+500,Is()))}break;case 13:tn(function(){var n=cs(t,1);if(n!==null){var l=Jt();Fa(n,t,1,l)}}),Od(t,1)}};rd=function(t){if(t.tag===13){var a=cs(t,134217728);if(a!==null){var s=Jt();Fa(a,t,134217728,s)}Od(t,134217728)}};qp=function(t){if(t.tag===13){var a=Ds(t),s=cs(t,a);if(s!==null){var n=Jt();Fa(s,t,a,n)}Od(t,a)}};Yp=function(){return ct};Kp=function(t,a){var s=ct;try{return ct=t,a()}finally{ct=s}};cc=function(t,a,s){switch(a){case"input":if(ac(t,s),a=s.name,s.type==="radio"&&a!=null){for(s=t;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+a)+'][type="radio"]'),a=0;a<s.length;a++){var n=s[a];if(n!==t&&n.form===t.form){var l=gi(n);if(!l)throw Error(ge(90));kp(n),ac(n,l)}}}break;case"textarea":Tp(t,s);break;case"select":a=s.value,a!=null&&Tn(t,!!s.multiple,a,!1)}};$p=Ld;Up=tn;var pv={usingClientEntryPoint:!1,Events:[Gl,Nn,gi,Rp,Mp,Ld]},nl={findFiberByHostInstance:Hs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xv={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:us.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Fp(t),t===null?null:t.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||hv,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gr=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gr.isDisabled&&gr.supportsFiber)try{hi=gr.inject(xv),Za=gr}catch{}}ga.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pv;ga.createPortal=function(t,a){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fd(a))throw Error(ge(200));return mv(t,a,null,s)};ga.createRoot=function(t,a){if(!Fd(t))throw Error(ge(299));var s=!1,n="",l=jg;return a!=null&&(a.unstable_strictMode===!0&&(s=!0),a.identifierPrefix!==void 0&&(n=a.identifierPrefix),a.onRecoverableError!==void 0&&(l=a.onRecoverableError)),a=Ud(t,1,!1,null,null,s,!1,n,l),t[os]=a.current,Al(t.nodeType===8?t.parentNode:t),new Id(a)};ga.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var a=t._reactInternals;if(a===void 0)throw typeof t.render=="function"?Error(ge(188)):(t=Object.keys(t).join(","),Error(ge(268,t)));return t=Fp(a),t=t===null?null:t.stateNode,t};ga.flushSync=function(t){return tn(t)};ga.hydrate=function(t,a,s){if(!Ci(a))throw Error(ge(200));return ki(null,t,a,!0,s)};ga.hydrateRoot=function(t,a,s){if(!Fd(t))throw Error(ge(405));var n=s!=null&&s.hydratedSources||null,l=!1,r="",i=jg;if(s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(r=s.identifierPrefix),s.onRecoverableError!==void 0&&(i=s.onRecoverableError)),a=gg(a,null,t,1,s??null,l,!1,r,i),t[os]=a.current,Al(t),n)for(t=0;t<n.length;t++)s=n[t],l=s._getVersion,l=l(s._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[s,l]:a.mutableSourceEagerHydrationData.push(s,l);return new wi(a)};ga.render=function(t,a,s){if(!Ci(a))throw Error(ge(200));return ki(null,t,a,!1,s)};ga.unmountComponentAtNode=function(t){if(!Ci(t))throw Error(ge(40));return t._reactRootContainer?(tn(function(){ki(null,null,t,!1,function(){t._reactRootContainer=null,t[os]=null})}),!0):!1};ga.unstable_batchedUpdates=Ld;ga.unstable_renderSubtreeIntoContainer=function(t,a,s,n){if(!Ci(s))throw Error(ge(200));if(t==null||t._reactInternals===void 0)throw Error(ge(38));return ki(t,a,s,!1,n)};ga.version="18.3.1-next-f1338f8080-20240426";function bg(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(bg)}catch(t){console.error(t)}}bg(),bp.exports=ga;var gv=bp.exports,Cf=gv;Yo.createRoot=Cf.createRoot,Yo.hydrateRoot=Cf.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fl(){return Fl=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},Fl.apply(this,arguments)}var ws;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ws||(ws={}));const kf="popstate";function jv(t){t===void 0&&(t={});function a(n,l){let{pathname:r,search:i,hash:u}=n.location;return Bc("",{pathname:r,search:i,hash:u},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function s(n,l){return typeof l=="string"?l:di(l)}return yv(a,s,null,t)}function jt(t,a){if(t===!1||t===null||typeof t>"u")throw new Error(a)}function zd(t,a){if(!t){typeof console<"u"&&console.warn(a);try{throw new Error(a)}catch{}}}function bv(){return Math.random().toString(36).substr(2,8)}function Pf(t,a){return{usr:t.state,key:t.key,idx:a}}function Bc(t,a,s,n){return s===void 0&&(s=null),Fl({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof a=="string"?Hn(a):a,{state:s,key:a&&a.key||n||bv()})}function di(t){let{pathname:a="/",search:s="",hash:n=""}=t;return s&&s!=="?"&&(a+=s.charAt(0)==="?"?s:"?"+s),n&&n!=="#"&&(a+=n.charAt(0)==="#"?n:"#"+n),a}function Hn(t){let a={};if(t){let s=t.indexOf("#");s>=0&&(a.hash=t.substr(s),t=t.substr(0,s));let n=t.indexOf("?");n>=0&&(a.search=t.substr(n),t=t.substr(0,n)),t&&(a.pathname=t)}return a}function yv(t,a,s,n){n===void 0&&(n={});let{window:l=document.defaultView,v5Compat:r=!1}=n,i=l.history,u=ws.Pop,c=null,m=x();m==null&&(m=0,i.replaceState(Fl({},i.state,{idx:m}),""));function x(){return(i.state||{idx:null}).idx}function f(){u=ws.Pop;let C=x(),y=C==null?null:C-m;m=C,c&&c({action:u,location:_.location,delta:y})}function j(C,y){u=ws.Push;let h=Bc(_.location,C,y);m=x()+1;let p=Pf(h,m),b=_.createHref(h);try{i.pushState(p,"",b)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;l.location.assign(b)}r&&c&&c({action:u,location:_.location,delta:1})}function N(C,y){u=ws.Replace;let h=Bc(_.location,C,y);m=x();let p=Pf(h,m),b=_.createHref(h);i.replaceState(p,"",b),r&&c&&c({action:u,location:_.location,delta:0})}function v(C){let y=l.location.origin!=="null"?l.location.origin:l.location.href,h=typeof C=="string"?C:di(C);return h=h.replace(/ $/,"%20"),jt(y,"No window.location.(origin|href) available to create URL for href: "+h),new URL(h,y)}let _={get action(){return u},get location(){return t(l,i)},listen(C){if(c)throw new Error("A history only accepts one active listener");return l.addEventListener(kf,f),c=C,()=>{l.removeEventListener(kf,f),c=null}},createHref(C){return a(l,C)},createURL:v,encodeLocation(C){let y=v(C);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:j,replace:N,go(C){return i.go(C)}};return _}var Tf;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Tf||(Tf={}));function vv(t,a,s){return s===void 0&&(s="/"),Nv(t,a,s)}function Nv(t,a,s,n){let l=typeof a=="string"?Hn(a):a,r=Bn(l.pathname||"/",s);if(r==null)return null;let i=yg(t);_v(i);let u=null;for(let c=0;u==null&&c<i.length;++c){let m=Rv(r);u=Dv(i[c],m)}return u}function yg(t,a,s,n){a===void 0&&(a=[]),s===void 0&&(s=[]),n===void 0&&(n="");let l=(r,i,u)=>{let c={relativePath:u===void 0?r.path||"":u,caseSensitive:r.caseSensitive===!0,childrenIndex:i,route:r};c.relativePath.startsWith("/")&&(jt(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let m=Rs([n,c.relativePath]),x=s.concat(c);r.children&&r.children.length>0&&(jt(r.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+m+'".')),yg(r.children,a,x,m)),!(r.path==null&&!r.index)&&a.push({path:m,score:Ev(m,r.index),routesMeta:x})};return t.forEach((r,i)=>{var u;if(r.path===""||!((u=r.path)!=null&&u.includes("?")))l(r,i);else for(let c of vg(r.path))l(r,i,c)}),a}function vg(t){let a=t.split("/");if(a.length===0)return[];let[s,...n]=a,l=s.endsWith("?"),r=s.replace(/\?$/,"");if(n.length===0)return l?[r,""]:[r];let i=vg(n.join("/")),u=[];return u.push(...i.map(c=>c===""?r:[r,c].join("/"))),l&&u.push(...i),u.map(c=>t.startsWith("/")&&c===""?"/":c)}function _v(t){t.sort((a,s)=>a.score!==s.score?s.score-a.score:Av(a.routesMeta.map(n=>n.childrenIndex),s.routesMeta.map(n=>n.childrenIndex)))}const Sv=/^:[\w-]+$/,wv=3,Cv=2,kv=1,Pv=10,Tv=-2,Ef=t=>t==="*";function Ev(t,a){let s=t.split("/"),n=s.length;return s.some(Ef)&&(n+=Tv),a&&(n+=Cv),s.filter(l=>!Ef(l)).reduce((l,r)=>l+(Sv.test(r)?wv:r===""?kv:Pv),n)}function Av(t,a){return t.length===a.length&&t.slice(0,-1).every((n,l)=>n===a[l])?t[t.length-1]-a[a.length-1]:0}function Dv(t,a,s){let{routesMeta:n}=t,l={},r="/",i=[];for(let u=0;u<n.length;++u){let c=n[u],m=u===n.length-1,x=r==="/"?a:a.slice(r.length)||"/",f=Wc({path:c.relativePath,caseSensitive:c.caseSensitive,end:m},x),j=c.route;if(!f)return null;Object.assign(l,f.params),i.push({params:l,pathname:Rs([r,f.pathname]),pathnameBase:Iv(Rs([r,f.pathnameBase])),route:j}),f.pathnameBase!=="/"&&(r=Rs([r,f.pathnameBase]))}return i}function Wc(t,a){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[s,n]=Lv(t.path,t.caseSensitive,t.end),l=a.match(s);if(!l)return null;let r=l[0],i=r.replace(/(.)\/+$/,"$1"),u=l.slice(1);return{params:n.reduce((m,x,f)=>{let{paramName:j,isOptional:N}=x;if(j==="*"){let _=u[f]||"";i=r.slice(0,r.length-_.length).replace(/(.)\/+$/,"$1")}const v=u[f];return N&&!v?m[j]=void 0:m[j]=(v||"").replace(/%2F/g,"/"),m},{}),pathname:r,pathnameBase:i,pattern:t}}function Lv(t,a,s){a===void 0&&(a=!1),s===void 0&&(s=!0),zd(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],l="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,u,c)=>(n.push({paramName:u,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),l+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?l+="\\/*$":t!==""&&t!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,a?void 0:"i"),n]}function Rv(t){try{return t.split("/").map(a=>decodeURIComponent(a).replace(/\//g,"%2F")).join("/")}catch(a){return zd(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+a+").")),t}}function Bn(t,a){if(a==="/")return t;if(!t.toLowerCase().startsWith(a.toLowerCase()))return null;let s=a.endsWith("/")?a.length-1:a.length,n=t.charAt(s);return n&&n!=="/"?null:t.slice(s)||"/"}const Mv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$v=t=>Mv.test(t);function Uv(t,a){a===void 0&&(a="/");let{pathname:s,search:n="",hash:l=""}=typeof t=="string"?Hn(t):t,r;if(s)if($v(s))r=s;else{if(s.includes("//")){let i=s;s=s.replace(/\/\/+/g,"/"),zd(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+s))}s.startsWith("/")?r=Af(s.substring(1),"/"):r=Af(s,a)}else r=a;return{pathname:r,search:Fv(n),hash:zv(l)}}function Af(t,a){let s=a.replace(/\/+$/,"").split("/");return t.split("/").forEach(l=>{l===".."?s.length>1&&s.pop():l!=="."&&s.push(l)}),s.length>1?s.join("/"):"/"}function Do(t,a,s,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+a+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+s+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Ov(t){return t.filter((a,s)=>s===0||a.route.path&&a.route.path.length>0)}function Bd(t,a){let s=Ov(t);return a?s.map((n,l)=>l===s.length-1?n.pathname:n.pathnameBase):s.map(n=>n.pathnameBase)}function Wd(t,a,s,n){n===void 0&&(n=!1);let l;typeof t=="string"?l=Hn(t):(l=Fl({},t),jt(!l.pathname||!l.pathname.includes("?"),Do("?","pathname","search",l)),jt(!l.pathname||!l.pathname.includes("#"),Do("#","pathname","hash",l)),jt(!l.search||!l.search.includes("#"),Do("#","search","hash",l)));let r=t===""||l.pathname==="",i=r?"/":l.pathname,u;if(i==null)u=s;else{let f=a.length-1;if(!n&&i.startsWith("..")){let j=i.split("/");for(;j[0]==="..";)j.shift(),f-=1;l.pathname=j.join("/")}u=f>=0?a[f]:"/"}let c=Uv(l,u),m=i&&i!=="/"&&i.endsWith("/"),x=(r||i===".")&&s.endsWith("/");return!c.pathname.endsWith("/")&&(m||x)&&(c.pathname+="/"),c}const Rs=t=>t.join("/").replace(/\/\/+/g,"/"),Iv=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Fv=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,zv=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Bv(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Ng=["post","put","patch","delete"];new Set(Ng);const Wv=["get",...Ng];new Set(Wv);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zl(){return zl=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},zl.apply(this,arguments)}const Pi=o.createContext(null),_g=o.createContext(null),ms=o.createContext(null),Ti=o.createContext(null),hs=o.createContext({outlet:null,matches:[],isDataRoute:!1}),Sg=o.createContext(null);function Vv(t,a){let{relative:s}=a===void 0?{}:a;Qn()||jt(!1);let{basename:n,navigator:l}=o.useContext(ms),{hash:r,pathname:i,search:u}=Ei(t,{relative:s}),c=i;return n!=="/"&&(c=i==="/"?n:Rs([n,i])),l.createHref({pathname:c,search:u,hash:r})}function Qn(){return o.useContext(Ti)!=null}function ba(){return Qn()||jt(!1),o.useContext(Ti).location}function wg(t){o.useContext(ms).static||o.useLayoutEffect(t)}function fs(){let{isDataRoute:t}=o.useContext(hs);return t?sN():Gv()}function Gv(){Qn()||jt(!1);let t=o.useContext(Pi),{basename:a,future:s,navigator:n}=o.useContext(ms),{matches:l}=o.useContext(hs),{pathname:r}=ba(),i=JSON.stringify(Bd(l,s.v7_relativeSplatPath)),u=o.useRef(!1);return wg(()=>{u.current=!0}),o.useCallback(function(m,x){if(x===void 0&&(x={}),!u.current)return;if(typeof m=="number"){n.go(m);return}let f=Wd(m,JSON.parse(i),r,x.relative==="path");t==null&&a!=="/"&&(f.pathname=f.pathname==="/"?a:Rs([a,f.pathname])),(x.replace?n.replace:n.push)(f,x.state,x)},[a,n,i,r,t])}function ps(){let{matches:t}=o.useContext(hs),a=t[t.length-1];return a?a.params:{}}function Ei(t,a){let{relative:s}=a===void 0?{}:a,{future:n}=o.useContext(ms),{matches:l}=o.useContext(hs),{pathname:r}=ba(),i=JSON.stringify(Bd(l,n.v7_relativeSplatPath));return o.useMemo(()=>Wd(t,JSON.parse(i),r,s==="path"),[t,i,r,s])}function Hv(t,a){return Qv(t,a)}function Qv(t,a,s,n){Qn()||jt(!1);let{navigator:l}=o.useContext(ms),{matches:r}=o.useContext(hs),i=r[r.length-1],u=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let m=ba(),x;if(a){var f;let C=typeof a=="string"?Hn(a):a;c==="/"||(f=C.pathname)!=null&&f.startsWith(c)||jt(!1),x=C}else x=m;let j=x.pathname||"/",N=j;if(c!=="/"){let C=c.replace(/^\//,"").split("/");N="/"+j.replace(/^\//,"").split("/").slice(C.length).join("/")}let v=vv(t,{pathname:N}),_=Zv(v&&v.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:Rs([c,l.encodeLocation?l.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?c:Rs([c,l.encodeLocation?l.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),r,s,n);return a&&_?o.createElement(Ti.Provider,{value:{location:zl({pathname:"/",search:"",hash:"",state:null,key:"default"},x),navigationType:ws.Pop}},_):_}function qv(){let t=aN(),a=Bv(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),s=t instanceof Error?t.stack:null,l={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return o.createElement(o.Fragment,null,o.createElement("h2",null,"Unexpected Application Error!"),o.createElement("h3",{style:{fontStyle:"italic"}},a),s?o.createElement("pre",{style:l},s):null,null)}const Yv=o.createElement(qv,null);class Kv extends o.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,s){return s.location!==a.location||s.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:s.error,location:s.location,revalidation:a.revalidation||s.revalidation}}componentDidCatch(a,s){console.error("React Router caught the following error during render",a,s)}render(){return this.state.error!==void 0?o.createElement(hs.Provider,{value:this.props.routeContext},o.createElement(Sg.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Jv(t){let{routeContext:a,match:s,children:n}=t,l=o.useContext(Pi);return l&&l.static&&l.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(l.staticContext._deepestRenderedBoundaryId=s.route.id),o.createElement(hs.Provider,{value:a},n)}function Zv(t,a,s,n){var l;if(a===void 0&&(a=[]),s===void 0&&(s=null),n===void 0&&(n=null),t==null){var r;if(!s)return null;if(s.errors)t=s.matches;else if((r=n)!=null&&r.v7_partialHydration&&a.length===0&&!s.initialized&&s.matches.length>0)t=s.matches;else return null}let i=t,u=(l=s)==null?void 0:l.errors;if(u!=null){let x=i.findIndex(f=>f.route.id&&(u==null?void 0:u[f.route.id])!==void 0);x>=0||jt(!1),i=i.slice(0,Math.min(i.length,x+1))}let c=!1,m=-1;if(s&&n&&n.v7_partialHydration)for(let x=0;x<i.length;x++){let f=i[x];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(m=x),f.route.id){let{loaderData:j,errors:N}=s,v=f.route.loader&&j[f.route.id]===void 0&&(!N||N[f.route.id]===void 0);if(f.route.lazy||v){c=!0,m>=0?i=i.slice(0,m+1):i=[i[0]];break}}}return i.reduceRight((x,f,j)=>{let N,v=!1,_=null,C=null;s&&(N=u&&f.route.id?u[f.route.id]:void 0,_=f.route.errorElement||Yv,c&&(m<0&&j===0?(nN("route-fallback"),v=!0,C=null):m===j&&(v=!0,C=f.route.hydrateFallbackElement||null)));let y=a.concat(i.slice(0,j+1)),h=()=>{let p;return N?p=_:v?p=C:f.route.Component?p=o.createElement(f.route.Component,null):f.route.element?p=f.route.element:p=x,o.createElement(Jv,{match:f,routeContext:{outlet:x,matches:y,isDataRoute:s!=null},children:p})};return s&&(f.route.ErrorBoundary||f.route.errorElement||j===0)?o.createElement(Kv,{location:s.location,revalidation:s.revalidation,component:_,error:N,children:h(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):h()},null)}var Cg=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Cg||{}),kg=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(kg||{});function Xv(t){let a=o.useContext(Pi);return a||jt(!1),a}function eN(t){let a=o.useContext(_g);return a||jt(!1),a}function tN(t){let a=o.useContext(hs);return a||jt(!1),a}function Pg(t){let a=tN(),s=a.matches[a.matches.length-1];return s.route.id||jt(!1),s.route.id}function aN(){var t;let a=o.useContext(Sg),s=eN(),n=Pg();return a!==void 0?a:(t=s.errors)==null?void 0:t[n]}function sN(){let{router:t}=Xv(Cg.UseNavigateStable),a=Pg(kg.UseNavigateStable),s=o.useRef(!1);return wg(()=>{s.current=!0}),o.useCallback(function(l,r){r===void 0&&(r={}),s.current&&(typeof l=="number"?t.navigate(l):t.navigate(l,zl({fromRouteId:a},r)))},[t,a])}const Df={};function nN(t,a,s){Df[t]||(Df[t]=!0)}function lN(t,a){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function $e(t){let{to:a,replace:s,state:n,relative:l}=t;Qn()||jt(!1);let{future:r,static:i}=o.useContext(ms),{matches:u}=o.useContext(hs),{pathname:c}=ba(),m=fs(),x=Wd(a,Bd(u,r.v7_relativeSplatPath),c,l==="path"),f=JSON.stringify(x);return o.useEffect(()=>m(JSON.parse(f),{replace:s,state:n,relative:l}),[m,f,l,s,n]),null}function Ue(t){jt(!1)}function rN(t){let{basename:a="/",children:s=null,location:n,navigationType:l=ws.Pop,navigator:r,static:i=!1,future:u}=t;Qn()&&jt(!1);let c=a.replace(/^\/*/,"/"),m=o.useMemo(()=>({basename:c,navigator:r,static:i,future:zl({v7_relativeSplatPath:!1},u)}),[c,u,r,i]);typeof n=="string"&&(n=Hn(n));let{pathname:x="/",search:f="",hash:j="",state:N=null,key:v="default"}=n,_=o.useMemo(()=>{let C=Bn(x,c);return C==null?null:{location:{pathname:C,search:f,hash:j,state:N,key:v},navigationType:l}},[c,x,f,j,N,v,l]);return _==null?null:o.createElement(ms.Provider,{value:m},o.createElement(Ti.Provider,{children:s,value:_}))}function iN(t){let{children:a,location:s}=t;return Hv(Vc(a),s)}new Promise(()=>{});function Vc(t,a){a===void 0&&(a=[]);let s=[];return o.Children.forEach(t,(n,l)=>{if(!o.isValidElement(n))return;let r=[...a,l];if(n.type===o.Fragment){s.push.apply(s,Vc(n.props.children,r));return}n.type!==Ue&&jt(!1),!n.props.index||!n.props.children||jt(!1);let i={id:n.props.id||r.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Vc(n.props.children,r)),s.push(i)}),s}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ui(){return ui=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},ui.apply(this,arguments)}function Tg(t,a){if(t==null)return{};var s={},n=Object.keys(t),l,r;for(r=0;r<n.length;r++)l=n[r],!(a.indexOf(l)>=0)&&(s[l]=t[l]);return s}function oN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function cN(t,a){return t.button===0&&(!a||a==="_self")&&!oN(t)}const dN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],uN=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],mN="6";try{window.__reactRouterVersion=mN}catch{}const hN=o.createContext({isTransitioning:!1}),fN="startTransition",Lf=rb[fN];function pN(t){let{basename:a,children:s,future:n,window:l}=t,r=o.useRef();r.current==null&&(r.current=jv({window:l,v5Compat:!0}));let i=r.current,[u,c]=o.useState({action:i.action,location:i.location}),{v7_startTransition:m}=n||{},x=o.useCallback(f=>{m&&Lf?Lf(()=>c(f)):c(f)},[c,m]);return o.useLayoutEffect(()=>i.listen(x),[i,x]),o.useEffect(()=>lN(n),[n]),o.createElement(rN,{basename:a,children:s,location:u.location,navigationType:u.action,navigator:i,future:n})}const xN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,et=o.forwardRef(function(a,s){let{onClick:n,relative:l,reloadDocument:r,replace:i,state:u,target:c,to:m,preventScrollReset:x,viewTransition:f}=a,j=Tg(a,dN),{basename:N}=o.useContext(ms),v,_=!1;if(typeof m=="string"&&gN.test(m)&&(v=m,xN))try{let p=new URL(window.location.href),b=m.startsWith("//")?new URL(p.protocol+m):new URL(m),P=Bn(b.pathname,N);b.origin===p.origin&&P!=null?m=P+b.search+b.hash:_=!0}catch{}let C=Vv(m,{relative:l}),y=bN(m,{replace:i,state:u,target:c,preventScrollReset:x,relative:l,viewTransition:f});function h(p){n&&n(p),p.defaultPrevented||y(p)}return o.createElement("a",ui({},j,{href:v||C,onClick:_||r?n:h,ref:s,target:c}))}),Lo=o.forwardRef(function(a,s){let{"aria-current":n="page",caseSensitive:l=!1,className:r="",end:i=!1,style:u,to:c,viewTransition:m,children:x}=a,f=Tg(a,uN),j=Ei(c,{relative:f.relative}),N=ba(),v=o.useContext(_g),{navigator:_,basename:C}=o.useContext(ms),y=v!=null&&yN(j)&&m===!0,h=_.encodeLocation?_.encodeLocation(j).pathname:j.pathname,p=N.pathname,b=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;l||(p=p.toLowerCase(),b=b?b.toLowerCase():null,h=h.toLowerCase()),b&&C&&(b=Bn(b,C)||b);const P=h!=="/"&&h.endsWith("/")?h.length-1:h.length;let $=p===h||!i&&p.startsWith(h)&&p.charAt(P)==="/",E=b!=null&&(b===h||!i&&b.startsWith(h)&&b.charAt(h.length)==="/"),L={isActive:$,isPending:E,isTransitioning:y},V=$?n:void 0,U;typeof r=="function"?U=r(L):U=[r,$?"active":null,E?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let w=typeof u=="function"?u(L):u;return o.createElement(et,ui({},f,{"aria-current":V,className:U,ref:s,style:w,to:c,viewTransition:m}),typeof x=="function"?x(L):x)});var Gc;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Gc||(Gc={}));var Rf;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Rf||(Rf={}));function jN(t){let a=o.useContext(Pi);return a||jt(!1),a}function bN(t,a){let{target:s,replace:n,state:l,preventScrollReset:r,relative:i,viewTransition:u}=a===void 0?{}:a,c=fs(),m=ba(),x=Ei(t,{relative:i});return o.useCallback(f=>{if(cN(f,s)){f.preventDefault();let j=n!==void 0?n:di(m)===di(x);c(t,{replace:j,state:l,preventScrollReset:r,relative:i,viewTransition:u})}},[m,c,x,n,l,s,t,r,i,u])}function yN(t,a){a===void 0&&(a={});let s=o.useContext(hN);s==null&&jt(!1);let{basename:n}=jN(Gc.useViewTransitionState),l=Ei(t,{relative:a.relative});if(!s.isTransitioning)return!1;let r=Bn(s.currentLocation.pathname,n)||s.currentLocation.pathname,i=Bn(s.nextLocation.pathname,n)||s.nextLocation.pathname;return Wc(l.pathname,i)!=null||Wc(l.pathname,r)!=null}const Ro="http://127.0.0.1:8000".replace(/\/+$/,"");function Mf(t){return t.startsWith("http://")||t.startsWith("https://")?t:Ro?t.startsWith("/api")?`${Ro}${t}`:`${Ro}/api${t.startsWith("/")?"":"/"}${t}`:t.startsWith("/api")?t:`/api${t.startsWith("/")?"":"/"}${t}`}function vN(t){if(typeof document>"u")return"";const a=document.cookie?document.cookie.split(";"):[];for(const s of a){const n=s.trim();if(n.startsWith(`${t}=`))return decodeURIComponent(n.substring(t.length+1))}return""}function es(){return vN("csrftoken")}async function z(t,a={}){const s=Mf(t),n={credentials:"include",headers:{...a.headers||{}},...a},l=(n.method||"GET").toUpperCase();if(typeof window<"u"&&window.__WZ_READ_ONLY__&&l!=="GET"&&l!=="HEAD"){const c=new Error("read_only");throw c.status=403,c.data={error:"read_only"},c}l!=="GET"&&l!=="HEAD"&&(es()||await fetch(Mf("/api/auth/csrf"),{credentials:"include"}),n.headers={"Content-Type":"application/json","X-CSRFToken":es(),...n.headers});const r=await fetch(s,n),i=await r.text();let u=null;if(i)try{u=JSON.parse(i)}catch{u=null}if(!r.ok){const c=(u==null?void 0:u.error)||(u==null?void 0:u.detail)||`Request failed (${r.status})`,m=new Error(c);throw m.status=r.status,m.data=u,m}return u}function He({page:t,totalPages:a,onPageChange:s,showPageLinks:n=!1,showPageLabel:l=!0,maxPageLinks:r=7}){if(a<=1)return null;const i=()=>{const m=window.prompt(`Go to page (1-${a})`,String(t));if(!m)return;const x=Number(m);if(!Number.isFinite(x))return;const f=Math.min(Math.max(Math.trunc(x),1),a);f!==t&&s(f)},c=(()=>{if(!n)return[];if(a<=r)return Array.from({length:a},(N,v)=>({type:"page",number:v+1}));const m=Math.max(r-2,1);let x=t-Math.floor(m/2),f=t+Math.floor(m/2);x<2&&(x=2,f=x+m-1),f>a-1&&(f=a-1,x=f-m+1);const j=[{type:"page",number:1}];x>2&&j.push({type:"ellipsis",key:"start-ellipsis"});for(let N=x;N<=f;N+=1)j.push({type:"page",number:N});return f<a-1&&j.push({type:"ellipsis",key:"end-ellipsis"}),j.push({type:"page",number:a}),j})();return e.jsxs("div",{className:"table-pagination",children:[e.jsx("button",{type:"button",className:"shot-btn",onClick:()=>s(Math.max(t-1,1)),disabled:t<=1,children:"Previous"}),l?e.jsxs("button",{type:"button",className:"table-page-label table-page-label-button",onClick:i,title:"Jump to page",children:["Page ",t," of ",a]}):null,n?e.jsx("div",{className:"table-page-links",children:c.map((m,x)=>m.type==="ellipsis"?e.jsx("span",{className:"table-page-ellipsis",children:"..."},m.key||`ellipsis-${x}`):e.jsx("button",{type:"button",className:`table-page-link ${m.number===t?"active":""}`,onClick:()=>{m.number!==t&&s(m.number)},"aria-current":m.number===t?"page":void 0,children:m.number},m.number))}):null,e.jsx("button",{type:"button",className:"shot-btn",onClick:()=>s(Math.min(t+1,a)),disabled:t>=a,children:"Next"})]})}function Vd({products:t=[],subscriptions:a=[],isReadOnly:s=!1}){const n={monitor:"/app/monitor","ai-chatbot":"/app/ai-chatbot",storage:"/app/storage","ai-chat-widget":"/app/ai-chat-widget","digital-card":"/app/digital-card"},l=[{slug:"monitor",name:"Monitor",icon:"bi-display",description:"Workforce monitoring and productivity insights.",features:["Live activity","Screenshots","App usage"],status:"active"},{slug:"ai-chatbot",name:"AI Chatbot",icon:"bi-robot",description:"Website chatbot and live agent support in one inbox.",features:["Live chat","Agent inbox","Leads"],status:"active"},{slug:"storage",name:"Online Storage",icon:"bi-cloud",description:"Secure online cloud file storage with org-based controls.",features:["Online Access","Admin Controls","Free System Sync"],status:"active"}],r={monitor:{description:"Workforce monitoring and productivity insights.",features:["Live activity","Screenshots","App usage"]},"ai-chatbot":{description:"Website chatbot and live agent support in one inbox.",features:["Live chat","Agent inbox","Leads"]},storage:{description:"Secure online cloud file storage with org-based controls.",features:["Online Access","Admin Controls","Free System Sync"]}},i=o.useMemo(()=>{const c=Date.now(),m=new Set;return(a||[]).forEach(x=>{const f=String(x.status||"").toLowerCase();if(f==="active"){m.add(x.product_slug);return}if(f==="trialing"){if(!x.trial_end){m.add(x.product_slug);return}const j=Date.parse(x.trial_end);(Number.isNaN(j)||j>=c)&&m.add(x.product_slug)}}),m.has("online-storage")&&m.add("storage"),m},[a]),u=o.useMemo(()=>{const c=t&&t.length?t:l;return Array.from(c.reduce((m,x)=>{const f=x.slug||x.key;if(!f)return m;const j=r[f]||{},N={key:f,name:x.name,icon:x.icon||"bi-box",description:x.description||j.description||"",features:x.features&&x.features.length?x.features:j.features||[],status:x.status||"active"},v=m.get(f);if(!v)return m.set(f,N),m;const _=(N.description?1:0)+(N.features.length?1:0)+(N.status==="active"?1:0),C=(v.description?1:0)+(v.features.length?1:0)+(v.status==="active"?1:0);return _>=C&&m.set(f,N),m},new Map).values())},[t]);return s?null:e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{children:"Products"}),e.jsx("div",{className:"row g-3 mt-1",children:u.map(c=>{const m=i.has(c.key),x=c.status==="active",f=m?"Open Dashboard":"Take a Plan",j=n[c.key]||`/app/${c.key}`,N=x?m?j:`/pricing/?product=${c.key}`:"";return e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:`bi ${c.icon}`,"aria-hidden":"true"})}),e.jsx("h5",{className:"mb-0",children:c.name})]}),e.jsx("p",{className:"text-secondary mb-2",children:c.description||"Product details coming soon."}),c.features.length?e.jsx("div",{className:"text-secondary mb-3",children:c.features.join(" / ")}):null,N?e.jsx("a",{href:N,className:"btn btn-primary btn-sm",children:f}):e.jsx("span",{className:"badge-coming-soon",children:"Coming soon"})]})},c.key)})})]})}const NN={loading:!0,error:"",data:null};function _N(){try{const a=`usageAlertLastShown:${new Date().toISOString().slice(0,10)}`,s=Number(localStorage.getItem(a)||0),n=Date.now(),l=3*60*60*1e3;return!s||n-s>=l?(localStorage.setItem(a,String(n)),!0):!1}catch{return!1}}function SN({productSlug:t="",subscriptions:a=[]}){const[s,n]=o.useState(NN),[l,r]=o.useState(!1),i=typeof window<"u"&&window.__WZ_READ_ONLY__===!0,[u,c]=o.useState(1),[m,x]=o.useState(1),[f,j]=o.useState(""),[N,v]=o.useState(""),[_,C]=o.useState(""),[y,h]=o.useState(""),p=5;o.useEffect(()=>{let Y=!0;async function ue(){var he,ye;try{const G=await z("/api/dashboard/summary");if(!Y)return;n({loading:!1,error:"",data:G}),(he=G==null?void 0:G.usage_alerts)!=null&&he.length&&_N()&&r(!0)}catch(G){if((ye=G==null?void 0:G.data)!=null&&ye.redirect){window.location.href=G.data.redirect;return}Y&&n({loading:!1,error:(G==null?void 0:G.message)||"Unable to load dashboard.",data:null})}}return ue(),()=>{Y=!1}},[]),o.useEffect(()=>{const Y=setTimeout(()=>{v(f.trim()),c(1)},300);return()=>clearTimeout(Y)},[f]),o.useEffect(()=>{const Y=setTimeout(()=>{h(_.trim()),x(1)},300);return()=>clearTimeout(Y)},[_]);const b=s.data||{},P=b.stats||{},$=b.org||{},E=b.subscription||null,L=b.settings||{},V=b.top_apps||[],U=b.recent_admin_actions||[],w=b.usage_alerts||[],Q=[{label:"Total Employees",value:P.employees??0,icon:"bi-people",color:"#4dabff"},{label:"Online Now",value:P.online??0,icon:"bi-broadcast",color:"#3ef58a"},{label:"Total Activities",value:P.activities??0,icon:"bi-activity",color:"#ffdd57"},{label:"Screenshots",value:P.screenshots??0,icon:"bi-camera",color:"#ff6b6b"}],J=Date.now(),me=(a||[]).filter(Y=>{if(!(Y!=null&&Y.product_slug))return!1;const ue=String(Y.status||"").toLowerCase();if(ue==="active")return!0;if(ue==="trialing"){if(!Y.trial_end)return!0;const he=Date.parse(Y.trial_end);return Number.isNaN(he)?!0:he>=J}return!1});new Set(me.map(Y=>Y.product_slug));const re=o.useMemo(()=>{if(!N)return U;const Y=N.toLowerCase();return U.filter(ue=>[ue.time,ue.action,ue.details].some(ye=>String(ye||"").toLowerCase().includes(Y)))},[U,N]),K=o.useMemo(()=>{if(!y)return V;const Y=y.toLowerCase();return V.filter(ue=>[ue.app_name,ue.count].some(ye=>String(ye||"").toLowerCase().includes(Y)))},[V,y]),O=re.length,T=K.length,H=Math.max(Math.ceil(O/p),1),I=Math.max(Math.ceil(T/p),1),S=o.useMemo(()=>re.slice((u-1)*p,u*p),[re,u]),k=o.useMemo(()=>K.slice((m-1)*p,m*p),[K,m]),M=O?(u-1)*p+1:0,A=O?Math.min(u*p,O):0,F=T?(m-1)*p+1:0,te=T?Math.min(m*p,T):0;return o.useEffect(()=>{u>H&&c(H)},[u,H]),o.useEffect(()=>{m>I&&x(I)},[m,I]),s.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading dashboard..."})]}):s.error?e.jsx("div",{className:"alert alert-danger",children:s.error}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Dashboard Analytics"}),e.jsx("hr",{className:"section-divider"}),e.jsxs("div",{id:"monitor-analytics",className:"card p-3 mb-3 notice-card",children:[e.jsx("h5",{className:"mb-1",children:"Monitoring Policy Notice"}),e.jsx("p",{className:"mb-0 text-secondary",children:"Employee activity is monitored for productivity and security purposes. Screenshots may be captured when required. Sensitive / personal screens are excluded from monitoring."})]}),e.jsx("div",{className:"row g-3",children:Q.map(Y=>e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 text-center h-100",children:[e.jsx("div",{className:"stat-icon",style:{color:Y.color},children:e.jsx("i",{className:`bi ${Y.icon}`,"aria-hidden":"true"})}),e.jsx("h5",{children:Y.label}),e.jsx("div",{className:"stat-value",style:{color:Y.color},children:Y.value})]})},Y.label))}),i?null:e.jsxs("div",{className:"card p-4 mt-4",children:[e.jsx("h4",{children:"Admin Activity (Last 100)"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",p," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dashboard-admin-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dashboard-admin-search",type:"text",value:f,onChange:Y=>j(Y.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:S.length?S.map((Y,ue)=>e.jsxs("tr",{children:[e.jsx("td",{children:Y.time}),e.jsx("td",{children:Y.action}),e.jsx("td",{children:Y.details||"-"})]},`${Y.time}-${ue}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",children:"No admin activity yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",M," to ",A," of ",O," entries"]}),e.jsx(He,{page:u,totalPages:H,onPageChange:c,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h5",{children:"Company Details"}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Name"}),e.jsx("strong",{children:$.name||"-"})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Company Key"}),e.jsx("strong",{children:$.company_key||"-"})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Created"}),e.jsx("strong",{children:$.created_at||"-"})]})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h5",{children:"Subscription"}),E?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Plan"}),e.jsx("strong",{children:E.plan})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Employees Allowed"}),e.jsx("strong",{children:E.employee_limit===0?"Unlimited":E.employee_limit})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Valid Till"}),e.jsx("strong",{children:E.end_date||"-"})]})]}):e.jsx("div",{className:"monitor-summary-note",children:"No active plan."})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h5",{children:"Screenshot Interval"}),e.jsxs("div",{className:"monitor-summary-row monitor-summary-row--accent",children:[e.jsx("span",{children:"Current Interval"}),e.jsxs("strong",{children:[L.screenshot_interval_minutes??"-"," minutes"]})]})]})})]}),e.jsxs("div",{className:"card p-4 mt-4",children:[e.jsx("h4",{children:"Top Applications Used"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",p," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dashboard-apps-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dashboard-apps-search",type:"text",value:_,onChange:Y=>C(Y.target.value),placeholder:"Search apps"})]})]}),K.length?e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Application"}),e.jsx("th",{children:"Usage Count"})]})}),e.jsx("tbody",{children:k.map((Y,ue)=>e.jsxs("tr",{children:[e.jsx("td",{children:Y.app_name}),e.jsx("td",{children:Y.count})]},`${Y.app_name}-${ue}`))})]})}):e.jsx("p",{className:"mb-0",children:"No data available."}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",F," to ",te," of ",T," entries"]}),e.jsx(He,{page:m,totalPages:I,onPageChange:x,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsx(Vd,{products:b.products||[],subscriptions:a,isReadOnly:i}),l&&w.length?e.jsx("div",{className:"modal-overlay",onClick:()=>r(!1),children:e.jsxs("div",{className:"modal-panel",onClick:Y=>Y.stopPropagation(),children:[e.jsx("h5",{children:"Automation Alert: Gaming/OTT Usage"}),e.jsxs("div",{className:"text-secondary mb-2",children:["Work hours: ",b.work_hours_label||"09:00 - 18:00"]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"App / URL"}),e.jsx("th",{children:"Time"})]})}),e.jsx("tbody",{children:w.map((Y,ue)=>e.jsxs("tr",{children:[e.jsx("td",{children:Y.employee}),e.jsx("td",{className:"text-truncate",style:{maxWidth:"320px"},children:Y.app}),e.jsx("td",{children:Y.time})]},`${Y.employee}-${ue}`))})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{className:"modal-close",type:"button",onClick:()=>r(!1),children:"Close"})})]})}):null]})}const Eg=o.createContext(null),$f={open:!1,title:"",message:"",confirmText:"Confirm",cancelText:"Cancel",confirmVariant:"primary",resolve:null};function Ag({children:t}){const[a,s]=o.useState($f),n=o.useMemo(()=>r=>new Promise(i=>{s({open:!0,title:(r==null?void 0:r.title)||"Please Confirm",message:(r==null?void 0:r.message)||"",confirmText:(r==null?void 0:r.confirmText)||"Confirm",cancelText:(r==null?void 0:r.cancelText)||"Cancel",confirmVariant:(r==null?void 0:r.confirmVariant)||"primary",resolve:i})}),[]),l=r=>{a.resolve&&a.resolve(r),s($f)};return e.jsxs(Eg.Provider,{value:n,children:[t,a.open?e.jsx("div",{className:"modal-overlay",onClick:()=>l(!1),children:e.jsxs("div",{className:"modal-panel",onClick:r=>r.stopPropagation(),children:[e.jsx("h5",{children:a.title}),a.message?e.jsx("div",{className:"text-secondary mb-2",children:a.message}):null,e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>l(!1),children:a.cancelText}),e.jsx("button",{type:"button",className:`btn btn-${a.confirmVariant}`,onClick:()=>l(!0),children:a.confirmText})]})]})}):null]})}function nn(){const t=o.useContext(Eg);if(!t)throw new Error("useConfirm must be used inside ConfirmProvider");return t}const wN={loading:!0,error:"",data:null};function CN(){var K,O,T,H,I,S;const[t,a]=o.useState(wN),[s,n]=o.useState(""),[l,r]=o.useState(""),[i,u]=o.useState(0),[c,m]=o.useState(""),[x,f]=o.useState(""),[j,N]=o.useState(1),v=nn(),_=20;function C(k){const M=new URLSearchParams;return k&&M.set("q",k),M.toString()?`/api/dashboard/employees?${M.toString()}`:"/api/dashboard/employees"}async function y(k=l){var F;const M=C(k),A=await z(M);a({loading:!1,error:"",data:A}),u(0),m(((F=A.meta)==null?void 0:F.screenshot_interval_minutes)??"")}o.useEffect(()=>{let k=!0;async function M(){var A,F;f("");try{const te=await z(C(l));if(!k)return;a({loading:!1,error:"",data:te}),u(0),m(((A=te.meta)==null?void 0:A.screenshot_interval_minutes)??"")}catch(te){if((F=te==null?void 0:te.data)!=null&&F.redirect){window.location.href=te.data.redirect;return}k&&a({loading:!1,error:(te==null?void 0:te.message)||"Unable to load employees.",data:null})}}return M(),()=>{k=!1}},[l]),o.useEffect(()=>{const k=setTimeout(()=>{r(s.trim()),N(1)},300);return()=>clearTimeout(k)},[s]);const h=((K=t.data)==null?void 0:K.employees)||[],p=((O=t.data)==null?void 0:O.meta)||{},b=((T=t.data)==null?void 0:T.subscription)||null,P=((I=(H=t.data)==null?void 0:H.org)==null?void 0:I.company_key)||"-",$=((S=t.data)==null?void 0:S.hr_access)||{},E=o.useMemo(()=>{if(!s)return h;const k=s.toLowerCase();return h.filter(M=>M.name.toLowerCase().includes(k))},[h,s]),L=Math.max(Math.ceil(E.length/_),1),V=o.useMemo(()=>E.slice((j-1)*_,j*_),[E,j]),U=E.length,w=U?(j-1)*_+1:0,Q=U?Math.min(j*_,U):0;o.useEffect(()=>{j>L&&N(L)},[j,L]);async function J(k){var A;if(await v({title:"Delete Employee",message:"Are you sure you want to delete this employee?",confirmText:"Delete",confirmVariant:"danger"}))try{await z(`/api/dashboard/employees/${k}/delete`,{method:"DELETE"}),f("Employee deleted."),await y()}catch(F){if((A=F==null?void 0:F.data)!=null&&A.redirect){window.location.href=F.data.redirect;return}f(""),a(te=>({...te,error:(F==null?void 0:F.message)||"Unable to delete employee."}))}}async function me(k){var M;k.preventDefault(),f("");try{const A=await z("/api/dashboard/employees/screenshot-interval",{method:"POST",body:JSON.stringify({interval:c})});f(`Screenshot interval updated to ${A.screenshot_interval_minutes} minutes.`),await y()}catch(A){if((M=A==null?void 0:A.data)!=null&&M.redirect){window.location.href=A.data.redirect;return}f(""),a(F=>({...F,error:(A==null?void 0:A.message)||"Unable to update interval."}))}}async function re(k){var M;k.preventDefault(),f("");try{const A=await z("/api/dashboard/employees/addons",{method:"POST",body:JSON.stringify({addon_count:i})});if(A!=null&&A.redirect){window.location.href=A.redirect;return}f("Add-ons updated."),u(0),await y()}catch(A){if((M=A==null?void 0:A.data)!=null&&M.redirect){window.location.href=A.data.redirect;return}f(""),a(F=>({...F,error:(A==null?void 0:A.message)||"Unable to update add-ons."}))}}return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading employees..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"page-title",children:"Employees"}),e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsxs("div",{className:"col-12 col-lg-10",children:[e.jsx("div",{className:"d-flex flex-wrap gap-2 align-items-center justify-content-between",children:e.jsxs("div",{className:"d-flex gap-2 align-items-center flex-wrap",children:[e.jsx("a",{href:"/dashboard/export/csv/",className:"btn btn-success btn-sm",children:"Export CSV"}),e.jsx("a",{href:"/dashboard/export/pdf/",className:"btn btn-danger btn-sm",children:"Export PDF"})]})}),e.jsx("p",{className:"text-secondary mt-2 mb-0",children:p.employee_limit===0?e.jsxs(e.Fragment,{children:["Employees: ",p.employee_count??0," / Add-ons:"," ",p.addon_count??0]}):e.jsxs(e.Fragment,{children:["Employees: ",p.employee_count??0," / ",p.employee_limit??0,b?e.jsxs("span",{className:"ms-2",children:["Add-ons: ",p.addon_count??0]}):null]})}),x?e.jsx("div",{className:"alert alert-success mt-3 mb-0",children:x}):null,t.error?e.jsx("div",{className:"alert alert-danger mt-3 mb-0",children:t.error}):null,e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",_," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"employees-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"employees-search",type:"text",value:s,onChange:k=>n(k.target.value),placeholder:"Search employees"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"PC Name"}),e.jsx("th",{children:"Company Key"}),e.jsx("th",{children:"Device"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Last Seen"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:V.length?V.map(k=>{const M=k.status||(k.is_online?"Online":"Offline");let A="bg-secondary";return M==="Online"?A="bg-success":M==="Ideal"&&(A="bg-warning text-dark"),e.jsxs("tr",{children:[e.jsx("td",{children:k.id}),e.jsx("td",{children:k.name}),e.jsx("td",{children:k.pc_name||"-"}),e.jsx("td",{children:P}),e.jsx("td",{children:k.device_id}),e.jsx("td",{children:e.jsx("span",{className:`badge ${A}`,children:M})}),e.jsx("td",{children:k.last_seen||"-"}),e.jsxs("td",{children:[e.jsx(et,{to:`/employees/${k.id}`,className:"btn btn-primary btn-sm me-2",children:"View"}),e.jsx(et,{to:`/employees/${k.id}/edit`,className:"btn btn-outline-light btn-sm me-2",children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>J(k.id),children:"Delete"})]})]},k.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No employees found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",w," to ",Q," of ",U," entries"]}),e.jsx(He,{page:j,totalPages:L,onPageChange:N,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]}),e.jsxs("div",{className:"col-12 col-lg-2",children:[b?e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-2",children:"Add Employee Add-ons"}),b.allow_addons?e.jsxs("form",{onSubmit:re,children:[e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[e.jsx("label",{className:"form-label mb-0",children:"Addon Count"}),e.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",style:{maxWidth:"120px"},value:i,onChange:k=>u(k.target.value)}),e.jsx("button",{className:"btn btn-primary btn-sm",type:"submit",children:"Update"})]}),e.jsx("small",{className:"text-secondary",children:"Proration applies based on remaining days in the current cycle."})]}):e.jsx("p",{className:"text-warning mb-0",children:"Add-ons disabled for this plan."})]}):null,e.jsxs("div",{className:`card p-3 ${b?"mt-3":""}`,children:[e.jsx("h6",{className:"mb-2",children:"Screenshot Interval"}),e.jsx("form",{onSubmit:me,children:e.jsxs("div",{className:"d-flex gap-2 align-items-center",children:[e.jsx("select",{className:"form-select form-select-sm",style:{maxWidth:"200px"},value:c,onChange:k=>m(k.target.value),disabled:!p.allowed_intervals||p.allowed_intervals.length===0,children:p.allowed_intervals&&p.allowed_intervals.length?p.allowed_intervals.map(k=>e.jsxs("option",{value:k,children:[k," minutes"]},k)):e.jsx("option",{value:"",children:"No intervals"})}),e.jsx("button",{className:"btn btn-primary btn-sm",type:"submit",disabled:!p.allowed_intervals||p.allowed_intervals.length===0,children:"Save"})]})})]}),$.enabled?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h6",{className:"mb-2",children:"HR User Details"}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("span",{className:"text-secondary",children:"Login URL"}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:$.login_url||"/hr-login/",target:"_blank",rel:"noreferrer",children:"Click Here"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-secondary",children:"User Name: "}),e.jsx("strong",{children:$.username||P})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-secondary",children:"Password: "}),e.jsx("strong",{children:$.default_password||`${P}hrlog`})]}),e.jsx("div",{className:"text-secondary small",children:"Default password format: Company Key + hrlog."})]}):null]})]})]})}const kN={loading:!0,error:"",data:null};function PN(){var N,v,_;const{employeeId:t}=ps(),[a,s]=o.useState(kN),[n,l]=o.useState(1),r=5;o.useEffect(()=>{let C=!0;async function y(){var h;try{const p=await z(`/api/dashboard/employees/${t}`);C&&s({loading:!1,error:"",data:p})}catch(p){if((h=p==null?void 0:p.data)!=null&&h.redirect){window.location.href=p.data.redirect;return}C&&s({loading:!1,error:(p==null?void 0:p.message)||"Unable to load employee.",data:null})}}return y(),()=>{C=!1}},[t]);const i=((N=a.data)==null?void 0:N.employee)||{},u=((v=a.data)==null?void 0:v.recent_activities)||[],c=((_=a.data)==null?void 0:_.recent_screenshots)||[],m=i.status||"Offline";let x="bg-danger";m==="Online"?x="bg-success":m==="Ideal"&&(x="bg-warning text-dark");const f=Math.max(Math.ceil(u.length/r),1),j=o.useMemo(()=>u.slice((n-1)*r,n*r),[u,n]);return o.useEffect(()=>{n>f&&l(f)},[n,f]),a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading employee..."})]}):a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-center justify-content-between",children:[e.jsxs("h3",{className:"page-title",children:[i.name," (",i.device_id,")"]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(et,{to:`/employees/${t}/edit`,className:"btn btn-outline-light btn-sm",children:"Edit"}),e.jsx(et,{to:"/employees",className:"btn btn-secondary btn-sm",children:"Back"})]})]}),e.jsxs("p",{className:"mb-1",children:["PC Name: ",i.pc_name||"-"]}),e.jsxs("p",{className:"mb-1",children:["Status: ",e.jsx("span",{className:`badge ${x}`,children:m})]}),e.jsxs("p",{children:["Last Seen: ",i.last_seen||"-"]}),e.jsx("hr",{className:"section-divider"}),e.jsx("h4",{children:"Recent Activity"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"App"}),e.jsx("th",{children:"Window"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"})]})}),e.jsx("tbody",{children:j.length?j.map((C,y)=>e.jsxs("tr",{children:[e.jsx("td",{children:C.app}),e.jsx("td",{children:C.window||"-"}),e.jsx("td",{children:C.start||"-"}),e.jsx("td",{children:C.end||"-"})]},`${C.app}-${y}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No activity yet."})})})]})}),e.jsx(He,{page:n,totalPages:f,onPageChange:l}),e.jsx("hr",{className:"section-divider"}),e.jsx("h4",{children:"Screenshots"}),c.length?e.jsx("div",{className:"row g-3",children:c.map(C=>e.jsxs("div",{className:"col-12 col-md-4 col-lg-3",children:[e.jsx("img",{src:C.image_url,alt:C.captured_at,className:"img-fluid rounded"}),e.jsx("div",{className:"text-secondary mt-1",style:{fontSize:"12px"},children:C.captured_at})]},C.id))}):e.jsx("p",{children:"No screenshots found."})]})}const TN={name:"",email:"",device_id:""};function Uf(){const{employeeId:t}=ps(),a=fs(),s=!!t,[n,l]=o.useState(TN),[r,i]=o.useState(s),[u,c]=o.useState("");o.useEffect(()=>{if(!s)return;let f=!0;async function j(){var N;try{const v=await z(`/api/dashboard/employees/${t}`);if(!f)return;const _=v.employee||{};l({name:_.name||"",email:_.email||"",device_id:_.device_id||""}),i(!1)}catch(v){if((N=v==null?void 0:v.data)!=null&&N.redirect){window.location.href=v.data.redirect;return}f&&(c((v==null?void 0:v.message)||"Unable to load employee."),i(!1))}}return j(),()=>{f=!1}},[t,s]);function m(f){const{name:j,value:N}=f.target;l(v=>({...v,[j]:N}))}async function x(f){var j;f.preventDefault(),c("");try{const N=s?`/api/dashboard/employees/${t}/update`:"/api/dashboard/employees/create";await z(N,{method:s?"PUT":"POST",body:JSON.stringify(n)}),a("/employees")}catch(N){if((j=N==null?void 0:N.data)!=null&&j.redirect){window.location.href=N.data.redirect;return}c((N==null?void 0:N.message)||"Unable to save employee.")}}return r?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading employee..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"page-title",children:s?"Edit Employee":"Add Employee"}),u?e.jsx("div",{className:"alert alert-danger",children:u}):null,e.jsx("div",{className:"card p-3 mt-3",children:e.jsxs("form",{onSubmit:x,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",name:"name",className:"form-control",value:n.name,onChange:m,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Email (optional)"}),e.jsx("input",{type:"email",name:"email",className:"form-control",value:n.email,onChange:m})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Device ID"}),e.jsx("input",{type:"text",name:"device_id",className:"form-control",value:n.device_id,onChange:m,required:!0})]}),e.jsx("button",{className:"btn btn-primary",type:"submit",children:s?"Save Changes":"Create Employee"}),e.jsx(et,{to:"/employees",className:"btn btn-outline-light ms-2",children:"Cancel"})]})})]})}const EN={loading:!0,error:"",data:null};function jr(t){const a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${a}-${s}-${n}`}function AN(){const t=jr(new Date),a=typeof window<"u"&&!!window.__WZ_READ_ONLY__,[s,n]=o.useState({employeeId:"",preset:"today",nickname:"",dateFrom:"",dateTo:""}),[l,r]=o.useState({dateFrom:t,dateTo:t}),[i,u]=o.useState(1),[c,m]=o.useState(EN),[x,f]=o.useState(""),[j,N]=o.useState(-1),[v,_]=o.useState(0),[C,y]=o.useState(()=>new Set),[h,p]=o.useState(null),b=nn(),P=30,$=120,E=o.useRef(null),L=o.useRef(null),V=o.useRef(null),U=o.useRef(null),[w,Q]=o.useState([]);o.useEffect(()=>{let D=!0;async function X(){var q;m(ie=>({...ie,loading:!0,error:""}));try{const ie=new URLSearchParams;s.employeeId&&ie.set("employee_id",s.employeeId),s.nickname&&ie.set("nickname",s.nickname),s.preset?ie.set("preset",s.preset):(s.dateFrom&&ie.set("date_from",s.dateFrom),s.dateTo&&ie.set("date_to",s.dateTo)),i&&ie.set("page",String(i));const Ee=ie.toString()?`/api/dashboard/screenshots?${ie.toString()}`:"/api/dashboard/screenshots",tt=await z(Ee);D&&m({loading:!1,error:"",data:tt})}catch(ie){if((q=ie==null?void 0:ie.data)!=null&&q.redirect){window.location.href=ie.data.redirect;return}D&&m({loading:!1,error:(ie==null?void 0:ie.message)||"Unable to load screenshots.",data:null})}}return X(),()=>{D=!1}},[s,i,v]),o.useEffect(()=>{y(new Set)},[s,i]);const J=c.data||{},me=J.employees||[],re=J.server_now||"",K=J.available_dates||[],O=w.length>0?w:J.nicknames||[],T=J.selected_employee_id?String(J.selected_employee_id):s.employeeId,H=s.nickname||"";o.useEffect(()=>{!Array.isArray(J.nicknames)||!J.nicknames.length||Q(D=>{const X=new Set(D),q=[...D];return J.nicknames.forEach(ie=>{ie&&!X.has(ie)&&(X.add(ie),q.push(ie))}),q})},[J.nicknames]);const I=o.useMemo(()=>{if(!x)return me;const D=x.toLowerCase();return me.filter(X=>X.name.toLowerCase().includes(D))},[me,x]),S=me.find(D=>String(D.id)===String(T));function k(D){if(D==null)return"";const X=Math.max(0,Math.round(D)),q=Math.floor(X/60),ie=X%60;return q>0?`${q}h ${ie}m`:`${ie}m`}function M(D){if(!D)return null;const X=re?Date.parse(re):Date.now(),q=Date.parse(D);return Number.isFinite(q)?Math.max(0,(X-q)/6e4):null}function A(D){if(!D)return"";const X=new Date(D);if(!Number.isFinite(X.getTime()))return"";const q=X.getHours(),ie=String(X.getMinutes()).padStart(2,"0"),Ee=q>=12?"PM":"AM";return`${q%12||12}:${ie} ${Ee}`}const F=(S==null?void 0:S.last_screenshot_uploaded_at)||"",te=(S==null?void 0:S.last_screenshot_captured_at)||"",Y=M(F),ue=Y===null?"":Y>=$?"danger":Y>=P?"warning":"",he=J.shots||[],ye=he.length>0&&he.every(D=>C.has(D.id)),G=J.pagination||{},Ne=G.page||i,_e=G.total_pages||1,de=G.page_size||he.length||20,Re=typeof G.total_items=="number"?G.total_items:he.length,je=Re?(Ne-1)*de+1:0,Ae=Re?Math.min(Ne*de,Re):0,Qe=j>=0?he[j]:null,qe=(Qe==null?void 0:Qe.image_url)||"";o.useEffect(()=>{j>=he.length&&N(-1)},[he,j]);const Je=Y===null?"No screenshots received yet for this user.":`No screenshots received for ${k(Y)}.`,Ye=A(te),oe=A(F),ve=A(re),Z=Y!==null&&oe&&ve?`No screenshots received between ${oe} to ${ve} due to PC Screen Lock or PC Signout.`:Je;function ce(D){n(X=>({...X,employeeId:D||"",nickname:""})),u(1)}function xe(D){n(X=>({...X,nickname:D||"",employeeId:""})),u(1)}o.useEffect(()=>{if(!window.flatpickr)return;const D=K.length?K:[],X={wrap:!0,altInput:!0,altFormat:"d-m-Y",dateFormat:"Y-m-d",altInputClass:"date-input flatpickr-input",enable:D,allowInput:!1,disableMobile:!0};E.current&&!V.current&&(V.current=window.flatpickr(E.current,{...X,onChange:(q,ie)=>{r(Ee=>({...Ee,dateFrom:ie}))}})),L.current&&!U.current&&(U.current=window.flatpickr(L.current,{...X,onChange:(q,ie)=>{r(Ee=>({...Ee,dateTo:ie}))}})),V.current&&(V.current.set("enable",D),l.dateFrom?V.current.setDate(l.dateFrom,!1):V.current.clear()),U.current&&(U.current.set("enable",D),l.dateTo?U.current.setDate(l.dateTo,!1):U.current.clear())},[K,l.dateFrom,l.dateTo]),o.useEffect(()=>{V.current&&(V.current.destroy(),V.current=null),U.current&&(U.current.destroy(),U.current=null)},[s.preset]),o.useEffect(()=>()=>{V.current&&V.current.destroy(),U.current&&U.current.destroy()},[]);function Ce(D){const X=new Date;if(D==="today"){const q=jr(X);n(ie=>({...ie,preset:"today",dateFrom:"",dateTo:""})),r({dateFrom:q,dateTo:q})}else if(D==="yesterday"){const q=new Date(X);q.setDate(X.getDate()-1);const ie=jr(q);n(Ee=>({...Ee,preset:"yesterday",dateFrom:"",dateTo:""})),r({dateFrom:ie,dateTo:ie})}else n(q=>({...q,preset:"all",dateFrom:"",dateTo:""})),r({dateFrom:"",dateTo:""});u(1)}function Fe(D){if(D.preventDefault(),!l.dateFrom&&!l.dateTo){const q=jr(new Date);n(ie=>({...ie,preset:"today",dateFrom:"",dateTo:""})),r({dateFrom:q,dateTo:q}),u(1);return}n(X=>({...X,preset:"",dateFrom:l.dateFrom,dateTo:l.dateTo})),u(1)}function Ze(D){if(!D)return"";const X=new Date(D);return Number.isFinite(X.getTime())?X.toLocaleString():""}function ne(D,X=null){p({open:!0,status:"pending",label:D,total:X,deleted:0,startedAt:new Date().toISOString(),finishedAt:"",error:""})}function Ie(D){p(X=>({...X||{},status:"completed",deleted:typeof D=="number"?D:(X==null?void 0:X.deleted)||0,finishedAt:new Date().toISOString()}))}function Oe(D){p(X=>({...X||{},status:"failed",error:(D==null?void 0:D.message)||"Unable to delete screenshots."}))}async function Me(){var X;if(await b({title:"Delete All Screenshots",message:"Are you sure? All screenshots will be deleted.",confirmText:"Delete All",confirmVariant:"danger"}))try{ne("Deleting all screenshots");const q=await z("/api/dashboard/screenshots/delete-all",{method:"POST"});Ie(q==null?void 0:q.count),_(ie=>ie+1)}catch(q){Oe(q),(X=q==null?void 0:q.data)!=null&&X.redirect&&(window.location.href=q.data.redirect)}}async function st(){var X;if(!(!S||!await b({title:"Delete Employee Screenshots",message:`Delete all screenshots for ${S.name}?`,confirmText:"Delete All",confirmVariant:"danger"})))try{ne(`Deleting screenshots for ${S.name||"employee"}`);const q=await z("/api/dashboard/screenshots/delete-employee",{method:"POST",body:JSON.stringify({employee_id:S.id})});Ie(q==null?void 0:q.count),_(ie=>ie+1)}catch(q){Oe(q),(X=q==null?void 0:q.data)!=null&&X.redirect&&(window.location.href=q.data.redirect)}}async function Dt(D){var q;if(await b({title:"Delete Screenshot",message:"Delete this screenshot?",confirmText:"Delete",confirmVariant:"danger"}))try{await z(`/api/dashboard/screenshots/${D}/delete`,{method:"DELETE"}),_(ie=>ie+1)}catch(ie){(q=ie==null?void 0:ie.data)!=null&&q.redirect&&(window.location.href=ie.data.redirect)}}async function W(){var X;if(!(!C.size||!await b({title:"Delete Selected Screenshots",message:`Delete ${C.size} selected screenshot(s)?`,confirmText:"Delete Selected",confirmVariant:"danger"})))try{ne("Deleting selected screenshots",C.size);const q=await z("/api/dashboard/screenshots/delete-selected",{method:"POST",body:JSON.stringify({ids:Array.from(C)})});Ie((q==null?void 0:q.count)??C.size),y(new Set),_(ie=>ie+1)}catch(q){Oe(q),(X=q==null?void 0:q.data)!=null&&X.redirect&&(window.location.href=q.data.redirect)}}function pe(D){y(X=>{const q=new Set(X);return q.has(D)?q.delete(D):q.add(D),q})}function fe(){const D=J.shots||[];y(X=>{const q=new Set(X);return D.every(Ee=>q.has(Ee.id))?D.forEach(Ee=>q.delete(Ee.id)):D.forEach(Ee=>q.add(Ee.id)),q})}return c.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading screenshots..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"gallery-header",children:[e.jsx("h2",{children:"Screenshot Gallery"}),e.jsxs("div",{className:"gallery-actions",children:[e.jsx("div",{className:"gallery-select-wrap",children:e.jsxs("select",{className:"gallery-select",value:H,onChange:D=>xe(D.target.value),children:[e.jsx("option",{value:"",children:"Nick Name"}),O.map(D=>e.jsx("option",{value:D,children:D},D))]})}),a?null:e.jsx("button",{type:"button",className:"shot-danger",onClick:Me,children:"Delete all User data"})]})]}),c.error?e.jsx("div",{className:"alert alert-danger",children:c.error}):null,e.jsxs("div",{className:"screen-layout",children:[e.jsx("div",{className:"screen-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{className:"user-panel-title",children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:x,onChange:D=>f(D.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${T?"":"active"}`,onClick:()=>ce(""),children:"All Users"}),I.map(D=>{const X=D.status||"Offline",q=X.toLowerCase(),ie=M(D.last_screenshot_uploaded_at),Ee=ie===null?"muted":ie>=$?"danger":ie>=P?"warning":"ok";return e.jsxs("button",{type:"button",className:`user-chip ${String(D.id)===String(T)?"active":""}`,onClick:()=>ce(String(D.id)),children:[e.jsx("span",{className:`status-dot status-${q}`}),e.jsx("span",{className:"user-name",children:D.name}),e.jsxs("span",{className:"user-status",children:["(",X,")"]}),e.jsx("span",{className:`gap-badge gap-${Ee}`,children:ie===null?"No shots":`Last: ${k(ie)}`})]},D.id)})]})]})}),e.jsxs("div",{className:"screen-right",children:[S&&ue?e.jsxs("div",{className:`alert alert-${ue}`,children:[S?`${S.name}: `:"",Z,Ye?e.jsxs("div",{className:"mt-1 text-secondary",style:{fontSize:"12px"},children:["Last captured at ",Ye,"."]}):null]}):S&&Y===null?e.jsxs("div",{className:"alert alert-warning",children:[S?`${S.name}: `:"",Je]}):null,h!=null&&h.open?e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:h.label||"Deleting screenshots"}),e.jsx("div",{className:"text-secondary",children:h.status==="failed"?"Delete failed.":h.status==="completed"?"Delete completed.":"Delete in progress..."}),h.finishedAt?e.jsxs("div",{className:"text-secondary small mt-1",children:["Completed at: ",Ze(h.finishedAt)]}):null]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>p(D=>D&&{...D,open:!1}),children:"Close"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"mb-2",children:h.total?e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:h.deleted||0})," /"," ",e.jsx("strong",{children:h.total})," items deleted"]}):e.jsxs(e.Fragment,{children:[e.jsx("strong",{children:h.deleted||0})," items deleted"]})}),e.jsx("div",{className:"progress mb-2",style:{height:"8px"},children:e.jsx("div",{className:`progress-bar ${h.status==="failed"?"bg-danger":"bg-success"}`,style:{width:h.total?`${Math.min(100,Math.round((h.deleted||0)/h.total*100))}%`:h.status==="completed"?"100%":"35%"}})}),h.startedAt?e.jsxs("div",{className:"text-secondary small",children:["Started at: ",Ze(h.startedAt)]}):null,h.error?e.jsx("div",{className:"alert alert-danger mt-2",children:h.error}):null]})]}):null,e.jsxs("div",{className:"shot-toolbar",children:[e.jsxs("div",{className:"shot-info",style:{marginTop:"5px"},children:["Showing: ",H||(S?S.name:"All Users")]}),e.jsxs("form",{className:"shot-filter",onSubmit:Fe,children:[e.jsxs("div",{className:"preset-buttons",children:[e.jsx("button",{type:"button",className:`shot-btn ${s.preset==="today"?"active":""}`,onClick:()=>Ce("today"),children:"Today"}),e.jsx("button",{type:"button",className:`shot-btn ${s.preset==="yesterday"?"active":""}`,onClick:()=>Ce("yesterday"),children:"Yesterday"})]}),e.jsxs("label",{children:[e.jsx("span",{children:"From"}),e.jsxs("div",{className:"date-picker-wrap",ref:E,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"To"}),e.jsxs("div",{className:"date-picker-wrap",ref:L,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsx("button",{type:"submit",className:"shot-btn primary",children:"Apply"}),e.jsx("button",{type:"button",className:`shot-btn ${s.preset==="all"?"active":""}`,onClick:()=>Ce("all"),children:"Reset"})]}),a?null:e.jsxs("div",{className:"toolbar-actions",children:[e.jsx("button",{type:"button",className:"shot-btn",onClick:fe,disabled:he.length===0,children:ye?"Unselect All":"Select All"}),e.jsx("button",{type:"button",className:"shot-danger outline",onClick:W,disabled:!C.size,children:"Delete Selected"}),S?e.jsxs("button",{type:"button",className:"shot-danger outline",onClick:st,children:["Delete All Screenshots - ",S.name]}):null]})]}),e.jsx("div",{className:"gallery",children:he.length?he.map((D,X)=>e.jsxs("div",{className:"shot-card",children:[e.jsxs("div",{className:"shot-meta",children:[e.jsx("span",{className:"shot-name",children:D.employee}),e.jsxs("span",{className:"shot-time",children:["Captured: ",D.captured_at_display||D.captured_at]})]}),e.jsxs("div",{className:"shot-image-wrap",children:[a?null:e.jsxs("label",{className:"shot-select",children:[e.jsx("input",{type:"checkbox",checked:C.has(D.id),onChange:()=>pe(D.id)}),e.jsx("span",{children:"Select"})]}),e.jsx("img",{src:D.image_url,alt:D.employee,onClick:()=>N(X)}),e.jsxs("span",{className:"shot-uploaded",children:["Uploaded: ",D.uploaded_at_display||"-"]})]}),a?null:e.jsx("div",{className:"shot-actions",children:e.jsx("button",{type:"button",className:"link-danger",onClick:()=>Dt(D.id),children:"Delete"})})]},D.id)):e.jsx("p",{children:"No screenshots yet."})}),e.jsxs("div",{className:"table-footer mt-4",children:[e.jsxs("div",{className:"table-info",children:["Showing ",je," to ",Ae," of ",Re," entries"]}),e.jsx(He,{page:Ne,totalPages:_e,onPageChange:u,showPageLinks:!0,showPageLabel:!0,maxPageLinks:7})]})]})]}),qe?e.jsx("div",{className:"modal-overlay",onClick:()=>N(-1),children:e.jsxs("div",{className:"preview-modal",onClick:D=>D.stopPropagation(),children:[e.jsx("button",{type:"button",className:"preview-nav preview-nav-prev",onClick:()=>N(D=>Math.max(0,D-1)),disabled:j<=0,children:e.jsx("span",{className:"preview-nav-icon",children:""})}),e.jsx("img",{src:qe,alt:(Qe==null?void 0:Qe.employee)||"Screenshot preview",className:"preview-image"}),e.jsx("button",{type:"button",className:"preview-nav preview-nav-next",onClick:()=>N(D=>Math.min(he.length-1,D+1)),disabled:j>=he.length-1,children:e.jsx("span",{className:"preview-nav-icon",children:""})})]})}):null]})}const Of=80,DN=24,LN=60;function If(t,a){const s=String(t||"");return s?s.length<=a?s:`${s.slice(0,Math.max(a-3,0))}...`:""}function RN(t){const a=String(t||"").trim();return a?/^https?:\/\//i.test(a)?a:/^\/\//.test(a)?`https:${a}`:/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(a)?"":a.toLowerCase().startsWith("localhost")||/^[0-9.]+(?::\d+)?(\/|$)/.test(a)?`http://${a}`:`https://${a}`:""}function MN(t){if(!t)return{text:"-",href:"",full:""};const a=String(t);return{text:a.length>Of?`${a.slice(0,Of-3)}...`:a,href:RN(a),full:a}}function $N(){const[t,a]=o.useState([]),[s,n]=o.useState(""),[l,r]=o.useState(""),[i,u]=o.useState([]),[c,m]=o.useState(!0),[x,f]=o.useState(!1),[j,N]=o.useState(""),[v,_]=o.useState(1),[C,y]=o.useState(1),[h,p]=o.useState(0),[b,P]=o.useState(20),[$,E]=o.useState(""),[L,V]=o.useState(""),[U,w]=o.useState({key:"start",direction:"desc"}),Q=20;o.useEffect(()=>{let T=!0;async function H(){var I;try{const S=await z("/api/dashboard/employees");if(!T)return;const k=(S.employees||[]).slice().sort((M,A)=>M.name.localeCompare(A.name));a(k),m(!1)}catch(S){if((I=S==null?void 0:S.data)!=null&&I.redirect){window.location.href=S.data.redirect;return}T&&(N((S==null?void 0:S.message)||"Unable to load users."),m(!1))}}return H(),()=>{T=!1}},[]),o.useEffect(()=>{_(1)},[s]),o.useEffect(()=>{const T=setTimeout(()=>{V($.trim()),_(1)},300);return()=>clearTimeout(T)},[$]),o.useEffect(()=>{let T=!0;async function H(){var S;f(!0);try{const k=new URLSearchParams;s&&k.set("employee_id",s),L&&k.set("q",L),U!=null&&U.key&&(k.set("sort",U.key),k.set("dir",U.direction)),k.set("page",v),k.set("page_size",Q);const M=`/api/dashboard/activity/live?${k.toString()}`,A=await z(M);if(T){u(A.logs||[]);const F=A.pagination||{},te=F.total_pages||1,Y=F.page||v,ue=F.page_size||Q,he=typeof F.total_items=="number"?F.total_items:(A.logs||[]).length;y(te),p(he),P(ue),Y!==v&&_(Y),f(!1)}}catch(k){if((S=k==null?void 0:k.data)!=null&&S.redirect){window.location.href=k.data.redirect;return}T&&(N((k==null?void 0:k.message)||"Unable to load activity."),f(!1))}}H();const I=setInterval(H,5e3);return()=>{T=!1,clearInterval(I)}},[v,s,U,L]);const J=o.useMemo(()=>{if(!l)return t;const T=l.toLowerCase().trim();return t.filter(H=>H.name.toLowerCase().includes(T))},[t,l]),me=h?(v-1)*b+1:0,re=h?Math.min(v*b,h):0,K=T=>{w(H=>H.key===T?{key:T,direction:H.direction==="asc"?"desc":"asc"}:{key:T,direction:"asc"}),_(1)},O=(T,H)=>{(T.key==="Enter"||T.key===" ")&&(T.preventDefault(),K(H))};return c?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading users..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsx("h2",{className:"page-title",children:"Live Activity"})}),j?e.jsx("div",{className:"alert alert-danger",children:j}):null,e.jsxs("div",{className:"activity-layout",children:[e.jsx("div",{className:"activity-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:l,onChange:T=>r(T.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${s?"":"active"}`,onClick:()=>n(""),children:"All Users"}),J.map(T=>e.jsx("button",{type:"button",className:`user-chip ${String(T.id)===String(s)?"active":""}`,onClick:()=>n(String(T.id)),children:T.name},T.id))]})]})}),e.jsxs("div",{className:"activity-right",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",b," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"activity-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"activity-search",type:"text",value:$,onChange:T=>E(T.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle activity-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:`sortable ${U.key==="employee"?`sorted-${U.direction}`:""}`,role:"button",tabIndex:0,onClick:()=>K("employee"),onKeyDown:T=>O(T,"employee"),children:"Employee"}),e.jsx("th",{className:`sortable ${U.key==="app"?`sorted-${U.direction}`:""}`,role:"button",tabIndex:0,onClick:()=>K("app"),onKeyDown:T=>O(T,"app"),children:"Application"}),e.jsx("th",{className:`sortable ${U.key==="window"?`sorted-${U.direction}`:""}`,role:"button",tabIndex:0,onClick:()=>K("window"),onKeyDown:T=>O(T,"window"),children:"Window"}),e.jsx("th",{className:`sortable ${U.key==="url"?`sorted-${U.direction}`:""}`,role:"button",tabIndex:0,onClick:()=>K("url"),onKeyDown:T=>O(T,"url"),children:"URL"}),e.jsx("th",{className:`sortable ${U.key==="start"?`sorted-${U.direction}`:""}`,role:"button",tabIndex:0,onClick:()=>K("start"),onKeyDown:T=>O(T,"start"),children:"Time"})]})}),e.jsx("tbody",{children:i.length?i.map((T,H)=>{const I=MN(T.url);return e.jsxs("tr",{children:[e.jsx("td",{children:T.employee||"-"}),e.jsx("td",{title:T.app||"-",children:If(T.app||"-",DN)}),e.jsx("td",{title:T.window||"-",children:If(T.window||"-",LN)}),e.jsx("td",{className:"activity-url-cell",children:I.href?e.jsxs(e.Fragment,{children:[e.jsx("a",{className:"activity-url",href:I.href,target:"_blank",rel:"noopener noreferrer",title:I.full,children:I.text}),e.jsx("span",{children:" "}),e.jsx("a",{className:"activity-url",href:I.href,target:"_blank",rel:"noopener noreferrer",children:"Backlink"})]}):e.jsx("span",{className:"activity-url",title:I.full,children:I.text})}),e.jsx("td",{children:T.start||"-"})]},`${T.employee}-${T.start}-${H}`)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:x?"Loading...":"No activity data yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",me," to ",re," of ",h," entries"]}),e.jsx(He,{page:v,totalPages:C,onPageChange:_,showPageLinks:!0,showPageLabel:!0,maxPageLinks:7})]})]})]})]})}const UN={loading:!0,error:"",data:null};function br(t){const a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${a}-${s}-${n}`}function ON(){const t=br(new Date),[a,s]=o.useState({employeeId:"",preset:"today",dateFrom:"",dateTo:""}),[n,l]=o.useState({dateFrom:t,dateTo:t}),[r,i]=o.useState(UN),[u,c]=o.useState(""),[m,x]=o.useState(""),[f,j]=o.useState(""),[N,v]=o.useState({open:!1,rows:[],meta:""}),[_,C]=o.useState(1),y=20,h=o.useRef(null),p=o.useRef(null),b=o.useRef(null),P=o.useRef(null);o.useEffect(()=>{let M=!0;async function A(){var F;i(te=>({...te,loading:!0,error:""}));try{const te=new URLSearchParams;a.employeeId&&te.set("employee_id",a.employeeId),a.preset?te.set("preset",a.preset):(a.dateFrom&&te.set("date_from",a.dateFrom),a.dateTo&&te.set("date_to",a.dateTo));const Y=te.toString()?`/api/dashboard/work-activity?${te.toString()}`:"/api/dashboard/work-activity",ue=await z(Y);if(!M)return;i({loading:!1,error:"",data:ue})}catch(te){if((F=te==null?void 0:te.data)!=null&&F.redirect){window.location.href=te.data.redirect;return}M&&i({loading:!1,error:(te==null?void 0:te.message)||"Unable to load activity log.",data:null})}}return A(),()=>{M=!1}},[a]),o.useEffect(()=>{C(1)},[a]),o.useEffect(()=>{const M=setTimeout(()=>{j(m.trim()),C(1)},300);return()=>clearTimeout(M)},[m]);const $=r.data||{},E=$.employees||[],L=$.available_dates||[],V=$.rows||[],U=$.selected_employee_id?String($.selected_employee_id):a.employeeId,w=o.useMemo(()=>{if(!u)return E;const M=u.toLowerCase();return E.filter(A=>A.name.toLowerCase().includes(M))},[E,u]),Q=E.find(M=>String(M.id)===String(U)),J=o.useMemo(()=>{if(!f)return V;const M=f.toLowerCase();return V.filter(A=>[A.employee,A.date,A.on_time,A.off_time,A.duration,A.history_label,A.stop_reason].some(te=>String(te||"").toLowerCase().includes(M)))},[V,f]),me=J.length,re=Math.max(Math.ceil(me/y),1),K=o.useMemo(()=>J.slice((_-1)*y,_*y),[J,_]),O=me?(_-1)*y+1:0,T=me?Math.min(_*y,me):0;o.useEffect(()=>{_>re&&C(re)},[_,re]),o.useEffect(()=>{if(!window.flatpickr)return;const M=L.length?L:[],A={wrap:!0,altInput:!0,altFormat:"d-m-Y",dateFormat:"Y-m-d",altInputClass:"date-input flatpickr-input",enable:M,allowInput:!1,disableMobile:!0};h.current&&!b.current&&(b.current=window.flatpickr(h.current,{...A,onChange:(F,te)=>{l(Y=>({...Y,dateFrom:te}))}})),p.current&&!P.current&&(P.current=window.flatpickr(p.current,{...A,onChange:(F,te)=>{l(Y=>({...Y,dateTo:te}))}})),b.current&&(b.current.set("enable",M),n.dateFrom?b.current.setDate(n.dateFrom,!1):b.current.clear()),P.current&&(P.current.set("enable",M),n.dateTo?P.current.setDate(n.dateTo,!1):P.current.clear())},[L,n.dateFrom,n.dateTo]),o.useEffect(()=>()=>{b.current&&b.current.destroy(),P.current&&P.current.destroy()},[]);function H(M){s(A=>({...A,employeeId:M||""}))}function I(M){const A=new Date;if(M==="today"){const F=br(A);s(te=>({...te,preset:"today",dateFrom:"",dateTo:""})),l({dateFrom:F,dateTo:F})}else if(M==="yesterday"){const F=new Date(A);F.setDate(A.getDate()-1);const te=br(F);s(Y=>({...Y,preset:"yesterday",dateFrom:"",dateTo:""})),l({dateFrom:te,dateTo:te})}else s(F=>({...F,preset:"all",dateFrom:"",dateTo:""})),l({dateFrom:"",dateTo:""})}function S(M){if(M.preventDefault(),!n.dateFrom&&!n.dateTo){const F=br(new Date);s(te=>({...te,preset:"today",dateFrom:"",dateTo:""})),l({dateFrom:F,dateTo:F});return}s(A=>({...A,preset:"",dateFrom:n.dateFrom,dateTo:n.dateTo}))}function k(M){const A=M.history||[];v({open:!0,rows:A,meta:`${M.employee} - ${M.date}`})}return r.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading activity log..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"gallery-header",children:e.jsx("h2",{children:"Work Activity Log"})}),r.error?e.jsx("div",{className:"alert alert-danger",children:r.error}):null,e.jsxs("div",{className:"screen-layout",children:[e.jsx("div",{className:"screen-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{className:"user-panel-title",children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:u,onChange:M=>c(M.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${U?"":"active"}`,onClick:()=>H(""),children:"All Users"}),w.map(M=>{const A=M.status||"Offline",F=A.toLowerCase();return e.jsxs("button",{type:"button",className:`user-chip ${String(M.id)===String(U)?"active":""}`,onClick:()=>H(String(M.id)),children:[e.jsx("span",{className:`status-dot status-${F}`}),e.jsx("span",{className:"user-name",children:M.name}),e.jsxs("span",{className:"user-status",children:["(",A,")"]})]},M.id)})]})]})}),e.jsxs("div",{className:"screen-right",children:[e.jsxs("div",{className:"shot-toolbar",children:[e.jsxs("div",{className:"shot-info",children:["Showing: ",Q?Q.name:"All Users"]}),e.jsxs("form",{className:"shot-filter",onSubmit:S,children:[e.jsxs("div",{className:"preset-buttons",children:[e.jsx("button",{type:"button",className:`shot-btn ${a.preset==="today"?"active":""}`,onClick:()=>I("today"),children:"Today"}),e.jsx("button",{type:"button",className:`shot-btn ${a.preset==="yesterday"?"active":""}`,onClick:()=>I("yesterday"),children:"Yesterday"})]}),e.jsxs("label",{children:[e.jsx("span",{children:"From"}),e.jsxs("div",{className:"date-picker-wrap",ref:h,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"To"}),e.jsxs("div",{className:"date-picker-wrap",ref:p,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsx("button",{type:"submit",className:"shot-btn primary",children:"Apply"}),e.jsx("button",{type:"button",className:`shot-btn ${a.preset==="all"?"active":""}`,onClick:()=>I("all"),children:"Reset"})]})]}),e.jsxs("div",{className:"card p-3 usage-card",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",y," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"work-activity-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"work-activity-search",type:"text",value:m,onChange:M=>x(M.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee Name"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"PC On Time"}),e.jsx("th",{children:"PC Off / Signout / Sleeping"}),e.jsx("th",{children:"Stop Reason"}),e.jsx("th",{children:"History"}),e.jsx("th",{children:"Duration"})]})}),e.jsx("tbody",{children:K.length?K.map((M,A)=>e.jsxs("tr",{children:[e.jsx("td",{children:M.employee}),e.jsx("td",{children:M.date}),e.jsx("td",{children:M.on_time}),e.jsx("td",{children:M.off_time}),e.jsx("td",{children:M.stop_reason||"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-link text-info p-0 history-trigger",onClick:()=>k(M),children:M.history_label})}),e.jsx("td",{children:M.duration})]},`${M.employee}-${M.date}-${A}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No activity data yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",O," to ",T," of ",me," entries"]}),e.jsx(He,{page:_,totalPages:re,onPageChange:C,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})]}),N.open?e.jsx("div",{className:"modal-overlay",onClick:()=>v({open:!1,rows:[],meta:""}),children:e.jsxs("div",{className:"modal-panel",onClick:M=>M.stopPropagation(),children:[e.jsx("h5",{children:"On/Off History"}),e.jsx("div",{className:"text-secondary mb-2",children:N.meta}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"On Time"}),e.jsx("th",{children:"PC Off / Signout / Sleeping"}),e.jsx("th",{children:"Stop Reason"}),e.jsx("th",{children:"Duration"})]})}),e.jsx("tbody",{children:N.rows.length?N.rows.map((M,A)=>e.jsxs("tr",{children:[e.jsx("td",{children:A+1}),e.jsx("td",{children:M.on}),e.jsx("td",{children:M.off}),e.jsx("td",{children:M.stop_reason||"-"}),e.jsx("td",{children:M.duration})]},`${M.on}-${A}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No history available."})})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"modal-close",onClick:()=>v({open:!1,rows:[],meta:""}),children:"Close"})})]})}):null]})}const IN={loading:!0,error:"",errorStatus:0,data:null};function yr(t){const a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${a}-${s}-${n}`}function FN(t){const a=String(t||"").trim();return a?/^https?:\/\//i.test(a)?a:/^\/\//.test(a)?`https:${a}`:/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(a)?"":a.toLowerCase().startsWith("localhost")||/^[0-9.]+(?::\d+)?(\/|$)/.test(a)?`http://${a}`:`https://${a}`:""}function zN(t,a){if(!t||t==="-")return a||"-";const s=FN(t);return s?e.jsx("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-info text-decoration-none",children:t}):a||t}function BN(){const t=yr(new Date),[a,s]=o.useState({employeeId:"",preset:"today",dateFrom:"",dateTo:""}),[n,l]=o.useState({dateFrom:t,dateTo:t}),[r,i]=o.useState(IN),[u,c]=o.useState(""),[m,x]=o.useState(""),[f,j]=o.useState(""),[N,v]=o.useState(1),_=20,C=o.useRef(null),y=o.useRef(null),h=o.useRef(null),p=o.useRef(null);o.useEffect(()=>{let S=!0;async function k(){var M;i(A=>({...A,loading:!0,error:"",errorStatus:0}));try{const A=new URLSearchParams;a.employeeId&&A.set("employee_id",a.employeeId),a.preset?A.set("preset",a.preset):(a.dateFrom&&A.set("date_from",a.dateFrom),a.dateTo&&A.set("date_to",a.dateTo));const F=A.toString()?`/api/dashboard/app-usage?${A.toString()}`:"/api/dashboard/app-usage",te=await z(F);if(!S)return;i({loading:!1,error:"",errorStatus:0,data:te})}catch(A){if((M=A==null?void 0:A.data)!=null&&M.redirect){window.location.href=A.data.redirect;return}S&&i({loading:!1,error:(A==null?void 0:A.message)||"Unable to load app usage.",errorStatus:(A==null?void 0:A.status)||0,data:null})}}return k(),()=>{S=!1}},[a]),o.useEffect(()=>{const S=setTimeout(()=>{j(m.trim()),v(1)},300);return()=>clearTimeout(S)},[m]);const b=r.data||{},P=b.employees||[],$=b.available_dates||[],E=b.app_rows||[],L=b.selected_employee_id?String(b.selected_employee_id):a.employeeId,V=o.useMemo(()=>{if(!u)return P;const S=u.toLowerCase();return P.filter(k=>k.name.toLowerCase().includes(S))},[P,u]),U=P.find(S=>String(S.id)===String(L)),w=o.useMemo(()=>{if(!f)return E;const S=f.toLowerCase();return E.filter(k=>[k.name,k.url,k.duration,k.percent].some(A=>String(A||"").toLowerCase().includes(S)))},[E,f]),Q=w.length,J=Math.max(Math.ceil(Q/_),1),me=o.useMemo(()=>w.slice((N-1)*_,N*_),[w,N]),re=Q?(N-1)*_+1:0,K=Q?Math.min(N*_,Q):0;o.useEffect(()=>{N>J&&v(J)},[N,J]),o.useEffect(()=>{v(1)},[a]),o.useEffect(()=>{if(!window.flatpickr)return;const S=$.length?$:[],k={wrap:!0,altInput:!0,altFormat:"d-m-Y",dateFormat:"Y-m-d",altInputClass:"date-input flatpickr-input",enable:S,allowInput:!1,disableMobile:!0};C.current&&!h.current&&(h.current=window.flatpickr(C.current,{...k,onChange:(M,A)=>{l(F=>({...F,dateFrom:A}))}})),y.current&&!p.current&&(p.current=window.flatpickr(y.current,{...k,onChange:(M,A)=>{l(F=>({...F,dateTo:A}))}})),h.current&&(h.current.set("enable",S),n.dateFrom?h.current.setDate(n.dateFrom,!1):h.current.clear()),p.current&&(p.current.set("enable",S),n.dateTo?p.current.setDate(n.dateTo,!1):p.current.clear())},[$,n.dateFrom,n.dateTo]),o.useEffect(()=>()=>{h.current&&h.current.destroy(),p.current&&p.current.destroy()},[]);function O(S){s(k=>({...k,employeeId:S||""}))}function T(S){const k=new Date;if(S==="today"){const M=yr(k);s(A=>({...A,preset:"today",dateFrom:"",dateTo:""})),l({dateFrom:M,dateTo:M})}else if(S==="yesterday"){const M=new Date(k);M.setDate(k.getDate()-1);const A=yr(M);s(F=>({...F,preset:"yesterday",dateFrom:"",dateTo:""})),l({dateFrom:A,dateTo:A})}else s(M=>({...M,preset:"all",dateFrom:"",dateTo:""})),l({dateFrom:"",dateTo:""})}function H(S){if(S.preventDefault(),!n.dateFrom&&!n.dateTo){const M=yr(new Date);s(A=>({...A,preset:"today",dateFrom:"",dateTo:""})),l({dateFrom:M,dateTo:M});return}s(k=>({...k,preset:"",dateFrom:n.dateFrom,dateTo:n.dateTo}))}function I(S){const k=new URLSearchParams;return k.set("app",S),L&&k.set("employee_id",L),a.preset?k.set("preset",a.preset):(a.dateFrom&&k.set("date_from",a.dateFrom),a.dateTo&&k.set("date_to",a.dateTo)),`/app-urls?${k.toString()}`}return r.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading app usage..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"gallery-header",children:e.jsx("h2",{children:"App Usage"})}),r.error?e.jsx("div",{className:`alert ${r.errorStatus===403?"alert-warning":"alert-danger"}`,children:r.error}):null,e.jsxs("div",{className:"screen-layout",children:[e.jsx("div",{className:"screen-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{className:"user-panel-title",children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:u,onChange:S=>c(S.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${L?"":"active"}`,onClick:()=>O(""),children:"All Users"}),V.map(S=>{const k=S.status||"Offline",M=k.toLowerCase();return e.jsxs("button",{type:"button",className:`user-chip ${String(S.id)===String(L)?"active":""}`,onClick:()=>O(String(S.id)),children:[e.jsx("span",{className:`status-dot status-${M}`}),e.jsx("span",{className:"user-name",children:S.name}),e.jsxs("span",{className:"user-status",children:["(",k,")"]})]},S.id)})]})]})}),e.jsxs("div",{className:"screen-right",children:[e.jsxs("div",{className:"shot-toolbar",children:[e.jsxs("div",{className:"shot-info",children:["Showing: ",U?U.name:"All Users"]}),e.jsxs("form",{className:"shot-filter",onSubmit:H,children:[e.jsxs("div",{className:"preset-buttons",children:[e.jsx("button",{type:"button",className:`shot-btn ${a.preset==="today"?"active":""}`,onClick:()=>T("today"),children:"Today"}),e.jsx("button",{type:"button",className:`shot-btn ${a.preset==="yesterday"?"active":""}`,onClick:()=>T("yesterday"),children:"Yesterday"})]}),e.jsxs("label",{children:[e.jsx("span",{children:"From"}),e.jsxs("div",{className:"date-picker-wrap",ref:C,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"To"}),e.jsxs("div",{className:"date-picker-wrap",ref:y,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsx("button",{type:"submit",className:"shot-btn primary",children:"Apply"}),e.jsx("button",{type:"button",className:`shot-btn ${a.preset==="all"?"active":""}`,onClick:()=>T("all"),children:"Reset"})]}),e.jsxs("div",{className:"usage-total",children:["Total Time: ",b.total_time||"0s"]})]}),e.jsxs("div",{className:"card p-3 usage-card",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",_," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"app-usage-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"app-usage-search",type:"text",value:m,onChange:S=>x(S.target.value),placeholder:"Search apps"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Application"}),e.jsx("th",{children:"Top URL"}),e.jsx("th",{children:"Total Time"}),e.jsx("th",{children:"Share"})]})}),e.jsx("tbody",{children:me.length?me.map(S=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("a",{className:"text-info text-decoration-none",href:I(S.name),children:S.name})}),e.jsx("td",{className:"text-truncate",style:{maxWidth:"280px"},children:zN(S.url)}),e.jsx("td",{children:S.duration}),e.jsxs("td",{children:[S.percent,"%"]})]},S.name)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No activity data yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",re," to ",K," of ",Q," entries"]}),e.jsx(He,{page:N,totalPages:J,onPageChange:v,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})]})]})}const WN={loading:!0,error:"",errorStatus:0,data:null};function vr(t){const a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${a}-${s}-${n}`}function VN(t){const a=String(t||"").trim();return a?/^https?:\/\//i.test(a)?a:/^\/\//.test(a)?`https:${a}`:/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(a)?"":a.toLowerCase().startsWith("localhost")||/^[0-9.]+(?::\d+)?(\/|$)/.test(a)?`http://${a}`:`https://${a}`:""}function GN(){const t=ba();return o.useMemo(()=>new URLSearchParams(t.search),[t.search])}function HN(){const t=vr(new Date),a=GN(),s=a.get("app")||"",n=a.get("employee_id")||"",l=a.get("preset")||"today",r=a.get("date_from")||"",i=a.get("date_to")||"",[u,c]=o.useState(s),[m,x]=o.useState({employeeId:n,preset:l,dateFrom:r,dateTo:i}),[f,j]=o.useState({dateFrom:r||t,dateTo:i||t}),[N,v]=o.useState(WN),[_,C]=o.useState(""),[y,h]=o.useState(""),[p,b]=o.useState(""),[P,$]=o.useState(1),E=20,L=o.useRef(null),V=o.useRef(null),U=o.useRef(null),w=o.useRef(null);o.useEffect(()=>{c(s),x(Y=>({...Y,employeeId:n,preset:l,dateFrom:r,dateTo:i})),j({dateFrom:r||t,dateTo:i||t}),$(1)},[s,n,l,r,i,t]),o.useEffect(()=>{let Y=!0;async function ue(){var he;v(ye=>({...ye,loading:!0,error:"",errorStatus:0}));try{const ye=new URLSearchParams;u&&ye.set("app",u),m.employeeId&&ye.set("employee_id",m.employeeId),m.preset?ye.set("preset",m.preset):(m.dateFrom&&ye.set("date_from",m.dateFrom),m.dateTo&&ye.set("date_to",m.dateTo));const G=ye.toString()?`/api/dashboard/app-urls?${ye.toString()}`:"/api/dashboard/app-urls",Ne=await z(G);if(!Y)return;v({loading:!1,error:"",errorStatus:0,data:Ne})}catch(ye){if((he=ye==null?void 0:ye.data)!=null&&he.redirect){window.location.href=ye.data.redirect;return}Y&&v({loading:!1,error:(ye==null?void 0:ye.message)||"Unable to load app URLs.",errorStatus:(ye==null?void 0:ye.status)||0,data:null})}}return ue(),()=>{Y=!1}},[u,m]),o.useEffect(()=>{const Y=setTimeout(()=>{b(y.trim()),$(1)},300);return()=>clearTimeout(Y)},[y]);const Q=N.data||{},J=Q.employees||[],me=Q.available_dates||[],re=Q.url_rows||[],K=Q.selected_employee_id?String(Q.selected_employee_id):m.employeeId,O=o.useMemo(()=>{if(!_)return J;const Y=_.toLowerCase();return J.filter(ue=>ue.name.toLowerCase().includes(Y))},[J,_]);J.find(Y=>String(Y.id)===String(K));const T=o.useMemo(()=>{if(!p)return re;const Y=p.toLowerCase();return re.filter(ue=>String(ue.url||"").toLowerCase().includes(Y))},[re,p]),H=T.length,I=Math.max(Math.ceil(H/E),1),S=o.useMemo(()=>T.slice((P-1)*E,P*E),[T,P]),k=H?(P-1)*E+1:0,M=H?Math.min(P*E,H):0;o.useEffect(()=>{P>I&&$(I)},[P,I]),o.useEffect(()=>{$(1)},[m,u]),o.useEffect(()=>{if(!window.flatpickr)return;const Y=me.length?me:[],ue={wrap:!0,altInput:!0,altFormat:"d-m-Y",dateFormat:"Y-m-d",altInputClass:"date-input flatpickr-input",enable:Y,allowInput:!1,disableMobile:!0};L.current&&!U.current&&(U.current=window.flatpickr(L.current,{...ue,onChange:(he,ye)=>{j(G=>({...G,dateFrom:ye}))}})),V.current&&!w.current&&(w.current=window.flatpickr(V.current,{...ue,onChange:(he,ye)=>{j(G=>({...G,dateTo:ye}))}})),U.current&&(U.current.set("enable",Y),f.dateFrom?U.current.setDate(f.dateFrom,!1):U.current.clear()),w.current&&(w.current.set("enable",Y),f.dateTo?w.current.setDate(f.dateTo,!1):w.current.clear())},[me,f.dateFrom,f.dateTo]),o.useEffect(()=>()=>{U.current&&U.current.destroy(),w.current&&w.current.destroy()},[]);function A(Y){x(ue=>({...ue,employeeId:Y||""}))}function F(Y){const ue=new Date;if(Y==="today"){const he=vr(ue);x(ye=>({...ye,preset:"today",dateFrom:"",dateTo:""})),j({dateFrom:he,dateTo:he})}else if(Y==="yesterday"){const he=new Date(ue);he.setDate(ue.getDate()-1);const ye=vr(he);x(G=>({...G,preset:"yesterday",dateFrom:"",dateTo:""})),j({dateFrom:ye,dateTo:ye})}else x(he=>({...he,preset:"all",dateFrom:"",dateTo:""})),j({dateFrom:"",dateTo:""})}function te(Y){if(Y.preventDefault(),!f.dateFrom&&!f.dateTo){const he=vr(new Date);x(ye=>({...ye,preset:"today",dateFrom:"",dateTo:""})),j({dateFrom:he,dateTo:he});return}x(ue=>({...ue,preset:"",dateFrom:f.dateFrom,dateTo:f.dateTo}))}return N.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading app URLs..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"gallery-header",children:[e.jsx("h2",{children:"App URLs"}),e.jsx("div",{className:"gallery-actions",children:e.jsx(et,{to:"/app-usage",className:"shot-btn",children:"Back to App Usage"})})]}),N.error?e.jsx("div",{className:`alert ${N.errorStatus===403?"alert-warning":"alert-danger"}`,children:N.error}):null,e.jsxs("div",{className:"screen-layout",children:[e.jsx("div",{className:"screen-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{className:"user-panel-title",children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:_,onChange:Y=>C(Y.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${K?"":"active"}`,onClick:()=>A(""),children:"All Users"}),O.map(Y=>{const ue=Y.status||"Offline",he=ue.toLowerCase();return e.jsxs("button",{type:"button",className:`user-chip ${String(Y.id)===String(K)?"active":""}`,onClick:()=>A(String(Y.id)),children:[e.jsx("span",{className:`status-dot status-${he}`}),e.jsx("span",{className:"user-name",children:Y.name}),e.jsxs("span",{className:"user-status",children:["(",ue,")"]})]},Y.id)})]})]})}),e.jsxs("div",{className:"screen-right",children:[e.jsxs("div",{className:"shot-toolbar",children:[e.jsx("div",{className:"shot-info",children:u?e.jsxs(e.Fragment,{children:["Application: ",e.jsx("strong",{children:u})]}):"Choose an application from App Usage."}),e.jsxs("form",{className:"shot-filter",onSubmit:te,children:[e.jsxs("div",{className:"preset-buttons",children:[e.jsx("button",{type:"button",className:`shot-btn ${m.preset==="today"?"active":""}`,onClick:()=>F("today"),children:"Today"}),e.jsx("button",{type:"button",className:`shot-btn ${m.preset==="yesterday"?"active":""}`,onClick:()=>F("yesterday"),children:"Yesterday"})]}),e.jsxs("label",{children:[e.jsx("span",{children:"From"}),e.jsxs("div",{className:"date-picker-wrap",ref:L,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"To"}),e.jsxs("div",{className:"date-picker-wrap",ref:V,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsx("button",{type:"submit",className:"shot-btn primary",children:"Apply"}),e.jsx("button",{type:"button",className:`shot-btn ${m.preset==="all"?"active":""}`,onClick:()=>F("all"),children:"Reset"})]}),e.jsxs("div",{className:"usage-total",children:["Total Time: ",Q.total_time||"0s"]})]}),e.jsxs("div",{className:"card p-3 usage-card",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",E," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"app-url-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"app-url-search",type:"text",value:y,onChange:Y=>h(Y.target.value),placeholder:"Search URLs"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"URL"}),e.jsx("th",{children:"Total Time"}),e.jsx("th",{children:"Share"})]})}),e.jsx("tbody",{children:S.length?S.map(Y=>e.jsxs("tr",{children:[e.jsx("td",{className:"text-truncate",style:{maxWidth:"380px"},children:Y.url?(()=>{const ue=VN(Y.url);return ue?e.jsx("a",{href:ue,target:"_blank",rel:"noopener noreferrer",className:"text-info text-decoration-none",children:Y.url}):Y.url})():"-"}),e.jsx("td",{children:Y.duration}),e.jsxs("td",{children:[Y.percent,"%"]})]},Y.url)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",children:"No URL data yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",k," to ",M," of ",H," entries"]}),e.jsx(He,{page:P,totalPages:I,onPageChange:$,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})]})]})}const QN={loading:!0,error:"",errorStatus:0,data:null};function Nr(t){const a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");return`${a}-${s}-${n}`}function qN(t){const a=String(t||"").trim();return a?/^https?:\/\//i.test(a)?a:/^\/\//.test(a)?`https:${a}`:/^[a-zA-Z][a-zA-Z0-9+.-]*:/.test(a)?"":a.toLowerCase().startsWith("localhost")||/^[0-9.]+(?::\d+)?(\/|$)/.test(a)?`http://${a}`:`https://${a}`:""}function YN(){const t=Nr(new Date),[a,s]=o.useState({employeeId:"",preset:"today",dateFrom:"",dateTo:""}),[n,l]=o.useState({dateFrom:t,dateTo:t}),[r,i]=o.useState(QN),[u,c]=o.useState(""),[m,x]=o.useState(""),[f,j]=o.useState(""),[N,v]=o.useState(1),_=20,C=o.useRef(null),y=o.useRef(null),h=o.useRef(null),p=o.useRef(null);o.useEffect(()=>{let I=!0;async function S(){var k;i(M=>({...M,loading:!0,error:"",errorStatus:0}));try{const M=new URLSearchParams;a.employeeId&&M.set("employee_id",a.employeeId),a.preset?M.set("preset",a.preset):(a.dateFrom&&M.set("date_from",a.dateFrom),a.dateTo&&M.set("date_to",a.dateTo));const A=M.toString()?`/api/dashboard/gaming-ott?${M.toString()}`:"/api/dashboard/gaming-ott",F=await z(A);if(!I)return;i({loading:!1,error:"",errorStatus:0,data:F})}catch(M){if((k=M==null?void 0:M.data)!=null&&k.redirect){window.location.href=M.data.redirect;return}I&&i({loading:!1,error:(M==null?void 0:M.message)||"Unable to load gaming/OTT usage.",errorStatus:(M==null?void 0:M.status)||0,data:null})}}return S(),()=>{I=!1}},[a]),o.useEffect(()=>{const I=setTimeout(()=>{j(m.trim()),v(1)},300);return()=>clearTimeout(I)},[m]);const b=r.data||{},P=b.employees||[],$=b.available_dates||[],E=b.rows||[],L=b.selected_employee_id?String(b.selected_employee_id):a.employeeId,V=o.useMemo(()=>{if(!u)return P;const I=u.toLowerCase();return P.filter(S=>S.name.toLowerCase().includes(I))},[P,u]),U=P.find(I=>String(I.id)===String(L)),w=o.useMemo(()=>{if(!f)return E;const I=f.toLowerCase();return E.filter(S=>[S.employee,S.date,S.app,S.detail,S.start,S.end,S.duration].some(M=>String(M||"").toLowerCase().includes(I)))},[E,f]),Q=w.length,J=Math.max(Math.ceil(Q/_),1),me=o.useMemo(()=>w.slice((N-1)*_,N*_),[w,N]),re=Q?(N-1)*_+1:0,K=Q?Math.min(N*_,Q):0;o.useEffect(()=>{N>J&&v(J)},[N,J]),o.useEffect(()=>{v(1)},[a]),o.useEffect(()=>{if(!window.flatpickr)return;const I=$.length?$:[],S={wrap:!0,altInput:!0,altFormat:"d-m-Y",dateFormat:"Y-m-d",altInputClass:"date-input flatpickr-input",enable:I,allowInput:!1,disableMobile:!0};C.current&&!h.current&&(h.current=window.flatpickr(C.current,{...S,onChange:(k,M)=>{l(A=>({...A,dateFrom:M}))}})),y.current&&!p.current&&(p.current=window.flatpickr(y.current,{...S,onChange:(k,M)=>{l(A=>({...A,dateTo:M}))}})),h.current&&(h.current.set("enable",I),n.dateFrom?h.current.setDate(n.dateFrom,!1):h.current.clear()),p.current&&(p.current.set("enable",I),n.dateTo?p.current.setDate(n.dateTo,!1):p.current.clear())},[$,n.dateFrom,n.dateTo]),o.useEffect(()=>()=>{h.current&&h.current.destroy(),p.current&&p.current.destroy()},[]);function O(I){s(S=>({...S,employeeId:I||""}))}function T(I){const S=new Date;if(I==="today"){const k=Nr(S);s(M=>({...M,preset:"today",dateFrom:"",dateTo:""})),l({dateFrom:k,dateTo:k})}else if(I==="yesterday"){const k=new Date(S);k.setDate(S.getDate()-1);const M=Nr(k);s(A=>({...A,preset:"yesterday",dateFrom:"",dateTo:""})),l({dateFrom:M,dateTo:M})}else s(k=>({...k,preset:"all",dateFrom:"",dateTo:""})),l({dateFrom:"",dateTo:""})}function H(I){if(I.preventDefault(),!n.dateFrom&&!n.dateTo){const k=Nr(new Date);s(M=>({...M,preset:"today",dateFrom:"",dateTo:""})),l({dateFrom:k,dateTo:k});return}s(S=>({...S,preset:"",dateFrom:n.dateFrom,dateTo:n.dateTo}))}return r.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading gaming/OTT usage..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"gallery-header",children:e.jsx("h2",{children:"Gaming / OTT Usage"})}),r.error?e.jsx("div",{className:`alert ${r.errorStatus===403?"alert-warning":"alert-danger"}`,children:r.error}):null,e.jsxs("div",{className:"screen-layout",children:[e.jsx("div",{className:"screen-left",children:e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header",children:[e.jsx("div",{className:"user-panel-title",children:"Users"}),e.jsx("div",{className:"user-search",children:e.jsx("input",{type:"text",placeholder:"Search user",value:u,onChange:I=>c(I.target.value)})})]}),e.jsxs("div",{className:"user-list",children:[e.jsx("button",{type:"button",className:`user-chip all ${L?"":"active"}`,onClick:()=>O(""),children:"All Users"}),V.map(I=>{const S=I.status||"Offline",k=S.toLowerCase();return e.jsxs("button",{type:"button",className:`user-chip ${String(I.id)===String(L)?"active":""}`,onClick:()=>O(String(I.id)),children:[e.jsx("span",{className:`status-dot status-${k}`}),e.jsx("span",{className:"user-name",children:I.name}),e.jsxs("span",{className:"user-status",children:["(",S,")"]})]},I.id)})]})]})}),e.jsxs("div",{className:"screen-right",children:[e.jsxs("div",{className:"shot-toolbar",children:[e.jsxs("div",{className:"shot-info",children:["Showing: ",U?U.name:"All Users"]}),e.jsxs("form",{className:"shot-filter",onSubmit:H,children:[e.jsxs("div",{className:"preset-buttons",children:[e.jsx("button",{type:"button",className:`shot-btn ${a.preset==="today"?"active":""}`,onClick:()=>T("today"),children:"Today"}),e.jsx("button",{type:"button",className:`shot-btn ${a.preset==="yesterday"?"active":""}`,onClick:()=>T("yesterday"),children:"Yesterday"})]}),e.jsxs("label",{children:[e.jsx("span",{children:"From"}),e.jsxs("div",{className:"date-picker-wrap",ref:C,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsxs("label",{children:[e.jsx("span",{children:"To"}),e.jsxs("div",{className:"date-picker-wrap",ref:y,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsx("button",{type:"submit",className:"shot-btn primary",children:"Apply"}),e.jsx("button",{type:"button",className:`shot-btn ${a.preset==="all"?"active":""}`,onClick:()=>T("all"),children:"Reset"})]})]}),e.jsxs("div",{className:"card p-3 usage-card",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",_," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"gaming-ott-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"gaming-ott-search",type:"text",value:m,onChange:I=>x(I.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Application"}),e.jsx("th",{children:"Title / URL"}),e.jsx("th",{children:"Start Time"}),e.jsx("th",{children:"End Time"}),e.jsx("th",{children:"Duration"})]})}),e.jsx("tbody",{children:me.length?me.map((I,S)=>e.jsxs("tr",{children:[e.jsx("td",{children:I.employee}),e.jsx("td",{children:I.date}),e.jsx("td",{children:I.app}),e.jsx("td",{className:"text-truncate",style:{maxWidth:"320px"},title:I.detail,children:I.detail?(()=>{const k=qN(I.detail);return k?e.jsx("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"text-info text-decoration-none",children:I.detail}):I.detail})():"-"}),e.jsx("td",{children:I.start}),e.jsx("td",{children:I.end}),e.jsx("td",{children:I.duration})]},`${I.employee}-${I.date}-${S}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No activity data yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",re," to ",K," of ",Q," entries"]}),e.jsx(He,{page:N,totalPages:J,onPageChange:v,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})]})]})}const Fs=[{code:"+93",label:"Afghanistan"},{code:"+355",label:"Albania"},{code:"+213",label:"Algeria"},{code:"+1",label:"American Samoa"},{code:"+376",label:"Andorra"},{code:"+244",label:"Angola"},{code:"+1",label:"Anguilla"},{code:"+672",label:"Antarctica"},{code:"+1",label:"Antigua and Barbuda"},{code:"+54",label:"Argentina"},{code:"+374",label:"Armenia"},{code:"+297",label:"Aruba"},{code:"+61",label:"Australia"},{code:"+43",label:"Austria"},{code:"+994",label:"Azerbaijan"},{code:"+1",label:"Bahamas"},{code:"+973",label:"Bahrain"},{code:"+880",label:"Bangladesh"},{code:"+1",label:"Barbados"},{code:"+375",label:"Belarus"},{code:"+32",label:"Belgium"},{code:"+501",label:"Belize"},{code:"+229",label:"Benin"},{code:"+1",label:"Bermuda"},{code:"+975",label:"Bhutan"},{code:"+591",label:"Bolivia"},{code:"+387",label:"Bosnia and Herzegovina"},{code:"+267",label:"Botswana"},{code:"+55",label:"Brazil"},{code:"+246",label:"British Indian Ocean Territory"},{code:"+1",label:"British Virgin Islands"},{code:"+673",label:"Brunei"},{code:"+359",label:"Bulgaria"},{code:"+226",label:"Burkina Faso"},{code:"+257",label:"Burundi"},{code:"+855",label:"Cambodia"},{code:"+237",label:"Cameroon"},{code:"+1",label:"Canada"},{code:"+238",label:"Cape Verde"},{code:"+1",label:"Cayman Islands"},{code:"+236",label:"Central African Republic"},{code:"+235",label:"Chad"},{code:"+56",label:"Chile"},{code:"+86",label:"China"},{code:"+61",label:"Christmas Island"},{code:"+61",label:"Cocos (Keeling) Islands"},{code:"+57",label:"Colombia"},{code:"+269",label:"Comoros"},{code:"+242",label:"Congo (Republic)"},{code:"+243",label:"Congo (DRC)"},{code:"+682",label:"Cook Islands"},{code:"+506",label:"Costa Rica"},{code:"+225",label:"Cote d'Ivoire"},{code:"+385",label:"Croatia"},{code:"+53",label:"Cuba"},{code:"+599",label:"Curacao"},{code:"+357",label:"Cyprus"},{code:"+420",label:"Czech Republic"},{code:"+45",label:"Denmark"},{code:"+253",label:"Djibouti"},{code:"+1",label:"Dominica"},{code:"+1",label:"Dominican Republic"},{code:"+593",label:"Ecuador"},{code:"+20",label:"Egypt"},{code:"+503",label:"El Salvador"},{code:"+240",label:"Equatorial Guinea"},{code:"+291",label:"Eritrea"},{code:"+372",label:"Estonia"},{code:"+268",label:"Eswatini"},{code:"+251",label:"Ethiopia"},{code:"+500",label:"Falkland Islands"},{code:"+298",label:"Faroe Islands"},{code:"+679",label:"Fiji"},{code:"+358",label:"Finland"},{code:"+33",label:"France"},{code:"+594",label:"French Guiana"},{code:"+689",label:"French Polynesia"},{code:"+241",label:"Gabon"},{code:"+220",label:"Gambia"},{code:"+995",label:"Georgia"},{code:"+49",label:"Germany"},{code:"+233",label:"Ghana"},{code:"+350",label:"Gibraltar"},{code:"+30",label:"Greece"},{code:"+299",label:"Greenland"},{code:"+1",label:"Grenada"},{code:"+590",label:"Guadeloupe"},{code:"+1",label:"Guam"},{code:"+502",label:"Guatemala"},{code:"+44",label:"Guernsey"},{code:"+224",label:"Guinea"},{code:"+245",label:"Guinea-Bissau"},{code:"+592",label:"Guyana"},{code:"+509",label:"Haiti"},{code:"+504",label:"Honduras"},{code:"+852",label:"Hong Kong"},{code:"+36",label:"Hungary"},{code:"+354",label:"Iceland"},{code:"+91",label:"India"},{code:"+62",label:"Indonesia"},{code:"+98",label:"Iran"},{code:"+964",label:"Iraq"},{code:"+353",label:"Ireland"},{code:"+44",label:"Isle of Man"},{code:"+972",label:"Israel"},{code:"+39",label:"Italy"},{code:"+1",label:"Jamaica"},{code:"+81",label:"Japan"},{code:"+44",label:"Jersey"},{code:"+962",label:"Jordan"},{code:"+7",label:"Kazakhstan"},{code:"+254",label:"Kenya"},{code:"+686",label:"Kiribati"},{code:"+965",label:"Kuwait"},{code:"+996",label:"Kyrgyzstan"},{code:"+856",label:"Laos"},{code:"+371",label:"Latvia"},{code:"+961",label:"Lebanon"},{code:"+266",label:"Lesotho"},{code:"+231",label:"Liberia"},{code:"+218",label:"Libya"},{code:"+423",label:"Liechtenstein"},{code:"+370",label:"Lithuania"},{code:"+352",label:"Luxembourg"},{code:"+853",label:"Macao"},{code:"+261",label:"Madagascar"},{code:"+265",label:"Malawi"},{code:"+60",label:"Malaysia"},{code:"+960",label:"Maldives"},{code:"+223",label:"Mali"},{code:"+356",label:"Malta"},{code:"+692",label:"Marshall Islands"},{code:"+596",label:"Martinique"},{code:"+222",label:"Mauritania"},{code:"+230",label:"Mauritius"},{code:"+262",label:"Mayotte"},{code:"+52",label:"Mexico"},{code:"+691",label:"Micronesia"},{code:"+373",label:"Moldova"},{code:"+377",label:"Monaco"},{code:"+976",label:"Mongolia"},{code:"+382",label:"Montenegro"},{code:"+1",label:"Montserrat"},{code:"+212",label:"Morocco"},{code:"+258",label:"Mozambique"},{code:"+95",label:"Myanmar"},{code:"+264",label:"Namibia"},{code:"+674",label:"Nauru"},{code:"+977",label:"Nepal"},{code:"+31",label:"Netherlands"},{code:"+687",label:"New Caledonia"},{code:"+64",label:"New Zealand"},{code:"+505",label:"Nicaragua"},{code:"+227",label:"Niger"},{code:"+234",label:"Nigeria"},{code:"+683",label:"Niue"},{code:"+850",label:"North Korea"},{code:"+389",label:"North Macedonia"},{code:"+1",label:"Northern Mariana Islands"},{code:"+47",label:"Norway"},{code:"+968",label:"Oman"},{code:"+92",label:"Pakistan"},{code:"+680",label:"Palau"},{code:"+970",label:"Palestine"},{code:"+507",label:"Panama"},{code:"+675",label:"Papua New Guinea"},{code:"+595",label:"Paraguay"},{code:"+51",label:"Peru"},{code:"+63",label:"Philippines"},{code:"+48",label:"Poland"},{code:"+351",label:"Portugal"},{code:"+1",label:"Puerto Rico"},{code:"+974",label:"Qatar"},{code:"+262",label:"Reunion"},{code:"+40",label:"Romania"},{code:"+7",label:"Russia"},{code:"+250",label:"Rwanda"},{code:"+590",label:"Saint Barthelemy"},{code:"+290",label:"Saint Helena"},{code:"+1",label:"Saint Kitts and Nevis"},{code:"+1",label:"Saint Lucia"},{code:"+590",label:"Saint Martin"},{code:"+508",label:"Saint Pierre and Miquelon"},{code:"+1",label:"Saint Vincent and the Grenadines"},{code:"+685",label:"Samoa"},{code:"+378",label:"San Marino"},{code:"+239",label:"Sao Tome and Principe"},{code:"+966",label:"Saudi Arabia"},{code:"+221",label:"Senegal"},{code:"+381",label:"Serbia"},{code:"+248",label:"Seychelles"},{code:"+232",label:"Sierra Leone"},{code:"+65",label:"Singapore"},{code:"+421",label:"Slovakia"},{code:"+386",label:"Slovenia"},{code:"+677",label:"Solomon Islands"},{code:"+252",label:"Somalia"},{code:"+27",label:"South Africa"},{code:"+82",label:"South Korea"},{code:"+211",label:"South Sudan"},{code:"+34",label:"Spain"},{code:"+94",label:"Sri Lanka"},{code:"+249",label:"Sudan"},{code:"+597",label:"Suriname"},{code:"+46",label:"Sweden"},{code:"+41",label:"Switzerland"},{code:"+963",label:"Syria"},{code:"+886",label:"Taiwan"},{code:"+992",label:"Tajikistan"},{code:"+255",label:"Tanzania"},{code:"+66",label:"Thailand"},{code:"+670",label:"Timor-Leste"},{code:"+228",label:"Togo"},{code:"+690",label:"Tokelau"},{code:"+676",label:"Tonga"},{code:"+1",label:"Trinidad and Tobago"},{code:"+216",label:"Tunisia"},{code:"+90",label:"Turkey"},{code:"+993",label:"Turkmenistan"},{code:"+1",label:"Turks and Caicos Islands"},{code:"+688",label:"Tuvalu"},{code:"+256",label:"Uganda"},{code:"+380",label:"Ukraine"},{code:"+971",label:"United Arab Emirates"},{code:"+44",label:"United Kingdom"},{code:"+1",label:"United States"},{code:"+598",label:"Uruguay"},{code:"+998",label:"Uzbekistan"},{code:"+678",label:"Vanuatu"},{code:"+379",label:"Vatican City"},{code:"+58",label:"Venezuela"},{code:"+84",label:"Vietnam"},{code:"+681",label:"Wallis and Futuna"},{code:"+212",label:"Western Sahara"},{code:"+967",label:"Yemen"},{code:"+260",label:"Zambia"},{code:"+263",label:"Zimbabwe"},{code:"+358",label:"Aland Islands"},{code:"+383",label:"Kosovo"}],Dg=Array.from(new Set(Fs.map(t=>t.label)));Dg.sort((t,a)=>t.localeCompare(a));const Ai=Dg,KN={loading:!0,error:"",data:null},Mo={contact_name:"",company_name:"",email:"",phone:"",address_line1:"",address_line2:"",city:"",state:"",postal_code:"",country:"India",gstin:""},JN=["contact_name","company_name","email","address_line1","city","state","postal_code","country","gstin"],ZN={india:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"]};function XN(t){return String(t||"").trim().toLowerCase()}function e_(t){return ZN[XN(t)]||[]}function t_(t){return JN.filter(a=>!String((t==null?void 0:t[a])||"").trim())}function a_(){const[t,a]=o.useState(KN),[s,n]=o.useState(""),[l,r]=o.useState(""),[i,u]=o.useState(Mo),[c,m]=o.useState(!1),[x,f]=o.useState(!1),[j,N]=o.useState(""),[v,_]=o.useState(""),[C,y]=o.useState([]);async function h(){var K;const re=await z("/api/dashboard/company");a({loading:!1,error:"",data:re}),r(((K=re.settings)==null?void 0:K.screenshot_interval_minutes)??"")}o.useEffect(()=>{const re={current:!0};async function K(){var O,T;n("");try{const H=await z("/api/dashboard/company");if(re&&!re.current)return;a({loading:!1,error:"",data:H}),r(((O=H.settings)==null?void 0:O.screenshot_interval_minutes)??"")}catch(H){if((T=H==null?void 0:H.data)!=null&&T.redirect){window.location.href=H.data.redirect;return}(!re||re.current)&&a({loading:!1,error:(H==null?void 0:H.message)||"Unable to load company settings.",data:null})}}return K(),p(re),()=>{re.current=!1}},[]);async function p(re){var K;N(""),_("");try{const O=await z("/api/dashboard/billing-profile");if(re&&!re.current)return;u(O.profile||Mo),y(O.missing_fields||[]),m(!0)}catch(O){if((K=O==null?void 0:O.data)!=null&&K.redirect){window.location.href=O.data.redirect;return}(!re||re.current)&&(_((O==null?void 0:O.message)||"Unable to load billing details."),m(!0))}}async function b(re){re.preventDefault(),n("");try{const K=await z("/api/dashboard/company/interval",{method:"POST",body:JSON.stringify({interval:l})});n(`Screenshot interval updated to ${K.screenshot_interval_minutes} minutes.`),await h()}catch(K){n(""),a(O=>({...O,error:(K==null?void 0:K.message)||"Unable to update interval."}))}}function P(re){const{name:K,value:O}=re.target;u(T=>K==="country"?{...T,country:O,state:T.state&&T.state.trim()?T.state:""}:{...T,[K]:O})}async function $(re){var K,O;re.preventDefault(),N(""),_(""),f(!0);try{const T=await z("/api/dashboard/billing-profile",{method:"POST",body:JSON.stringify(i)});u(T.profile||Mo),y(T.missing_fields||[]),N("Billing details saved.")}catch(T){if((K=T==null?void 0:T.data)!=null&&K.redirect){window.location.href=T.data.redirect;return}(O=T==null?void 0:T.data)!=null&&O.missing_fields&&y(T.data.missing_fields),(T==null?void 0:T.message)==="invalid_gstin"?_("Please enter a valid GSTIN."):_((T==null?void 0:T.message)||"Unable to save billing details.")}finally{f(!1)}}if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading company settings..."})]});const E=t.data||{},L=E.org||{},V=E.subscription||null,U=E.counts||{},w=E.allowed_intervals||[],Q=t_(i),J=C.length?C:Q,me=Q.length===0;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:L.name||"Company Settings"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-lg-3",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h4",{children:"Company Details"}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Name"}),e.jsx("strong",{children:L.name||"-"})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Company Key"}),e.jsx("strong",{children:L.company_key||"-"})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Created"}),e.jsx("strong",{children:L.created_at||"-"})]}),e.jsx(et,{to:"/company/edit",className:"btn btn-primary mt-3",children:"Edit Company"})]})}),e.jsx("div",{className:"col-12 col-lg-3",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h4",{children:"Subscription"}),V?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Plan"}),e.jsx("strong",{children:V.plan})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Employees Allowed"}),e.jsx("strong",{children:V.employee_limit===0?"Unlimited":V.employee_limit})]}),V.end_date?e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Valid Till"}),e.jsx("strong",{children:V.end_date})]}):null]}):e.jsx("div",{className:"monitor-summary-note",children:"No Active Subscription"}),e.jsx(et,{to:"/plans",className:"btn btn-outline-primary mt-2 manage-plan-btn",children:"Manage Plan"})]})}),e.jsx("div",{className:"col-12 col-lg-2",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h4",{children:"Plan Limits"}),V?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Employee Limit"}),e.jsx("strong",{children:V.employee_limit===0?"Unlimited":V.employee_limit})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Retention Days"}),e.jsx("strong",{children:V.plan_retention_days??"-"})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Min Screenshot"}),e.jsxs("strong",{children:[V.screenshot_min_minutes," minutes"]})]})]}):e.jsx("div",{className:"monitor-summary-note",children:"No active plan details."})]})}),e.jsx("div",{className:"col-12 col-lg-2",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h4",{children:"Usage Summary"}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Total Employees"}),e.jsx("strong",{children:U.employees??0})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Total Activities"}),e.jsx("strong",{children:U.activities??0})]}),e.jsxs("div",{className:"monitor-summary-row",children:[e.jsx("span",{children:"Total Screenshots"}),e.jsx("strong",{children:U.screenshots??0})]})]})}),e.jsx("div",{className:"col-12 col-lg-2",children:e.jsxs("div",{className:"card p-3 h-100 monitor-summary-card",children:[e.jsx("h4",{children:"Screenshot Interval"}),e.jsx("form",{className:"mt-2",onSubmit:b,children:e.jsxs("div",{className:"d-flex gap-2 align-items-center monitor-summary-row monitor-summary-row--accent",children:[e.jsx("select",{className:"form-select",style:{maxWidth:"140px"},value:l,onChange:re=>r(re.target.value),children:w.map(re=>e.jsxs("option",{value:re,children:[re," minutes"]},re))}),e.jsx("button",{className:"btn btn-primary",type:"submit",children:"Save"})]})})]})})]}),e.jsx("hr",{className:"section-divider"}),e.jsxs("div",{className:"card p-3 mt-3",id:"billing-details",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:"Billing Information & GST"}),e.jsx("p",{className:"text-secondary mb-0",children:"Required before paid plans and used for invoice generation."})]}),e.jsx("span",{className:`badge ${me?"bg-success":"bg-warning text-dark"}`,children:me?"Complete":"Incomplete"})]}),j?e.jsx("div",{className:"alert alert-success mt-2",children:j}):null,v?e.jsx("div",{className:"alert alert-danger mt-2",children:v}):null,c?e.jsxs("form",{onSubmit:$,children:[e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Contact Name"}),e.jsx("input",{type:"text",name:"contact_name",className:`form-control ${J.includes("contact_name")?"is-invalid":""}`,value:i.contact_name,onChange:P,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Company Name"}),e.jsx("input",{type:"text",name:"company_name",className:`form-control ${J.includes("company_name")?"is-invalid":""}`,value:i.company_name,onChange:P,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",name:"email",className:`form-control ${J.includes("email")?"is-invalid":""}`,value:i.email,onChange:P,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Phone (optional)"}),e.jsx("input",{type:"tel",name:"phone",className:"form-control",value:i.phone,onChange:P})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Address Line 1"}),e.jsx("input",{type:"text",name:"address_line1",className:`form-control ${J.includes("address_line1")?"is-invalid":""}`,value:i.address_line1,onChange:P,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Address Line 2 (optional)"}),e.jsx("input",{type:"text",name:"address_line2",className:"form-control",value:i.address_line2,onChange:P})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",name:"city",className:`form-control ${J.includes("city")?"is-invalid":""}`,value:i.city,onChange:P,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{type:"text",name:"country",className:`form-control ${J.includes("country")?"is-invalid":""}`,value:i.country,onChange:P,list:"country-options",required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"State"}),e.jsx("input",{type:"text",name:"state",className:`form-control ${J.includes("state")?"is-invalid":""}`,value:i.state,onChange:P,list:"state-options",disabled:!String(i.country||"").trim(),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Postal Code"}),e.jsx("input",{type:"text",name:"postal_code",className:`form-control ${J.includes("postal_code")?"is-invalid":""}`,value:i.postal_code,onChange:P,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"GSTIN"}),e.jsx("input",{type:"text",name:"gstin",className:`form-control ${J.includes("gstin")?"is-invalid":""}`,value:i.gstin,onChange:re=>P({target:{name:"gstin",value:re.target.value.toUpperCase()}}),maxLength:15,placeholder:"15-character GSTIN",required:!0})]})]}),e.jsx("datalist",{id:"country-options",children:Ai.map(re=>e.jsx("option",{value:re},re))}),e.jsx("datalist",{id:"state-options",children:e_(i.country).map(re=>e.jsx("option",{value:re},re))}),e.jsx("button",{className:"btn btn-primary btn-sm mt-3",type:"submit",disabled:x,children:x?"Saving...":"Save Billing Details"})]}):e.jsx("div",{className:"text-secondary mt-2",children:"Loading billing details..."})]})]})}const s_={loading:!0,error:"",data:null};function n_(){const[t,a]=o.useState(s_),[s,n]=o.useState(""),[l,r]=o.useState(2),[i,u]=o.useState(!1),[c,m]=o.useState(""),[x,f]=o.useState(""),[j,N]=o.useState(!0),[v,_]=o.useState(!0),[C,y]=o.useState(!0),[h,p]=o.useState(!0),[b,P]=o.useState(""),[$,E]=o.useState({open:!1,message:""}),[L,V]=o.useState(!1);async function U(){var H,I,S,k,M,A,F,te;const T=await z("/api/dashboard/company");a({loading:!1,error:"",data:T}),r(((H=T.privacy)==null?void 0:H.support_duration_selected)||2),u(!!((I=T.privacy)!=null&&I.support_access_enabled)),m(((S=T.settings)==null?void 0:S.screenshot_ignore_patterns)??""),f(((k=T.settings)==null?void 0:k.privacy_keyword_rules)??""),N(((M=T.settings)==null?void 0:M.auto_blur_password_fields)??!0),_(((A=T.settings)==null?void 0:A.auto_blur_otp_fields)??!0),y(((F=T.settings)==null?void 0:F.auto_blur_card_fields)??!0),p(((te=T.settings)==null?void 0:te.auto_blur_email_inbox)??!0)}o.useEffect(()=>{let T=!0;async function H(){var I,S,k,M,A,F,te,Y,ue;n("");try{const he=await z("/api/dashboard/company");if(!T)return;a({loading:!1,error:"",data:he}),r(((I=he.privacy)==null?void 0:I.support_duration_selected)||2),u(!!((S=he.privacy)!=null&&S.support_access_enabled)),m(((k=he.settings)==null?void 0:k.screenshot_ignore_patterns)??""),f(((M=he.settings)==null?void 0:M.privacy_keyword_rules)??""),N(((A=he.settings)==null?void 0:A.auto_blur_password_fields)??!0),_(((F=he.settings)==null?void 0:F.auto_blur_otp_fields)??!0),y(((te=he.settings)==null?void 0:te.auto_blur_card_fields)??!0),p(((Y=he.settings)==null?void 0:Y.auto_blur_email_inbox)??!0)}catch(he){if((ue=he==null?void 0:he.data)!=null&&ue.redirect){window.location.href=he.data.redirect;return}T&&a({loading:!1,error:(he==null?void 0:he.message)||"Unable to load privacy settings.",data:null})}}return H(),()=>{T=!1}},[]);async function w(T){T.preventDefault(),n("");try{await z("/api/dashboard/company/support-access",{method:"POST",body:JSON.stringify({support_access_enabled:i,support_access_hours:l})}),n("Support access settings updated."),await U()}catch(H){n(""),a(I=>({...I,error:(H==null?void 0:H.message)||"Unable to update support access."}))}}async function Q(T){T.preventDefault(),n("");try{await z("/api/dashboard/company/screenshot-privacy",{method:"POST",body:JSON.stringify({ignore_patterns:c,privacy_keyword_rules:x,auto_blur_password_fields:j,auto_blur_otp_fields:v,auto_blur_card_fields:C,auto_blur_email_inbox:h})}),n("Screenshot privacy list updated."),await U()}catch(H){n(""),a(I=>({...I,error:(H==null?void 0:H.message)||"Unable to update screenshot privacy list."}))}}function J(T){const H=(T||"").trim();if(!H)return"";const I=H.toLowerCase();return I.startsWith("url:")||I.startsWith("app:")||I.startsWith("title:")||I.startsWith("window:")?H:`*${H.replace(/^https?:\/\//i,"").replace(/^www\./i,"")}*`}function me(){const T=J(b);if(!T){E({open:!0,message:"Please enter a website URL."});return}m(H=>H.trim()?`${H.trim()}
${T}`:T),E({open:!0,message:`Added to privacy list: ${T}`}),P("")}if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading privacy settings..."})]});const re=t.data||{},K=re.org||{},O=re.privacy||{};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Privacy Settings"}),e.jsxs("p",{className:"text-secondary mb-1",children:["Organization: ",e.jsx("strong",{children:K.name||"-"})]}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,O.show?e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Monitoring Mode"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"badge bg-primary",children:"Privacy Lock - Enabled"}),e.jsx("div",{className:"text-secondary mt-2",children:"Only org admins can access employee activity and screenshot data. Even super admins do not have access in this mode."})]}),e.jsx("hr",{className:"section-divider my-3"}),e.jsx("h5",{children:"Support Access Duration (hours)"}),e.jsxs("form",{className:"mt-2",onSubmit:w,children:[e.jsx("select",{className:"form-select",value:l,onChange:T=>r(Number(T.target.value)),children:(O.support_duration_options||[]).map(T=>e.jsxs("option",{value:T,children:[T," hour",T!==1?"s":""]},T))}),e.jsx("div",{className:"form-text text-secondary",children:"Applies only when support access is enabled."}),e.jsx("div",{className:"form-text text-secondary",children:"Support access is available only in Privacy Lock mode."}),e.jsxs("div",{className:"form-check mt-2",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"supportAccessEnabled",checked:i,onChange:T=>u(T.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"supportAccessEnabled",children:"Enable Temporary Support Access"})]}),e.jsx("div",{className:"mt-3",children:O.support_active?e.jsxs("span",{className:"badge bg-success",children:["Active until ",O.support_access_until,O.support_remaining?` (${O.support_remaining} left)`:""]}):O.support_access_until?e.jsx("span",{className:"badge bg-danger",children:"Support access expired"}):e.jsx("span",{className:"text-secondary",children:"Support access is disabled."})}),e.jsx("button",{className:"btn btn-primary mt-3",type:"submit",children:"Save Support Access"})]})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Screenshot Privacy List"}),e.jsx("p",{className:"text-secondary mb-2",children:"Add URL or app patterns to blur screenshots on sensitive screens."}),e.jsxs("div",{className:"alert alert-info py-2",children:["Default blur rules apply for user privacy purpose.",e.jsx("button",{type:"button",className:"btn btn-link p-0 ms-2",onClick:()=>V(!0),children:"Click to View"})]}),e.jsxs("form",{onSubmit:Q,children:[e.jsx("textarea",{className:"form-control",rows:"6",value:c,onChange:T=>m(T.target.value),placeholder:`https://netbanking*
https://admin.company.com/*
outlook.office.com/*`}),e.jsx("div",{className:"form-text text-secondary",children:"One pattern per line. Use * wildcards. Matches URL, app name, or window title. Prefix with url:, app:, or title: to target one field."}),e.jsxs("div",{className:"d-flex flex-wrap gap-2 mt-3",children:[e.jsx("input",{type:"text",className:"form-control",style:{maxWidth:"260px"},placeholder:"Add website URL",value:b,onChange:T=>P(T.target.value)}),e.jsx("button",{className:"btn btn-outline-primary",type:"button",onClick:me,children:"Add Website URL"})]}),e.jsx("hr",{className:"section-divider my-3"}),e.jsx("h6",{children:"Additional Keyword Rules"}),e.jsx("p",{className:"text-secondary mb-2",children:"Add extra keywords for your company. Default rules stay active and cannot be removed."}),e.jsx("textarea",{className:"form-control",rows:"5",value:x,onChange:T=>f(T.target.value),placeholder:`netbank
internet banking
payment gateway
upi`}),e.jsx("div",{className:"form-text text-secondary",children:"One keyword per line. Matching happens on URL or window title."}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Auto-Blur Switches"}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"autoBlurPasswordFields",checked:j,onChange:T=>N(T.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"autoBlurPasswordFields",children:"Blur when password fields are detected"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"autoBlurOtpFields",checked:v,onChange:T=>_(T.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"autoBlurOtpFields",children:"Blur when OTP fields are detected"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"autoBlurCardFields",checked:C,onChange:T=>y(T.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"autoBlurCardFields",children:"Blur on card or payment forms"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"autoBlurEmailInbox",checked:h,onChange:T=>p(T.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"autoBlurEmailInbox",children:"Blur email inbox views"})]})]}),e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:e.jsx("button",{className:"btn btn-primary",type:"submit",children:"Save Privacy List"})})]})]})})]}):e.jsx("div",{className:"alert alert-warning",children:"Privacy settings are managed by super admin for this account."}),$.open?e.jsx("div",{className:"modal-overlay",onClick:()=>E({open:!1,message:""}),children:e.jsxs("div",{className:"modal-panel",onClick:T=>T.stopPropagation(),children:[e.jsx("h5",{children:"Privacy List Updated"}),e.jsx("div",{className:"text-secondary mb-2",children:$.message}),e.jsx("div",{className:"d-flex justify-content-end gap-2 mt-3",children:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>E({open:!1,message:""}),children:"OK"})})]})}):null,L?e.jsx("div",{className:"modal-overlay",onClick:()=>V(!1),children:e.jsxs("div",{className:"modal-panel",onClick:T=>T.stopPropagation(),children:[e.jsx("h5",{children:"Blur Action Lists"}),e.jsx("div",{className:"text-secondary mb-3",children:"These are the privacy rules applied to blur sensitive screens."}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Phase 1: Domain / URL Match (optional)"}),e.jsx("div",{className:"text-secondary",children:"Examples: admin.company.com/*, myhr.internal/*"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Phase 2: Keyword-Based Rules"}),e.jsx("div",{className:"text-secondary",children:"Blur if URL or title contains keywords like: netbank, netbanking, internet banking, payment gateway, upi, card payment, account login, sign in, mail inbox, webmail, roundcube."})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Phase 3: Page Type Detection Rules"}),e.jsx("div",{className:"text-secondary",children:"Blur when we detect password fields, credit card fields, OTP fields, or netbanking forms."})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Phase 4: Sensitive Page Auto-Detection (Toggle)"}),e.jsx("div",{className:"text-secondary",children:"Admin can enable: blur when password fields exist, blur when OTP field exists, blur on card or payment forms, blur email inbox view."})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Global Keyword Privacy Rules"}),e.jsx("div",{className:"text-secondary",children:"Examples: netbank, internet banking, loan account, credit card payment, beneficiary transfer, income tax portal, payslip, salary slip, confidential."})]}),e.jsx("div",{className:"d-flex justify-content-end gap-2 mt-3",children:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>V(!1),children:"Close"})})]})}):null]})}const l_={loading:!0,error:"",name:""};function r_(){const t=fs(),[a,s]=o.useState(l_),[n,l]=o.useState("");o.useEffect(()=>{let i=!0;async function u(){var c,m;try{const x=await z("/api/dashboard/company");if(!i)return;const f=((c=x.org)==null?void 0:c.name)||"";l(f),s({loading:!1,error:"",name:f})}catch(x){if((m=x==null?void 0:x.data)!=null&&m.redirect){window.location.href=x.data.redirect;return}i&&s({loading:!1,error:(x==null?void 0:x.message)||"Unable to load company details.",name:""})}}return u(),()=>{i=!1}},[]);async function r(i){i.preventDefault();try{await z("/api/dashboard/company/name",{method:"POST",body:JSON.stringify({name:n})}),t("/company")}catch(u){s(c=>({...c,error:(u==null?void 0:u.message)||"Unable to update company."}))}}return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading company..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Edit Company"}),e.jsx("hr",{className:"section-divider"}),a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):null,e.jsxs("form",{onSubmit:r,children:[e.jsx("label",{className:"form-label",children:"Company Name"}),e.jsx("input",{type:"text",className:"form-control",value:n,onChange:i=>l(i.target.value),required:!0}),e.jsxs("div",{className:"mt-3 d-flex gap-2",children:[e.jsx("button",{className:"btn btn-success",type:"submit",children:"Save"}),e.jsx(et,{to:"/company",className:"btn btn-outline-light",children:"Cancel"})]})]})]})}const i_={loading:!0,error:"",data:null};function Rt(t){return t==null||t===""?"-":t}function Ma(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}function $o(t){return t?t==="online"?"Online":Ma(t):"Bank Transfer"}function Ws(t,a){return a==null||a===""?"-":t?`${t} ${a}`:a}function o_(t,a){const s=Number(t||0),n=Number(a||0);if(!s||!n)return{base:s,tax:0,total:s};const l=Math.round(s/(1+n/100)*100)/100,r=Math.round((s-l)*100)/100;return{base:l,tax:r,total:s}}function c_(t,a,s){return t?s==="USD"?a==="yearly"?t.usd_yearly_price:t.usd_monthly_price:a==="yearly"?t.yearly_price:t.monthly_price:0}function d_(t,a,s){return t?s==="USD"?a==="yearly"?t.addon_usd_yearly_price:t.addon_usd_monthly_price:a==="yearly"?t.addon_yearly_price:t.addon_monthly_price:0}function u_(t){const a=(t==null?void 0:t.limits)||{},s=a.storage_gb??a.storage_limit_gb??0;return Number(s||0)}function m_(t){const a=(t==null?void 0:t.limits)||{},s=a.bandwidth_limit_gb_monthly??a.bandwidth_limit_gb??0;return Number(s||0)}function h_(t){return((t==null?void 0:t.limits)||{}).is_bandwidth_limited!==!1}function f_(t){const a=(t==null?void 0:t.limits)||{},s=a.max_users??a.user_limit??0;return Number(s||0)}function p_(t){return t?`${t} GB`:"-"}function x_(t,a){return a?t?`${t} GB / month`:"-":"Unlimited"}function g_(t){return t||"Unlimited"}function j_(){var ea,ya,ta,ts,ca,Ga,da,Ha,Lt,aa,at,Nt,sa,se,be,We;const t=ae=>String(ae||"").toLowerCase()==="trialing"?"status-pill status-pill--trialing":"status-pill",a=typeof window<"u"?window.location.pathname:"",n=(typeof window<"u"?window.__WZ_PRODUCT_SLUG__:"")||(a.includes("/ai-chatbot")?"ai-chatbot":a.includes("/storage")?"storage":"monitor"),l=n==="ai-chatbot",r=n==="storage"||n==="online-storage",i=n,[u,c]=o.useState(i_),[m,x]=o.useState(""),[f,j]=o.useState(0),[N,v]=o.useState({loading:!0,plans:[],taxRate:0,taxCurrency:"INR"}),[_,C]=o.useState({open:!1,entry:null,addonCount:0}),[y,h]=o.useState(1),[p,b]=o.useState(1),[P,$]=o.useState(1),[E,L]=o.useState(""),[V,U]=o.useState(""),[w,Q]=o.useState(""),[J,me]=o.useState(""),[re,K]=o.useState(""),[O,T]=o.useState(""),H=5,[I,S]=o.useState({open:!1,entry:null});async function k(){const ae=await z(`/api/dashboard/billing?product=${i}`);c({loading:!1,error:"",data:ae}),j(0)}async function M(ae){try{const Pe=await z(`/api/dashboard/plans?product=${i}`);if(ae&&!ae.current)return;v({loading:!1,plans:(Pe==null?void 0:Pe.plans)||[],taxRate:Number((Pe==null?void 0:Pe.tax_rate)||0),taxCurrency:(Pe==null?void 0:Pe.tax_currency)||"INR"})}catch{(!ae||ae.current)&&v(Ve=>({...Ve,loading:!1}))}}o.useEffect(()=>{let ae=!0;async function Pe(){var Ve;x("");try{const ze=await z(`/api/dashboard/billing?product=${i}`);if(!ae)return;c({loading:!1,error:"",data:ze}),j(0)}catch(ze){if((Ve=ze==null?void 0:ze.data)!=null&&Ve.redirect){window.location.href=ze.data.redirect;return}ae&&c({loading:!1,error:(ze==null?void 0:ze.message)||"Unable to load billing details.",data:null})}}return Pe(),()=>{ae=!1}},[]),o.useEffect(()=>{const ae={current:!0};return M(ae),()=>{ae.current=!1}},[]),o.useEffect(()=>{const ae=setTimeout(()=>{U(E.trim()),h(1)},300);return()=>clearTimeout(ae)},[E]),o.useEffect(()=>{const ae=setTimeout(()=>{me(w.trim()),b(1)},300);return()=>clearTimeout(ae)},[w]),o.useEffect(()=>{const ae=setTimeout(()=>{T(re.trim()),$(1)},300);return()=>clearTimeout(ae)},[re]);async function A(ae){var Pe;ae.preventDefault(),x("");try{const Ve=await z("/api/dashboard/employees/addons",{method:"POST",body:JSON.stringify({addon_count:f})});if(Ve!=null&&Ve.redirect){window.location.href=Ve.redirect;return}x("Add-ons updated."),j(0),await k()}catch(Ve){if((Pe=Ve==null?void 0:Ve.data)!=null&&Pe.redirect){window.location.href=Ve.data.redirect;return}x(""),c(ze=>({...ze,error:(Ve==null?void 0:Ve.message)||"Unable to update add-ons."}))}}function F(ae){const Pe=ae?qe==null?void 0:qe[ae.plan_id]:null,Ve=Pe!=null&&Pe.allow_addons?(G==null?void 0:G.addon_count)??1:0;C({open:!0,entry:ae,addonCount:Math.max(0,Number(Ve||0))})}function te(){C(ae=>({...ae,open:!1}))}function Y(ae){C(Pe=>{const Ve=Math.max(0,Number(Pe.addonCount||0)+ae);return{...Pe,addonCount:Ve}})}function ue(ae){const Pe=Number(ae.target.value||0);C(Ve=>({...Ve,addonCount:Number.isNaN(Pe)?0:Math.max(0,Pe)}))}async function he(ae,Pe){var Ve;if(ae!=null&&ae.plan_id){x("");try{const ze=await z(`/api/dashboard/plans/subscribe/${ae.plan_id}`,{method:"POST",body:JSON.stringify({billing_cycle:ae.billing_cycle||"monthly",addon_count:Pe,product:i})});if(ze!=null&&ze.redirect){window.location.href=ze.redirect;return}ze!=null&&ze.message?x(ze.message):x("Renewal request submitted."),await k()}catch(ze){if((Ve=ze==null?void 0:ze.data)!=null&&Ve.redirect){window.location.href=ze.data.redirect;return}c(ht=>({...ht,error:(ze==null?void 0:ze.message)||"Unable to renew plan."}))}}}const ye=u.data||{},G=ye.subscription||null,Ne=ye.show_currency||(G==null?void 0:G.currency)||"INR",_e=(G==null?void 0:G.prices)||{},de=ye.history_entries||[],Re=ye.approved_transfers||[],je=ye.pending_transfers||[],Ae=N.taxRate||0,Qe=N.taxCurrency||"INR",qe=o.useMemo(()=>{const ae={};return(N.plans||[]).forEach(Pe=>{ae[Pe.id]=Pe}),ae},[N.plans]),Je=o.useMemo(()=>{if(!V)return de;const ae=V.toLowerCase();return de.filter(Pe=>[Pe.plan,Pe.status,Pe.status_label,Pe.start_date,Pe.end_date].some(ze=>String(ze||"").toLowerCase().includes(ae)))},[de,V]),Ye=o.useMemo(()=>{if(!J)return Re;const ae=J.toLowerCase();return Re.filter(Pe=>[Pe.request_type,Pe.payment_type,Pe.plan,Pe.amount,Pe.status,Pe.updated_at,Pe.currency].some(ze=>String(ze||"").toLowerCase().includes(ae)))},[Re,J]),oe=o.useMemo(()=>{if(!O)return je;const ae=O.toLowerCase();return je.filter(Pe=>[Pe.request_type,Pe.payment_type,Pe.plan,Pe.amount,Pe.status_label,Pe.status,Pe.created_at,Pe.currency].some(ze=>String(ze||"").toLowerCase().includes(ae)))},[je,O]),ve=Je.length,Z=Ye.length,ce=oe.length,xe=Math.max(Math.ceil(ve/H),1),Ce=Math.max(Math.ceil(Z/H),1),Fe=Math.max(Math.ceil(ce/H),1),Ze=o.useMemo(()=>Je.slice((y-1)*H,y*H),[Je,y]),ne=o.useMemo(()=>Ye.slice((p-1)*H,p*H),[Ye,p]),Ie=o.useMemo(()=>oe.slice((P-1)*H,P*H),[oe,P]),Oe=ve?(y-1)*H+1:0,Me=ve?Math.min(y*H,ve):0,st=Z?(p-1)*H+1:0,Dt=Z?Math.min(p*H,Z):0,W=ce?(P-1)*H+1:0,pe=ce?Math.min(P*H,ce):0;function fe(ae){S({open:!0,entry:ae})}function D(){S({open:!1,entry:null})}if(o.useEffect(()=>{y>xe&&h(xe)},[y,xe]),o.useEffect(()=>{p>Ce&&b(Ce)},[p,Ce]),o.useEffect(()=>{P>Fe&&$(Fe)},[P,Fe]),u.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading billing..."})]});const X=_.entry,q=X?qe[X.plan_id]:null,ie=(X==null?void 0:X.billing_cycle)||"monthly",Ee=Number(_.addonCount||0),tt=q?Number(c_(q,ie,Ne)||0):0,B=q&&q.allow_addons?Number(d_(q,ie,Ne)||0):0,le=Math.round(B*Ee*100)/100,Te=Math.round((tt+le)*100)/100,Se=Ne===Qe&&Ae>0,Le=Se?Math.round(Te*(Ae/100)*100)/100:0,lt=Math.round((Te+Le)*100)/100,Ut=q&&q.employee_limit===0?"Unlimited":(q==null?void 0:q.employee_limit)??"-",Ba=q&&q.employee_limit===0?"Unlimited":Number((q==null?void 0:q.employee_limit)||0)+Ee,Wa=Number((G==null?void 0:G.addon_count)||0),Va=q&&q.employee_limit===0?"Unlimited":(q==null?void 0:q.employee_limit)??"-",Ct=Va==="Unlimited"?1:Va,kt=I.entry?o_(I.entry.amount,I.entry.tax_rate):{base:0,tax:0,total:0};return e.jsxs(e.Fragment,{children:[m?e.jsx("div",{className:"alert alert-success",children:m}):null,u.error?e.jsx("div",{className:"alert alert-danger",children:u.error}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-lg-2",children:e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsx("div",{className:"card p-3",children:G?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"billing-current-plan__header",children:[e.jsxs("div",{children:[e.jsx("div",{className:"billing-current-plan__title",children:"Current Plan"}),e.jsx("div",{className:"billing-current-plan__plan",children:G.plan||"-"})]}),e.jsx("span",{className:"badge bg-success text-white text-uppercase",children:Rt(G.status)})]}),e.jsxs("div",{className:"billing-current-plan__section",children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:Ne==="USD"?"USD Monthly":"Monthly"}),e.jsx("span",{children:Rt(_e.monthly)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:Ne==="USD"?"USD Yearly":"Yearly"}),e.jsx("span",{children:Rt(_e.yearly)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:Ne==="USD"?"Add-on USD Monthly":"Add-on Monthly"}),e.jsx("span",{children:Rt(_e.addon_monthly)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:Ne==="USD"?"Add-on USD Yearly":"Add-on Yearly"}),e.jsx("span",{children:Rt(_e.addon_yearly)})]})]}),e.jsx("div",{className:"billing-current-plan__section",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Website Chat Widgets"}),e.jsx("span",{children:Rt((ea=G.limits)==null?void 0:ea.widgets)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Agents Included"}),e.jsx("span",{children:Rt((ya=G.limits)==null?void 0:ya.included_agents)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Conversations / Month"}),e.jsx("span",{children:Rt((ta=G.limits)==null?void 0:ta.conversations_per_month)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"AI Replies / Month"}),e.jsx("span",{children:Rt((ts=G.limits)==null?void 0:ts.ai_replies_per_month)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Chat History"}),e.jsxs("span",{children:[Rt((ca=G.limits)==null?void 0:ca.chat_history_days)," day(s)"]})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Max Messages / Conversation"}),e.jsx("span",{children:Rt((Ga=G.limits)==null?void 0:Ga.max_messages_per_conversation)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Max Chars / Message"}),e.jsx("span",{children:Rt((da=G.limits)==null?void 0:da.max_chars_per_message)})]}),e.jsx("div",{className:"plan-feature-divider"}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:"bi bi-check-circle-fill plan-feature-icon text-success","aria-hidden":"true"}),e.jsx("span",{children:"Quick enquiry form"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${G.allow_addons?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Allow Agent Add-Ons"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(Ha=G.features)!=null&&Ha.remove_branding?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Remove branding"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(Lt=G.features)!=null&&Lt.analytics_basic?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Analytics (basic)"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(aa=G.features)!=null&&aa.csv_export?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"CSV export"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(at=G.features)!=null&&at.agent_inbox?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Agent inbox"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(Nt=G.features)!=null&&Nt.ai_enabled?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"AI replies enabled"})]})]}):r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Storage Limit"}),e.jsx("span",{children:p_(u_(G))})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Bandwidth Limit"}),e.jsx("span",{children:x_(m_(G),h_(G))})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Users Allowed"}),e.jsx("span",{children:g_(f_(G))})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Employees Allowed"}),e.jsx("span",{children:G.employee_limit===0?"Unlimited":G.employee_limit})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Screenshot Interval"}),e.jsxs("span",{children:[Rt(((sa=G.limits)==null?void 0:sa.screenshot_min_minutes)||G.screenshot_min_minutes)," min"]})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Screenshot Retention"}),e.jsxs("span",{children:[Rt(G.retention_days)," day(s)"]})]}),e.jsx("div",{className:"plan-feature-divider"}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${G.allow_addons?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Employee add-ons"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${G.allow_app_usage?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"App usage tracking"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${G.allow_gaming_ott_usage?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"OTT/Gaming usage"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${G.allow_hr_view?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"HR view"})]})]})}),e.jsxs("div",{className:"billing-current-plan__section",children:[e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Start Date"}),e.jsx("span",{children:Rt(G.start_date)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"End Date"}),e.jsx("span",{children:Rt(G.end_date)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Billing Cycle"}),e.jsx("span",{children:Ma(G.billing_cycle)})]}),!l&&!r?e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Screenshot Storage"}),e.jsxs("span",{children:[Rt(G.retention_days)," day(s)"]})]}):null,e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Add-ons"}),e.jsx("span",{children:Rt(G.addon_count)})]}),e.jsxs("div",{className:"billing-current-plan__row",children:[e.jsx("span",{children:"Proration Due Now"}),e.jsx("span",{children:Ws(Ne,G.addon_proration_amount)})]})]}),e.jsx(et,{to:"/plans",className:"btn btn-primary btn-sm w-100 billing-current-plan__cta",children:"Change Plan"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{children:"No active plan found."}),e.jsx(et,{to:"/plans",className:"btn btn-primary btn-sm",children:"Choose Plan"})]})}),G&&!l&&!r?e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{children:"Add Employee Add-ons"}),G.allow_addons?e.jsxs("form",{onSubmit:A,children:[e.jsx("label",{className:"form-label mb-1",children:"Addon Count"}),e.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",value:f,onChange:ae=>j(ae.target.value)}),e.jsx("button",{className:"btn btn-primary btn-sm w-100 mt-2",type:"submit",children:"Update"}),e.jsx("small",{className:"text-secondary d-block mt-2",children:"Proration applies based on remaining days in the current cycle."})]}):e.jsx("p",{className:"text-warning mb-0",children:"Add-ons disabled for this plan."})]}):null]})}),e.jsx("div",{className:"col-12 col-lg-10",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Billing History"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",H," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"billing-history-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"billing-history-search",type:"text",value:E,onChange:ae=>L(ae.target.value),placeholder:"Search history"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Renew"})]})}),e.jsx("tbody",{children:Je.length?Ze.map((ae,Pe)=>e.jsxs("tr",{children:[e.jsx("td",{children:ae.plan||"-"}),e.jsx("td",{children:e.jsx("span",{className:t(ae.status),children:ae.status_label||Ma(ae.status)})}),e.jsx("td",{children:ae.start_date||"-"}),e.jsx("td",{children:ae.end_date||"-"}),e.jsx("td",{children:ae.action_label||"-"}),e.jsx("td",{children:ae.renew_pending?e.jsx("span",{className:"text-warning",children:"Waiting for approval"}):ae.renew_available?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>F(ae),children:"Renew"}):e.jsx("span",{className:"text-secondary",children:"-"})})]},`${ae.plan}-${ae.start_date}-${Pe}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No billing history available."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Oe," to ",Me," of ",ve," entries"]}),e.jsx(He,{page:y,totalPages:xe,onPageChange:h,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Approved Transfers"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",H," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"billing-approved-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"billing-approved-search",type:"text",value:w,onChange:ae=>Q(ae.target.value),placeholder:"Search approved"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Payment Type"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Approved"}),e.jsx("th",{children:"Invoice"}),e.jsx("th",{children:"View"})]})}),e.jsx("tbody",{children:Ye.length?ne.map((ae,Pe)=>e.jsxs("tr",{children:[e.jsx("td",{children:Ma(ae.request_type)}),e.jsx("td",{children:$o(ae.payment_type)}),e.jsx("td",{children:ae.plan||"-"}),e.jsx("td",{children:Ws(ae.currency,ae.amount)}),e.jsx("td",{children:e.jsx("span",{className:t(ae.status),children:ae.status_label||Ma(ae.status)||"Approved"})}),e.jsx("td",{children:ae.updated_at||"-"}),e.jsx("td",{children:ae.invoice_available&&ae.id?e.jsx("a",{className:"text-info text-decoration-none",href:`/api/dashboard/billing/invoice/${ae.id}`,target:"_blank",rel:"noopener noreferrer",children:"Download"}):"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>fe(ae),children:"View"})})]},`${ae.plan}-${ae.updated_at}-${Pe}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No approved transfers yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",st," to ",Dt," of ",Z," entries"]}),e.jsx(He,{page:p,totalPages:Ce,onPageChange:b,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h6",{children:"Billing Activity"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",H," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"billing-pending-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"billing-pending-search",type:"text",value:re,onChange:ae=>K(ae.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Payment Type"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Submitted"}),e.jsx("th",{children:"Invoice"})]})}),e.jsx("tbody",{children:oe.length?Ie.map((ae,Pe)=>e.jsxs("tr",{children:[e.jsx("td",{children:Ma(ae.request_type)}),e.jsx("td",{children:$o(ae.payment_type)}),e.jsx("td",{children:ae.plan||"-"}),e.jsx("td",{children:Ws(ae.currency,ae.amount)}),e.jsx("td",{children:e.jsx("span",{className:t(ae.status),children:ae.status_label||Ma(ae.status)})}),e.jsx("td",{children:ae.created_at||"-"}),e.jsx("td",{children:"-"})]},`${ae.plan}-${ae.created_at}-${Pe}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No pending payments."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",W," to ",pe," of ",ce," entries"]}),e.jsx(He,{page:P,totalPages:Fe,onPageChange:$,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})})]}),_.open&&q?e.jsx("div",{className:"modal-overlay",onClick:te,children:e.jsxs("div",{className:"modal-panel",onClick:ae=>ae.stopPropagation(),children:[e.jsx("h5",{children:l?"Update Agent Add-ons":"Update User Count"}),e.jsxs("div",{className:"text-secondary mb-2",children:["Plan: ",q.name," (",Ma(ie),")"]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("strong",{children:[l?"Base Agents Included":"Base Employees User Limit",":"]})," ",l?((se=q.limits)==null?void 0:se.included_agents)??"-":Ut]}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("strong",{children:[l?"Current Existing Agents":"Current Existing Users",":"]})," ",l?((be=q.limits)==null?void 0:be.included_agents)??"-":Ct," + ",Wa," Addons"]}),q.allow_addons?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:l?"Additional Agents (Add-ons)":"Additional Users (Add-ons)"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Y(-1),disabled:Ee<=0,children:"-"}),e.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",style:{maxWidth:"120px"},value:Ee,onChange:ue}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Y(1),children:"+"})]}),e.jsxs("div",{className:"text-secondary mt-2",children:["Add-on price: ",Ne," ",B||"-"]})]}):e.jsx("p",{className:"text-warning mb-3",children:"Add-ons disabled for this plan."}),e.jsxs("div",{className:"mb-2",children:[e.jsxs("strong",{children:[l?"Total Agents":"Total Employees",":"]})," ",l?Wa+Number(((We=q.limits)==null?void 0:We.included_agents)||0):Ba]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"text-secondary",children:["Base: ",Ne," ",tt||"-"]}),q.allow_addons?e.jsxs("div",{className:"text-secondary",children:["Add-ons: ",Ne," ",le||0]}):null,Se?e.jsxs("div",{className:"text-secondary",children:["GST (",Ae,"%): ",Ne," ",Le||0]}):null,e.jsxs("div",{className:"fw-semibold",children:["Total: ",Ne," ",lt||0]})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:te,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:async()=>{await he(X,Ee),te()},children:"Continue"})]})]})}):null,I.open&&I.entry?e.jsx("div",{className:"modal-overlay",onClick:D,children:e.jsxs("div",{className:"modal-panel",onClick:ae=>ae.stopPropagation(),children:[e.jsx("h5",{children:"Payment Details"}),e.jsxs("div",{className:"text-secondary mb-2",children:[Ma(I.entry.request_type)," -"," ",$o(I.entry.payment_type)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Plan:"})," ",I.entry.plan||"-"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Billing Cycle:"})," ",Ma(I.entry.billing_cycle)||"-"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Add-ons:"})," ",I.entry.addon_count??0]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Amount:"})," ",Ws(I.entry.currency,I.entry.amount)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Base:"})," ",Ws(I.entry.currency,kt.base)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"GST:"})," ",Ws(I.entry.currency,kt.tax)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total:"})," ",Ws(I.entry.currency,kt.total)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Status:"})," ",I.entry.status_label||Ma(I.entry.status)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Approved:"})," ",I.entry.updated_at||"-"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Reference / UTR:"})," ",I.entry.reference_no||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("strong",{children:"Receipt:"})," ",I.entry.receipt_url?e.jsx("a",{href:I.entry.receipt_url,target:"_blank",rel:"noopener noreferrer",className:"text-info text-decoration-none",children:"View Receipt"}):"-"]}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:D,children:"Close"})})]})}):null]})}const b_={loading:!0,error:"",data:null},Lg={contact_name:"",company_name:"",email:"",phone:"",phone_country:"+91",address_line1:"",address_line2:"",city:"",state:"",postal_code:"",country:"India",gstin:""},y_=["contact_name","company_name","email","phone","address_line1","city","state","postal_code","country"],v_={india:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"]};function N_(t){return String(t||"").trim().toLowerCase()}function __(t){return v_[N_(t)]||[]}function S_(t){return y_.filter(a=>!String((t==null?void 0:t[a])||"").trim())}function Ya(t){return!!(t.monthly_price||t.yearly_price||t.usd_monthly_price||t.usd_yearly_price)}function Yt(t){return t==="USD"?"USD":"INR"}function Uo(t){const a=(t==null?void 0:t.limits)||{},s=a.storage_gb??a.storage_limit_gb??0;return Number(s||0)}function Oo(t){const a=(t==null?void 0:t.limits)||{},s=a.bandwidth_limit_gb_monthly??a.bandwidth_limit_gb??0;return Number(s||0)}function Io(t){return((t==null?void 0:t.limits)||{}).is_bandwidth_limited!==!1}function w_(t){const a=(t==null?void 0:t.limits)||{},s=a.max_users??a.user_limit??0;return Number(s||0)}function Fo(t){const s=((t==null?void 0:t.limits)||{}).device_limit_per_user??(t==null?void 0:t.device_limit_per_user)??0;return Number(s||0)}function C_(t){return t?`${t} GB`:"-"}function k_(t,a){return a?t?`${t} GB / month`:"-":"Unlimited"}function P_(t){return t||"Unlimited"}function T_(t){return t?`Up to ${t} devices per user`:"-"}function zo(t){return{...Lg,...t||{},phone_country:(t==null?void 0:t.phone_country)||(t==null?void 0:t.phone_code)||"+91"}}function E_(t){return String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase())}function pn(t,a,s){return s==="USD"?a==="yearly"?t.usd_yearly_price:t.usd_monthly_price:a==="yearly"?t.yearly_price:t.monthly_price}function Bo(t,a,s){return s==="USD"?a==="yearly"?t.addon_usd_yearly_price:t.addon_usd_monthly_price:a==="yearly"?t.addon_yearly_price:t.addon_monthly_price}function A_(t,a,s){if(!s||!s.end_ts||!s.start_ts||Number(s.plan_id)===Number(t.id))return"";if(s.billing_cycle&&s.billing_cycle!==a)return"Billing cycle change applies at full price.";const n=Date.now()/1e3,l=Math.max((s.end_ts-s.start_ts)/86400,0),r=Math.max((s.end_ts-n)/86400,0);if(!l||!r)return"";const i=a==="yearly"?t.yearly_price:t.monthly_price,u=a==="yearly"?s.current_yearly:s.current_monthly;if(!i||!u)return"";const c=Number(i)-Number(u);return c>0?`Prorated upgrade: INR ${Math.round(c*(r/l)*100)/100} (based on remaining days).`:c<0?"Downgrade: no refund will be issued.":"Plan change at no additional charge."}function D_(){var Oe,Me,st,Dt,W,pe,fe;const t=typeof window<"u"?window.location.pathname:"",s=(typeof window<"u"?window.__WZ_PRODUCT_SLUG__:"")||(t.includes("/ai-chatbot")?"ai-chatbot":t.includes("/storage")?"storage":"monitor"),n=s==="ai-chatbot",l=s==="storage"||s==="online-storage",r=s,[i,u]=o.useState(b_),[c,m]=o.useState("INR"),[x,f]=o.useState({}),[j,N]=o.useState(""),[v,_]=o.useState(Lg),[C,y]=o.useState(!1),[h,p]=o.useState(!1),[b,P]=o.useState(""),[$,E]=o.useState(""),[L,V]=o.useState([]),[U,w]=o.useState({open:!1,plan:null,cycle:"monthly",addonCount:1}),Q=nn();async function J(D){var X;N("");try{const q=await z(`/api/dashboard/plans?product=${r}`);if(D&&!D.current)return;u({loading:!1,error:"",data:q})}catch(q){if((X=q==null?void 0:q.data)!=null&&X.redirect){window.location.href=q.data.redirect;return}(!D||D.current)&&u({loading:!1,error:(q==null?void 0:q.message)||"Unable to load plans.",data:null})}}async function me(D){var X;P(""),E("");try{const q=await z("/api/dashboard/billing-profile");if(D&&!D.current)return;_(zo(q.profile)),V(q.missing_fields||[]),y(!0)}catch(q){if((X=q==null?void 0:q.data)!=null&&X.redirect){window.location.href=q.data.redirect;return}(!D||D.current)&&(E((q==null?void 0:q.message)||"Unable to load billing details."),y(!0))}}o.useEffect(()=>{const D={current:!0};return J(D),me(D),()=>{D.current=!1}},[]);const re=((Oe=i.data)==null?void 0:Oe.plans)||[],K=((Me=i.data)==null?void 0:Me.free_eligible)!==!1,O=((st=i.data)==null?void 0:st.active_sub)||null,T=O&&String(O.status||"").toLowerCase()==="trialing"?Number(O.plan_id):null,H=o.useMemo(()=>{var D;return!O||!((D=i.data)!=null&&D.plans)?null:i.data.plans.find(X=>Number(X.id)===Number(O.plan_id))||null},[O,(Dt=i.data)==null?void 0:Dt.plans]),I=((W=i.data)==null?void 0:W.rollback)||null,S=Number(((pe=i.data)==null?void 0:pe.tax_rate)||0),k=((fe=i.data)==null?void 0:fe.tax_currency)||"INR",M=S_(v),A=L.length?L:M,F=M.length===0,te=o.useMemo(()=>{if(r!=="storage")return re;const D=re.find(ie=>!Ya(ie)),X=re.filter(ie=>Ya(ie));return(K||D&&Number(D.id)===T)&&D?[D,...X.filter(ie=>Number(ie.id)!==Number(D.id))]:X},[re,K,r,T]),Y=o.useMemo(()=>{const D={};return te.forEach(X=>{D[X.id]=x[X.id]||"monthly"}),D},[te,x]);async function ue(D,X){var B,le,Te,Se;N(""),E(""),P("");const q=Y[D.id]||"monthly",ie=q==="yearly"?O==null?void 0:O.current_yearly:O==null?void 0:O.current_monthly,Ee=q==="yearly"?D.yearly_price:D.monthly_price;if(Ya(D)){if(!C){E("Billing details are still loading. Please try again.");return}if(!F){V(M),E("Please complete billing details before proceeding."),(B=document.getElementById("billing-details"))==null||B.scrollIntoView({behavior:"smooth"});return}}if(!(O&&Number(O.plan_id)!==Number(D.id)&&(!Ya(D)||Number(Ee||0)<Number(ie||0))&&!await Q({title:"Confirm Downgrade",message:"You are downgrading your plan. Existing benefits will be replaced. Continue?",confirmText:"Continue",confirmVariant:"warning"})))try{const Le=await z(`/api/dashboard/plans/subscribe/${D.id}`,{method:"POST",body:JSON.stringify({billing_cycle:q,addon_count:X,product:r})});if(Le!=null&&Le.redirect){window.location.href=Le.redirect;return}Le!=null&&Le.message&&N(Le.message)}catch(Le){if((le=Le==null?void 0:Le.data)!=null&&le.redirect){window.location.href=Le.data.redirect;return}if((Te=Le==null?void 0:Le.data)!=null&&Te.missing_fields){V(Le.data.missing_fields),E("Please complete billing details before proceeding."),(Se=document.getElementById("billing-details"))==null||Se.scrollIntoView({behavior:"smooth"});return}u(lt=>({...lt,error:(Le==null?void 0:Le.message)||"Unable to update plan."}))}}function he(D){if(!Ya(D)){ue(D,0);return}if(n){ue(D,0);return}const X=Y[D.id]||"monthly",q=D.allow_addons?1:0;w({open:!0,plan:D,cycle:X,addonCount:q})}async function ye(){var X;if(!(!I||!await Q({title:"Rollback Plan",message:`Rollback to ${I.plan} (valid till ${I.end_date})?`,confirmText:"Rollback",confirmVariant:"warning"})))try{const q=await z("/api/dashboard/plans/rollback",{method:"POST"});q!=null&&q.message&&N(q.message),await J()}catch(q){if((X=q==null?void 0:q.data)!=null&&X.redirect){window.location.href=q.data.redirect;return}u(ie=>({...ie,error:(q==null?void 0:q.message)||"Unable to rollback plan."}))}}function G(D){const{name:X,value:q}=D.target;_(ie=>X==="country"?{...ie,country:q,state:ie.state&&ie.state.trim()?ie.state:""}:{...ie,[X]:q})}async function Ne(D){var X,q;D.preventDefault(),P(""),E(""),p(!0);try{const ie=await z("/api/dashboard/billing-profile",{method:"POST",body:JSON.stringify(zo(v))});_(zo(ie.profile)),V(ie.missing_fields||[]),P("Billing details saved.")}catch(ie){if((X=ie==null?void 0:ie.data)!=null&&X.redirect){window.location.href=ie.data.redirect;return}(q=ie==null?void 0:ie.data)!=null&&q.missing_fields&&V(ie.data.missing_fields),(ie==null?void 0:ie.message)==="invalid_gstin"?E("Please enter a valid GSTIN."):(ie==null?void 0:ie.message)==="billing_profile_incomplete"?E("Please complete billing details."):E((ie==null?void 0:ie.message)||"Unable to save billing details.")}finally{p(!1)}}function _e(){w(D=>({...D,open:!1}))}function de(D){w(X=>{const q=Math.max(0,Number(X.addonCount||0)+D);return{...X,addonCount:q}})}function Re(D){const X=Number(D.target.value||0);w(q=>({...q,addonCount:Number.isNaN(X)?0:Math.max(0,X)}))}async function je(){U.plan&&(await ue(U.plan,U.addonCount),_e())}if(i.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading plans..."})]});const Ae=U.plan,Qe=U.cycle||"monthly",qe=Number(U.addonCount||0),Je=Ae?Number(pn(Ae,Qe,c)||0):0,Ye=Ae&&Ae.allow_addons?Number(Bo(Ae,Qe,c)||0):0,oe=Math.round(Ye*qe*100)/100,ve=Math.round((Je+oe)*100)/100,Z=c===k&&S>0,ce=Z?Math.round(ve*(S/100)*100)/100:0,xe=Math.round((ve+ce)*100)/100,Ce=Ae&&Ae.employee_limit===0?"Unlimited":(Ae==null?void 0:Ae.employee_limit)??"-",Fe=Ae&&Ae.employee_limit===0?"Unlimited":Number((Ae==null?void 0:Ae.employee_limit)||0)+qe,Ze=O&&Ae&&Number(O.plan_id)===Number(Ae.id)?Number(O.addon_count||0):0,ne=Ae&&Ae.employee_limit===0?"Unlimited":(Ae==null?void 0:Ae.employee_limit)??"-",Ie=ne==="Unlimited"?1:ne;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Choose a Plan"}),e.jsx("hr",{className:"section-divider"}),O?e.jsxs("p",{className:"text-secondary",children:["Current Plan: ",e.jsx("strong",{children:O.plan}),O.end_date?` (Valid till ${O.end_date})`:""]}):null,e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"currency-toggle",role:"group","aria-label":"Currency toggle",children:[e.jsx("button",{type:"button",className:c==="USD"?"active":"",onClick:()=>m("USD"),children:"USD Payment"}),e.jsx("button",{type:"button",className:c==="INR"?"active":"",onClick:()=>m("INR"),children:"INR Payment"})]})}),j?e.jsx("div",{className:"alert alert-success mt-3",children:j}):null,i.error?e.jsx("div",{className:"alert alert-danger mt-3",children:i.error}):null,I?e.jsxs("div",{className:"alert alert-warning mt-3 d-flex flex-wrap align-items-center justify-content-between gap-2",children:[e.jsxs("span",{children:["Rollback available: ",e.jsx("strong",{children:I.plan}),I.end_date?` (Valid till ${I.end_date})`:""]}),e.jsx("button",{type:"button",className:"btn btn-warning btn-sm",onClick:ye,children:"Rollback Plan"})]}):null,e.jsxs("div",{className:"card p-3 mt-3",id:"billing-details",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:"Billing Information & GST"}),e.jsx("p",{className:"text-secondary mb-0",children:"Required before paid plans and used for invoice generation."})]}),e.jsx("span",{className:`badge ${F?"bg-success":"bg-warning text-dark"}`,children:F?"Complete":"Incomplete"})]}),b?e.jsx("div",{className:"alert alert-success mt-2",children:b}):null,$?e.jsx("div",{className:"alert alert-danger mt-2",children:$}):null,e.jsxs("form",{onSubmit:Ne,children:[e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Contact Name"}),e.jsx("input",{type:"text",name:"contact_name",className:`form-control ${A.includes("contact_name")?"is-invalid":""}`,value:v.contact_name,onChange:G,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Company Name"}),e.jsx("input",{type:"text",name:"company_name",className:`form-control ${A.includes("company_name")?"is-invalid":""}`,value:v.company_name,onChange:G,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",name:"email",className:`form-control ${A.includes("email")?"is-invalid":""}`,value:v.email,onChange:G,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",style:{maxWidth:"140px"},value:v.phone_country||"+91",onChange:D=>_(X=>({...X,phone_country:D.target.value})),children:Fs.map(D=>e.jsxs("option",{value:D.code,children:[D.code," (",D.label,")"]},`${D.code}-${D.label}`))}),e.jsx("input",{type:"tel",name:"phone",className:`form-control ${A.includes("phone")?"is-invalid":""}`,value:v.phone,onChange:G,required:!0,placeholder:"Phone number"})]})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Address Line 1"}),e.jsx("input",{type:"text",name:"address_line1",className:`form-control ${A.includes("address_line1")?"is-invalid":""}`,value:v.address_line1,onChange:G,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Address Line 2 (optional)"}),e.jsx("input",{type:"text",name:"address_line2",className:"form-control",value:v.address_line2,onChange:G})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",name:"city",className:`form-control ${A.includes("city")?"is-invalid":""}`,value:v.city,onChange:G,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{type:"text",name:"country",className:`form-control ${A.includes("country")?"is-invalid":""}`,value:v.country,onChange:G,list:"country-options",required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"State"}),e.jsx("input",{type:"text",name:"state",className:`form-control ${A.includes("state")?"is-invalid":""}`,value:v.state,onChange:G,list:"state-options",disabled:!String(v.country||"").trim(),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"Postal Code"}),e.jsx("input",{type:"text",name:"postal_code",className:`form-control ${A.includes("postal_code")?"is-invalid":""}`,value:v.postal_code,onChange:G,required:!0})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label",children:"GSTIN (optional)"}),e.jsx("input",{type:"text",name:"gstin",className:"form-control",value:v.gstin,onChange:D=>G({target:{name:"gstin",value:D.target.value.toUpperCase()}}),maxLength:15,placeholder:"15-character GSTIN"})]})]}),e.jsx("datalist",{id:"country-options",children:Ai.map(D=>e.jsx("option",{value:D},D))}),e.jsx("datalist",{id:"state-options",children:__(v.country).map(D=>e.jsx("option",{value:D},D))}),e.jsx("button",{className:"btn btn-primary btn-sm mt-3",type:"submit",disabled:h,children:h?"Saving...":"Save Billing Details"})]})]}),e.jsx("div",{className:"row mt-4 g-3",children:te.length?te.map(D=>{var ta,ts,ca,Ga,da,Ha,Lt,aa,at,Nt,sa;const X=Y[D.id]||"monthly",q=pn(D,"monthly",c),ie=pn(D,"yearly",c),Ee=Bo(D,"monthly",c),tt=Bo(D,"yearly",c),B=O&&Number(O.plan_id)===Number(D.id),le=B&&String((O==null?void 0:O.status)||"").toLowerCase()==="trialing"&&!Ya(D),Te=!Ya(D),Se=!!(H&&!B),Le=Se?Number(q||0)!==Number(pn(H,"monthly",c)||0):!1,lt=Se?Number(ie||0)!==Number(pn(H,"yearly",c)||0):!1,Ut=Se?Uo(D)!==Uo(H):!1,Ba=Se?Oo(D)!==Oo(H)||Io(D)!==Io(H):!1,Wa=Se?Fo(D)!==Fo(H):!1,Va=A_(D,X,O),Ct=c===k&&S>0,kt=Number(pn(D,X,c)||0),ea=Ct?Math.round(kt*(S/100)*100)/100:0,ya=Ct?Math.round((kt+ea)*100)/100:kt;return e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 plan-card h-100",children:[e.jsx("h4",{className:"mb-2",children:D.name}),e.jsxs("p",{className:"price-monthly",children:["Monthly: ",Yt(c)," ",e.jsx("span",{className:Le?"highlight-text":"",children:q||"-"})]}),e.jsxs("p",{className:"price-yearly",children:["Yearly: ",Yt(c)," ",e.jsx("span",{className:lt?"highlight-text":"",children:ie||"-"})]}),n?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"plan-feature-list",children:[e.jsxs("div",{className:"plan-metric",children:["Website Chat Widgets: ",((ta=D.limits)==null?void 0:ta.widgets)??"-"]}),e.jsxs("div",{className:"plan-metric",children:["Agents included: ",((ts=D.limits)==null?void 0:ts.included_agents)??"-"]}),e.jsxs("div",{className:"plan-metric",children:["Conversations/month: ",((ca=D.limits)==null?void 0:ca.conversations_per_month)??"-"]}),e.jsxs("div",{className:"plan-metric",children:["AI replies/month: ",((Ga=D.limits)==null?void 0:Ga.ai_replies_per_month)??"-"]}),e.jsxs("div",{className:"plan-metric",children:["Chat history: ",((da=D.limits)==null?void 0:da.chat_history_days)??"-"," days"]}),e.jsxs("div",{className:"plan-metric",children:["Max messages/conversation: ",((Ha=D.limits)==null?void 0:Ha.max_messages_per_conversation)??"-"]}),e.jsxs("div",{className:"plan-metric",children:["Max chars/message: ",((Lt=D.limits)==null?void 0:Lt.max_chars_per_message)??"-"]}),e.jsx("div",{className:"plan-feature-divider"}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:"bi bi-check-circle-fill plan-feature-icon text-success","aria-hidden":"true"}),e.jsx("span",{children:"Quick enquiry form"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${D.allow_addons?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Allow Agent Add-Ons"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(aa=D.features)!=null&&aa.remove_branding?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Remove branding"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(at=D.features)!=null&&at.analytics_basic?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Analytics (basic)"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(Nt=D.features)!=null&&Nt.csv_export?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"CSV export"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${(sa=D.features)!=null&&sa.agent_inbox?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"Agent inbox"})]})]})}):l?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"plan-feature-list",children:[e.jsxs("div",{className:"plan-metric",children:["Storage limit:"," ",e.jsx("span",{className:Ut?"highlight-text":"",children:C_(Uo(D))})]}),e.jsxs("div",{className:"plan-metric",children:["Bandwidth limit:"," ",e.jsx("span",{className:Ba?"highlight-text":"",children:k_(Oo(D),Io(D))})]}),e.jsxs("div",{className:"plan-metric",children:["Device limit:"," ",e.jsx("span",{className:Wa?"highlight-text":"",children:T_(Fo(D))})]}),e.jsxs("div",{className:"plan-metric",children:["Users allowed: ",P_(w_(D))]}),D.allow_addons?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"plan-metric",children:["Add-on Monthly: ",Yt(c)," ",Ee||"-"]}),e.jsxs("div",{className:"plan-metric",children:["Add-on Yearly: ",Yt(c)," ",tt||"-"]})]}):e.jsx("div",{className:"plan-metric",children:"Add-ons disabled"})]})}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"plan-feature-list",children:[e.jsxs("div",{className:"plan-metric",children:["Employees allowed: ",D.employee_limit===0?"Unlimited":D.employee_limit]}),D.allow_addons?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"plan-metric",children:["Add-on Monthly: ",Yt(c)," ",Ee||"-"]}),e.jsxs("div",{className:"plan-metric",children:["Add-on Yearly: ",Yt(c)," ",tt||"-"]})]}):e.jsx("div",{className:"plan-metric",children:"Add-ons disabled"}),e.jsx("div",{className:"plan-feature-divider"}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${D.allow_app_usage?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"App usage tracking"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${D.allow_gaming_ott_usage?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"OTT/Gaming usage"})]}),e.jsxs("div",{className:"plan-feature",children:[e.jsx("i",{className:`bi ${D.allow_hr_view?"bi-check-circle-fill text-success":"bi-x-circle-fill text-danger"} plan-feature-icon`,"aria-hidden":"true"}),e.jsx("span",{children:"HR view"})]})]})}),B?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"form-label",children:"Billing Cycle"}),e.jsx("div",{className:"text-secondary",children:X==="yearly"?"Yearly":"Monthly"})]}),!n&&!l?e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"form-label",children:"Screenshot Storage History"}),e.jsxs("div",{className:"retention-text",children:["Screenshot Retention:"," ",e.jsxs("span",{className:"highlight-text",children:[D.retention_days," Days"]})]})]}):null,Ct&&kt?e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"text-secondary",children:["GST (",S,"%): ",Yt(c)," ",ea]}),e.jsxs("div",{className:"fw-semibold",children:["Total: ",Yt(c)," ",ya]})]}):null,e.jsx("button",{type:"button",className:"btn btn-success btn-sm mt-2",disabled:le,children:le?"Activated":"Active"}),le?e.jsx("div",{className:"text-success small mt-2",children:"Free trial active."}):null]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"form-label",children:"Billing Cycle"}),Ya(D)?e.jsxs("select",{className:"form-select form-select-sm",value:X,onChange:se=>f(be=>({...be,[D.id]:se.target.value})),children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-secondary",children:"Monthly (1 month)"}),e.jsx("input",{type:"hidden",value:"monthly"})]})]}),!n&&!l?e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{className:"form-label",children:"Screenshot Storage History"}),e.jsxs("div",{className:"retention-text",children:["Screenshot Retention:"," ",e.jsxs("span",{className:"highlight-text",children:[D.retention_days," Days"]})]})]}):null,e.jsx("button",{type:"button",className:`btn ${Ya(D)?"btn-primary":"btn-outline-light"} btn-sm mt-2`,onClick:()=>he(D),disabled:Te?!K:!1,children:Ya(D)?"Proceed to Bank Transfer":K?"Activate":"Free Trial Used"}),Te&&!K?e.jsx("div",{className:"text-warning small mt-2",children:"Free trial is only available once. Please choose a paid plan."}):null,Ct&&kt?e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"text-secondary",children:["GST (",S,"%): ",Yt(c)," ",ea]}),e.jsxs("div",{className:"fw-semibold",children:["Total: ",Yt(c)," ",ya]})]}):null,Va?e.jsx("small",{className:"text-secondary d-block mt-2 proration-note",children:Va}):e.jsx("small",{className:"text-secondary d-block mt-2 proration-note"})]})]})},D.id)}):e.jsx("div",{className:"col-12",children:e.jsx("p",{children:"No plans available."})})}),U.open&&Ae?e.jsx("div",{className:"modal-overlay",onClick:_e,children:e.jsxs("div",{className:"modal-panel",onClick:D=>D.stopPropagation(),children:[e.jsx("h5",{children:"Update User Count"}),e.jsxs("div",{className:"text-secondary mb-2",children:["Plan: ",Ae.name," (",E_(Qe),")"]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Base Employees User Limit:"})," ",Ce]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Current Existing Users:"})," ",Ie," + ",Ze," Addons"]}),Ae.allow_addons?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Additional Users (Add-ons)"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>de(-1),disabled:qe<=0,children:"-"}),e.jsx("input",{type:"number",min:"0",className:"form-control form-control-sm",style:{maxWidth:"120px"},value:qe,onChange:Re}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>de(1),children:"+"})]}),e.jsxs("div",{className:"text-secondary mt-2",children:["Add-on price: ",Yt(c)," ",Ye||"-"]})]}):e.jsx("p",{className:"text-warning mb-3",children:"Add-ons disabled for this plan."}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Total Employees:"})," ",Fe]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"text-secondary",children:["Base: ",Yt(c)," ",Je||"-"]}),Ae.allow_addons?e.jsxs("div",{className:"text-secondary",children:["Add-ons: ",Yt(c)," ",oe||0]}):null,Z?e.jsxs("div",{className:"text-secondary",children:["GST (",S,"%): ",Yt(c)," ",ce||0]}):null,e.jsxs("div",{className:"fw-semibold",children:["Total: ",Yt(c)," ",xe||0]})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:_e,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:je,children:"Continue"})]})]})}):null]})}const L_={loading:!0,error:"",data:null},R_=Fs,M_=["UTC","America/New_York","America/Chicago","America/Denver","America/Los_Angeles","Europe/London","Europe/Berlin","Europe/Paris","Asia/Dubai","Asia/Kolkata","Asia/Singapore","Asia/Tokyo","Australia/Sydney"];function $_(){var Ye;const[t,a]=o.useState(L_),[s,n]=o.useState(""),[l,r]=o.useState(1),[i,u]=o.useState(""),[c,m]=o.useState(""),[x,f]=o.useState({open:!1,users:[]}),[j,N]=o.useState(""),[v,_]=o.useState("+91"),[C,y]=o.useState(""),[h,p]=o.useState("UTC"),[b,P]=o.useState(""),[$,E]=o.useState(""),[L,V]=o.useState(""),[U,w]=o.useState(!0),[Q,J]=o.useState(""),[me,re]=o.useState([]),[K,O]=o.useState([]),[T,H]=o.useState(""),[I,S]=o.useState(!1),[k,M]=o.useState("");o.useEffect(()=>{let oe=!0;async function ve(){var Z,ce;n("");try{const xe=new URLSearchParams;l&&xe.set("admin_page",String(l)),c&&xe.set("q",c);const Ce=xe.toString()?`/api/dashboard/profile?${xe.toString()}`:"/api/dashboard/profile",Fe=await z(Ce);if(!oe)return;a({loading:!1,error:"",data:Fe}),N(((Z=Fe.user)==null?void 0:Z.email)||""),_(Fe.phone_country||"+91"),y(Fe.phone_number||""),p(Fe.org_timezone||"UTC")}catch(xe){if((ce=xe==null?void 0:xe.data)!=null&&ce.redirect){window.location.href=xe.data.redirect;return}oe&&a({loading:!1,error:(xe==null?void 0:xe.message)||"Unable to load profile.",data:null})}}return ve(),()=>{oe=!1}},[l,c]),o.useEffect(()=>{const oe=setTimeout(()=>{m(i.trim()),r(1)},300);return()=>clearTimeout(oe)},[i]),o.useEffect(()=>{let oe=!0;async function ve(){try{const Z=await z("/api/auth/subscriptions");if(!oe)return;const ce=(Z.subscriptions||[]).map(xe=>({slug:xe.product_slug,name:xe.product_name||xe.product_slug}));O(ce),!T&&ce.length&&H(ce[0].slug)}catch(Z){if(!oe)return;J((Z==null?void 0:Z.message)||"Unable to load products for backups.")}}return ve(),()=>{oe=!1}},[]),o.useEffect(()=>{let oe=!0;async function ve(){if(!T){w(!1);return}w(!0),J("");try{const Z=new URLSearchParams;Z.set("limit","10"),Z.set("product_slug",T);const ce=await z(`/api/backup/list?${Z.toString()}`);if(!oe)return;re(Array.isArray(ce.items)?ce.items:[]),w(!1)}catch(Z){if(!oe)return;J((Z==null?void 0:Z.message)||"Unable to load backups."),w(!1)}}return ve(),()=>{oe=!1}},[T]);async function A(oe){oe.preventDefault(),n("");try{await z("/api/dashboard/profile/email",{method:"POST",body:JSON.stringify({email:j,phone_country:v,phone_number:C,org_timezone:h})}),n("Email updated successfully.")}catch(ve){a(Z=>({...Z,error:(ve==null?void 0:ve.message)||"Unable to update email."}))}}async function F(oe){oe.preventDefault(),n("");try{await z("/api/dashboard/profile/password",{method:"POST",body:JSON.stringify({current_password:b,new_password:$,confirm_password:L})}),n("Password updated successfully."),P(""),E(""),V("")}catch(ve){a(Z=>({...Z,error:(ve==null?void 0:ve.message)||"Unable to update password."}))}}async function te(){var oe;if(!((oe=Y.org)!=null&&oe.id)||!T){J("Organization or product missing.");return}M(""),J(""),S(!0);try{await z("/api/backup/request",{method:"POST",body:JSON.stringify({organization_id:Y.org.id,product_slug:T})}),M("Backup request queued. It will appear here once ready."),S(!1)}catch(ve){J((ve==null?void 0:ve.message)||"Unable to request backup."),S(!1)}}if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading profile..."})]});const Y=t.data||{},ue=Y.user||{},he=Y.recent_actions||[],ye=Y.referral||{},G=Array.isArray(ye.earnings)?ye.earnings:[],Ne=typeof Intl.supportedValuesOf=="function"?Intl.supportedValuesOf("timeZone"):M_,_e=!!((Ye=Y.org)!=null&&Ye.id),de=Y.pagination||{},Re=de.page||l,je=de.page_size||50,Ae=typeof de.total_items=="number"?de.total_items:he.length,Qe=Ae?(Re-1)*je+1:0,qe=Ae?Math.min(Re*je,Ae):0;function Je(oe){f({open:!0,users:oe})}return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Profile"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Account"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",ue.username||"-"]}),e.jsxs("form",{className:"mt-3",onSubmit:A,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:j,onChange:oe=>N(oe.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Mobile Number"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",value:v,onChange:oe=>_(oe.target.value),style:{maxWidth:"170px"},children:R_.map(oe=>e.jsxs("option",{value:oe.code,children:[oe.label," ",oe.code]},`${oe.code}-${oe.label}`))}),e.jsx("input",{type:"tel",className:"form-control",value:C,onChange:oe=>y(oe.target.value),placeholder:"Phone number"})]})]}),_e?e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Organization Timezone"}),e.jsx("select",{className:"form-select",value:h,onChange:oe=>p(oe.target.value),children:Ne.map(oe=>e.jsx("option",{value:oe,children:oe},oe))})]}):null,e.jsx("button",{className:"btn btn-primary btn-sm",children:"Update Details"})]})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Update Password"}),e.jsxs("form",{onSubmit:F,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Current Password"}),e.jsx("input",{type:"password",className:"form-control",value:b,onChange:oe=>P(oe.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsx("input",{type:"password",className:"form-control",value:$,onChange:oe=>E(oe.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Confirm New Password"}),e.jsx("input",{type:"password",className:"form-control",value:L,onChange:oe=>V(oe.target.value),required:!0})]}),e.jsx("button",{className:"btn btn-warning btn-sm",children:"Update Password"})]})]})})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"Downloads & Backups"}),e.jsx("p",{className:"text-secondary",children:"Generate a downloadable backup of your organization's data."}),e.jsx("div",{className:"mb-2",children:e.jsx("a",{className:"btn btn-outline-light btn-sm",href:"/app/backup-history",children:"View Full History"})}),k?e.jsx("div",{className:"alert alert-success",children:k}):null,Q?e.jsx("div",{className:"alert alert-danger",children:Q}):null,e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Product"}),e.jsx("select",{className:"form-select",value:T,onChange:oe=>H(oe.target.value),children:K.length?K.map(oe=>e.jsx("option",{value:oe.slug,children:oe.name},oe.slug)):e.jsx("option",{value:"",children:"No products"})})]}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:te,disabled:I||!T,children:I?"Generating...":"Generate Backup"})})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Expires"}),e.jsx("th",{children:"Download"})]})}),e.jsx("tbody",{children:U?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"Loading backups..."})}):me.length?me.map(oe=>e.jsxs("tr",{children:[e.jsx("td",{children:oe.product_name||"-"}),e.jsx("td",{children:oe.status||"-"}),e.jsx("td",{children:oe.size_bytes?`${(oe.size_bytes/(1024*1024)).toFixed(2)} MB`:"-"}),e.jsx("td",{children:oe.completed_at||oe.requested_at||"-"}),e.jsx("td",{children:oe.expires_at||"-"}),e.jsx("td",{children:oe.can_download&&oe.download_url?e.jsx("a",{className:"btn btn-sm btn-outline-light",href:oe.download_url,children:"Download"}):"-"})]},oe.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No backups yet."})})})]})})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"Referral Program"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Commission Rate:"})," ",ye.commission_rate??0,"%"]}),ye.subscription_amount?e.jsxs("p",{children:[e.jsx("strong",{children:"Subscription Amount:"})," ",ye.subscription_amount]}):null,e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Referral Code"}),e.jsx("input",{type:"text",className:"form-control",value:ye.code||"",readOnly:!0})]}),e.jsxs("div",{className:"col-12 col-md-8",children:[e.jsx("label",{className:"form-label",children:"Referral Link"}),e.jsx("input",{type:"text",className:"form-control",value:ye.link||"",readOnly:!0})]})]})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"Referral Income"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Company / Dealer"}),e.jsx("th",{children:"Transfer"}),e.jsx("th",{children:"Base Amount"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Flat Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]})}),e.jsx("tbody",{children:G.length?G.map(oe=>e.jsxs("tr",{children:[e.jsx("td",{children:oe.referred_org||oe.referred_dealer||"-"}),e.jsx("td",{children:oe.transfer_id||"-"}),e.jsx("td",{children:oe.base_amount??"-"}),e.jsxs("td",{children:[oe.commission_rate??0,"%"]}),e.jsx("td",{children:oe.commission_amount??"-"}),e.jsx("td",{children:oe.flat_amount??"-"}),e.jsx("td",{children:oe.status||"-"}),e.jsx("td",{children:oe.payout_reference||"-"}),e.jsx("td",{children:oe.payout_date||"-"})]},oe.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",children:"No referral income yet."})})})]})})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"Admin Activity"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",je," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"profile-admin-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"profile-admin-search",type:"text",value:i,onChange:oe=>u(oe.target.value),placeholder:"Search activity"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Time"}),e.jsx("th",{children:"Action"}),e.jsx("th",{children:"Users"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:he.length?he.map((oe,ve)=>{const Z=Array.isArray(oe.employees)?oe.employees:[];return e.jsxs("tr",{children:[e.jsx("td",{children:oe.time}),e.jsx("td",{children:oe.action}),e.jsx("td",{children:Z.length===1?Z[0]:Z.length>1?e.jsx("button",{type:"button",className:"btn btn-link text-info p-0 history-trigger",onClick:()=>Je(Z),children:"View Users Details"}):"-"}),e.jsx("td",{children:oe.details||"-"})]},`${oe.time}-${ve}`)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No recent activity."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Qe," to ",qe," of ",Ae," entries"]}),e.jsx(He,{page:Re,totalPages:de.total_pages||1,onPageChange:r,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),x.open?e.jsx("div",{className:"modal-overlay",onClick:()=>f({open:!1,users:[]}),children:e.jsxs("div",{className:"modal-panel",onClick:oe=>oe.stopPropagation(),children:[e.jsx("h5",{children:"Users Details"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Employee"})]})}),e.jsx("tbody",{children:x.users.map((oe,ve)=>e.jsxs("tr",{children:[e.jsx("td",{children:ve+1}),e.jsx("td",{children:oe})]},`${oe}-${ve}`))})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{className:"modal-close",type:"button",onClick:()=>f({open:!1,users:[]}),children:"Close"})})]})}):null]})}const U_={loading:!0,error:"",data:null};function _a(t,a="-"){if(t==null||t==="")return a;if(typeof t=="object")try{return JSON.stringify(t)}catch{return a}return String(t)}function Ff(){var y;const{transferId:t}=ps(),[a,s]=o.useState(U_),[n,l]=o.useState(""),[r,i]=o.useState(""),[u,c]=o.useState(null),[m,x]=o.useState(!1);async function f(h){var p;l("");try{const b=t?`/api/dashboard/bank-transfer/${t}`:"/api/dashboard/bank-transfer",P=await z(b);if(P!=null&&P.redirect){window.location.href=P.redirect;return}if(h&&!h.current)return;s({loading:!1,error:"",data:P})}catch(b){if((p=b==null?void 0:b.data)!=null&&p.redirect){window.location.href=b.data.redirect;return}(!h||h.current)&&s({loading:!1,error:(b==null?void 0:b.message)||"Unable to load bank transfer details.",data:null})}}o.useEffect(()=>{const h={current:!0};return f(h),()=>{h.current=!1}},[t]);const j=((y=a.data)==null?void 0:y.transfer)||null,N=!a.loading&&!a.error&&!j&&!t,v=_a(n,""),_=_a(a.error,"");o.useEffect(()=>{N&&(window.location.href="/plans")},[N]);async function C(h){if(h.preventDefault(),!r.trim()){l("Please enter the reference / UTR number.");return}l(""),x(!0);try{const p=t?`/api/dashboard/bank-transfer/${t}/submit`:"/api/dashboard/bank-transfer/submit",b=new FormData;b.append("reference_no",r.trim()),u&&b.append("receipt",u);const P=await fetch(p,{method:"POST",credentials:"include",headers:{"X-CSRFToken":es()},body:b}),$=await P.json().catch(()=>null);if(!P.ok){l(($==null?void 0:$.error)||"Unable to submit payment."),x(!1);return}$!=null&&$.message&&l($.message),$!=null&&$.redirect?window.location.href=$.redirect:await f()}catch{l("Unable to submit payment.")}finally{x(!1)}}return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading bank transfer..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Bank Transfer"}),e.jsx("p",{className:"text-secondary mb-1",children:"Submit your payment details. We will verify and activate your plan."}),e.jsx("hr",{className:"section-divider"}),v?e.jsx("div",{className:"alert alert-info",children:v}):null,_?e.jsx("div",{className:"alert alert-danger",children:_}):null,j?e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{className:"mb-3",children:"Plan Summary"}),e.jsx("table",{className:"table table-borderless mb-0",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Company"}),e.jsx("td",{children:_a(j.org_name)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Plan"}),e.jsx("td",{children:_a(j.plan_name)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Billing Cycle"}),e.jsx("td",{children:_a(j.billing_cycle,"monthly")})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Amount"}),e.jsxs("td",{children:[_a(j.currency,"INR")," ",_a(j.base_amount??j.amount,"0")]})]}),j.tax_amount?e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"GST"}),e.jsxs("td",{children:[_a(j.currency,"INR")," ",_a(j.tax_amount,"0")]})]}):null,j.tax_amount?e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Total Payable"}),e.jsxs("td",{children:[_a(j.currency,"INR")," ",_a(j.total_amount,"0")]})]}):null,j.addon_count?e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Add-ons"}),e.jsx("td",{children:_a(j.addon_count)})]}):null]})})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{className:"mb-3",children:"Payment Details"}),e.jsxs("form",{onSubmit:C,children:[j.bank_account_details?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Bank Account Details"}),e.jsx("div",{className:"form-control",style:{whiteSpace:"pre-wrap"},children:j.bank_account_details})]}):null,e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Reference / UTR Number"}),e.jsx("input",{type:"text",className:"form-control",value:r,onChange:h=>i(h.target.value),placeholder:"Enter reference or UTR number",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Transaction Screenshot"}),e.jsx("input",{type:"file",className:"form-control",required:!0,onChange:h=>{var p;return c(((p=h.target.files)==null?void 0:p[0])||null)}})]}),e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:m,children:m?"Submitting...":"Submit for Approval"}),e.jsx("p",{className:"text-secondary mt-3 mb-0",children:"Your account will be activated after verification."})]})]})})]}):t?e.jsx("div",{className:"alert alert-warning",children:"No pending payment request found."}):N?e.jsx("div",{className:"alert alert-info",children:"No pending payment request found. Redirecting to Plans..."}):null]})}const O_={loading:!0,error:"",data:null};function I_(){var i,u,c,m,x;const[t,a]=o.useState(O_);if(o.useEffect(()=>{let f=!0;async function j(){try{const N=await z("/api/dashboard/dealer/summary");if(!f)return;a({loading:!1,error:"",data:N})}catch(N){f&&a({loading:!1,error:(N==null?void 0:N.message)||"Unable to load dealer summary.",data:null})}}return j(),()=>{f=!1}},[]),t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading dashboard..."})]});const s=((i=t.data)==null?void 0:i.dealer)||{},n=((u=t.data)==null?void 0:u.referral_amounts)||{},l=((c=t.data)==null?void 0:c.referral)||{},r=((m=t.data)==null?void 0:m.products_count)??0;return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Dealer Dashboard"}),e.jsx("hr",{className:"section-divider"}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-cash-stack","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"My Total Earnings"})]}),e.jsx("div",{className:"stat-value",children:n.total??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-calendar-check","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"This Month Earnings"})]}),e.jsx("div",{className:"stat-value",children:n.month_total??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-building","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"Total ORG Refered"})]}),e.jsx("div",{className:"stat-value",children:n.org_count??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-people","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"Total Agent Refered"})]}),e.jsx("div",{className:"stat-value",children:n.dealer_count??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-calendar-event","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"My Plan Expire Date"})]}),e.jsx("div",{className:"stat-value",children:s.subscription_end||"-"})]})}),e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-boxes","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-0",children:"Work Zilla Products"})]}),e.jsx("div",{className:"stat-value",children:r})]})})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"My Subscription"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Agent Name"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Commission %"}),e.jsx("th",{children:"Plan Amount (Yearly)"}),e.jsx("th",{children:"Total Earned"}),e.jsx("th",{children:"Paid Earned"})]})}),e.jsx("tbody",{children:e.jsxs("tr",{children:[e.jsx("td",{children:s.name||"-"}),e.jsx("td",{children:s.email||"-"}),e.jsx("td",{children:s.subscription_start||"-"}),e.jsx("td",{children:s.subscription_end||"-"}),e.jsxs("td",{children:[((x=t.data)==null?void 0:x.commission_rate)??0,"%"]}),e.jsx("td",{children:s.subscription_amount??"-"}),e.jsx("td",{children:n.total??0}),e.jsx("td",{children:n.paid??0})]})})]})})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"Referral Details"}),e.jsx("div",{className:"row g-3 mt-1",children:e.jsxs("div",{className:"col-3",children:[e.jsx("label",{className:"form-label",children:"Referral Code"}),e.jsx("input",{className:"form-control",type:"text",value:l.code||"",readOnly:!0})]})})]})]})}const F_={loading:!0,error:"",data:null};function z_(){var V,U;const[t,a]=o.useState(F_),[s,n]=o.useState("org"),[l,r]=o.useState(""),[i,u]=o.useState(""),[c,m]=o.useState(1),[x,f]=o.useState(""),[j,N]=o.useState(""),[v,_]=o.useState(1),C=20;o.useEffect(()=>{let w=!0;async function Q(){try{const J=await z("/api/dashboard/dealer/referrals");if(!w)return;a({loading:!1,error:"",data:J})}catch(J){w&&a({loading:!1,error:(J==null?void 0:J.message)||"Unable to load referrals.",data:null})}}return Q(),()=>{w=!1}},[]),o.useEffect(()=>{const w=setTimeout(()=>{u(l.trim()),m(1)},300);return()=>clearTimeout(w)},[l]),o.useEffect(()=>{const w=setTimeout(()=>{N(x.trim()),_(1)},300);return()=>clearTimeout(w)},[x]);const y=((V=t.data)==null?void 0:V.org_referrals)||[],h=((U=t.data)==null?void 0:U.dealer_referrals)||[],p=o.useMemo(()=>{if(!i)return y;const w=i.toLowerCase();return y.filter(Q=>[Q.referred_org,Q.transfer_id,Q.base_amount,Q.commission_rate,Q.commission_amount,Q.status,Q.payout_reference,Q.payout_date].some(J=>String(J||"").toLowerCase().includes(w)))},[y,i]),b=Math.max(Math.ceil(p.length/C),1),P=o.useMemo(()=>p.slice((c-1)*C,c*C),[p,c]),$=o.useMemo(()=>{if(!j)return h;const w=j.toLowerCase();return h.filter(Q=>[Q.referred_dealer,Q.flat_amount,Q.status,Q.payout_reference,Q.payout_date].some(J=>String(J||"").toLowerCase().includes(w)))},[h,j]),E=Math.max(Math.ceil($.length/C),1),L=o.useMemo(()=>$.slice((v-1)*C,v*C),[$,v]);return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading referrals..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Referrals"}),e.jsx("hr",{className:"section-divider"}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"d-flex gap-2 flex-wrap mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${s==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>n("org"),children:"ORG Referrals"}),e.jsx("button",{type:"button",className:`btn btn-sm ${s==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>n("dealer"),children:"Agent Referrals"})]}),s==="org"?e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{children:"Organization Referrals"}),e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",C," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dealer-org-referrals-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dealer-org-referrals-search",type:"text",value:l,onChange:w=>r(w.target.value),placeholder:"Search referrals"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Transfer"}),e.jsx("th",{children:"Base Amount"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]})}),e.jsx("tbody",{children:P.length?P.map(w=>e.jsxs("tr",{children:[e.jsx("td",{children:w.referred_org||"-"}),e.jsx("td",{children:w.transfer_id||"-"}),e.jsx("td",{children:w.base_amount??"-"}),e.jsxs("td",{children:[w.commission_rate??0,"%"]}),e.jsx("td",{children:w.commission_amount??"-"}),e.jsx("td",{children:w.status||"-"}),e.jsx("td",{children:w.payout_reference||"-"}),e.jsx("td",{children:w.payout_date||"-"})]},w.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No organization referrals yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",P.length?(c-1)*C+1:0," to"," ",Math.min(c*C,p.length)," of ",p.length," entries"]}),e.jsx(He,{page:c,totalPages:b,onPageChange:m,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{children:"Agent Referrals"}),e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",C," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dealer-agent-referrals-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dealer-agent-referrals-search",type:"text",value:x,onChange:w=>f(w.target.value),placeholder:"Search referrals"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Agent"}),e.jsx("th",{children:"Flat Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]})}),e.jsx("tbody",{children:L.length?L.map(w=>e.jsxs("tr",{children:[e.jsx("td",{children:w.referred_dealer||"-"}),e.jsx("td",{children:w.flat_amount??"-"}),e.jsx("td",{children:w.status||"-"}),e.jsx("td",{children:w.payout_reference||"-"}),e.jsx("td",{children:w.payout_date||"-"})]},w.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No agent referrals yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",L.length?(v-1)*C+1:0," to"," ",Math.min(v*C,$.length)," of"," ",$.length," entries"]}),e.jsx(He,{page:v,totalPages:E,onPageChange:_,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})}const B_={loading:!0,error:"",data:null},W_=Fs,V_={india:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"]};function G_(t){return String(t||"").trim().toLowerCase()}function Wo(t){return V_[G_(t)]||[]}function H_(t){const a=String(t||"").trim();if(!a)return{country:"+91",number:""};if(a.startsWith("+")){const s=a.split(" ");return s.length>1?{country:s[0],number:s.slice(1).join(" ").trim()}:{country:a,number:""}}return{country:"+91",number:a}}function Q_(){const[t,a]=o.useState(B_),[s,n]=o.useState(""),[l,r]=o.useState(""),[i,u]=o.useState(""),[c,m]=o.useState("+91"),[x,f]=o.useState(""),[j,N]=o.useState(""),[v,_]=o.useState(""),[C,y]=o.useState(""),[h,p]=o.useState(""),[b,P]=o.useState(""),[$,E]=o.useState(""),[L,V]=o.useState(""),[U,w]=o.useState(""),[Q,J]=o.useState(""),[me,re]=o.useState(""),[K,O]=o.useState(""),[T,H]=o.useState(""),[I,S]=o.useState("");o.useEffect(()=>{let A=!0;async function F(){n("");try{const te=await z("/api/dashboard/dealer/profile");if(!A)return;a({loading:!1,error:"",data:te});const Y=te.user||{},ue=te.dealer||{};r(Y.name||""),u(Y.email||"");const he=H_(te.phone_number||"");m(he.country),f(he.number),N(ue.address_line1||""),_(ue.address_line2||""),y(ue.city||""),p(ue.state||""),P(ue.country||"India"),E(ue.postal_code||""),V(ue.bank_name||""),w(ue.bank_account_number||""),J(ue.bank_ifsc||""),re(ue.upi_id||"")}catch(te){A&&a({loading:!1,error:(te==null?void 0:te.message)||"Unable to load profile.",data:null})}}return F(),()=>{A=!1}},[]);async function k(A){A.preventDefault(),n("");try{await z("/api/dashboard/dealer/profile",{method:"POST",body:JSON.stringify({name:l,email:i,phone_country:c,phone_number:x,address_line1:j,address_line2:v,city:C,state:h,country:b,postal_code:$,bank_name:L,bank_account_number:U,bank_ifsc:Q,upi_id:me})}),n("Profile updated successfully.")}catch(F){a(te=>({...te,error:(F==null?void 0:F.message)||"Unable to update profile."}))}}async function M(A){A.preventDefault(),n("");try{await z("/api/dashboard/dealer/profile/password",{method:"POST",body:JSON.stringify({current_password:K,new_password:T,confirm_password:I})}),n("Password updated successfully."),O(""),H(""),S("")}catch(F){a(te=>({...te,error:(F==null?void 0:F.message)||"Unable to update password."}))}}return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading profile..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"My Profile"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsx("form",{id:"dealer-profile-form",onSubmit:k}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Profile Details"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:l,onChange:A=>r(A.target.value),form:"dealer-profile-form",required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Email ID"}),e.jsx("input",{type:"email",className:"form-control",value:i,onChange:A=>u(A.target.value),form:"dealer-profile-form",required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Phone Number"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",value:c,onChange:A=>m(A.target.value),style:{maxWidth:"170px"},form:"dealer-profile-form",children:W_.map(A=>e.jsxs("option",{value:A.code,children:[A.label," ",A.code]},`${A.code}-${A.label}`))}),e.jsx("input",{type:"tel",className:"form-control",value:x,onChange:A=>f(A.target.value),placeholder:"Phone number",form:"dealer-profile-form"})]})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Address Line 1"}),e.jsx("input",{type:"text",className:"form-control",value:j,onChange:A=>N(A.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Address Line 2"}),e.jsx("input",{type:"text",className:"form-control",value:v,onChange:A=>_(A.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",className:"form-control",value:C,onChange:A=>y(A.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{type:"text",className:"form-control",value:b,onChange:A=>{const F=A.target.value,te=Wo(F);P(F),te.length&&!te.includes(h)&&p("")},list:"country-options",form:"dealer-profile-form"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"State"}),Wo(b).length?e.jsxs("select",{className:"form-select",value:h,onChange:A=>p(A.target.value),form:"dealer-profile-form",children:[e.jsx("option",{value:"",children:"Select state"}),Wo(b).map(A=>e.jsx("option",{value:A,children:A},A))]}):e.jsx("input",{type:"text",className:"form-control",value:h,onChange:A=>p(A.target.value),placeholder:"State",form:"dealer-profile-form"})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Pincode"}),e.jsx("input",{type:"text",className:"form-control",value:$,onChange:A=>E(A.target.value),form:"dealer-profile-form"})]})]})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Bank Details"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Bank Name"}),e.jsx("input",{type:"text",className:"form-control",value:L,onChange:A=>V(A.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Account Number"}),e.jsx("input",{type:"text",className:"form-control",value:U,onChange:A=>w(A.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"IFSC"}),e.jsx("input",{type:"text",className:"form-control",value:Q,onChange:A=>J(A.target.value),form:"dealer-profile-form"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"UPI ID"}),e.jsx("input",{type:"text",className:"form-control",value:me,onChange:A=>re(A.target.value),form:"dealer-profile-form"})]}),e.jsx("button",{className:"btn btn-primary btn-sm",type:"submit",form:"dealer-profile-form",children:"Save Profile"})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Update Password"}),e.jsxs("form",{onSubmit:M,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Current Password"}),e.jsx("input",{type:"password",className:"form-control",value:K,onChange:A=>O(A.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsx("input",{type:"password",className:"form-control",value:T,onChange:A=>H(A.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Confirm New Password"}),e.jsx("input",{type:"password",className:"form-control",value:I,onChange:A=>S(A.target.value),required:!0})]}),e.jsx("button",{className:"btn btn-warning btn-sm",type:"submit",children:"Update Password"})]})]})})]}),e.jsx("datalist",{id:"country-options",children:Ai.map(A=>e.jsx("option",{value:A},A))})]})}const q_={loading:!0,error:"",data:null};function Y_(){const[t,a]=o.useState(q_),[s,n]=o.useState("");o.useEffect(()=>{let u=!0;async function c(){try{const m=await z("/api/dashboard/dealer/plan");if(!u)return;a({loading:!1,error:"",data:m})}catch(m){u&&a({loading:!1,error:(m==null?void 0:m.message)||"Unable to load plan details.",data:null})}}return c(),()=>{u=!1}},[]);async function l(){n("");try{const u=await z("/api/dashboard/dealer/subscribe",{method:"POST",body:JSON.stringify({})});if(u!=null&&u.redirect){window.location.href=u.redirect;return}n((u==null?void 0:u.message)||"Subscription created.")}catch(u){n(""),a(c=>({...c,error:(u==null?void 0:u.message)||"Unable to create subscription."}))}}if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading plan..."})]});const r=t.data||{},i=r.dealer_name||"Agent";return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Plan"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Dealer Subscription"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Yearly Amount:"})," ",r.subscription_amount??"-"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Commission Rate:"})," ",r.commission_rate??0,"%"]}),e.jsx("button",{className:"btn btn-primary",type:"button",onClick:l,children:"Proceed to Bank Transfer"})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("h5",{children:["Welcome ",i]}),e.jsxs("p",{className:"text-secondary mb-0",children:["You earn ",r.commission_rate??0,"% commission on the first invoice payment from the companies you bring to our products. Please complete your subscription payment to enable your account."]})]})})]})]})}const K_={loading:!0,error:"",data:null};function J_(){var N;const[t,a]=o.useState(K_),[s,n]=o.useState(""),[l,r]=o.useState(""),[i,u]=o.useState(1),c=20;o.useEffect(()=>{let v=!0;async function _(){try{const C=await z("/api/dashboard/dealer/billing");if(!v)return;a({loading:!1,error:"",data:C})}catch(C){v&&a({loading:!1,error:(C==null?void 0:C.message)||"Unable to load billing history.",data:null})}}return _(),()=>{v=!1}},[]),o.useEffect(()=>{const v=setTimeout(()=>{r(s.trim()),u(1)},300);return()=>clearTimeout(v)},[s]);const m=((N=t.data)==null?void 0:N.transfers)||[],x=o.useMemo(()=>{if(!l)return m;const v=l.toLowerCase();return m.filter(_=>[_.amount,_.currency,_.status_label,_.status,_.created_at,_.updated_at].some(C=>String(C||"").toLowerCase().includes(v)))},[m,l]),f=Math.max(Math.ceil(x.length/c),1),j=o.useMemo(()=>x.slice((i-1)*c,i*c),[x,i]);return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading billing..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Billing"}),e.jsx("hr",{className:"section-divider"}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{children:"Subscription Billing History"}),e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",c," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dealer-billing-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dealer-billing-search",type:"text",value:s,onChange:v=>n(v.target.value),placeholder:"Search billing"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Updated"})]})}),e.jsx("tbody",{children:j.length?j.map(v=>e.jsxs("tr",{children:[e.jsxs("td",{children:[v.currency," ",v.amount]}),e.jsx("td",{children:v.status_label||v.status}),e.jsx("td",{children:v.created_at||"-"}),e.jsx("td",{children:v.updated_at||"-"})]},v.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No billing history yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",j.length?(i-1)*c+1:0," to"," ",Math.min(i*c,x.length)," of ",x.length," entries"]}),e.jsx(He,{page:i,totalPages:f,onPageChange:u,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})}const Z_={loading:!0,error:"",data:null},Ir=8;function X_(t){const a=((t==null?void 0:t.org_referrals)||[]).map(n=>({id:`org-${n.id}`,type:"ORG",referred:n.referred_org||"-",base_amount:n.base_amount??"-",commission_rate:n.commission_rate??0,commission_amount:n.commission_amount??"-",flat_amount:"-",payout_reference:n.payout_reference||"-",payout_date:n.payout_date||"-",status:String(n.status||"pending").toLowerCase()})),s=((t==null?void 0:t.dealer_referrals)||[]).map(n=>({id:`dealer-${n.id}`,type:"Agent",referred:n.referred_dealer||"-",base_amount:n.base_amount??"-",commission_rate:n.commission_rate??0,commission_amount:n.commission_amount??"-",flat_amount:n.flat_amount??"-",payout_reference:n.payout_reference||"-",payout_date:n.payout_date||"-",status:String(n.status||"pending").toLowerCase()}));return[...a,...s]}function eS(t,a){if(!a)return t;const s=a.toLowerCase();return t.filter(n=>[n.type,n.referred,n.base_amount,n.commission_rate,n.commission_amount,n.flat_amount,n.payout_reference,n.payout_date,n.status].some(l=>String(l||"").toLowerCase().includes(s)))}function tS(t,a,s){const n=eS(t,a),l=Math.max(Math.ceil(n.length/Ir),1),r=Math.min(s,l),i=(r-1)*Ir,u=n.slice(i,i+Ir);return{filtered:n,paged:u,totalPages:l,currentPage:r,startIndex:i}}function Vo({title:t,rows:a,tableState:s,onStateChange:n,idKey:l}){const{filtered:r,paged:i,totalPages:u,currentPage:c,startIndex:m}=tS(a,s.term,s.page),x=`payout-${l}-search`;return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:t}),e.jsxs("label",{className:"table-search",htmlFor:x,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:x,type:"text",value:s.term,onChange:f=>n({term:f.target.value,page:1}),placeholder:"Search payouts"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Referred"}),e.jsx("th",{children:"Base Amount"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Flat"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]})}),e.jsx("tbody",{children:i.length?i.map(f=>e.jsxs("tr",{children:[e.jsx("td",{children:f.type}),e.jsx("td",{children:f.referred}),e.jsx("td",{children:f.base_amount}),e.jsxs("td",{children:[f.commission_rate,"%"]}),e.jsx("td",{children:f.commission_amount}),e.jsx("td",{children:f.flat_amount}),e.jsx("td",{children:f.payout_reference}),e.jsx("td",{children:f.payout_date})]},f.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No payouts found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",r.length?m+1:0," to ",Math.min(m+Ir,r.length)," of"," ",r.length," entries"]}),e.jsx(He,{page:c,totalPages:u,onPageChange:f=>n({page:f}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function aS(){const[t,a]=o.useState(Z_),[s,n]=o.useState({pending:{term:"",page:1},paid:{term:"",page:1},rejected:{term:"",page:1}});o.useEffect(()=>{let c=!0;async function m(){try{const x=await z("/api/dashboard/dealer/referrals");if(!c)return;a({loading:!1,error:"",data:x})}catch(x){c&&a({loading:!1,error:(x==null?void 0:x.message)||"Unable to load payouts.",data:null})}}return m(),()=>{c=!1}},[]);const l=o.useMemo(()=>X_(t.data),[t.data]),r=l.filter(c=>c.status==="pending"),i=l.filter(c=>c.status==="paid"),u=l.filter(c=>c.status==="rejected");return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading payouts..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Payouts"}),e.jsx("hr",{className:"section-divider"}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsx(Vo,{title:"Pending Payout Payments",rows:r,tableState:s.pending,idKey:"pending",onStateChange:c=>n(m=>({...m,pending:{...m.pending,...c}}))}),e.jsx(Vo,{title:"Paid Payments",rows:i,tableState:s.paid,idKey:"paid",onStateChange:c=>n(m=>({...m,paid:{...m.paid,...c}}))}),e.jsx(Vo,{title:"Payment Rejections",rows:u,tableState:s.rejected,idKey:"rejected",onStateChange:c=>n(m=>({...m,rejected:{...m.rejected,...c}}))})]})}const sS={loading:!0,error:"",data:null};function La(t,a="-"){if(t==null||t==="")return a;if(typeof t=="object")try{return JSON.stringify(t)}catch{return a}return String(t)}function nS(){var C;const{transferId:t}=ps(),[a,s]=o.useState(sS),[n,l]=o.useState(""),[r,i]=o.useState(""),[u,c]=o.useState(null),[m,x]=o.useState(!1);async function f(y){l("");try{const h=await z(`/api/dashboard/dealer/bank-transfer/${t}`);if(y&&!y.current)return;s({loading:!1,error:"",data:h})}catch(h){(!y||y.current)&&s({loading:!1,error:(h==null?void 0:h.message)||"Unable to load bank transfer details.",data:null})}}o.useEffect(()=>{const y={current:!0};return f(y),()=>{y.current=!1}},[t]);const j=((C=a.data)==null?void 0:C.transfer)||null,N=La(n,""),v=La(a.error,"");async function _(y){if(y.preventDefault(),!r.trim()){l("Please enter the reference / UTR number.");return}l(""),x(!0);try{const h=`/api/dashboard/dealer/bank-transfer/${t}/submit`,p=new FormData;p.append("reference_no",r.trim()),u&&p.append("receipt",u);const b=await fetch(h,{method:"POST",credentials:"include",headers:{"X-CSRFToken":es()},body:p}),P=await b.json().catch(()=>null);if(!b.ok){l((P==null?void 0:P.error)||"Unable to submit payment."),x(!1);return}P!=null&&P.message&&l(P.message),P!=null&&P.redirect?window.location.href=P.redirect:await f()}catch{l("Unable to submit payment.")}finally{x(!1)}}return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading bank transfer..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Bank Transfer"}),e.jsx("p",{className:"text-secondary mb-1",children:"Submit your payment details. We will verify and activate your dealer subscription."}),e.jsx("hr",{className:"section-divider"}),N?e.jsx("div",{className:"alert alert-info",children:N}):null,v?e.jsx("div",{className:"alert alert-danger",children:v}):null,j?e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{className:"mb-3",children:"Subscription Summary"}),e.jsx("table",{className:"table table-borderless mb-0",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Agent"}),e.jsx("td",{children:La(j.org_name)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Plan"}),e.jsx("td",{children:La(j.plan_name)})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Billing Cycle"}),e.jsx("td",{children:La(j.billing_cycle,"yearly")})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Amount"}),e.jsxs("td",{children:[La(j.currency,"INR")," ",La(j.base_amount??j.amount,"0")]})]}),j.tax_amount?e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"GST"}),e.jsxs("td",{children:[La(j.currency,"INR")," ",La(j.tax_amount,"0")]})]}):null,j.tax_amount?e.jsxs("tr",{children:[e.jsx("td",{className:"fw-semibold",children:"Total Payable"}),e.jsxs("td",{children:[La(j.currency,"INR")," ",La(j.total_amount,"0")]})]}):null]})})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{className:"mb-3",children:"Payment Details"}),e.jsxs("form",{onSubmit:_,children:[j.bank_account_details?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Bank Account Details"}),e.jsx("div",{className:"form-control",style:{whiteSpace:"pre-wrap"},children:j.bank_account_details})]}):null,e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Reference / UTR Number"}),e.jsx("input",{type:"text",className:"form-control",value:r,onChange:y=>i(y.target.value),placeholder:"Enter reference or UTR number",required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Transaction Screenshot"}),e.jsx("input",{type:"file",className:"form-control",onChange:y=>{var h;return c(((h=y.target.files)==null?void 0:h[0])||null)}})]}),e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:m,children:m?"Submitting...":"Submit for Approval"}),e.jsx("p",{className:"text-secondary mt-3 mb-0",children:"Your account will be activated after verification."})]})]})})]}):e.jsx("div",{className:"alert alert-warning",children:"No pending transfer found."})]})}const lS={loading:!0,error:"",data:null};function rS(){const[t,a]=o.useState(lS),s=ba();o.useEffect(()=>{let f=!0;async function j(){try{const N=await z("/api/saas-admin/overview");if(!f)return;a({loading:!1,error:"",data:N})}catch(N){f&&a({loading:!1,error:(N==null?void 0:N.message)||"Unable to load SaaS admin dashboard.",data:null})}}return j(),()=>{f=!1}},[]);const n=t.data||{},l=n.stats||{},r=m(n.products||[]),i=s.hash==="#products";if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading SaaS admin..."})]});if(t.error)return e.jsx("div",{className:"alert alert-danger",children:t.error});const u=[{label:"Total Orgs",value:l.total_orgs??0,icon:"bi-building"},{label:"Total Users",value:l.total_users??0,icon:"bi-people"},{label:"Active Subs",value:l.active_subscriptions??0,icon:"bi-check2-circle"},{label:"Pending Transfers",value:l.pending_transfers??0,icon:"bi-hourglass-split"},{label:"Expiring (Monthly)",value:l.expiring_monthly??0,icon:"bi-clock"},{label:"Expiring (Yearly)",value:l.expiring_yearly??0,icon:"bi-clock-history"},{label:"MRR (INR)",value:l.mrr??0,icon:"bi-cash"},{label:"ARR (INR)",value:l.arr??0,icon:"bi-graph-up-arrow"}];function c(f){return(f==null?void 0:f.slug)==="monitor"?"Work Zilla Monitoring and Productivity Insights.":(f==null?void 0:f.description)||"-"}function m(f){const j=new Map;f.forEach(_=>{const C=(_==null?void 0:_.slug)||(_==null?void 0:_.name),y=C?String(C).trim().toLowerCase():"";if(!y)return;const h=j.get(y);if(!h){j.set(y,_);return}const p=String(h.description||h.short_description||"").trim(),b=String(_.description||_.short_description||"").trim();if(!p&&b){j.set(y,_);return}const P=String(h.icon||"").trim(),$=String(_.icon||"").trim();!P&&$&&j.set(y,_)});const N=Array.from(j.values());if(N.length<=1)return N;const v=new Map;return N.forEach(_=>{const C=String((_==null?void 0:_.name)||"").trim().toLowerCase();if(!C)return;const y=v.get(C);if(!y){v.set(C,_);return}const h=x(y);x(_)>h&&v.set(C,_)}),Array.from(v.values())}function x(f){const j=String((f==null?void 0:f.description)||(f==null?void 0:f.short_description)||"").trim(),N=String((f==null?void 0:f.icon)||"").trim();let v=0;return j&&(v+=2),N&&(v+=1),f!=null&&f.slug&&(v+=1),v}return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",id:i?"products":"overview",children:i?"Products":"SaaS Admin"}),e.jsx("hr",{className:"section-divider"}),i?null:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"row g-3",children:u.map(f=>e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:`bi ${f.icon}`,"aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:f.label}),e.jsx("div",{className:"stat-value",children:f.value})]})},f.label))}),e.jsxs("div",{className:"row g-3 mt-4",children:[e.jsx("div",{className:"col-12 col-xl-6",children:e.jsxs("div",{className:"card p-4 h-100",children:[e.jsx("h4",{children:"Operations"}),e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-shield-check","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Retention Policy"}),e.jsx("p",{className:"text-secondary mb-3",children:"Manage retention rules and overrides."}),e.jsx(et,{to:"/saas-admin/retention-policy",className:"btn btn-primary btn-sm",children:"Manage"})]})}),e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-hdd-network","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Media Storage"}),e.jsx("p",{className:"text-secondary mb-3",children:"Configure storage targets for backups."}),e.jsx(et,{to:"/saas-admin/storage",className:"btn btn-primary btn-sm",children:"Open"})]})}),e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-cloud-download","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Org Downloads"}),e.jsx("p",{className:"text-secondary mb-3",children:"Track backup generation and downloads across orgs."}),e.jsx(et,{to:"/saas-admin/backup-activity",className:"btn btn-primary btn-sm",children:"View Activity"})]})}),e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-cpu","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Server Monitoring"}),e.jsx("p",{className:"text-secondary mb-3",children:"Track CPU, RAM, disk, and uptime across servers."}),e.jsx(et,{to:"/saas-admin/server-monitoring",className:"btn btn-primary btn-sm",children:"Open"})]})})]})]})}),e.jsx("div",{className:"col-12 col-xl-6",children:e.jsxs("div",{className:"card p-4 h-100",children:[e.jsx("h4",{children:"Org Admin Common Features"}),e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-cloud-download","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Org Downloads"}),e.jsx("p",{className:"text-secondary mb-3",children:"View organization backup history and exports."}),e.jsx(et,{to:"/saas-admin/backup-activity",className:"btn btn-primary btn-sm",children:"Open"})]})}),e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-shield-check","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Retention Policy"}),e.jsx("p",{className:"text-secondary mb-3",children:"Manage global retention rules for all orgs."}),e.jsx(et,{to:"/saas-admin/retention-policy",className:"btn btn-primary btn-sm",children:"Manage"})]})}),e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-hdd-network","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Storage Settings"}),e.jsx("p",{className:"text-secondary mb-3",children:"Configure screenshot storage targets."}),e.jsx(et,{to:"/saas-admin/storage",className:"btn btn-primary btn-sm",children:"Open"})]})}),e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-images","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Media Library"}),e.jsx("p",{className:"text-secondary mb-3",children:"Browse and manage stored media files."}),e.jsx(et,{to:"/org-admin/media-library",className:"btn btn-primary btn-sm",children:"Open"})]})}),e.jsx("div",{className:"col-12 col-md-6",children:e.jsxs("div",{className:"card p-3 h-100 admin-feature-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-receipt","aria-hidden":"true"})}),e.jsx("h5",{className:"mb-1",children:"Billing"}),e.jsx("p",{className:"text-secondary mb-3",children:"Review org billing and renewals."}),e.jsx(et,{to:"/saas-admin/billing",className:"btn btn-primary btn-sm",children:"Open"})]})})]})]})})]})]}),e.jsxs("div",{className:`card p-4 ${i?"":"mt-4"}`,id:"products",children:[i?null:e.jsx("h4",{children:"Products"}),e.jsx("div",{className:"row g-3 mt-1",children:r.map(f=>e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center gap-2 mb-2",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:`bi ${f.icon||"bi-grid"}`,"aria-hidden":"true"})}),e.jsx("h5",{className:"mb-0",children:f.name})]}),e.jsx("p",{className:"text-secondary mb-2",children:c(f)}),e.jsxs("div",{className:"text-secondary mb-3",children:["Active Orgs: ",f.active_orgs??0]}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[f.status==="active"?e.jsx("span",{className:"badge bg-success",children:"Active"}):f.status==="disabled"?e.jsx("span",{className:"badge bg-secondary",children:"Disabled"}):e.jsx("span",{className:"badge bg-warning text-dark",children:"Coming soon"}),e.jsx(et,{to:`/saas-admin/products/${f.slug}`,className:"btn btn-primary btn-sm",children:"Open"})]})]})},f.id))})]})]})}function ll(t,a,s,n){const l=Number(t),r=Number(a),i=Number(s),u=Number(n);return!Number.isFinite(l)||l<=0||!Number.isFinite(r)||r<=0||!Number.isFinite(i)||i<0||!Number.isFinite(u)||u<=0?null:{costInr:l*r/1e3*i*u,tokensPerReply:r,usdPer1k:i,usdToInr:u}}async function iS({days:t=7,org_id:a=null,product:s=null}={}){const n=new URLSearchParams;t&&n.set("days",String(t)),a&&n.set("org_id",String(a)),s&&n.set("product",s);const l=await fetch(`/api/saas-admin/observability/summary?${n.toString()}`,{credentials:"include"});if(l.status===401){typeof window<"u"&&window.location.assign("/auth/login/");const u=new Error("Unauthorized");throw u.status=401,u}if(l.status===403){const u=new Error("Not authorized");throw u.status=403,u}const r=await l.text();let i=null;if(r)try{i=JSON.parse(r)}catch{i=null}if(!l.ok){const u=(i==null?void 0:i.error)||`Request failed (${l.status})`,c=new Error(u);throw c.status=l.status,c.data=i,c}return i}const oS={loading:!0,error:"",data:null},rl=[{key:"agent_activity_upload",label:"Activity uploads",icon:"bi-upload"},{key:"agent_screenshot_upload",label:"Screenshot uploads",icon:"bi-camera"},{key:"agent_org_settings",label:"Org settings hits",icon:"bi-gear"},{key:"agent_rate_limited",label:"Rate limited hits",icon:"bi-slash-circle"},{key:"renew_submitted",label:"Renew submitted",icon:"bi-arrow-repeat"},{key:"transfer_approved",label:"Transfer approved",icon:"bi-check2-circle"},{key:"subscription_expired",label:"Subscription expired",icon:"bi-x-circle"}],cS=[7,14,30];function _r(t){return t==null?0:Number(t).toLocaleString()}function Rg({initialProduct:t="monitor",initialOrgId:a="all",initialDays:s=7,showTitle:n=!0}){const[l,r]=o.useState(oS),[i,u]=o.useState({days:s,orgId:a,product:t}),[c,m]=o.useState(0),[x,f]=o.useState(!1);o.useEffect(()=>{let p=!0;async function b(){r(P=>({...P,loading:!0,error:""}));try{const P=await iS({days:i.days,org_id:i.orgId==="all"?null:i.orgId,product:i.product==="all"?null:i.product});if(!p)return;r({loading:!1,error:"",data:P})}catch(P){if(!p)return;r({loading:!1,error:(P==null?void 0:P.message)||"Unable to load observability summary.",data:null})}}return b(),()=>{p=!1}},[i,c]),o.useEffect(()=>{if(!x)return;const p=setInterval(()=>{m(b=>b+1)},6e4);return()=>clearInterval(p)},[x]);const j=l.data||{},N=j.totals||{},v=j.orgs||[],_=j.products||[],C=j.by_day||[],y=j.pending_transfers||[],h=o.useMemo(()=>C.map(p=>{const b=p.counts||{};return{date:p.date,counts:rl.reduce((P,$)=>(P[$.key]=b[$.key]??0,P),{})}}),[C]);return l.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading observability summary..."})]}):l.error?e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"alert alert-danger mb-3",children:l.error}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>m(p=>p+1),children:"Retry"})]}):e.jsxs(e.Fragment,{children:[n?e.jsx("h3",{className:"page-title",children:"Observability"}):null,e.jsxs("div",{className:"d-flex flex-wrap align-items-end gap-2 mt-3",children:[e.jsxs("label",{className:"table-search",children:[e.jsx("span",{children:"Organization"}),e.jsxs("select",{value:i.orgId,onChange:p=>u(b=>({...b,orgId:p.target.value})),children:[e.jsx("option",{value:"all",children:"All"}),v.map(p=>e.jsx("option",{value:String(p.id),children:p.name},p.id))]})]}),e.jsxs("label",{className:"table-search",children:[e.jsx("span",{children:"Product"}),e.jsxs("select",{value:i.product,onChange:p=>u(b=>({...b,product:p.target.value})),children:[e.jsx("option",{value:"all",children:"All"}),_.map(p=>e.jsx("option",{value:p,children:p},p))]})]}),e.jsxs("label",{className:"table-search",children:[e.jsx("span",{children:"Days"}),e.jsx("select",{value:i.days,onChange:p=>u(b=>({...b,days:Number(p.target.value)})),children:cS.map(p=>e.jsxs("option",{value:p,children:[p," days"]},p))})]}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>m(p=>p+1),children:"Refresh"}),e.jsxs("div",{className:"form-check ms-2",children:[e.jsx("input",{id:"observability-auto-refresh",className:"form-check-input",type:"checkbox",checked:x,onChange:p=>f(p.target.checked)}),e.jsx("label",{className:"form-check-label",htmlFor:"observability-auto-refresh",children:"Auto-refresh (60s)"})]})]}),e.jsx("div",{className:"row g-3 mt-3",children:rl.map(p=>e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:`bi ${p.icon}`,"aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:p.label}),e.jsx("div",{className:"stat-value",children:_r(N[p.key]??0)})]})},p.key))}),e.jsxs("div",{className:"row g-3 mt-3",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{className:"mb-0",children:"Daily Breakdown"}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Date"}),rl.map(p=>e.jsx("th",{children:p.label},p.key))]})}),e.jsx("tbody",{children:h.length?h.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.date}),rl.map(b=>e.jsx("td",{children:_r(p.counts[b.key]||0)},`${p.date}-${b.key}`))]},p.date)):e.jsx("tr",{children:e.jsx("td",{colSpan:rl.length+1,children:"No metrics found."})})})]})})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("h5",{className:"mb-0",children:"Pending Approvals"}),e.jsx("span",{className:"badge bg-warning text-dark",children:_r(y.reduce((p,b)=>p+(b.count||0),0))})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Org"}),e.jsx("th",{children:"Pending Transfers"}),e.jsx("th",{children:"Link"})]})}),e.jsx("tbody",{children:y.length?y.map(p=>e.jsxs("tr",{children:[e.jsx("td",{children:p.org_name}),e.jsx("td",{children:_r(p.count)}),e.jsx("td",{children:e.jsx(et,{className:"btn btn-outline-light btn-sm",to:`/saas-admin/transfers?org_id=${p.org_id}`,children:"View"})})]},p.org_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"3",children:"No pending transfers."})})})]})})]})})]})]})}const Ra={loading:!0,error:"",data:null},zf={tokensPerReply:300,usdPer1k:.002,usdToInr:85,warnHighInr:500,warnVeryHighInr:2e3};function we(t){return t==null||t===""?"-":t}function ma(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}function Bf(){var _u,Su,wu,Cu,ku,Pu,Tu,Eu,Au,Du,Lu,Ru,Mu,$u,Uu,Ou,Iu,Fu,zu,Bu,Wu,Vu,Gu,Hu,Qu,qu,Yu,Ku,Ju,Zu,Xu,em,tm,am,sm,nm,lm,rm,im,om,cm,dm,um,mm,hm,fm,pm,xm,gm,jm,bm,ym,vm,Nm,_m,Sm,wm,Cm,km,Pm,Tm,Em,Am,Dm,Lm,Rm,Mm,$m,Um,Om,Im,Fm,zm,Bm,Wm,Vm,Gm,Hm,Qm,qm,Ym,Km,Jm,Zm,Xm,eh,th,ah,sh,nh,lh,rh,ih,oh,ch,dh,uh,mh,hh,fh,ph,xh;const{slug:t}=ps(),a=ba(),s=nn(),[n,l]=o.useState(Ra),[r,i]=o.useState("organizations"),[u,c]=o.useState(Ra),[m,x]=o.useState("org"),[f,j]=o.useState("active"),[N,v]=o.useState("active"),[_,C]=o.useState({org:{active:{term:"",page:1},inactive:{term:"",page:1},expired:{term:"",page:1},deleted:{term:"",page:1}},dealer:{active:{term:"",page:1},inactive:{term:"",page:1},expired:{term:"",page:1},deleted:{term:"",page:1}}}),[y,h]=o.useState(Ra),[p,b]=o.useState(""),[P,$]=o.useState(""),[E,L]=o.useState(1),[V,U]=o.useState(Ra),[w,Q]=o.useState({open:!1,mode:"create",form:{},error:"",fieldErrors:{},loading:!1,planId:null}),[J,me]=o.useState(()=>{try{const d=window.localStorage.getItem("wz_ai_cost_assumptions");if(d)return{...zf,...JSON.parse(d)}}catch{}return zf}),[re,K]=o.useState(!1);function O(d){var ee;const g=(ee=w.fieldErrors)==null?void 0:ee[d];if(!g)return null;const R=Array.isArray(g)?g.join(", "):g;return e.jsx("div",{className:"text-danger small",children:R})}o.useEffect(()=>{try{window.localStorage.setItem("wz_ai_cost_assumptions",JSON.stringify(J))}catch{}},[J]);function T(d){const g=Number(d);if(!Number.isFinite(g)||g<=0)return null;const R=Number(J.tokensPerReply),ee=Number(J.usdPer1k),ke=Number(J.usdToInr);return ll(g,R,ee,ke)}const[H,I]=o.useState(Ra),[S,k]=o.useState("org"),[M,A]=o.useState(""),[F,te]=o.useState(""),[Y,ue]=o.useState(1),[he,ye]=o.useState(Ra),[G,Ne]=o.useState("approved"),[_e,de]=o.useState("org"),[Re,je]=o.useState(""),[Ae,Qe]=o.useState(""),[qe,Je]=o.useState(1),[Ye,oe]=o.useState(Ra),[ve,Z]=o.useState("upcoming"),[ce,xe]=o.useState("monthly"),[Ce,Fe]=o.useState(""),[Ze,ne]=o.useState(""),[Ie,Oe]=o.useState(1),[Me,st]=o.useState(Ra),[Dt,W]=o.useState(""),[pe,fe]=o.useState(""),[D,X]=o.useState(1),[q,ie]=o.useState(""),[Ee,tt]=o.useState(""),[B,le]=o.useState(1),[Te,Se]=o.useState(Ra),[Le,lt]=o.useState("org"),[Ut,Ba]=o.useState({org:{pending:{term:"",page:1},paid:{term:"",page:1},rejected:{term:"",page:1}},dealer:{pending:{term:"",page:1},paid:{term:"",page:1},rejected:{term:"",page:1}}}),[Wa,Va]=o.useState(Ra),[Ct,kt]=o.useState(Ra),[ea,ya]=o.useState(7),[ta,ts]=o.useState(""),[ca,Ga]=o.useState(new Date().getFullYear()),[da,Ha]=o.useState(new Date().getMonth()+1),[Lt,aa]=o.useState({open:!1,loading:!1,error:"",org:null,rows:[]}),[at,Nt]=o.useState({loading:!1,error:"",data:null,form:{api_key:"",model:"gpt-4o-mini",input_cost_per_1k_tokens_inr:"",output_cost_per_1k_tokens_inr:"",fixed_markup_percent:"",is_active:!0},saved:""}),[sa,se]=o.useState({loading:!1,message:"",ok:null}),[be,We]=o.useState({open:!1,loading:!1,data:null,error:""}),[ae,Pe]=o.useState({open:!1,loading:!1,data:null,error:"",clearing:!1,receiptPreview:""}),[Ve,ze]=o.useState({open:!1,url:"",transferId:null,clearing:!1}),[ht,Di]=o.useState({open:!1,title:"",details:{}}),[ua,xs]=o.useState({open:!1,row:null,type:"org",note:"",error:"",saving:!1}),[ot,Pt]=o.useState({open:!1,loading:!1,data:null,error:"",form:{}}),[yt,Li]=o.useState({open:!1,row:null}),[Aa,qn]=o.useState({open:!1,loading:!1,data:null,error:""}),[qt,va]=o.useState({open:!1,loading:!1,data:null,error:"",form:{}}),rt=10;o.useEffect(()=>{const d=(a.hash||"").replace("#","").trim();i(d||"organizations")},[a.hash,a.pathname,t]),o.useEffect(()=>{let d=!0;async function g(){try{const R=await z(`/api/saas-admin/products/${t}`);if(!d)return;l({loading:!1,error:"",data:R})}catch(R){d&&l({loading:!1,error:(R==null?void 0:R.message)||"Unable to load product dashboard.",data:null})}}return g(),()=>{d=!1}},[t]);async function Gd(){const d=await z(`/api/saas-admin/products/${t}/organizations`);c({loading:!1,error:"",data:d})}async function Hd(){const d=await z(`/api/saas-admin/products/${t}/users`);h({loading:!1,error:"",data:d})}async function Ri(){const d=t==="storage"||t==="online-storage"?await z("/api/saas-admin/storage/plan"):await z(`/api/saas-admin/plans?product=${t}`);U({loading:!1,error:"",data:d})}async function Mi(){const d=await z(`/api/saas-admin/products/${t}/pending-transfers`);I({loading:!1,error:"",data:d})}async function $i(){const d=await z(`/api/saas-admin/products/${t}/transfer-history`);ye({loading:!1,error:"",data:d})}async function Mg(){const d=await z(`/api/saas-admin/products/${t}/billing-history`);st({loading:!1,error:"",data:d})}async function Qd(){const d=await z(`/api/saas-admin/products/${t}/referrals`);Se({loading:!1,error:"",data:d})}async function $g(){const d=new URLSearchParams;d.set("days",String(ea)),d.set("year",String(ca)),d.set("month",String(da)),ta&&d.set("org_id",ta);const g=await z(`/api/saas-admin/ai-chatbot/usage/summary?${d.toString()}`);kt({loading:!1,error:"",data:g})}async function Ug(d){if(d!=null&&d.org_id){aa({open:!0,loading:!0,error:"",org:d,rows:[]});try{const g=new URLSearchParams;g.set("org_id",String(d.org_id)),g.set("months","6");const R=await z(`/api/saas-admin/ai-chatbot/usage/trend?${g.toString()}`);aa(ee=>({...ee,loading:!1,error:"",rows:R.trend||[]}))}catch(g){aa(R=>({...R,loading:!1,error:(g==null?void 0:g.message)||"Unable to load usage trend."}))}}}async function qd(){Nt(d=>({...d,loading:!0,error:""}));try{const d=await z("/api/saas-admin/ai-chatbot/openai/settings");Nt(g=>({...g,loading:!1,error:"",data:d,form:{api_key:"",model:d.model||"gpt-4o-mini",input_cost_per_1k_tokens_inr:d.input_cost_per_1k_tokens_inr??"",output_cost_per_1k_tokens_inr:d.output_cost_per_1k_tokens_inr??"",fixed_markup_percent:d.fixed_markup_percent??"",is_active:!!d.is_active},saved:d.updated_at||""}))}catch(d){Nt(g=>({...g,loading:!1,error:(d==null?void 0:d.message)||"Unable to load OpenAI settings."}))}}async function Og(){Nt(d=>({...d,loading:!0,error:""}));try{const d={api_key:at.form.api_key,model:at.form.model,input_cost_per_1k_tokens_inr:Number(at.form.input_cost_per_1k_tokens_inr||0),output_cost_per_1k_tokens_inr:Number(at.form.output_cost_per_1k_tokens_inr||0),fixed_markup_percent:Number(at.form.fixed_markup_percent||0),is_active:!!at.form.is_active},g=await z("/api/saas-admin/ai-chatbot/openai/settings",{method:"POST",body:JSON.stringify(d)});Nt(R=>({...R,loading:!1,error:"",data:g,form:{...R.form,api_key:"",model:g.model||R.form.model,input_cost_per_1k_tokens_inr:g.input_cost_per_1k_tokens_inr??R.form.input_cost_per_1k_tokens_inr,output_cost_per_1k_tokens_inr:g.output_cost_per_1k_tokens_inr??R.form.output_cost_per_1k_tokens_inr,fixed_markup_percent:g.fixed_markup_percent??R.form.fixed_markup_percent,is_active:!!g.is_active},saved:g.updated_at||new Date().toISOString()}))}catch(d){Nt(g=>({...g,loading:!1,error:(d==null?void 0:d.message)||"Unable to save OpenAI settings."}))}}async function Ig(){se({loading:!0,message:"",ok:null});try{const d={api_key:at.form.api_key,model:at.form.model},g=await z("/api/saas-admin/ai-chatbot/openai/test",{method:"POST",body:JSON.stringify(d)});se({loading:!1,message:`Connection OK (${g.model||"model"})`,ok:!0})}catch(d){se({loading:!1,message:(d==null?void 0:d.message)||"Connection failed.",ok:!1})}}o.useEffect(()=>{let d=!0;async function g(){try{const R=await z(`/api/saas-admin/products/${t}/organizations`);d&&c({loading:!1,error:"",data:R})}catch(R){d&&c({loading:!1,error:(R==null?void 0:R.message)||"Unable to load organizations.",data:null})}}return g(),()=>{d=!1}},[t]),o.useEffect(()=>{let d=!0;async function g(){try{const R=await z(`/api/saas-admin/products/${t}/users`);d&&h({loading:!1,error:"",data:R})}catch(R){d&&h({loading:!1,error:(R==null?void 0:R.message)||"Unable to load users.",data:null})}}return g(),()=>{d=!1}},[t]),o.useEffect(()=>{let d=!0;async function g(){try{const R=t==="storage"||t==="online-storage"?await z("/api/saas-admin/storage/plan"):await z(`/api/saas-admin/plans?product=${t}`);d&&U({loading:!1,error:"",data:R})}catch(R){d&&U({loading:!1,error:(R==null?void 0:R.message)||"Unable to load plans.",data:null})}}return g(),()=>{d=!1}},[t]),o.useEffect(()=>{let d=!0;async function g(){try{const R=await z(`/api/saas-admin/products/${t}/pending-transfers`);d&&I({loading:!1,error:"",data:R})}catch(R){d&&I({loading:!1,error:(R==null?void 0:R.message)||"Unable to load pending transfers.",data:null})}}return g(),()=>{d=!1}},[t]),o.useEffect(()=>{let d=!0;async function g(){try{const R=await z(`/api/saas-admin/products/${t}/transfer-history`);d&&ye({loading:!1,error:"",data:R})}catch(R){d&&ye({loading:!1,error:(R==null?void 0:R.message)||"Unable to load transfer history.",data:null})}}return g(),()=>{d=!1}},[t]),o.useEffect(()=>{let d=!0;async function g(){try{const R=await z(`/api/saas-admin/products/${t}/renewals`);d&&oe({loading:!1,error:"",data:R})}catch(R){d&&oe({loading:!1,error:(R==null?void 0:R.message)||"Unable to load renewals.",data:null})}}return g(),()=>{d=!1}},[t]),o.useEffect(()=>{let d=!0;async function g(){try{const R=await z(`/api/saas-admin/products/${t}/billing-history`);d&&st({loading:!1,error:"",data:R})}catch(R){d&&st({loading:!1,error:(R==null?void 0:R.message)||"Unable to load billing history.",data:null})}}return g(),()=>{d=!1}},[t]),o.useEffect(()=>{let d=!0;async function g(){try{const R=await z(`/api/saas-admin/products/${t}/referrals`);d&&Se({loading:!1,error:"",data:R})}catch(R){d&&Se({loading:!1,error:(R==null?void 0:R.message)||"Unable to load referrals.",data:null})}}return g(),()=>{d=!1}},[t]),o.useEffect(()=>{let d=!0;async function g(){try{const R=await z(`/api/saas-admin/products/${t}/support-access`);d&&Va({loading:!1,error:"",data:R})}catch(R){d&&Va({loading:!1,error:(R==null?void 0:R.message)||"Unable to load support access.",data:null})}}return g(),()=>{d=!1}},[t]),o.useEffect(()=>{const d=setTimeout(()=>{te(M.trim()),ue(1)},300);return()=>clearTimeout(d)},[M]),o.useEffect(()=>{const d=setTimeout(()=>{Qe(Re.trim()),Je(1)},300);return()=>clearTimeout(d)},[Re]),o.useEffect(()=>{const d=setTimeout(()=>{ne(Ce.trim()),Oe(1)},300);return()=>clearTimeout(d)},[Ce]),o.useEffect(()=>{const d=setTimeout(()=>{fe(Dt.trim()),X(1)},300);return()=>clearTimeout(d)},[Dt]),o.useEffect(()=>{const d=setTimeout(()=>{tt(q.trim()),le(1)},300);return()=>clearTimeout(d)},[q]),o.useEffect(()=>{const d=setTimeout(()=>{$(p.trim()),L(1)},300);return()=>clearTimeout(d)},[p]);const Ui=((_u=u.data)==null?void 0:_u.organizations)||[],Fg=((Su=u.data)==null?void 0:Su.plans)||((wu=V.data)==null?void 0:wu.plans)||[],zg=((Cu=u.data)==null?void 0:Cu.deleted_orgs)||[],Yd=((ku=u.data)==null?void 0:ku.dealers)||[],Bg=((Pu=u.data)==null?void 0:Pu.deleted_dealers)||[],Wg=o.useMemo(()=>Uj(Ui),[Ui]),Vg=o.useMemo(()=>Oj(Yd),[Yd]),Oi=((Tu=y.data)==null?void 0:Tu.users)||[],Yn=o.useMemo(()=>{if(!P)return Oi;const d=P.toLowerCase();return Oi.filter(g=>[g.name,g.email,g.org_name,g.device_id,g.pc_name].some(R=>String(R||"").toLowerCase().includes(d)))},[Oi,P]),Gg=Math.max(Math.ceil(Yn.length/rt),1),Ql=o.useMemo(()=>Yn.slice((E-1)*rt,E*rt),[Yn,E]),Kd=((Eu=V.data)==null?void 0:Eu.plans)||[],Hg=((Au=H.data)==null?void 0:Au.org_transfers)||[],Qg=((Du=H.data)==null?void 0:Du.dealer_transfers)||[],Ii=S==="dealer"?Qg:Hg,qg=S==="dealer"?"Dealer":"Organization",ln=o.useMemo(()=>{if(!F)return Ii;const d=F.toLowerCase();return Ii.filter(g=>[g.organization,g.plan,g.request_type,g.billing_cycle,g.amount,g.currency,g.created_at].some(R=>String(R||"").toLowerCase().includes(d)))},[Ii,F]),Yg=Math.max(Math.ceil(ln.length/rt),1),Jd=o.useMemo(()=>ln.slice((Y-1)*rt,Y*rt),[ln,Y]),Zd=((Lu=he.data)==null?void 0:Lu.transfers)||[],Fi=o.useMemo(()=>Zd.filter(d=>d.status===G),[Zd,G]),zi=o.useMemo(()=>_e==="dealer"?Fi.filter(d=>d.request_type==="dealer"):Fi.filter(d=>d.request_type!=="dealer"),[Fi,_e]),rn=o.useMemo(()=>{if(!Ae)return zi;const d=Ae.toLowerCase();return zi.filter(g=>[g.organization,g.plan,g.request_type,g.billing_cycle,g.amount,g.currency,g.updated_at].some(R=>String(R||"").toLowerCase().includes(d)))},[zi,Ae]),Kg=Math.max(Math.ceil(rn.length/rt),1),Xd=o.useMemo(()=>rn.slice((qe-1)*rt,qe*rt),[rn,qe]),Bi=Ye.data||{},Jg=Bi.upcoming||[],Zg=Bi.missed||[],Xg=Bi.deleted||[],Wi=ve==="missed"?Zg:ve==="deleted"?Xg:Jg,on=o.useMemo(()=>{const d=ve==="deleted"||ce==="all"?Wi:Wi.filter(R=>R.billing_cycle===ce);if(!Ze)return d;const g=Ze.toLowerCase();return d.filter(R=>(ve==="deleted"?[R.organization_name,R.owner_username,R.owner_email,R.reason,R.deleted_at]:[R.organization,R.owner_name,R.owner_email,R.plan,R.billing_cycle,R.end_date,R.status,R.days_remaining,R.days_overdue]).some(ke=>String(ke||"").toLowerCase().includes(g)))},[Wi,Ze,ve,ce]),ej=Math.max(Math.ceil(on.length/rt),1),ql=o.useMemo(()=>on.slice((Ie-1)*rt,Ie*rt),[on,Ie]),eu=Me.data||{},tu=eu.transfers||[],au=eu.subscriptions||[],tj=o.useMemo(()=>hn(tu,pe,D,(g,R)=>{if(!R)return g;const ee=R.toLowerCase();return g.filter(ke=>[ke.organization,ke.owner_name,ke.owner_email,ke.request_type,ke.billing_cycle,ke.plan,ke.amount,ke.currency,ke.status,ke.paid_on,ke.reference_no,ke.created_at,ke.updated_at].some(Ke=>String(Ke||"").toLowerCase().includes(ee)))}),[tu,pe,D]),aj=o.useMemo(()=>hn(au,Ee,B,(g,R)=>{if(!R)return g;const ee=R.toLowerCase();return g.filter(ke=>[ke.organization,ke.plan,ke.status,ke.billing_cycle,ke.start_date,ke.end_date,ke.created_at,ke.user_name,ke.user_email].some(Ke=>String(Ke||"").toLowerCase().includes(ee)))}),[au,Ee,B]),{filtered:Vi,paged:su,totalPages:sj,currentPage:nj,startIndex:nu}=tj,{filtered:Gi,paged:lu,totalPages:lj,currentPage:rj,startIndex:ru}=aj,iu=Te.data||{},ij=iu.org_referrals||[],oj=iu.dealer_referrals||[],ou=Le==="dealer"?oj:ij,cn=o.useMemo(()=>Ij(ou),[ou]),cu=((Ru=Wa.data)==null?void 0:Ru.rows)||[],dn=((Mu=Ct.data)==null?void 0:Mu.totals)||{},du=(($u=Ct.data)==null?void 0:$u.top_orgs)||[],uu=((Uu=Ct.data)==null?void 0:Uu.alerts)||[],mu=((Ou=Ct.data)==null?void 0:Ou.period)||"",Yl=Number(J.usdPer1k),un=Number(J.tokensPerReply),Kl=Number(J.usdToInr),hu=Number(dn.tokens_total??0),Hi=Number(dn.ai_replies_used??0),zs=Number(dn.ai_replies_limit??0),Qi=zs?Math.round(Hi/zs*100):0,qi=hu>0?ll(hu/un,un,Yl,Kl):null,Yi=Hi>0?ll(Hi,un,Yl,Kl):null,cj=Number(dn.cost_inr_est??0)||(qi==null?void 0:qi.costInr)||(Yi==null?void 0:Yi.costInr)||0,mn=zs&&Qi>=100?{level:"danger",message:"AI usage limit reached. Upgrade plan to continue."}:zs&&Qi>=80?{level:"warning",message:"AI usage is above 80% for this org."}:null,Ki=new Date().getFullYear(),dj=[Ki-1,Ki,Ki+1],uj=Array.from({length:12},(d,g)=>g+1),Ji=((Iu=at.data)==null?void 0:Iu.api_key_masked)||"",fu=!!(Ji||at.form.api_key),Zi=n.data||{},Bs=Zi.product||{},Xi=(Bs==null?void 0:Bs.slug)||t,Wt=Xi==="ai-chatbot",Qa=Xi==="storage"||Xi==="online-storage",Kn=Zi.stats||{},pu=Zi.monthly_sales||{},xu=pu.INR??0,gu=pu.USD??0,mj=gu?`INR ${xu} / USD ${gu}`:`INR ${xu}`,hj=[{label:"Total Orgs",value:Kn.total??0,icon:"bi-building"},{label:"Active Orgs",value:Kn.active??0,icon:"bi-check2-circle"},{label:"Trial Orgs",value:Kn.trial??0,icon:"bi-clock"},{label:"Inactive Orgs",value:Kn.inactive??0,icon:"bi-slash-circle"},{label:"Pending Approvals",value:Kn.pending_approvals??0,icon:"bi-hourglass-split"},{label:"Monthly Sales (30d)",value:mj,icon:"bi-cash-stack"}];o.useEffect(()=>{if(!Wt||r!=="ai-usage")return;let d=!0;async function g(){try{const R=new URLSearchParams;R.set("days",String(ea)),R.set("year",String(ca)),R.set("month",String(da)),ta&&R.set("org_id",ta);const ee=await z(`/api/saas-admin/ai-chatbot/usage/summary?${R.toString()}`);d&&kt({loading:!1,error:"",data:ee})}catch(R){d&&kt({loading:!1,error:(R==null?void 0:R.message)||"Unable to load AI usage.",data:null})}}return kt(R=>({...R,loading:!0,error:""})),g(),()=>{d=!1}},[r,ea,ta,ca,da,Wt]),o.useEffect(()=>{!Wt||r!=="openai-settings"||qd()},[r,Wt]);function fj(d,g){return g==="monitor"?"Work Zilla Monitoring and Productivity Insights.":d||"-"}async function pj(d){We({open:!0,loading:!0,data:null,error:""});try{const g=await z(`/api/saas-admin/organizations/${d}`);We({open:!0,loading:!1,data:g,error:""})}catch(g){We({open:!0,loading:!1,data:null,error:(g==null?void 0:g.message)||"Unable to load organization."})}}async function xj(d){Pe({open:!0,loading:!0,data:null,error:"",clearing:!1,receiptPreview:""});try{const g=await z(`/api/saas-admin/products/${t}/pending-transfers/${d}`);Pe({open:!0,loading:!1,data:g,error:"",clearing:!1,receiptPreview:""})}catch(g){Pe({open:!0,loading:!1,data:null,error:(g==null?void 0:g.message)||"Unable to load transfer details.",clearing:!1,receiptPreview:""})}}async function gj(d){if(await s({title:"Clear Receipt",message:"Delete the uploaded receipt image?",confirmText:"Delete",confirmVariant:"danger"})){Pe(R=>({...R,clearing:!0}));try{await z(`/api/saas-admin/products/${t}/pending-transfers/${d}/receipt-clear`,{method:"POST"}),await Mi();const R=await z(`/api/saas-admin/products/${t}/pending-transfers/${d}`);Pe({open:!0,loading:!1,data:R,error:"",clearing:!1})}catch(R){Pe(ee=>({...ee,clearing:!1,error:(R==null?void 0:R.message)||"Unable to clear receipt."}))}}}async function jj(d){if(await s({title:"Delete Attachment",message:"Delete the uploaded receipt image?",confirmText:"Delete",confirmVariant:"danger"}))try{await z(`/api/saas-admin/products/${t}/pending-transfers/${d}/receipt-clear`,{method:"POST"}),await $i()}catch(R){ye(ee=>({...ee,error:(R==null?void 0:R.message)||"Unable to clear attachment."}))}}async function bj(){if(!(!Ve.transferId||!await s({title:"Clear Receipt",message:"Delete the uploaded receipt image?",confirmText:"Delete",confirmVariant:"danger"}))){ze(g=>({...g,clearing:!0}));try{await z(`/api/saas-admin/products/${t}/pending-transfers/${Ve.transferId}/receipt-clear`,{method:"POST"}),await Mi(),await $i(),ze({open:!1,url:"",transferId:null,clearing:!1})}catch(g){ze(R=>({...R,clearing:!1})),I(R=>({...R,error:(g==null?void 0:g.message)||"Unable to clear receipt."}))}}}async function yj(d){var g,R;Pt({open:!0,loading:!0,data:null,error:"",form:{}});try{const ee=await z(`/api/saas-admin/organizations/${d}`),ke=ee.owner||{},Ke=ee.subscription||{},_t={name:((g=ee.organization)==null?void 0:g.name)||"",company_key:((R=ee.organization)==null?void 0:R.company_key)||"",owner_username:ke.username||"",owner_first_name:ke.first_name||"",owner_last_name:ke.last_name||"",owner_email:ke.email||"",plan_id:Ke.plan_id||"",billing_cycle:Ke.billing_cycle||"monthly",status:Ke.status||"active",end_date:Ke.end_date||"",addon_count:Ke.addon_count??0};Pt({open:!0,loading:!1,data:ee,error:"",form:_t})}catch(ee){Pt({open:!0,loading:!1,data:null,error:(ee==null?void 0:ee.message)||"Unable to load organization.",form:{}})}}async function vj(d){if(await s({title:"Delete Organization",message:`Delete ${d.name}? This removes the organization and owner user.`,confirmText:"Delete",confirmVariant:"danger"}))try{await z(`/api/saas-admin/organizations/${d.id}`,{method:"DELETE"}),await Gd()}catch(R){c(ee=>({...ee,error:(R==null?void 0:R.message)||"Unable to delete organization."}))}}async function Nj(){var d,g;if((g=(d=ot.data)==null?void 0:d.organization)!=null&&g.id){Pt(R=>({...R,loading:!0,error:""}));try{const R={name:ot.form.name,company_key:ot.form.company_key,owner_username:ot.form.owner_username,owner_first_name:ot.form.owner_first_name,owner_last_name:ot.form.owner_last_name,owner_email:ot.form.owner_email,plan_id:ot.form.plan_id||null,billing_cycle:ot.form.billing_cycle,status:ot.form.status,end_date:ot.form.end_date,addon_count:ot.form.addon_count};await z(`/api/saas-admin/organizations/${ot.data.organization.id}`,{method:"PUT",body:JSON.stringify(R)}),await Gd(),Pt({open:!1,loading:!1,data:null,error:"",form:{}})}catch(R){Pt(ee=>({...ee,loading:!1,error:(R==null?void 0:R.message)||"Unable to update organization."}))}}}async function _j(d){qn({open:!0,loading:!0,data:null,error:""});try{const g=await z(`/api/saas-admin/products/${t}/users/${d}`);qn({open:!0,loading:!1,data:g,error:""})}catch(g){qn({open:!0,loading:!1,data:null,error:(g==null?void 0:g.message)||"Unable to load user."})}}async function Sj(d){va({open:!0,loading:!0,data:null,error:"",form:{}});try{const g=await z(`/api/saas-admin/products/${t}/users/${d}`),R=g.user||{},ee={name:R.name||"",email:R.email||"",pc_name:R.pc_name||"",device_id:R.device_id||""};va({open:!0,loading:!1,data:g,error:"",form:ee})}catch(g){va({open:!0,loading:!1,data:null,error:(g==null?void 0:g.message)||"Unable to load user.",form:{}})}}async function wj(){var d,g;if((g=(d=qt.data)==null?void 0:d.user)!=null&&g.id){va(R=>({...R,loading:!0,error:""}));try{await z(`/api/saas-admin/products/${t}/users/${qt.data.user.id}`,{method:"PUT",body:JSON.stringify({name:qt.form.name,email:qt.form.email,pc_name:qt.form.pc_name,device_id:qt.form.device_id})}),await Hd(),va({open:!1,loading:!1,data:null,error:"",form:{}})}catch(R){va(ee=>({...ee,loading:!1,error:(R==null?void 0:R.message)||"Unable to update user."}))}}}async function Cj(d){if(await s({title:"Delete User",message:`Delete ${d.name}?`,confirmText:"Delete",confirmVariant:"danger"}))try{await z(`/api/saas-admin/products/${t}/users/${d.id}`,{method:"DELETE"}),await Hd()}catch(R){h(ee=>({...ee,error:(R==null?void 0:R.message)||"Unable to delete user."}))}}function ju(d,g=null){const R=(g==null?void 0:g.limits)||{},ee=(g==null?void 0:g.features)||{},ke=Qa?g?{name:g.name||"",monthly_price_inr:g.monthly_price_inr??g.monthly_price??"",yearly_price_inr:g.yearly_price_inr??g.yearly_price??"",monthly_price_usd:g.monthly_price_usd??g.usd_monthly_price??"",yearly_price_usd:g.yearly_price_usd??g.usd_yearly_price??"",max_users:g.max_users??"",device_limit_per_user:g.device_limit_per_user??"",storage_limit_gb:g.storage_limit_gb??"",bandwidth_limit_gb_monthly:g.bandwidth_limit_gb_monthly??"",is_bandwidth_limited:g.is_bandwidth_limited!==!1,is_active:g.is_active!==!1}:{name:"",monthly_price_inr:"",yearly_price_inr:"",monthly_price_usd:"",yearly_price_usd:"",max_users:"",device_limit_per_user:"",storage_limit_gb:"",bandwidth_limit_gb_monthly:"",is_bandwidth_limited:!0,is_active:!0}:g?{plan_template:"Custom",name:g.name||"",monthly_price:g.monthly_price??"",yearly_price:g.yearly_price??"",usd_monthly_price:g.usd_monthly_price??"",usd_yearly_price:g.usd_yearly_price??"",addon_monthly_price:g.addon_monthly_price??"",addon_yearly_price:g.addon_yearly_price??"",addon_usd_monthly_price:g.addon_usd_monthly_price??"",addon_usd_yearly_price:g.addon_usd_yearly_price??"",employee_limit:g.employee_limit??0,retention_days:g.retention_days??30,screenshot_min_minutes:g.screenshot_min_minutes??5,ai_library_limit_mb:g.ai_library_limit_mb??"",website_page_limit:g.website_page_limit??"",allow_addons:!!g.allow_addons,allow_app_usage:!!g.allow_app_usage,allow_hr_view:!!g.allow_hr_view,widgets:R.widgets??"",included_agents:R.included_agents??"",conversations_per_month:R.conversations_per_month??"",chat_history_days:R.chat_history_days??"",max_messages_per_conversation:R.max_messages_per_conversation??"",max_chars_per_message:R.max_chars_per_message??"",remove_branding:!!ee.remove_branding,analytics_basic:!!ee.analytics_basic,csv_export:!!ee.csv_export,agent_inbox:!!ee.agent_inbox,ai_enabled:!!(ee.ai_enabled??!0),ai_replies_per_month:R.ai_replies_per_month??"",ai_max_messages_per_conversation:R.ai_max_messages_per_conversation??"",ai_max_chars_per_message:R.ai_max_chars_per_message??""}:{plan_template:"Custom",name:"",monthly_price:"",yearly_price:"",usd_monthly_price:"",usd_yearly_price:"",addon_monthly_price:"",addon_yearly_price:"",addon_usd_monthly_price:"",addon_usd_yearly_price:"",employee_limit:0,retention_days:30,screenshot_min_minutes:5,ai_library_limit_mb:"",website_page_limit:"",allow_addons:!0,allow_app_usage:!1,allow_hr_view:!1,widgets:"",included_agents:"",conversations_per_month:"",chat_history_days:"",max_messages_per_conversation:"",max_chars_per_message:"",remove_branding:!1,analytics_basic:!1,csv_export:!1,agent_inbox:!0,ai_enabled:!0,ai_replies_per_month:"",ai_max_messages_per_conversation:"",ai_max_chars_per_message:""};Q({open:!0,mode:d,form:ke,error:"",fieldErrors:{},loading:!1,planId:(g==null?void 0:g.id)||null})}function kj(d){return!d||d==="Custom"?null:{"Free Trial":{widgets:1,included_agents:1,conversations_per_month:200,chat_history_days:7,max_messages_per_conversation:15,max_chars_per_message:700,ai_enabled:!0,ai_replies_per_month:50,allow_addons:!1,remove_branding:!1,analytics_basic:!1,csv_export:!1,agent_inbox:!0},Starter:{widgets:1,included_agents:1,conversations_per_month:1e3,chat_history_days:30,max_messages_per_conversation:20,max_chars_per_message:900,ai_enabled:!0,ai_replies_per_month:1e3,allow_addons:!0,remove_branding:!1,analytics_basic:!0,csv_export:!1,agent_inbox:!0},Growth:{widgets:3,included_agents:3,conversations_per_month:1e4,chat_history_days:90,max_messages_per_conversation:30,max_chars_per_message:1200,ai_enabled:!0,ai_replies_per_month:1e4,allow_addons:!0,remove_branding:!0,analytics_basic:!0,csv_export:!1,agent_inbox:!0},Pro:{widgets:10,included_agents:10,conversations_per_month:5e4,chat_history_days:180,max_messages_per_conversation:40,max_chars_per_message:1500,ai_enabled:!0,ai_replies_per_month:5e4,allow_addons:!0,remove_branding:!0,analytics_basic:!0,csv_export:!0,agent_inbox:!0}}[d]||null}async function Pj(){Q(d=>({...d,loading:!0,error:"",fieldErrors:{}}));try{if(Qa){const it=(w.form.name||"").trim(),Ot=["name","monthly_price_inr","yearly_price_inr","monthly_price_usd","yearly_price_usd","storage_limit_gb","bandwidth_limit_gb_monthly","device_limit_per_user"],Be={},Ge=Na=>Na===""||Na===null||Na===void 0;if(Ot.forEach(Na=>{const Bj=Na==="name"?it:w.form[Na];Ge(Bj)&&(Be[Na]=["This field is required."])}),Object.keys(Be).length){Q(Na=>({...Na,loading:!1,fieldErrors:Be,error:"Please fix the highlighted fields."}));return}const er={id:w.mode==="edit"?w.planId:void 0,name:it,monthly_price_inr:w.form.monthly_price_inr,yearly_price_inr:w.form.yearly_price_inr,monthly_price_usd:w.form.monthly_price_usd,yearly_price_usd:w.form.yearly_price_usd,max_users:w.form.max_users===""?null:w.form.max_users,device_limit_per_user:w.form.device_limit_per_user===""?null:w.form.device_limit_per_user,storage_limit_gb:w.form.storage_limit_gb,bandwidth_limit_gb_monthly:w.form.bandwidth_limit_gb_monthly,is_bandwidth_limited:w.form.is_bandwidth_limited!==!1,is_active:w.form.is_active!==!1};await z("/api/saas-admin/storage/plan",{method:"POST",body:JSON.stringify(er)}),await Ri(),Q({open:!1,mode:"create",form:{},error:"",fieldErrors:{},loading:!1,planId:null});return}const d=(w.form.name||"").trim(),g=Wt?["name","widgets","included_agents","conversations_per_month","chat_history_days","max_messages_per_conversation","max_chars_per_message","ai_replies_per_month","monthly_price","yearly_price","usd_monthly_price","usd_yearly_price","addon_monthly_price","addon_yearly_price","addon_usd_monthly_price","addon_usd_yearly_price"]:["name","employee_limit","retention_days","screenshot_min_minutes","monthly_price","yearly_price","usd_monthly_price","usd_yearly_price","addon_monthly_price","addon_yearly_price","addon_usd_monthly_price","addon_usd_yearly_price"],R={},ee=it=>it===""||it===null||it===void 0;if(g.forEach(it=>{const Ot=it==="name"?d:w.form[it];ee(Ot)&&(R[it]=["This field is required."])}),Object.keys(R).length){Q(it=>({...it,loading:!1,fieldErrors:R,error:"Please fix the highlighted fields."}));return}const ke={widgets:w.form.widgets?Number(w.form.widgets):void 0,included_agents:w.form.included_agents?Number(w.form.included_agents):void 0,conversations_per_month:w.form.conversations_per_month?Number(w.form.conversations_per_month):void 0,chat_history_days:w.form.chat_history_days?Number(w.form.chat_history_days):void 0,max_messages_per_conversation:w.form.max_messages_per_conversation?Number(w.form.max_messages_per_conversation):void 0,max_chars_per_message:w.form.max_chars_per_message?Number(w.form.max_chars_per_message):void 0,ai_replies_per_month:w.form.ai_replies_per_month?Number(w.form.ai_replies_per_month):void 0,ai_max_messages_per_conversation:w.form.ai_max_messages_per_conversation?Number(w.form.ai_max_messages_per_conversation):void 0,ai_max_chars_per_message:w.form.ai_max_chars_per_message?Number(w.form.ai_max_chars_per_message):void 0};Object.keys(ke).forEach(it=>{(ke[it]===void 0||Number.isNaN(ke[it]))&&delete ke[it]});const Ke={remove_branding:!!w.form.remove_branding,analytics_basic:!!w.form.analytics_basic,csv_export:!!w.form.csv_export,agent_inbox:!!w.form.agent_inbox,ai_enabled:!!w.form.ai_enabled},_t={name:d,product_slug:t,monthly_price:w.form.monthly_price,yearly_price:w.form.yearly_price,usd_monthly_price:w.form.usd_monthly_price,usd_yearly_price:w.form.usd_yearly_price,addon_monthly_price:w.form.addon_monthly_price,addon_yearly_price:w.form.addon_yearly_price,addon_usd_monthly_price:w.form.addon_usd_monthly_price,addon_usd_yearly_price:w.form.addon_usd_yearly_price,employee_limit:w.form.employee_limit,retention_days:w.form.retention_days,screenshot_min_minutes:w.form.screenshot_min_minutes,ai_library_limit_mb:w.form.ai_library_limit_mb,website_page_limit:w.form.website_page_limit,allow_addons:!!w.form.allow_addons,allow_app_usage:!!w.form.allow_app_usage,allow_hr_view:!!w.form.allow_hr_view,limits:ke,features:Ke};["monthly_price","yearly_price","usd_monthly_price","usd_yearly_price","addon_monthly_price","addon_yearly_price","addon_usd_monthly_price","addon_usd_yearly_price","employee_limit","retention_days","screenshot_min_minutes","ai_library_limit_mb","website_page_limit"].forEach(it=>{_t[it]===""&&delete _t[it]}),w.mode==="edit"?await z(`/api/saas-admin/plans/${w.planId}`,{method:"PUT",body:JSON.stringify(_t)}):await z("/api/saas-admin/plans",{method:"POST",body:JSON.stringify(_t)}),await Ri(),Q({open:!1,mode:"create",form:{},error:"",fieldErrors:{},loading:!1,planId:null})}catch(d){const g=d==null?void 0:d.data;console.error("Plan save failed",d),console.error("Plan save response",g);const R=g&&typeof g=="object"&&!Array.isArray(g)&&!g.error&&!g.detail?g:null;Q(ee=>({...ee,loading:!1,fieldErrors:R||{},error:(g==null?void 0:g.detail)||(R?"Please fix the highlighted fields.":(d==null?void 0:d.message)||"Unable to save plan.")}))}}async function Tj(d){if(await s({title:"Delete Plan",message:`Delete ${d.name}?`,confirmText:"Delete",confirmVariant:"danger"}))try{await z(`/api/saas-admin/plans/${d.id}`,{method:"DELETE"}),await Ri()}catch(R){U(ee=>({...ee,error:(R==null?void 0:R.message)||"Unable to delete plan."}))}}async function bu(d,g){const R=g==="approve"?"Approve":"Reject";if(await s({title:`${R} Transfer`,message:`Are you sure you want to ${R.toLowerCase()} this transfer?`,confirmText:R,confirmVariant:g==="approve"?"primary":"danger"}))try{await z(`/api/saas-admin/products/${t}/pending-transfers/${d}/${g}`,{method:"POST"}),await Mi(),await $i()}catch(ke){I(Ke=>({...Ke,error:(ke==null?void 0:ke.message)||"Unable to update transfer."}))}}function yu(d,g){Di({open:!0,title:g,details:(d==null?void 0:d.bank_details)||{}})}function Ej(d){Li({open:!0,row:d})}function vu(d,g){xs({open:!0,row:d,type:g,note:(d==null?void 0:d.payout_reference)||"",error:"",saving:!1})}async function Nu(d){if(!ua.row)return;const g=ua.note.trim();if(!g){xs(R=>({...R,error:"Please enter details before proceeding."}));return}xs(R=>({...R,saving:!0,error:""}));try{const R={status:d,payout_reference:g,payout_date:d==="paid"?new Date().toISOString().slice(0,10):""},ee=ua.type==="dealer"?`/api/saas-admin/referrals/dealer-earnings/${ua.row.id}`:`/api/saas-admin/referrals/earnings/${ua.row.id}`;await z(ee,{method:"POST",body:JSON.stringify(R)}),await Qd(),xs({open:!1,row:null,type:"org",note:"",error:"",saving:!1})}catch(R){xs(ee=>({...ee,saving:!1,error:(R==null?void 0:R.message)||"Unable to update payout."}))}}async function Jl(d,g){if(await s({title:"Reset Payout",message:"Reset this payout back to pending?",confirmText:"Reset",confirmVariant:"warning"}))try{const ee=g==="dealer"?`/api/saas-admin/referrals/dealer-earnings/${d.id}`:`/api/saas-admin/referrals/earnings/${d.id}`;await z(ee,{method:"POST",body:JSON.stringify({status:"pending",payout_reference:"",payout_date:""})}),await Qd()}catch(ee){Se(ke=>({...ke,error:(ee==null?void 0:ee.message)||"Unable to reset payout."}))}}function Zl(d,g,R){Ba(ee=>({...ee,[d]:{...ee[d],[g]:{...ee[d][g],...R}}}))}function Aj(d,g){if(!g)return d;const R=g.toLowerCase();return d.filter(ee=>[ee.referrer_org,ee.referred_org,ee.referrer_dealer,ee.referred_dealer,ee.base_amount,ee.commission_rate,ee.commission_amount,ee.flat_amount,ee.status,ee.payout_reference,ee.created_at].some(ke=>String(ke||"").toLowerCase().includes(R)))}function hn(d,g,R,ee){const Ke=(ee||Aj)(d,g),_t=Math.max(Math.ceil(Ke.length/rt),1),it=Math.min(R,_t),Ot=(it-1)*rt,Be=Ke.slice(Ot,Ot+rt);return{filtered:Ke,paged:Be,totalPages:_t,currentPage:it,startIndex:Ot}}function Xl(d,g,R){C(ee=>({...ee,[d]:{...ee[d],[g]:{...ee[d][g],...R}}}))}function Dj(d,g){if(!g)return d;const R=g.toLowerCase();return d.filter(ee=>{var ke,Ke;return[ee.name,ee.company_key,ee.owner_name,ee.owner_email,(ke=ee.subscription)==null?void 0:ke.plan_name,(Ke=ee.subscription)==null?void 0:Ke.end_date].some(_t=>String(_t||"").toLowerCase().includes(R))})}function Lj(d,g){if(!g)return d;const R=g.toLowerCase();return d.filter(ee=>[ee.name,ee.username,ee.email,ee.referral_code,ee.referred_by,ee.subscription_status,ee.subscription_start,ee.subscription_end,ee.subscription_amount].some(ke=>String(ke||"").toLowerCase().includes(R)))}function Rj(d,g){if(!g)return d;const R=g.toLowerCase();return d.filter(ee=>[ee.organization_name,ee.owner_username,ee.owner_email,ee.deleted_at,ee.reason].some(ke=>String(ke||"").toLowerCase().includes(R)))}function Mj(d,g){if(!g)return d;const R=g.toLowerCase();return d.filter(ee=>[ee.name,ee.username,ee.email,ee.deleted_at,ee.reason].some(ke=>String(ke||"").toLowerCase().includes(R)))}function $j(d){const g=d.subscription||null;return g?g.status==="expired"?"expired":g.status==="active"?g.end_date&&new Date(`${g.end_date}T23:59:59`)<new Date?"expired":"active":"inactive":"inactive"}function Uj(d){const g={active:[],inactive:[],expired:[]};return d.forEach(R=>{const ee=$j(R);ee==="active"?g.active.push(R):ee==="expired"?g.expired.push(R):g.inactive.push(R)}),g}function Oj(d){const g={active:[],inactive:[],expired:[]};return d.forEach(R=>{const ee=String(R.subscription_status||"").toLowerCase();ee==="active"?g.active.push(R):ee==="expired"?g.expired.push(R):g.inactive.push(R)}),g}function Ij(d){const g={pending:[],paid:[],rejected:[]};return d.forEach(R=>{const ee=String(R.status||"pending").toLowerCase();ee==="paid"?g.paid.push(R):ee==="rejected"?g.rejected.push(R):g.pending.push(R)}),g}function eo(d,g,R){const ee=Ut[Le][R],{filtered:ke,paged:Ke,totalPages:_t,currentPage:it,startIndex:Ot}=hn(d,ee.term,ee.page);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:g}),e.jsxs("label",{className:"table-search",htmlFor:`referrals-${Le}-${R}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`referrals-${Le}-${R}-search`,type:"text",value:ee.term,onChange:Be=>Zl(Le,R,{term:Be.target.value,page:1}),placeholder:"Search"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Referrer Org"}),e.jsx("th",{children:"Referred Org"}),e.jsx("th",{children:"Base"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Bank Details"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:Ke.length?Ke.map(Be=>e.jsxs("tr",{children:[e.jsx("td",{children:Be.referrer_org||"-"}),e.jsx("td",{children:Be.referred_org||"-"}),e.jsx("td",{children:Be.base_amount??"-"}),e.jsxs("td",{children:[Be.commission_rate??0,"%"]}),e.jsx("td",{children:Be.commission_amount??"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",onClick:()=>yu(Be,Be.referrer_org||"ORG Account"),children:"View Account"})}),e.jsx("td",{children:Be.status==="paid"?e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"badge bg-success",children:"Paid"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Jl(Be,"org"),children:"Reset"})]}):Be.status==="rejected"?e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"badge bg-danger",children:"Rejected"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Jl(Be,"org"),children:"Reset"})]}):e.jsx("button",{type:"button",className:"btn btn-outline-warning btn-sm",onClick:()=>vu(Be,"org"),children:"Pending"})})]},Be.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No referrals found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",ke.length?Ot+1:0," to ",Math.min(Ot+rt,ke.length)," of"," ",ke.length," entries"]}),e.jsx(He,{page:it,totalPages:_t,onPageChange:Be=>Zl(Le,R,{page:Be}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function to(d,g,R){const ee=Ut[Le][R],{filtered:ke,paged:Ke,totalPages:_t,currentPage:it,startIndex:Ot}=hn(d,ee.term,ee.page);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:g}),e.jsxs("label",{className:"table-search",htmlFor:`referrals-${Le}-${R}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`referrals-${Le}-${R}-search`,type:"text",value:ee.term,onChange:Be=>Zl(Le,R,{term:Be.target.value,page:1}),placeholder:"Search"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Referrer Dealer"}),e.jsx("th",{children:"Referred Org"}),e.jsx("th",{children:"Referred Dealer"}),e.jsx("th",{children:"Base"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Flat"}),e.jsx("th",{children:"Bank Details"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:Ke.length?Ke.map(Be=>e.jsxs("tr",{children:[e.jsx("td",{children:Be.referrer_dealer||"-"}),e.jsx("td",{children:Be.referred_org||"-"}),e.jsx("td",{children:Be.referred_dealer||"-"}),e.jsx("td",{children:Be.base_amount??"-"}),e.jsxs("td",{children:[Be.commission_rate??0,"%"]}),e.jsx("td",{children:Be.commission_amount??"-"}),e.jsx("td",{children:Be.flat_amount??"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",onClick:()=>yu(Be,Be.referrer_dealer||"Dealer Account"),children:"View Account"})}),e.jsx("td",{children:Be.status==="paid"?e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"badge bg-success",children:"Paid"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Jl(Be,"dealer"),children:"Reset"})]}):Be.status==="rejected"?e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"badge bg-danger",children:"Rejected"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Jl(Be,"dealer"),children:"Reset"})]}):e.jsx("button",{type:"button",className:"btn btn-outline-warning btn-sm",onClick:()=>vu(Be,"dealer"),children:"Pending"})})]},Be.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",children:"No referrals found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",ke.length?Ot+1:0," to ",Math.min(Ot+rt,ke.length)," of"," ",ke.length," entries"]}),e.jsx(He,{page:it,totalPages:_t,onPageChange:Be=>Zl(Le,R,{page:Be}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function Fj(d,g){const R=d==="deleted"?zg:Wg[d]||[],ee=_.org[d],ke=d==="deleted"?Rj:Dj,{filtered:Ke,paged:_t,totalPages:it,currentPage:Ot,startIndex:Be}=hn(R,ee.term,ee.page,ke);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:g}),e.jsxs("label",{className:"table-search",htmlFor:`org-${d}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`org-${d}-search`,type:"text",value:ee.term,onChange:Ge=>Xl("org",d,{term:Ge.target.value,page:1}),placeholder:"Search organizations"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:d==="deleted"?e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Owner Username"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Deleted At"}),e.jsx("th",{children:"Reason"})]}):e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Admin User Name"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Expire Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:_t.length?_t.map(Ge=>{var er,Na;return d==="deleted"?e.jsxs("tr",{children:[e.jsx("td",{children:Ge.organization_name||"-"}),e.jsx("td",{children:Ge.owner_username||"-"}),e.jsx("td",{children:Ge.owner_email||"-"}),e.jsx("td",{children:Ge.deleted_at||"-"}),e.jsx("td",{children:Ge.reason||"-"})]},`${Ge.organization_name}-${Ge.deleted_at}`):e.jsxs("tr",{children:[e.jsx("td",{children:Ge.name}),e.jsx("td",{children:we(Ge.owner_name)}),e.jsx("td",{children:we(Ge.owner_email)}),e.jsx("td",{children:((er=Ge.subscription)==null?void 0:er.plan_name)||"-"}),e.jsx("td",{children:((Na=Ge.subscription)==null?void 0:Na.end_date)||"-"}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>pj(Ge.id),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>yj(Ge.id),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>vj(Ge),children:"Delete"})]})]},Ge.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:d==="deleted"?5:6,children:d==="deleted"?"No deleted organizations found.":"No organizations found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Ke.length?Be+1:0," to ",Math.min(Be+rt,Ke.length)," of"," ",Ke.length," entries"]}),e.jsx(He,{page:Ot,totalPages:it,onPageChange:Ge=>Xl("org",d,{page:Ge}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function zj(d,g){const R=d==="deleted"?Bg:Vg[d]||[],ee=_.dealer[d],ke=d==="deleted"?Mj:Lj,{filtered:Ke,paged:_t,totalPages:it,currentPage:Ot,startIndex:Be}=hn(R,ee.term,ee.page,ke);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:g}),e.jsxs("label",{className:"table-search",htmlFor:`dealer-${d}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`dealer-${d}-search`,type:"text",value:ee.term,onChange:Ge=>Xl("dealer",d,{term:Ge.target.value,page:1}),placeholder:"Search dealers"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:d==="deleted"?e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Deleted At"}),e.jsx("th",{children:"Reason"})]}):e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Referral Code"}),e.jsx("th",{children:"Referred By"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:_t.length?_t.map(Ge=>d==="deleted"?e.jsxs("tr",{children:[e.jsx("td",{children:Ge.name||Ge.username||"-"}),e.jsx("td",{children:Ge.email||"-"}),e.jsx("td",{children:Ge.deleted_at||"-"}),e.jsx("td",{children:Ge.reason||"-"})]},`${Ge.email}-${Ge.deleted_at}`):e.jsxs("tr",{children:[e.jsx("td",{children:Ge.name||Ge.username||"-"}),e.jsx("td",{children:Ge.email||"-"}),e.jsx("td",{children:Ge.referral_code||"-"}),e.jsx("td",{children:Ge.referred_by||"-"}),e.jsx("td",{children:Ge.subscription_start||"-"}),e.jsx("td",{children:Ge.subscription_end||"-"}),e.jsx("td",{children:Ge.subscription_amount??"-"}),e.jsx("td",{children:ma(Ge.subscription_status)})]},Ge.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:d==="deleted"?4:8,children:d==="deleted"?"No deleted dealers found.":"No dealers found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Ke.length?Be+1:0," to ",Math.min(Be+rt,Ke.length)," of"," ",Ke.length," entries"]}),e.jsx(He,{page:Ot,totalPages:it,onPageChange:Ge=>Xl("dealer",d,{page:Ge}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}if(n.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading product dashboard..."})]});if(n.error)return e.jsx("div",{className:"alert alert-danger",children:n.error});let ao=[{key:"organizations",label:"Organizations",icon:"bi-building"},{key:"users",label:"Users",icon:"bi-people"},{key:"plans",label:"Plans",icon:"bi-clipboard-check"},{key:"pending-transfers",label:"Pending Transfers",icon:"bi-hourglass-split"},{key:"renewals",label:"Renewals",icon:"bi-arrow-repeat"},{key:"billing",label:"Billing",icon:"bi-receipt"},{key:"referrals",label:"Referrals",icon:"bi-people-fill"},{key:"support-access",label:"Support Access",icon:"bi-shield-lock"},{key:"observability",label:"Observability",icon:"bi-bar-chart"}];Wt&&(ao.splice(6,0,{key:"ai-usage",label:"AI Usage & Spend",icon:"bi-cpu"}),ao.splice(7,0,{key:"openai-settings",label:"API Settings",icon:"bi-key"}));const so={active:"Active ORG",inactive:"Inactive ORG",expired:"Expired ORG",deleted:"Deleted ORG"},no={active:"Active Dealers",inactive:"Inactive Dealers",expired:"Expired Dealers",deleted:"Deleted Dealers"};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:Bs.name||"Product Dashboard"}),e.jsx("div",{className:"text-secondary",children:fj(Bs.description,Bs.slug||t)})]}),e.jsx(et,{to:"/saas-admin",className:"btn btn-outline-light btn-sm",children:"Back to SaaS Admin"})]}),e.jsx("hr",{className:"section-divider"}),e.jsx("div",{className:"row g-3",children:hj.map(d=>e.jsx("div",{className:"col-12 col-md-6 col-lg-4 col-xl-2",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:`bi ${d.icon}`,"aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:d.label}),e.jsx("div",{className:"stat-value",children:d.value})]})},d.label))}),e.jsxs("div",{className:"product-admin-layout mt-4",children:[e.jsx("aside",{className:"product-admin-sidebar",children:e.jsx("div",{className:"card p-3",children:e.jsx("div",{className:"product-admin-nav",children:ao.map(d=>e.jsxs(et,{to:`/saas-admin/products/${t}#${d.key}`,className:`product-admin-link ${r===d.key?"active":""}`,children:[e.jsx("i",{className:`bi ${d.icon}`,"aria-hidden":"true"}),e.jsx("span",{children:d.label})]},d.key))})})}),e.jsxs("section",{className:"product-admin-content",children:[r==="organizations"?e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Organizations"})}),u.error?e.jsx("div",{className:"alert alert-danger mt-2",children:u.error}):null,e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${m==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>x("org"),children:"ORG"}),e.jsx("button",{type:"button",className:`btn btn-sm ${m==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>x("dealer"),children:"Dealers"})]}),m==="org"?e.jsx("div",{className:"d-flex gap-2 flex-wrap mt-2",children:Object.keys(so).map(d=>e.jsx("button",{type:"button",className:`btn btn-sm ${f===d?"btn-primary":"btn-outline-light"}`,onClick:()=>j(d),children:so[d]},d))}):e.jsx("div",{className:"d-flex gap-2 flex-wrap mt-2",children:Object.keys(no).map(d=>e.jsx("button",{type:"button",className:`btn btn-sm ${N===d?"btn-primary":"btn-outline-light"}`,onClick:()=>v(d),children:no[d]},d))}),m==="org"?Fj(f,so[f]):zj(N,no[N])]}):null,r==="users"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Users"}),e.jsxs("label",{className:"table-search",htmlFor:"product-user-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"product-user-search",type:"text",value:p,onChange:d=>b(d.target.value),placeholder:"Search users"})]})]}),y.error?e.jsx("div",{className:"alert alert-danger mt-2",children:y.error}):null,e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Device ID"}),e.jsx("th",{children:"PC Name"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:Ql.length?Ql.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.name}),e.jsx("td",{children:we(d.email)}),e.jsx("td",{children:we(d.org_name)}),e.jsx("td",{children:we(d.device_id)}),e.jsx("td",{children:we(d.pc_name)}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>_j(d.id),children:"View"}),Qa?null:e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>Sj(d.id),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>Cj(d),children:"Delete"})]})]})]},d.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No users found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Ql.length?(E-1)*rt+1:0," to ",Ql.length?Math.min(E*rt,Yn.length):0," of ",Yn.length," entries"]}),e.jsx(He,{page:E,totalPages:Gg,onPageChange:L,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):null,r==="plans"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Plans"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>ju("create"),children:"Create Plan"})]}),V.error?e.jsx("div",{className:"alert alert-danger mt-2",children:V.error}):null,e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Monthly"}),Qa?e.jsxs(e.Fragment,{children:[e.jsx("th",{children:"Max Users"}),e.jsx("th",{children:"Device/User"}),e.jsx("th",{children:"Storage (GB)"}),e.jsx("th",{children:"Status"})]}):e.jsx("th",{children:"Yearly"}),Qa?null:Wt?e.jsxs(e.Fragment,{children:[e.jsx("th",{children:"Widgets"}),e.jsx("th",{children:"Agents"}),e.jsx("th",{children:"Conversations/mo"}),e.jsx("th",{children:"Chat history (days)"}),e.jsx("th",{children:"AI replies/mo"}),e.jsx("th",{children:"Add-ons"})]}):e.jsxs(e.Fragment,{children:[e.jsx("th",{children:"Employees"}),e.jsx("th",{children:"Add-ons"}),e.jsx("th",{children:"App Usage"})]}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:Kd.length?Kd.map(d=>{var g,R,ee,ke,Ke;return e.jsxs("tr",{children:[e.jsx("td",{children:d.name}),e.jsx("td",{children:we(d.monthly_price_inr??d.monthly_price)}),Qa?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:we(d.max_users??"-")}),e.jsx("td",{children:we(d.device_limit_per_user??"-")}),e.jsx("td",{children:we(d.storage_limit_gb??"-")}),e.jsx("td",{children:d.is_active===!1?"Inactive":"Active"})]}):e.jsx("td",{children:we(d.yearly_price)}),Qa?null:Wt?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:((g=d.limits)==null?void 0:g.widgets)??"-"}),e.jsx("td",{children:((R=d.limits)==null?void 0:R.included_agents)??"-"}),e.jsx("td",{children:((ee=d.limits)==null?void 0:ee.conversations_per_month)??"-"}),e.jsx("td",{children:((ke=d.limits)==null?void 0:ke.chat_history_days)??"-"}),e.jsx("td",{children:((Ke=d.limits)==null?void 0:Ke.ai_replies_per_month)??"-"}),e.jsx("td",{children:d.allow_addons?"Enabled":"Disabled"})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{children:d.employee_limit===0?"Unlimited":d.employee_limit}),e.jsx("td",{children:d.allow_addons?"Enabled":"Disabled"}),e.jsx("td",{children:d.allow_app_usage?"Enabled":"Disabled"})]}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>ju("edit",d),children:"Edit"}),Qa?null:e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>Tj(d),children:"Delete"})]})]},d.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:Qa?7:Wt?10:7,children:"No plans found."})})})]})})]}):null,r==="observability"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Observability"}),e.jsx(et,{to:"/saas-admin/observability",className:"btn btn-outline-light btn-sm",children:"Open Full View"})]}),e.jsx("div",{className:"mt-3",children:e.jsx(Rg,{initialProduct:Bs.slug||t,showTitle:!1})})]}):null,r==="ai-usage"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-0",children:"AI Usage & Spend"}),mu?e.jsxs("div",{className:"text-secondary small",children:["Period: ",mu]}):null]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:$g,children:"Refresh"})]}),e.jsxs("div",{className:"d-flex gap-3 flex-wrap align-items-center mt-2",children:[e.jsxs("label",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"Days"}),e.jsxs("select",{className:"form-select form-select-sm",value:ea,onChange:d=>ya(Number(d.target.value)),children:[e.jsx("option",{value:7,children:"7 days"}),e.jsx("option",{value:14,children:"14 days"}),e.jsx("option",{value:30,children:"30 days"})]})]}),e.jsxs("label",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"Year"}),e.jsx("select",{className:"form-select form-select-sm",value:ca,onChange:d=>Ga(Number(d.target.value)),children:dj.map(d=>e.jsx("option",{value:d,children:d},d))})]}),e.jsxs("label",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"Month"}),e.jsx("select",{className:"form-select form-select-sm",value:da,onChange:d=>Ha(Number(d.target.value)),children:uj.map(d=>e.jsx("option",{value:d,children:d.toString().padStart(2,"0")},d))})]}),e.jsxs("label",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"Organization"}),e.jsxs("select",{className:"form-select form-select-sm",value:ta,onChange:d=>ts(d.target.value),children:[e.jsx("option",{value:"",children:"All"}),Ui.map(d=>e.jsx("option",{value:String(d.id),children:d.name},d.id))]})]})]}),Ct.loading?e.jsx("div",{className:"text-secondary mt-2",children:"Loading..."}):null,Ct.error?e.jsx("div",{className:"alert alert-danger mt-2",children:Ct.error}):null,uu.length||mn?e.jsxs("div",{className:`alert ${(mn==null?void 0:mn.level)==="danger"?"alert-danger":"alert-warning"} mt-2`,children:[mn?e.jsx("div",{children:mn.message}):null,uu.map((d,g)=>e.jsx("div",{children:d.message},`${d.level}-${g}`))]}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-robot","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"AI Replies Used"}),e.jsx("div",{className:"stat-value",children:Number(dn.ai_replies_used??0).toLocaleString()})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-speedometer2","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"AI Usage Limit"}),e.jsx("div",{className:"stat-value",children:zs?zs.toLocaleString():"-"}),zs?e.jsxs("div",{className:"text-secondary small",children:[Qi,"% used"]}):null]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-hash","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"Tokens Total"}),e.jsx("div",{className:"stat-value",children:Number(dn.tokens_total??0).toLocaleString()})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-currency-rupee","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"Estimated Cost (INR)"}),e.jsxs("div",{className:"stat-value",children:["INR ",Number(cj).toLocaleString()]})]})})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Replies"}),e.jsx("th",{children:"Tokens"}),e.jsx("th",{children:"Estimated INR"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:du.length?du.map(d=>{const g=Number(d.tokens_total??0),R=Number(d.ai_replies_used??0),ee=g>0?ll(g/un,un,Yl,Kl):null,ke=R>0?ll(R,un,Yl,Kl):null,Ke=Number(d.cost_inr_est??0)||(ee==null?void 0:ee.costInr)||(ke==null?void 0:ke.costInr)||0;return e.jsxs("tr",{children:[e.jsx("td",{children:d.org_name||"-"}),e.jsx("td",{children:R.toLocaleString()}),e.jsx("td",{children:g.toLocaleString()}),e.jsxs("td",{children:["INR ",Number(Ke).toLocaleString()]}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Ug(d),children:"View Trend"})})]},d.org_id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:"No usage data found."})})})]})})]}):null,r==="openai-settings"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"API Settings"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:qd,children:"Refresh"})]}),at.error?e.jsx("div",{className:"alert alert-danger mt-2",children:at.error}):null,!fu||!at.form.is_active?e.jsxs("div",{className:"alert alert-warning mt-2",children:[fu?null:e.jsx("div",{children:"OpenAI API key is missing."}),at.form.is_active?null:e.jsx("div",{children:"AI is currently disabled globally."})]}):null,e.jsx("div",{className:"text-secondary small mt-1",children:Ji?`API Key: ${Ji}`:"API Key: Not set"}),at.saved?e.jsxs("div",{className:"text-secondary small",children:["Last updated: ",at.saved]}):null,e.jsxs("div",{className:"modal-form-grid mt-3",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"OpenAI API Key"}),e.jsx("input",{type:"password",value:at.form.api_key,onChange:d=>Nt(g=>({...g,form:{...g.form,api_key:d.target.value}})),placeholder:"Enter new key to update"})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Default Model"}),e.jsx("input",{type:"text",value:at.form.model,onChange:d=>Nt(g=>({...g,form:{...g.form,model:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Input Cost / 1K Tokens (INR)"}),e.jsx("input",{type:"number",value:at.form.input_cost_per_1k_tokens_inr,onChange:d=>Nt(g=>({...g,form:{...g.form,input_cost_per_1k_tokens_inr:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Output Cost / 1K Tokens (INR)"}),e.jsx("input",{type:"number",value:at.form.output_cost_per_1k_tokens_inr,onChange:d=>Nt(g=>({...g,form:{...g.form,output_cost_per_1k_tokens_inr:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Markup %"}),e.jsx("input",{type:"number",value:at.form.fixed_markup_percent,onChange:d=>Nt(g=>({...g,form:{...g.form,fixed_markup_percent:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"AI Enabled"}),e.jsxs("select",{value:at.form.is_active?"yes":"no",onChange:d=>Nt(g=>({...g,form:{...g.form,is_active:d.target.value==="yes"}})),children:[e.jsx("option",{value:"yes",children:"Yes"}),e.jsx("option",{value:"no",children:"No"})]})]})]}),sa.message?e.jsx("div",{className:`alert mt-3 ${sa.ok?"alert-success":"alert-danger"}`,children:sa.message}):null,e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:Ig,disabled:sa.loading||at.loading,children:sa.loading?"Testing...":"Test Connection"}),e.jsx("button",{type:"button",className:"btn btn-success",onClick:Og,disabled:at.loading,children:at.loading?"Saving...":"Save"})]})]}):null,r==="pending-transfers"?e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Pending Transfers"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${S==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>k("org"),children:"ORG Transfers"}),e.jsx("button",{type:"button",className:`btn btn-sm ${S==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>k("dealer"),children:"Dealer Transfers"})]}),H.error?e.jsx("div",{className:"alert alert-danger mt-2",children:H.error}):null,e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",rt," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"pending-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"pending-search",type:"text",value:M,onChange:d=>A(d.target.value),placeholder:"Search transfers"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:qg}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Billing Cycle"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Receipt"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:Jd.length?Jd.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.organization}),e.jsx("td",{children:ma(d.request_type)}),e.jsx("td",{children:d.plan}),e.jsxs("td",{children:[d.currency," ",d.amount]}),e.jsx("td",{children:ma(d.billing_cycle)}),e.jsx("td",{children:d.created_at||"-"}),e.jsx("td",{children:d.receipt_url?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>ze({open:!0,url:d.receipt_url,transferId:d.id,clearing:!1}),children:"View Image"}):e.jsx("span",{className:"text-secondary",children:"Not Available"})}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm me-2",onClick:()=>xj(d.id),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-success btn-sm me-2",onClick:()=>bu(d.id,"approve"),children:"Approve"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>bu(d.id,"reject"),children:"Reject"})]})]},d.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No pending transfers."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",ln.length?(Y-1)*rt+1:0," ","to ",Math.min(Y*rt,ln.length)," of ",ln.length," entries"]}),e.jsx(He,{page:Y,totalPages:Yg,onPageChange:ue,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):null,r==="pending-transfers"?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Transfer History"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${G==="approved"?"btn-primary":"btn-outline-light"}`,onClick:()=>Ne("approved"),children:"Approved Transfers"}),e.jsx("button",{type:"button",className:`btn btn-sm ${G==="rejected"?"btn-primary":"btn-outline-light"}`,onClick:()=>Ne("rejected"),children:"Rejected Transfers"})]}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${_e==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>de("org"),children:"ORG Transfers"}),e.jsx("button",{type:"button",className:`btn btn-sm ${_e==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>de("dealer"),children:"Dealer Transfers"})]}),he.error?e.jsx("div",{className:"alert alert-danger mt-2",children:he.error}):null,e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",rt," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"history-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"history-search",type:"text",value:Re,onChange:d=>je(d.target.value),placeholder:"Search transfers"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization / Dealer"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Billing Cycle"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:G==="approved"?"Attachment":"Receipt"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:Xd.length?Xd.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.organization}),e.jsx("td",{children:ma(d.request_type)}),e.jsx("td",{children:d.plan}),e.jsxs("td",{children:[d.currency," ",d.amount]}),e.jsx("td",{children:ma(d.billing_cycle)}),e.jsx("td",{children:d.updated_at||"-"}),e.jsx("td",{children:d.receipt_url?e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>ze({open:!0,url:d.receipt_url,transferId:d.id,clearing:!1}),children:G==="approved"?"Attachment":"View Image"}),G==="approved"?e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>jj(d.id),children:"Delete"}):null]}):e.jsx("span",{className:"text-secondary",children:"Not Available"})}),e.jsx("td",{children:ma(d.status)})]},d.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No transfer history."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",rn.length?(qe-1)*rt+1:0," ","to ",Math.min(qe*rt,rn.length)," of ",rn.length," entries"]}),e.jsx(He,{page:qe,totalPages:Kg,onPageChange:Je,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):null,r==="renewals"?e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Renewals"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${ve==="upcoming"?"btn-primary":"btn-outline-light"}`,onClick:()=>{Z("upcoming"),xe("monthly"),Oe(1)},children:"Upcoming Renewals"}),e.jsx("button",{type:"button",className:`btn btn-sm ${ve==="missed"?"btn-primary":"btn-outline-light"}`,onClick:()=>{Z("missed"),xe("monthly"),Oe(1)},children:"Missed Renewals"}),e.jsx("button",{type:"button",className:`btn btn-sm ${ve==="deleted"?"btn-primary":"btn-outline-light"}`,onClick:()=>{Z("deleted"),xe("monthly"),Oe(1)},children:"Deleted Accounts"})]}),ve!=="deleted"?e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${ce==="monthly"?"btn-primary":"btn-outline-light"}`,onClick:()=>{xe("monthly"),Oe(1)},children:"Monthly"}),e.jsx("button",{type:"button",className:`btn btn-sm ${ce==="yearly"?"btn-primary":"btn-outline-light"}`,onClick:()=>{xe("yearly"),Oe(1)},children:"Yearly"})]}):null,Ye.error?e.jsx("div",{className:"alert alert-danger mt-2",children:Ye.error}):null,e.jsxs("div",{className:"table-controls mt-2",children:[e.jsxs("div",{className:"table-length",children:["Show ",rt," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"renewals-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"renewals-search",type:"text",value:Ce,onChange:d=>Fe(d.target.value),placeholder:"Search renewals"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsx("table",{className:"table table-dark table-striped table-hover align-middle",children:ve==="deleted"?e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Owner"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Deleted At"}),e.jsx("th",{children:"Reason"})]})}),e.jsx("tbody",{children:ql.length?ql.map((d,g)=>e.jsxs("tr",{children:[e.jsx("td",{children:d.organization_name||"-"}),e.jsx("td",{children:d.owner_username||"-"}),e.jsx("td",{children:d.owner_email||"-"}),e.jsx("td",{children:d.deleted_at||"-"}),e.jsx("td",{children:d.reason||"-"})]},`${d.organization_name}-${g}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No deleted accounts."})})})]}):e.jsxs(e.Fragment,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Owner"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Billing Cycle"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:ve==="missed"?"Days Overdue":"Days Remaining"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:ql.length?ql.map((d,g)=>e.jsxs("tr",{children:[e.jsx("td",{children:d.organization||"-"}),e.jsx("td",{children:d.owner_name||"-"}),e.jsx("td",{children:d.owner_email||"-"}),e.jsx("td",{children:d.plan||"-"}),e.jsx("td",{children:ma(d.billing_cycle)}),e.jsx("td",{children:d.end_date||"-"}),e.jsx("td",{children:ve==="missed"?d.days_overdue??"-":d.days_remaining??"-"}),e.jsx("td",{children:ma(d.status)})]},`${d.organization}-${g}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No renewals found."})})})]})})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",on.length?(Ie-1)*rt+1:0," ","to ",Math.min(Ie*rt,on.length)," of ",on.length," entries"]}),e.jsx(He,{page:Ie,totalPages:ej,onPageChange:Oe,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):null,r==="billing"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Billing"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Mg,children:"Refresh"})]}),Me.error?e.jsx("div",{className:"alert alert-danger mt-2",children:Me.error}):null,e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:"Billing Activity"}),e.jsxs("label",{className:"table-search",htmlFor:"billing-transfer-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"billing-transfer-search",type:"text",value:Dt,onChange:d=>W(d.target.value),placeholder:"Search billing activity"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Owner"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Paid On"}),e.jsx("th",{children:"GST Bill"}),e.jsx("th",{children:"View"})]})}),e.jsx("tbody",{children:su.length?su.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.organization||"-"}),e.jsx("td",{children:d.owner_name||"-"}),e.jsx("td",{children:d.owner_email||"-"}),e.jsx("td",{children:d.plan||"-"}),e.jsx("td",{children:d.request_type||"-"}),e.jsx("td",{children:d.billing_cycle||"-"}),e.jsx("td",{children:d.currency?`${d.currency} ${we(d.amount)}`:we(d.amount)}),e.jsx("td",{children:d.status||"-"}),e.jsx("td",{children:d.paid_on||"-"}),e.jsx("td",{children:d.invoice_available&&d.invoice_url?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:d.invoice_url,target:"_blank",rel:"noreferrer",children:"Download"}):"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Ej(d),children:"View"})})]},d.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"11",children:"No billing activity found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Vi.length?nu+1:0," to"," ",Math.min(nu+rt,Vi.length)," of"," ",Vi.length," entries"]}),e.jsx(He,{page:nj,totalPages:sj,onPageChange:X,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:"Subscription History"}),e.jsxs("label",{className:"table-search",htmlFor:"billing-sub-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"billing-sub-search",type:"text",value:q,onChange:d=>ie(d.target.value),placeholder:"Search subscription history"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Email"})]})}),e.jsx("tbody",{children:lu.length?lu.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.organization||"-"}),e.jsx("td",{children:d.plan||"-"}),e.jsx("td",{children:d.status||"-"}),e.jsx("td",{children:d.billing_cycle||"-"}),e.jsx("td",{children:d.start_date||"-"}),e.jsx("td",{children:d.end_date||"-"}),e.jsx("td",{children:d.created_at||"-"}),e.jsx("td",{children:d.user_name||"-"}),e.jsx("td",{children:d.user_email||"-"})]},d.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",children:"No subscription history found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Gi.length?ru+1:0," to"," ",Math.min(ru+rt,Gi.length)," of"," ",Gi.length," entries"]}),e.jsx(He,{page:rj,totalPages:lj,onPageChange:le,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]}):null,r==="referrals"?e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Referrals"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${Le==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>{lt("org")},children:"ORG Referrals"}),e.jsx("button",{type:"button",className:`btn btn-sm ${Le==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>{lt("dealer")},children:"Dealer Referrals"})]}),Te.error?e.jsx("div",{className:"alert alert-danger mt-2",children:Te.error}):null,Le==="org"?e.jsxs(e.Fragment,{children:[eo(cn.pending,"Pending Payments","pending"),eo(cn.paid,"Completed Payments","paid"),eo(cn.rejected,"Rejected Payments","rejected")]}):e.jsxs(e.Fragment,{children:[to(cn.pending,"Pending Payments","pending"),to(cn.paid,"Completed Payments","paid"),to(cn.rejected,"Rejected Payments","rejected")]})]}):null,r==="support-access"?e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"Support Access"})}),Wa.error?e.jsx("div",{className:"alert alert-danger mt-2",children:Wa.error}):null,e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Admin"}),e.jsx("th",{children:"Monitoring Mode"}),e.jsx("th",{children:"Approved Duration"}),e.jsx("th",{children:"Access Until"})]})}),e.jsx("tbody",{children:cu.length?cu.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:d.organization}),e.jsxs("td",{children:[e.jsx("div",{children:d.admin_name}),e.jsx("small",{className:"text-secondary",children:d.admin_email})]}),e.jsx("td",{children:d.monitoring_mode}),e.jsx("td",{children:d.approved_duration}),e.jsx("td",{children:d.support_access_until||"-"})]},d.org_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No support access entries."})})})]})})]}):null]})]}),Lt.open?e.jsx("div",{className:"modal-overlay",onClick:()=>aa({open:!1,loading:!1,error:"",org:null,rows:[]}),children:e.jsxs("div",{className:"modal-panel",onClick:d=>d.stopPropagation(),children:[e.jsx("h5",{children:"AI Usage Trend"}),e.jsx("div",{className:"text-secondary small mb-2",children:(Fu=Lt.org)!=null&&Fu.org_name?`Organization: ${Lt.org.org_name}`:"Organization"}),Lt.loading?e.jsx("div",{className:"text-secondary",children:"Loading..."}):null,Lt.error?e.jsx("div",{className:"alert alert-danger",children:Lt.error}):null,Lt.loading?null:e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Month"}),e.jsx("th",{children:"Replies"}),e.jsx("th",{children:"Tokens"}),e.jsx("th",{children:"Cost (INR)"})]})}),e.jsx("tbody",{children:Lt.rows.length?Lt.rows.map(d=>e.jsxs("tr",{children:[e.jsx("td",{children:`${d.year}-${String(d.month).padStart(2,"0")}`}),e.jsx("td",{children:Number(d.ai_replies_used??0).toLocaleString()}),e.jsx("td",{children:Number(d.total_tokens??0).toLocaleString()}),e.jsxs("td",{children:["INR ",Number(d.cost_inr??0).toLocaleString()]})]},`${d.year}-${d.month}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,children:"No trend data."})})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>aa({open:!1,loading:!1,error:"",org:null,rows:[]}),children:"Close"})})]})}):null,be.open?e.jsx("div",{className:"modal-overlay",onClick:()=>We({open:!1,loading:!1,data:null,error:""}),children:e.jsxs("div",{className:`modal-panel ${Wt?"ai-chatbot-plan-modal":""}`,onClick:d=>d.stopPropagation(),children:[e.jsx("h5",{children:"Organization Details"}),be.loading?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading..."})]}):be.error?e.jsx("div",{className:"alert alert-danger",children:be.error}):be.data?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Name:"})," ",we((zu=be.data.organization)==null?void 0:zu.name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Company Key:"})," ",we((Bu=be.data.organization)==null?void 0:Bu.company_key)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Created:"})," ",we((Wu=be.data.organization)==null?void 0:Wu.created_at)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner:"})," ",we(`${((Vu=be.data.owner)==null?void 0:Vu.first_name)||""} ${((Gu=be.data.owner)==null?void 0:Gu.last_name)||""}`.trim())]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner Email:"})," ",we((Hu=be.data.owner)==null?void 0:Hu.email)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"User Phone:"})," ",we((Qu=be.data.profile)==null?void 0:Qu.phone_number)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner Username:"})," ",we((qu=be.data.owner)==null?void 0:qu.username)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Plan:"})," ",we((Yu=be.data.subscription)==null?void 0:Yu.plan_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Status:"})," ",ma((Ku=be.data.subscription)==null?void 0:Ku.status)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Billing Cycle:"})," ",ma((Ju=be.data.subscription)==null?void 0:Ju.billing_cycle)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"End Date:"})," ",we((Zu=be.data.subscription)==null?void 0:Zu.end_date)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Add-ons:"})," ",we((Xu=be.data.subscription)==null?void 0:Xu.addon_count)]}),e.jsxs("div",{className:"border-top pt-2 mt-3",children:[e.jsx("div",{className:"fw-semibold mb-2",children:"Settings"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Screenshot Interval:"})," ",we((em=be.data.settings)==null?void 0:em.screenshot_interval_minutes)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Monitoring Mode:"})," ",we((tm=be.data.settings)==null?void 0:tm.monitoring_mode)]})]})]}),e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("div",{className:"fw-semibold mb-2",children:"Billing Profile"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Contact Name:"})," ",we((am=be.data.billing_profile)==null?void 0:am.contact_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Company Name:"})," ",we((sm=be.data.billing_profile)==null?void 0:sm.company_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Email:"})," ",we((nm=be.data.billing_profile)==null?void 0:nm.email)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Phone:"})," ",we((lm=be.data.billing_profile)==null?void 0:lm.phone)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Address:"})," ",we((rm=be.data.billing_profile)==null?void 0:rm.address_line1)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Address 2:"})," ",we((im=be.data.billing_profile)==null?void 0:im.address_line2)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"City:"})," ",we((om=be.data.billing_profile)==null?void 0:om.city)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"State:"})," ",we((cm=be.data.billing_profile)==null?void 0:cm.state)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Postal Code:"})," ",we((dm=be.data.billing_profile)==null?void 0:dm.postal_code)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Country:"})," ",we((um=be.data.billing_profile)==null?void 0:um.country)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"GSTIN:"})," ",we((mm=be.data.billing_profile)==null?void 0:mm.gstin)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Updated:"})," ",we((hm=be.data.billing_profile)==null?void 0:hm.updated_at)]})]})]})}):null,e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>We({open:!1,loading:!1,data:null,error:""}),children:"Close"})})]})}):null,ae.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Pe({open:!1,loading:!1,data:null,error:"",clearing:!1,receiptPreview:""}),children:e.jsxs("div",{className:"modal-panel",onClick:d=>d.stopPropagation(),children:[e.jsx("h5",{children:"Pending Transfer Details"}),ae.loading?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading..."})]}):ae.error?e.jsx("div",{className:"alert alert-danger",children:ae.error}):ae.data?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Organization / Dealer:"})," ",we(((fm=ae.data.transfer)==null?void 0:fm.organization)||((pm=ae.data.transfer)==null?void 0:pm.dealer))]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Type:"})," ",ma((xm=ae.data.transfer)==null?void 0:xm.request_type)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Plan:"})," ",we((gm=ae.data.transfer)==null?void 0:gm.plan)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Amount:"})," ",we((jm=ae.data.transfer)==null?void 0:jm.currency)," ",we((bm=ae.data.transfer)==null?void 0:bm.amount)]}),((ym=ae.data.transfer)==null?void 0:ym.request_type)==="addon"||((vm=ae.data.transfer)==null?void 0:vm.addon_count)!==void 0?e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Add-on Users:"})," ",we(((Nm=ae.data.transfer)==null?void 0:Nm.addon_count)??"-")]}):null,e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Billing Cycle:"})," ",ma((_m=ae.data.transfer)==null?void 0:_m.billing_cycle)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Reference No:"})," ",we((Sm=ae.data.transfer)==null?void 0:Sm.reference_no)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Status:"})," ",ma((wm=ae.data.transfer)==null?void 0:wm.status)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Created:"})," ",we((Cm=ae.data.transfer)==null?void 0:Cm.created_at)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Updated:"})," ",we((km=ae.data.transfer)==null?void 0:km.updated_at)]}),(Pm=ae.data.transfer)!=null&&Pm.notes?e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Notes:"})," ",(Tm=ae.data.transfer)==null?void 0:Tm.notes]}):null,(Em=ae.data.transfer)!=null&&Em.receipt_url?e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Receipt:"}),e.jsx("div",{className:"mt-2",children:ae.receiptPreview?e.jsx("img",{src:ae.receiptPreview,alt:"Receipt",style:{maxWidth:"100%",borderRadius:"8px"}}):e.jsx("span",{className:"text-secondary",children:"Not Available"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[ae.receiptPreview?null:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Pe(d=>{var g,R;return{...d,receiptPreview:((R=(g=d.data)==null?void 0:g.transfer)==null?void 0:R.receipt_url)||""}}),children:"View Image"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>gj(ae.data.transfer.id),disabled:ae.clearing,children:ae.clearing?"Clearing...":"Clear Image"})]})]}):e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Receipt:"})," -"]})]}):null]})}):null,Ve.open?e.jsx("div",{className:"modal-overlay",onClick:()=>ze({open:!1,url:"",transferId:null,clearing:!1}),children:e.jsxs("div",{className:"modal-panel",style:{width:"min(520px, 90vw)"},onClick:d=>d.stopPropagation(),children:[e.jsx("h5",{children:"Receipt Image"}),e.jsx("div",{className:"mt-3",children:Ve.url?e.jsx("img",{src:Ve.url,alt:"Receipt",style:{width:"100%",borderRadius:"8px"}}):e.jsx("div",{className:"text-secondary",children:"Not Available"})}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-danger",onClick:bj,disabled:Ve.clearing,children:Ve.clearing?"Clearing...":"Clear Image"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>ze({open:!1,url:"",transferId:null,clearing:!1}),children:"Close"})]})]})}):null,yt.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Li({open:!1,row:null}),children:e.jsxs("div",{className:"modal-panel",onClick:d=>d.stopPropagation(),children:[e.jsx("h5",{children:"Billing Details"}),e.jsxs("div",{className:"modal-form-grid billing-modal-grid mt-3",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Organization"}),e.jsx("div",{children:we((Am=yt.row)==null?void 0:Am.organization)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Owner"}),e.jsx("div",{children:we((Dm=yt.row)==null?void 0:Dm.owner_name)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Email"}),e.jsx("div",{children:we((Lm=yt.row)==null?void 0:Lm.owner_email)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Plan"}),e.jsx("div",{children:we((Rm=yt.row)==null?void 0:Rm.plan)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Type"}),e.jsx("div",{children:we((Mm=yt.row)==null?void 0:Mm.request_type)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Cycle"}),e.jsx("div",{children:we(($m=yt.row)==null?void 0:$m.billing_cycle)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Amount"}),e.jsx("div",{children:(Um=yt.row)!=null&&Um.currency?`${yt.row.currency} ${we((Om=yt.row)==null?void 0:Om.amount)}`:we((Im=yt.row)==null?void 0:Im.amount)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Status"}),e.jsx("div",{children:we((Fm=yt.row)==null?void 0:Fm.status)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Paid On"}),e.jsx("div",{children:we((zm=yt.row)==null?void 0:zm.paid_on)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Reference"}),e.jsx("div",{children:we((Bm=yt.row)==null?void 0:Bm.reference_no)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Created"}),e.jsx("div",{children:we((Wm=yt.row)==null?void 0:Wm.created_at)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Updated"}),e.jsx("div",{children:we((Vm=yt.row)==null?void 0:Vm.updated_at)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Notes"}),e.jsx("div",{children:we((Gm=yt.row)==null?void 0:Gm.notes)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Receipt"}),(Hm=yt.row)!=null&&Hm.receipt_url?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:yt.row.receipt_url,target:"_blank",rel:"noreferrer",children:"View"}):e.jsx("div",{children:"-"})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"GST Bill"}),(Qm=yt.row)!=null&&Qm.invoice_available&&((qm=yt.row)!=null&&qm.invoice_url)?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:yt.row.invoice_url,target:"_blank",rel:"noreferrer",children:"Download"}):e.jsx("div",{children:"-"})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Li({open:!1,row:null}),children:"Close"})})]})}):null,ht.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Di({open:!1,title:"",details:{}}),children:e.jsxs("div",{className:"modal-panel",onClick:d=>d.stopPropagation(),children:[e.jsxs("h5",{children:["Bank Details - ",ht.title||"Account"]}),e.jsxs("div",{className:"modal-form-grid mt-3",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Contact Name"}),e.jsx("div",{children:we(((Ym=ht.details)==null?void 0:Ym.contact_name)||((Km=ht.details)==null?void 0:Km.name))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Company Name"}),e.jsx("div",{children:we((Jm=ht.details)==null?void 0:Jm.company_name)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Email"}),e.jsx("div",{children:we((Zm=ht.details)==null?void 0:Zm.email)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Phone"}),e.jsx("div",{children:we((Xm=ht.details)==null?void 0:Xm.phone)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Bank Name"}),e.jsx("div",{children:we((eh=ht.details)==null?void 0:eh.bank_name)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Account Number"}),e.jsx("div",{children:we((th=ht.details)==null?void 0:th.bank_account_number)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"IFSC"}),e.jsx("div",{children:we((ah=ht.details)==null?void 0:ah.bank_ifsc)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"UPI"}),e.jsx("div",{children:we((sh=ht.details)==null?void 0:sh.upi_id)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Address Line 1"}),e.jsx("div",{children:we((nh=ht.details)==null?void 0:nh.address_line1)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Address Line 2"}),e.jsx("div",{children:we((lh=ht.details)==null?void 0:lh.address_line2)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"City"}),e.jsx("div",{children:we((rh=ht.details)==null?void 0:rh.city)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"State"}),e.jsx("div",{children:we((ih=ht.details)==null?void 0:ih.state)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Postal Code"}),e.jsx("div",{children:we((oh=ht.details)==null?void 0:oh.postal_code)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Country"}),e.jsx("div",{children:we((ch=ht.details)==null?void 0:ch.country)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"GSTIN"}),e.jsx("div",{children:we((dh=ht.details)==null?void 0:dh.gstin)})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Di({open:!1,title:"",details:{}}),children:"Close"})})]})}):null,ua.open?e.jsx("div",{className:"modal-overlay",onClick:()=>xs({open:!1,row:null,type:"org",note:"",error:"",saving:!1}),children:e.jsxs("div",{className:"modal-panel",onClick:d=>d.stopPropagation(),children:[e.jsx("h5",{children:"Update Referral Payout"}),e.jsx("p",{className:"text-secondary mb-2",children:"Add payment or rejection details before updating the status."}),ua.error?e.jsx("div",{className:"alert alert-danger",children:ua.error}):null,e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Details"}),e.jsx("textarea",{className:"form-control",rows:"3",value:ua.note,onChange:d=>xs(g=>({...g,note:d.target.value})),placeholder:"Ref: 251245 / Date: 03/01/2026 / Reason"})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>xs({open:!1,row:null,type:"org",note:"",error:"",saving:!1}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>Nu("rejected"),disabled:ua.saving,children:ua.saving?"Saving...":"Reject"}),e.jsx("button",{type:"button",className:"btn btn-success",onClick:()=>Nu("paid"),disabled:ua.saving,children:ua.saving?"Saving...":"Paid"})]})]})}):null,ot.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Pt({open:!1,loading:!1,data:null,error:"",form:{}}),children:e.jsxs("div",{className:"modal-panel",onClick:d=>d.stopPropagation(),children:[e.jsx("h5",{children:"Edit Organization"}),ot.error?e.jsx("div",{className:"alert alert-danger",children:ot.error}):null,ot.loading?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading..."})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:"modal-form-grid",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Organization Name"}),e.jsx("input",{type:"text",className:"form-control",value:ot.form.name||"",onChange:d=>Pt(g=>({...g,form:{...g.form,name:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Company Key"}),e.jsx("input",{type:"text",className:"form-control",value:ot.form.company_key||"",onChange:d=>Pt(g=>({...g,form:{...g.form,company_key:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Username"}),e.jsx("input",{type:"text",className:"form-control",value:ot.form.owner_username||"",onChange:d=>Pt(g=>({...g,form:{...g.form,owner_username:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin First Name"}),e.jsx("input",{type:"text",className:"form-control",value:ot.form.owner_first_name||"",onChange:d=>Pt(g=>({...g,form:{...g.form,owner_first_name:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Last Name"}),e.jsx("input",{type:"text",className:"form-control",value:ot.form.owner_last_name||"",onChange:d=>Pt(g=>({...g,form:{...g.form,owner_last_name:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Email"}),e.jsx("input",{type:"email",className:"form-control",value:ot.form.owner_email||"",onChange:d=>Pt(g=>({...g,form:{...g.form,owner_email:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan"}),e.jsxs("select",{className:"form-select",value:ot.form.plan_id||"",onChange:d=>Pt(g=>({...g,form:{...g.form,plan_id:Number(d.target.value)||""}})),children:[e.jsx("option",{value:"",children:"Select Plan"}),Fg.map(d=>e.jsx("option",{value:d.id,children:d.name},d.id))]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Billing Cycle"}),e.jsxs("select",{className:"form-select",value:ot.form.billing_cycle||"monthly",onChange:d=>Pt(g=>({...g,form:{...g.form,billing_cycle:d.target.value}})),children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:ot.form.status||"active",onChange:d=>Pt(g=>({...g,form:{...g.form,status:d.target.value}})),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Expire Date"}),e.jsx("input",{type:"date",className:"form-control",value:ot.form.end_date||"",onChange:d=>Pt(g=>({...g,form:{...g.form,end_date:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Add-on Count"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:ot.form.addon_count??0,onChange:d=>Pt(g=>({...g,form:{...g.form,addon_count:d.target.value}}))})]})]})}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Pt({open:!1,loading:!1,data:null,error:"",form:{}}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Nj,disabled:ot.loading,children:"Save"})]})]})}):null,Aa.open?e.jsx("div",{className:"modal-overlay",onClick:()=>qn({open:!1,loading:!1,data:null,error:""}),children:e.jsxs("div",{className:"modal-panel",onClick:d=>d.stopPropagation(),children:[e.jsx("h5",{children:"User Details"}),Aa.loading?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading..."})]}):Aa.error?e.jsx("div",{className:"alert alert-danger",children:Aa.error}):Aa.data?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Name:"})," ",we((uh=Aa.data.user)==null?void 0:uh.name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Email:"})," ",we((mh=Aa.data.user)==null?void 0:mh.email)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Organization:"})," ",we((hh=Aa.data.user)==null?void 0:hh.org_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Device ID:"})," ",we((fh=Aa.data.user)==null?void 0:fh.device_id)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"PC Name:"})," ",we((ph=Aa.data.user)==null?void 0:ph.pc_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Created:"})," ",we((xh=Aa.data.user)==null?void 0:xh.created_at)]})]}):null,e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>qn({open:!1,loading:!1,data:null,error:""}),children:"Close"})})]})}):null,qt.open?e.jsx("div",{className:"modal-overlay",onClick:()=>va({open:!1,loading:!1,data:null,error:"",form:{}}),children:e.jsxs("div",{className:"modal-panel",onClick:d=>d.stopPropagation(),children:[e.jsx("h5",{children:"Edit User"}),qt.error?e.jsx("div",{className:"alert alert-danger",children:qt.error}):null,qt.loading?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading..."})]}):e.jsxs("div",{className:"modal-form-grid",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:qt.form.name||"",onChange:d=>va(g=>({...g,form:{...g.form,name:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:qt.form.email||"",onChange:d=>va(g=>({...g,form:{...g.form,email:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"PC Name"}),e.jsx("input",{type:"text",className:"form-control",value:qt.form.pc_name||"",onChange:d=>va(g=>({...g,form:{...g.form,pc_name:d.target.value}}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Device ID"}),e.jsx("input",{type:"text",className:"form-control",value:qt.form.device_id||"",onChange:d=>va(g=>({...g,form:{...g.form,device_id:d.target.value}}))})]})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>va({open:!1,loading:!1,data:null,error:"",form:{}}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:wj,disabled:qt.loading,children:"Save"})]})]})}):null,w.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Q({open:!1,mode:"create",form:{},error:"",fieldErrors:{},loading:!1,planId:null}),children:e.jsxs("div",{className:`modal-panel ${Wt?"ai-chatbot-plan-modal":""}`,onClick:d=>d.stopPropagation(),children:[e.jsx("h5",{children:w.mode==="edit"?"Edit Plan":"Create Plan"}),w.error?e.jsx("div",{className:"alert alert-danger",children:w.error}):null,Qa?e.jsxs("div",{className:"modal-form-grid",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan Name"}),e.jsx("input",{type:"text",className:"form-control",value:w.form.name||"",onChange:d=>Q(g=>({...g,form:{...g.form,name:d.target.value}}))}),O("name")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Monthly Price (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.monthly_price_inr??"",onChange:d=>Q(g=>({...g,form:{...g.form,monthly_price_inr:d.target.value}}))}),O("monthly_price_inr")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Yearly Price (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.yearly_price_inr??"",onChange:d=>Q(g=>({...g,form:{...g.form,yearly_price_inr:d.target.value}}))}),O("yearly_price_inr")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Monthly Price (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.monthly_price_usd??"",onChange:d=>Q(g=>({...g,form:{...g.form,monthly_price_usd:d.target.value}}))}),O("monthly_price_usd")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Yearly Price (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.yearly_price_usd??"",onChange:d=>Q(g=>({...g,form:{...g.form,yearly_price_usd:d.target.value}}))}),O("yearly_price_usd")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Max Users"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:w.form.max_users??"",onChange:d=>Q(g=>({...g,form:{...g.form,max_users:d.target.value}}))}),O("max_users")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Device Limit per User"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:w.form.device_limit_per_user??"",onChange:d=>Q(g=>({...g,form:{...g.form,device_limit_per_user:d.target.value}}))}),O("device_limit_per_user")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Storage Limit (GB)"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:w.form.storage_limit_gb??"",onChange:d=>Q(g=>({...g,form:{...g.form,storage_limit_gb:d.target.value}}))}),O("storage_limit_gb")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Bandwidth Limit (GB / month)"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:w.form.bandwidth_limit_gb_monthly??"",onChange:d=>Q(g=>({...g,form:{...g.form,bandwidth_limit_gb_monthly:d.target.value}}))}),O("bandwidth_limit_gb_monthly")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Bandwidth Limited"}),e.jsxs("select",{className:"form-select",value:w.form.is_bandwidth_limited===!1?"false":"true",onChange:d=>Q(g=>({...g,form:{...g.form,is_bandwidth_limited:d.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:w.form.is_active?"true":"false",onChange:d=>Q(g=>({...g,form:{...g.form,is_active:d.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]})]})]}):e.jsxs("div",{className:"modal-form-grid",style:Wt?{gridTemplateColumns:"repeat(4, minmax(0, 1fr))"}:void 0,children:[Wt?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan Template"}),e.jsxs("select",{className:"form-select",value:w.form.plan_template||"Custom",onChange:d=>{const g=d.target.value,R=kj(g);Q(ee=>({...ee,form:{...ee.form,plan_template:g,...R||{}}}))},children:[e.jsx("option",{value:"Free Trial",children:"Free Trial"}),e.jsx("option",{value:"Starter",children:"Starter"}),e.jsx("option",{value:"Growth",children:"Growth"}),e.jsx("option",{value:"Pro",children:"Pro"}),e.jsx("option",{value:"Custom",children:"Custom"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan Name"}),e.jsx("input",{type:"text",className:"form-control",value:w.form.name||"",onChange:d=>Q(g=>({...g,form:{...g.form,name:d.target.value}}))}),O("name")]})]}):e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan Name"}),e.jsx("input",{type:"text",className:"form-control",value:w.form.name||"",onChange:d=>Q(g=>({...g,form:{...g.form,name:d.target.value}}))}),O("name")]}),Wt?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Widgets"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:w.form.widgets??"",onChange:d=>Q(g=>({...g,form:{...g.form,widgets:d.target.value}}))}),O("widgets")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Agents Included"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:w.form.included_agents??"",onChange:d=>Q(g=>({...g,form:{...g.form,included_agents:d.target.value}}))}),O("included_agents")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Conversations / Month"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:w.form.conversations_per_month??"",onChange:d=>Q(g=>({...g,form:{...g.form,conversations_per_month:d.target.value}}))}),O("conversations_per_month")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Chat History (days)"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:w.form.chat_history_days??"",onChange:d=>Q(g=>({...g,form:{...g.form,chat_history_days:d.target.value}}))}),O("chat_history_days")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Max Messages / Conversation"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:w.form.max_messages_per_conversation??"",onChange:d=>Q(g=>({...g,form:{...g.form,max_messages_per_conversation:d.target.value}}))}),O("max_messages_per_conversation")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Max Chars / Message"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:w.form.max_chars_per_message??"",onChange:d=>Q(g=>({...g,form:{...g.form,max_chars_per_message:d.target.value}}))}),O("max_chars_per_message")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"AI Max Messages / Conversation"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:w.form.ai_max_messages_per_conversation??"",onChange:d=>Q(g=>({...g,form:{...g.form,ai_max_messages_per_conversation:d.target.value}}))}),O("ai_max_messages_per_conversation")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"AI Max Chars / Message"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:w.form.ai_max_chars_per_message??"",onChange:d=>Q(g=>({...g,form:{...g.form,ai_max_chars_per_message:d.target.value}}))}),O("ai_max_chars_per_message")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"AI Library Limit (MB)"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:w.form.ai_library_limit_mb??"",onChange:d=>Q(g=>({...g,form:{...g.form,ai_library_limit_mb:d.target.value}}))}),O("ai_library_limit_mb")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Maximum Website Pages Allowed for AI Import"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:w.form.website_page_limit??"",onChange:d=>Q(g=>({...g,form:{...g.form,website_page_limit:d.target.value}}))}),O("website_page_limit")]})]}):e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Employee Limit"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:w.form.employee_limit??0,onChange:d=>Q(g=>({...g,form:{...g.form,employee_limit:d.target.value}}))}),O("employee_limit")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Monthly Price (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.monthly_price??"",onChange:d=>Q(g=>({...g,form:{...g.form,monthly_price:d.target.value}}))}),O("monthly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Yearly Price (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.yearly_price??"",onChange:d=>Q(g=>({...g,form:{...g.form,yearly_price:d.target.value}}))}),O("yearly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Monthly Price (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.usd_monthly_price??"",onChange:d=>Q(g=>({...g,form:{...g.form,usd_monthly_price:d.target.value}}))}),O("usd_monthly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Yearly Price (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.usd_yearly_price??"",onChange:d=>Q(g=>({...g,form:{...g.form,usd_yearly_price:d.target.value}}))}),O("usd_yearly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Addon Monthly (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.addon_monthly_price??"",onChange:d=>Q(g=>({...g,form:{...g.form,addon_monthly_price:d.target.value}}))}),O("addon_monthly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Addon Yearly (INR)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.addon_yearly_price??"",onChange:d=>Q(g=>({...g,form:{...g.form,addon_yearly_price:d.target.value}}))}),O("addon_yearly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Addon Monthly (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.addon_usd_monthly_price??"",onChange:d=>Q(g=>({...g,form:{...g.form,addon_usd_monthly_price:d.target.value}}))}),O("addon_usd_monthly_price")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Addon Yearly (USD)"}),e.jsx("input",{type:"number",step:"0.01",className:"form-control",value:w.form.addon_usd_yearly_price??"",onChange:d=>Q(g=>({...g,form:{...g.form,addon_usd_yearly_price:d.target.value}}))}),O("addon_usd_yearly_price")]}),Wt?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Retention Days"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:w.form.retention_days??30,onChange:d=>Q(g=>({...g,form:{...g.form,retention_days:d.target.value}}))}),O("retention_days")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Screenshot Interval (min)"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:w.form.screenshot_min_minutes??5,onChange:d=>Q(g=>({...g,form:{...g.form,screenshot_min_minutes:d.target.value}}))}),O("screenshot_min_minutes")]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Allow Add-ons"}),e.jsxs("select",{className:"form-select",value:w.form.allow_addons?"true":"false",onChange:d=>Q(g=>({...g,form:{...g.form,allow_addons:d.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),O("allow_addons")]}),Wt?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Remove Branding"}),e.jsxs("select",{className:"form-select",value:w.form.remove_branding?"true":"false",onChange:d=>Q(g=>({...g,form:{...g.form,remove_branding:d.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),O("remove_branding")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Analytics (Basic)"}),e.jsxs("select",{className:"form-select",value:w.form.analytics_basic?"true":"false",onChange:d=>Q(g=>({...g,form:{...g.form,analytics_basic:d.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),O("analytics_basic")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"CSV Export"}),e.jsxs("select",{className:"form-select",value:w.form.csv_export?"true":"false",onChange:d=>Q(g=>({...g,form:{...g.form,csv_export:d.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),O("csv_export")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Agent Inbox"}),e.jsxs("select",{className:"form-select",value:w.form.agent_inbox?"true":"false",onChange:d=>Q(g=>({...g,form:{...g.form,agent_inbox:d.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),O("agent_inbox")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"AI Enabled"}),e.jsxs("select",{className:"form-select",value:w.form.ai_enabled?"true":"false",onChange:d=>Q(g=>({...g,form:{...g.form,ai_enabled:d.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),O("ai_enabled")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"AI Replies / Month"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:w.form.ai_replies_per_month??"",onChange:d=>Q(g=>({...g,form:{...g.form,ai_replies_per_month:d.target.value}}))}),O("ai_replies_per_month"),(()=>{const d=T(w.form.ai_replies_per_month);if(!d)return null;const g=d.costInr,R=g>=J.warnHighInr,ee=g>=J.warnVeryHighInr;return e.jsxs("div",{className:"text-secondary small mt-1",children:[e.jsxs("div",{children:["Estimated OpenAI cost (Approx): INR ",g.toFixed(0)," / month"]}),e.jsxs("div",{children:["Assumes ",d.tokensPerReply," tokens per reply, $",d.usdPer1k,"/1k tokens, 1 USD=INR ",d.usdToInr]}),ee?e.jsx("div",{className:"text-danger",children:"Very high AI cost - review limits"}):R?e.jsx("div",{className:"text-warning",children:"High AI cost"}):null]})})(),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm mt-2",onClick:()=>K(d=>!d),children:re?"Hide assumptions":"Edit assumptions"}),re?e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("label",{className:"form-label",children:"Avg tokens/reply"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:J.tokensPerReply,onChange:d=>me(g=>({...g,tokensPerReply:Number(d.target.value)}))})]}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("label",{className:"form-label",children:"USD / 1k tokens"}),e.jsx("input",{type:"number",step:"0.0001",min:"0",className:"form-control",value:J.usdPer1k,onChange:d=>me(g=>({...g,usdPer1k:Number(d.target.value)}))})]}),e.jsxs("div",{className:"flex-grow-1",children:[e.jsx("label",{className:"form-label",children:"USD to INR"}),e.jsx("input",{type:"number",min:"1",className:"form-control",value:J.usdToInr,onChange:d=>me(g=>({...g,usdToInr:Number(d.target.value)}))})]})]})}):null]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Allow App Usage"}),e.jsxs("select",{className:"form-select",value:w.form.allow_app_usage?"true":"false",onChange:d=>Q(g=>({...g,form:{...g.form,allow_app_usage:d.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),O("allow_app_usage")]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Allow HR View Login"}),e.jsxs("select",{className:"form-select",value:w.form.allow_hr_view?"true":"false",onChange:d=>Q(g=>({...g,form:{...g.form,allow_hr_view:d.target.value==="true"}})),children:[e.jsx("option",{value:"true",children:"Yes"}),e.jsx("option",{value:"false",children:"No"})]}),O("allow_hr_view")]})]})]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Q({open:!1,mode:"create",form:{},error:"",fieldErrors:{},loading:!1,planId:null}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Pj,disabled:w.loading,children:"Save"})]})]})}):null]})}const dS={loading:!0,error:"",data:null};function Tt(t){return t==null||t===""?"-":t}function Wf(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}function uS(){var Ha,Lt,aa,at,Nt,sa;const[t,a]=o.useState(dS),[s,n]=o.useState(""),[l,r]=o.useState(""),[i,u]=o.useState("all"),[c,m]=o.useState(1),[x,f]=o.useState("org"),[j,N]=o.useState(""),[v,_]=o.useState(""),[C,y]=o.useState(1),[h,p]=o.useState("org"),[b,P]=o.useState(""),[$,E]=o.useState(""),[L,V]=o.useState(1),[U,w]=o.useState(""),[Q,J]=o.useState(""),[me,re]=o.useState(1),[K,O]=o.useState("org"),[T,H]=o.useState(""),[I,S]=o.useState(""),[k,M]=o.useState(1),[A,F]=o.useState(""),[te,Y]=o.useState(""),[ue,he]=o.useState(1),[ye,G]=o.useState({open:!1,loading:!1,data:null,error:""}),[Ne,_e]=o.useState({open:!1,loading:!1,data:null,error:"",form:{}}),de=nn(),Re=fs(),je=10;async function Ae(){const se=await z("/api/saas-admin/organizations");a({loading:!1,error:"",data:se})}o.useEffect(()=>{let se=!0;async function be(){try{const We=await z("/api/saas-admin/organizations");if(!se)return;a({loading:!1,error:"",data:We})}catch(We){se&&a({loading:!1,error:(We==null?void 0:We.message)||"Unable to load organizations.",data:null})}}return be(),()=>{se=!1}},[]),o.useEffect(()=>{const se=setTimeout(()=>{r(s.trim()),m(1)},300);return()=>clearTimeout(se)},[s]),o.useEffect(()=>{const se=setTimeout(()=>{_(j.trim()),y(1)},300);return()=>clearTimeout(se)},[j]),o.useEffect(()=>{const se=setTimeout(()=>{E(b.trim()),V(1)},300);return()=>clearTimeout(se)},[b]),o.useEffect(()=>{const se=setTimeout(()=>{J(U.trim()),re(1)},300);return()=>clearTimeout(se)},[U]),o.useEffect(()=>{const se=setTimeout(()=>{S(T.trim()),M(1)},300);return()=>clearTimeout(se)},[T]),o.useEffect(()=>{const se=setTimeout(()=>{Y(A.trim()),he(1)},300);return()=>clearTimeout(se)},[A]);const Qe=((Ha=t.data)==null?void 0:Ha.organizations)||[],qe=((Lt=t.data)==null?void 0:Lt.dealers)||[];(aa=t.data)!=null&&aa.plans;const Je=((at=t.data)==null?void 0:at.products)||[],Ye=((Nt=t.data)==null?void 0:Nt.deleted_orgs)||[],oe=((sa=t.data)==null?void 0:sa.deleted_dealers)||[],ve=o.useMemo(()=>{if(!l)return i==="all"?Qe:Qe.filter(be=>(be.products||[]).includes(i));const se=l.toLowerCase();return Qe.filter(be=>{var Ve,ze;const We=((Ve=be.subscription)==null?void 0:Ve.plan_name)||"",ae=[be.name,be.company_key,be.owner_name,be.owner_email,We,(ze=be.subscription)==null?void 0:ze.end_date].some(ht=>String(ht||"").toLowerCase().includes(se)),Pe=i==="all"||(be.products||[]).includes(i);return ae&&Pe})},[Qe,l,i]),Z=Math.max(Math.ceil(ve.length/je),1),ce=o.useMemo(()=>ve.slice((c-1)*je,c*je),[ve,c]),xe=ve.length,Ce=xe?(c-1)*je+1:0,Fe=xe?Math.min(c*je,xe):0,Ze=o.useMemo(()=>{if(!v)return qe;const se=v.toLowerCase();return qe.filter(be=>[be.name,be.email,be.referral_code,be.referred_by,be.subscription_status,be.subscription_end].some(We=>String(We||"").toLowerCase().includes(se)))},[qe,v]),ne=Math.max(Math.ceil(Ze.length/je),1),Ie=o.useMemo(()=>Ze.slice((C-1)*je,C*je),[Ze,C]),Oe=Ze.length,Me=Oe?(C-1)*je+1:0,st=Oe?Math.min(C*je,Oe):0,Dt=o.useMemo(()=>Qe.filter(se=>{var Ve,ze;const be=String(((Ve=se.subscription)==null?void 0:Ve.status)||"").toLowerCase(),ae=(se.product_statuses||[]).some(ht=>ht.status==="inactive"),Pe=!((ze=se.subscription)!=null&&ze.plan_name);return ae||be==="inactive"||be==="expired"||Pe}),[Qe]),W=o.useMemo(()=>{const se=Dt.filter(We=>i==="all"?!0:(We.products||[]).includes(i));if(!$)return se;const be=$.toLowerCase();return se.filter(We=>{var Pe,Ve;const ae=((Pe=We.subscription)==null?void 0:Pe.plan_name)||"";return[We.name,We.company_key,We.owner_name,We.owner_email,ae,(Ve=We.subscription)==null?void 0:Ve.end_date].some(ze=>String(ze||"").toLowerCase().includes(be))})},[Dt,$,i]),pe=Math.max(Math.ceil(W.length/je),1),fe=o.useMemo(()=>W.slice((L-1)*je,L*je),[W,L]),D=W.length,X=D?(L-1)*je+1:0,q=D?Math.min(L*je,D):0,ie=o.useMemo(()=>qe.filter(se=>String(se.subscription_status||"").toLowerCase()!=="active"),[qe]),Ee=o.useMemo(()=>{if(!Q)return ie;const se=Q.toLowerCase();return ie.filter(be=>[be.name,be.email,be.referral_code,be.referred_by,be.subscription_status,be.subscription_end].some(We=>String(We||"").toLowerCase().includes(se)))},[ie,Q]),tt=Math.max(Math.ceil(Ee.length/je),1),B=o.useMemo(()=>Ee.slice((me-1)*je,me*je),[Ee,me]),le=Ee.length,Te=le?(me-1)*je+1:0,Se=le?Math.min(me*je,le):0,Le=o.useMemo(()=>{if(!I)return Ye;const se=I.toLowerCase();return Ye.filter(be=>[be.organization_name,be.owner_username,be.owner_email,be.reason,be.deleted_at].some(We=>String(We||"").toLowerCase().includes(se)))},[Ye,I]),lt=Math.max(Math.ceil(Le.length/je),1),Ut=o.useMemo(()=>Le.slice((k-1)*je,k*je),[Le,k]),Ba=Le.length,Wa=Ba?(k-1)*je+1:0,Va=Ba?Math.min(k*je,Ba):0,Ct=o.useMemo(()=>{if(!te)return oe;const se=te.toLowerCase();return oe.filter(be=>[be.name,be.email,be.reason,be.deleted_at].some(We=>String(We||"").toLowerCase().includes(se)))},[oe,te]),kt=Math.max(Math.ceil(Ct.length/je),1),ea=o.useMemo(()=>Ct.slice((ue-1)*je,ue*je),[Ct,ue]),ya=Ct.length,ta=ya?(ue-1)*je+1:0,ts=ya?Math.min(ue*je,ya):0;o.useEffect(()=>{c>Z&&m(Z)},[c,Z]),o.useEffect(()=>{C>ne&&y(ne)},[C,ne]),o.useEffect(()=>{L>pe&&V(pe)},[L,pe]),o.useEffect(()=>{me>tt&&re(tt)},[me,tt]),o.useEffect(()=>{k>lt&&M(lt)},[k,lt]),o.useEffect(()=>{ue>kt&&he(kt)},[ue,kt]);function ca(){G({open:!1,loading:!1,data:null,error:""})}async function Ga(se){if(await de({title:"Delete Organization",message:`Delete ${se.name}? This removes the organization and owner user.`,confirmText:"Delete",confirmVariant:"danger"}))try{await z(`/api/saas-admin/organizations/${se.id}`,{method:"DELETE"}),await Ae()}catch(We){a(ae=>({...ae,error:(We==null?void 0:We.message)||"Unable to delete organization."}))}}async function da(se){if(await de({title:"Delete Dealer",message:`Delete ${se.name||se.email}? This removes the dealer account and user login.`,confirmText:"Delete",confirmVariant:"danger"}))try{await z(`/api/saas-admin/dealers/${se.id}`,{method:"DELETE"}),await Ae()}catch(We){a(ae=>({...ae,error:(We==null?void 0:We.message)||"Unable to delete dealer."}))}}return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading organizations..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"page-title",children:"Organizations"}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex gap-2 flex-wrap mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${x==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>f("org"),children:"ORG Accounts"}),e.jsx("button",{type:"button",className:`btn btn-sm ${x==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>f("dealer"),children:"Dealer Accounts"})]}),x==="org"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",je," entries"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsxs("label",{className:"table-search",htmlFor:"saas-org-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-org-search",type:"text",value:s,onChange:se=>n(se.target.value),placeholder:"Search organizations"})]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-org-product",children:[e.jsx("span",{children:"Product:"}),e.jsxs("select",{id:"saas-org-product",value:i,onChange:se=>{u(se.target.value),m(1)},children:[e.jsx("option",{value:"all",children:"All"}),Je.map(se=>e.jsx("option",{value:se.slug,children:se.name},se.slug))]})]})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Admin User Name"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Products"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Expire Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:ce.length?ce.map(se=>{var be,We;return e.jsxs("tr",{children:[e.jsx("td",{children:se.name}),e.jsx("td",{children:Tt(se.owner_name)}),e.jsx("td",{children:Tt(se.owner_email)}),e.jsx("td",{children:se.product_statuses&&se.product_statuses.length?se.product_statuses.map(ae=>ae.name).join(", "):"-"}),e.jsx("td",{children:((be=se.subscription)==null?void 0:be.plan_name)||"-"}),e.jsx("td",{children:((We=se.subscription)==null?void 0:We.end_date)||"-"}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>Re(`/saas-admin/organizations/${se.id}`),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>Re(`/saas-admin/organizations/${se.id}#edit`),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>Ga(se),children:"Delete"})]})]},se.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No organizations found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Ce," to ",Fe," of ",xe," entries"]}),e.jsx(He,{page:c,totalPages:Z,onPageChange:m,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",je," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-dealer-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-dealer-search",type:"text",value:j,onChange:se=>N(se.target.value),placeholder:"Search dealers"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Referral Code"}),e.jsx("th",{children:"Referred By"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:Ie.length?Ie.map(se=>e.jsxs("tr",{children:[e.jsx("td",{children:se.name||"-"}),e.jsx("td",{children:Tt(se.email)}),e.jsx("td",{children:Tt(se.referral_code)}),e.jsx("td",{children:Tt(se.referred_by)}),e.jsx("td",{children:Wf(se.subscription_status)}),e.jsx("td",{children:se.subscription_start||"-"}),e.jsx("td",{children:se.subscription_end||"-"}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>Re(`/saas-admin/dealers/${se.id}`),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>Re(`/saas-admin/dealers/${se.id}#edit`),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>da(se),children:"Delete"})]})]},se.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No dealers found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Me," to ",st," of ",Oe," entries"]}),e.jsx(He,{page:C,totalPages:ne,onPageChange:y,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]}),e.jsxs("div",{className:"card p-3 mt-4",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h4",{className:"mb-0",children:"Inactive Accounts"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-3 mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${h==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>p("org"),children:"ORG Accounts"}),e.jsx("button",{type:"button",className:`btn btn-sm ${h==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>p("dealer"),children:"Dealer Accounts"})]}),h==="org"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",je," entries"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2 flex-wrap",children:[e.jsxs("label",{className:"table-search",htmlFor:"saas-inactive-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-inactive-search",type:"text",value:b,onChange:se=>P(se.target.value),placeholder:"Search organizations"})]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-inactive-product",children:[e.jsx("span",{children:"Product:"}),e.jsxs("select",{id:"saas-inactive-product",value:i,onChange:se=>{u(se.target.value),V(1)},children:[e.jsx("option",{value:"all",children:"All"}),Je.map(se=>e.jsx("option",{value:se.slug,children:se.name},se.slug))]})]})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Admin User Name"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Products"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Expire Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:fe.length?fe.map(se=>{var be,We;return e.jsxs("tr",{children:[e.jsx("td",{children:se.name}),e.jsx("td",{children:Tt(se.owner_name)}),e.jsx("td",{children:Tt(se.owner_email)}),e.jsx("td",{children:se.product_statuses&&se.product_statuses.length?se.product_statuses.map(ae=>ae.name).join(", "):"-"}),e.jsx("td",{children:((be=se.subscription)==null?void 0:be.plan_name)||"-"}),e.jsx("td",{children:((We=se.subscription)==null?void 0:We.end_date)||"-"}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>Re(`/saas-admin/organizations/${se.id}`),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>Re(`/saas-admin/organizations/${se.id}#edit`),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>Ga(se),children:"Delete"})]})]},`inactive-${se.id}`)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No inactive organizations found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",X," to ",q," of ",D," entries"]}),e.jsx(He,{page:L,totalPages:pe,onPageChange:V,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",je," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-inactive-dealer-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-inactive-dealer-search",type:"text",value:U,onChange:se=>w(se.target.value),placeholder:"Search dealers"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Referral Code"}),e.jsx("th",{children:"Referred By"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Start Date"}),e.jsx("th",{children:"End Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:B.length?B.map(se=>e.jsxs("tr",{children:[e.jsx("td",{children:se.name||"-"}),e.jsx("td",{children:Tt(se.email)}),e.jsx("td",{children:Tt(se.referral_code)}),e.jsx("td",{children:Tt(se.referred_by)}),e.jsx("td",{children:Wf(se.subscription_status)}),e.jsx("td",{children:se.subscription_start||"-"}),e.jsx("td",{children:se.subscription_end||"-"}),e.jsxs("td",{children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm me-2",onClick:()=>Re(`/saas-admin/dealers/${se.id}`),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm me-2",onClick:()=>Re(`/saas-admin/dealers/${se.id}#edit`),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-danger btn-sm",onClick:()=>da(se),children:"Delete"})]})]},`inactive-dealer-${se.id}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"8",children:"No inactive dealers found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Te," to ",Se," of ",le," entries"]}),e.jsx(He,{page:me,totalPages:tt,onPageChange:re,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]}),e.jsxs("div",{className:"card p-3 mt-4",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h4",{className:"mb-0",children:"Deleted Accounts"})}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-3 mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${K==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>O("org"),children:"ORG Accounts"}),e.jsx("button",{type:"button",className:`btn btn-sm ${K==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>O("dealer"),children:"Dealer Accounts"})]}),K==="org"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",je," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-deleted-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-deleted-search",type:"text",value:T,onChange:se=>H(se.target.value),placeholder:"Search organizations"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Admin User Name"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Deleted At"}),e.jsx("th",{children:"Reason"})]})}),e.jsx("tbody",{children:Ut.length?Ut.map((se,be)=>e.jsxs("tr",{children:[e.jsx("td",{children:Tt(se.organization_name)}),e.jsx("td",{children:Tt(se.owner_username)}),e.jsx("td",{children:Tt(se.owner_email)}),e.jsx("td",{children:Tt(se.deleted_at)}),e.jsx("td",{children:Tt(se.reason)})]},`deleted-org-${se.organization_name}-${be}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No deleted organizations found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Wa," to ",Va," of ",Ba," entries"]}),e.jsx(He,{page:k,totalPages:lt,onPageChange:M,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",je," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-deleted-dealer-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-deleted-dealer-search",type:"text",value:A,onChange:se=>F(se.target.value),placeholder:"Search dealers"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email ID"}),e.jsx("th",{children:"Deleted At"}),e.jsx("th",{children:"Reason"})]})}),e.jsx("tbody",{children:ea.length?ea.map((se,be)=>e.jsxs("tr",{children:[e.jsx("td",{children:Tt(se.name)}),e.jsx("td",{children:Tt(se.email)}),e.jsx("td",{children:Tt(se.deleted_at)}),e.jsx("td",{children:Tt(se.reason)})]},`deleted-dealer-${se.id||se.email}-${be}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",children:"No deleted dealers found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",ta," to ",ts," of ",ya," entries"]}),e.jsx(He,{page:ue,totalPages:kt,onPageChange:he,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]}),ye.open?e.jsx("div",{className:"modal-overlay",onClick:ca,children:e.jsxs("div",{className:"modal-panel",onClick:se=>se.stopPropagation(),children:[e.jsx("h5",{children:"Organization Details"}),e.jsx("div",{className:"text-secondary",children:"Use the separate organization page to view and edit details."}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:ca,children:"Close"})})]})}):null]})}const mS={loading:!0,error:"",data:null};function Sr(t){return t==null||t===""?"-":t}function Go(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}function hS(){var J,me,re;const{dealerId:t}=ps(),a=ba(),s=fs(),[n,l]=o.useState(mS),[r,i]=o.useState(""),[u,c]=o.useState("org"),[m,x]=o.useState(""),[f,j]=o.useState(""),[N,v]=o.useState(1),[_,C]=o.useState({name:"",email:"",phone_number:"",address_line1:"",address_line2:"",city:"",state:"",postal_code:"",bank_name:"",bank_account_number:"",bank_ifsc:"",upi_id:"",subscription_status:"pending"}),y=8;o.useEffect(()=>{let K=!0;async function O(){i("");try{const T=await z(`/api/saas-admin/dealers/${t}`);if(!K)return;l({loading:!1,error:"",data:T});const H=T.dealer||{};C({name:H.name||"",email:H.email||"",phone_number:H.phone_number||"",address_line1:H.address_line1||"",address_line2:H.address_line2||"",city:H.city||"",state:H.state||"",postal_code:H.postal_code||"",bank_name:H.bank_name||"",bank_account_number:H.bank_account_number||"",bank_ifsc:H.bank_ifsc||"",upi_id:H.upi_id||"",subscription_status:H.subscription_status||"pending"})}catch(T){K&&l({loading:!1,error:(T==null?void 0:T.message)||"Unable to load dealer details.",data:null})}}return O(),()=>{K=!1}},[t]),o.useEffect(()=>{const K=setTimeout(()=>{j(m.trim()),v(1)},300);return()=>clearTimeout(K)},[m]),o.useEffect(()=>{if(a.hash==="#edit"){const K=document.getElementById("dealer-edit-section");K&&K.scrollIntoView({behavior:"smooth"})}},[a.hash]);async function h(K){K.preventDefault(),i("");try{await z(`/api/saas-admin/dealers/${t}`,{method:"PUT",body:JSON.stringify(_)}),i("Dealer details updated.")}catch(O){l(T=>({...T,error:(O==null?void 0:O.message)||"Unable to update dealer."}))}}const p=((J=n.data)==null?void 0:J.org_referrals)||[],b=((me=n.data)==null?void 0:me.dealer_referrals)||[],P=u==="dealer"?b:p,$=o.useMemo(()=>{if(!f)return P;const K=f.toLowerCase();return P.filter(O=>[O.referred_org,O.referred_dealer,O.transfer_id,O.base_amount,O.commission_rate,O.commission_amount,O.flat_amount,O.status,O.payout_reference,O.payout_date,O.created_at].some(T=>String(T||"").toLowerCase().includes(K)))},[P,f]),E=Math.max(Math.ceil($.length/y),1),L=o.useMemo(()=>$.slice((N-1)*y,N*y),[$,N]),V=$.length,U=V?(N-1)*y+1:0,w=V?Math.min(N*y,V):0;if(n.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading dealer..."})]});const Q=((re=n.data)==null?void 0:re.dealer)||{};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h3",{className:"page-title",children:"Dealer Details"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>s("/saas-admin/organizations"),children:"Back"})]}),r?e.jsx("div",{className:"alert alert-success mt-2",children:r}):null,n.error?e.jsx("div",{className:"alert alert-danger mt-2",children:n.error}):null,e.jsx("div",{className:"card p-3 mt-3",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("h5",{children:"Profile"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Referral Code:"})," ",Sr(Q.referral_code)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Referred By:"})," ",Sr(Q.referred_by)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Subscription Status:"})," ",Go(Q.subscription_status)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Start Date:"})," ",Sr(Q.subscription_start)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"End Date:"})," ",Sr(Q.subscription_end)]})]}),e.jsxs("div",{className:"col-12 col-lg-6",id:"dealer-edit-section",children:[e.jsx("h5",{children:"Edit Dealer"}),e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:_.name,onChange:K=>C(O=>({...O,name:K.target.value})),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:_.email,onChange:K=>C(O=>({...O,email:K.target.value})),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{type:"text",className:"form-control",value:_.phone_number,onChange:K=>C(O=>({...O,phone_number:K.target.value}))})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:_.subscription_status,onChange:K=>C(O=>({...O,subscription_status:K.target.value})),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm",children:"Save"})]})]})]})}),e.jsx("div",{className:"card p-3 mt-3",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("h5",{children:"Bank Details"}),e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Bank Name"}),e.jsx("input",{type:"text",className:"form-control",value:_.bank_name,onChange:K=>C(O=>({...O,bank_name:K.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Account Number"}),e.jsx("input",{type:"text",className:"form-control",value:_.bank_account_number,onChange:K=>C(O=>({...O,bank_account_number:K.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"IFSC"}),e.jsx("input",{type:"text",className:"form-control",value:_.bank_ifsc,onChange:K=>C(O=>({...O,bank_ifsc:K.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"UPI ID"}),e.jsx("input",{type:"text",className:"form-control",value:_.upi_id,onChange:K=>C(O=>({...O,upi_id:K.target.value}))})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm mt-3",children:"Save Bank Details"})]})]}),e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("h5",{children:"Address"}),e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"row g-2",children:[e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Address Line 1"}),e.jsx("input",{type:"text",className:"form-control",value:_.address_line1,onChange:K=>C(O=>({...O,address_line1:K.target.value}))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Address Line 2"}),e.jsx("input",{type:"text",className:"form-control",value:_.address_line2,onChange:K=>C(O=>({...O,address_line2:K.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",className:"form-control",value:_.city,onChange:K=>C(O=>({...O,city:K.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"State"}),e.jsx("input",{type:"text",className:"form-control",value:_.state,onChange:K=>C(O=>({...O,state:K.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-6",children:[e.jsx("label",{className:"form-label",children:"Pincode"}),e.jsx("input",{type:"text",className:"form-control",value:_.postal_code,onChange:K=>C(O=>({...O,postal_code:K.target.value}))})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm mt-3",children:"Save Address"})]})]})]})}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex gap-2 flex-wrap mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${u==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>c("org"),children:"ORG Referrals"}),e.jsx("button",{type:"button",className:`btn btn-sm ${u==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>c("dealer"),children:"Dealer Referrals"})]}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",y," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"dealer-referral-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"dealer-referral-search",type:"text",value:m,onChange:K=>x(K.target.value),placeholder:"Search referrals"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:u==="org"?e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Transfer"}),e.jsx("th",{children:"Base Amount"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]}):e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Flat Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"})]})}),e.jsx("tbody",{children:L.length?L.map(K=>e.jsx("tr",{children:u==="org"?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:K.referred_org||"-"}),e.jsx("td",{children:K.transfer_id||"-"}),e.jsx("td",{children:K.base_amount??"-"}),e.jsxs("td",{children:[K.commission_rate??0,"%"]}),e.jsx("td",{children:K.commission_amount??"-"}),e.jsx("td",{children:Go(K.status)}),e.jsx("td",{children:K.payout_reference||"-"}),e.jsx("td",{children:K.payout_date||"-"})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{children:K.referred_dealer||"-"}),e.jsx("td",{children:K.flat_amount??"-"}),e.jsx("td",{children:Go(K.status)}),e.jsx("td",{children:K.payout_reference||"-"}),e.jsx("td",{children:K.payout_date||"-"})]})},K.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:u==="org"?8:5,children:"No referrals found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",U," to ",w," of ",V," entries"]}),e.jsx(He,{page:N,totalPages:E,onPageChange:v,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})}const fS={loading:!0,error:"",data:null},pS={india:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"],"united states":["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],canada:["Alberta","British Columbia","Manitoba","New Brunswick","Newfoundland and Labrador","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Northwest Territories","Nunavut","Yukon"],australia:["Australian Capital Territory","New South Wales","Northern Territory","Queensland","South Australia","Tasmania","Victoria","Western Australia"],"united kingdom":["England","Northern Ireland","Scotland","Wales"]};function xS(t){return String(t||"").trim().toLowerCase()}function Vf(t){return pS[xS(t)]||[]}function pt(t){return t==null||t===""?"-":t}function Ho(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}function gS(){var p,b,P,$,E,L,V;const{orgId:t}=ps(),a=ba(),s=fs(),[n,l]=o.useState(fS),[r,i]=o.useState(""),[u,c]=o.useState([]),[m,x]=o.useState({name:"",company_key:"",owner_username:"",owner_first_name:"",owner_last_name:"",owner_email:"",plan_id:"",billing_cycle:"monthly",status:"active",end_date:"",addon_count:0}),[f,j]=o.useState({contact_name:"",company_name:"",email:"",phone:"",address_line1:"",address_line2:"",city:"",state:"",postal_code:"",country:"",gstin:""});o.useEffect(()=>{let U=!0;async function w(){var Q,J;i("");try{const me=await z(`/api/saas-admin/organizations/${t}`);if(!U)return;l({loading:!1,error:"",data:me});const re=me.owner||{},K=me.subscription||{},O=me.billing_profile||{};x({name:((Q=me.organization)==null?void 0:Q.name)||"",company_key:((J=me.organization)==null?void 0:J.company_key)||"",owner_username:re.username||"",owner_first_name:re.first_name||"",owner_last_name:re.last_name||"",owner_email:re.email||"",plan_id:K.plan_id||"",billing_cycle:K.billing_cycle||"monthly",status:K.status||"active",end_date:K.end_date||"",addon_count:K.addon_count??0}),j({contact_name:O.contact_name||"",company_name:O.company_name||"",email:O.email||"",phone:O.phone||"",address_line1:O.address_line1||"",address_line2:O.address_line2||"",city:O.city||"",state:O.state||"",postal_code:O.postal_code||"",country:O.country||"",gstin:O.gstin||""})}catch(me){U&&l({loading:!1,error:(me==null?void 0:me.message)||"Unable to load organization.",data:null})}}return w(),()=>{U=!1}},[t]),o.useEffect(()=>{let U=!0;async function w(){try{const Q=await z("/api/saas-admin/plans");if(!U)return;c(Q.plans||[])}catch{U&&c([])}}return w(),()=>{U=!1}},[]),o.useEffect(()=>{if(a.hash==="#edit"){const U=document.getElementById("org-edit-section");U&&U.scrollIntoView({behavior:"smooth"})}},[a.hash]);async function N(U){U.preventDefault(),i("");try{await z(`/api/saas-admin/organizations/${t}`,{method:"PUT",body:JSON.stringify({name:m.name,company_key:m.company_key,owner_username:m.owner_username,owner_first_name:m.owner_first_name,owner_last_name:m.owner_last_name,owner_email:m.owner_email,plan_id:m.plan_id||null,billing_cycle:m.billing_cycle,status:m.status,end_date:m.end_date,addon_count:m.addon_count,billing_contact_name:f.contact_name,billing_company_name:f.company_name,billing_email:f.email,billing_phone:f.phone,billing_address_line1:f.address_line1,billing_address_line2:f.address_line2,billing_city:f.city,billing_state:f.state,billing_postal_code:f.postal_code,billing_country:f.country,billing_gstin:f.gstin})}),i("Organization updated.")}catch(w){l(Q=>({...Q,error:(w==null?void 0:w.message)||"Unable to update organization."}))}}if(n.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading organization..."})]});const v=((p=n.data)==null?void 0:p.organization)||{},_=((b=n.data)==null?void 0:b.owner)||{},C=((P=n.data)==null?void 0:P.subscription)||{},y=(($=n.data)==null?void 0:$.billing_profile)||{},h=((E=n.data)==null?void 0:E.settings)||{};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h3",{className:"page-title",children:"Organization Details"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>s("/saas-admin/organizations"),children:"Back"})]}),r?e.jsx("div",{className:"alert alert-success mt-2",children:r}):null,n.error?e.jsx("div",{className:"alert alert-danger mt-2",children:n.error}):null,e.jsx("div",{className:"card p-3 mt-3",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("h5",{children:"Profile"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Name:"})," ",pt(v.name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Company Key:"})," ",pt(v.company_key)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Created:"})," ",pt(v.created_at)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner:"})," ",pt(`${_.first_name||""} ${_.last_name||""}`.trim())]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner Email:"})," ",pt(_.email)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner Phone:"})," ",pt((V=(L=n.data)==null?void 0:L.profile)==null?void 0:V.phone_number)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Owner Username:"})," ",pt(_.username)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Plan:"})," ",pt(C.plan_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Status:"})," ",Ho(C.status)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Billing Cycle:"})," ",Ho(C.billing_cycle)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"End Date:"})," ",pt(C.end_date)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Add-ons:"})," ",pt(C.addon_count)]})]}),e.jsxs("div",{className:"col-12 col-lg-6",children:[e.jsx("h5",{children:"Billing Profile"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Contact Name:"})," ",pt(y.contact_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Company Name:"})," ",pt(y.company_name)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Email:"})," ",pt(y.email)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Phone:"})," ",pt(y.phone)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Address:"})," ",pt(y.address_line1)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Address 2:"})," ",pt(y.address_line2)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"City:"})," ",pt(y.city)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"State:"})," ",pt(y.state)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Postal Code:"})," ",pt(y.postal_code)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Country:"})," ",pt(y.country)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"GSTIN:"})," ",pt(y.gstin)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Updated:"})," ",pt(y.updated_at)]})]})]})}),e.jsxs("div",{className:"card p-3 mt-3",id:"org-edit-section",children:[e.jsx("h5",{children:"Edit Organization"}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"modal-form-grid",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Organization Name"}),e.jsx("input",{type:"text",className:"form-control",value:m.name,onChange:U=>x(w=>({...w,name:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Company Key"}),e.jsx("input",{type:"text",className:"form-control",value:m.company_key,onChange:U=>x(w=>({...w,company_key:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Username"}),e.jsx("input",{type:"text",className:"form-control",value:m.owner_username,onChange:U=>x(w=>({...w,owner_username:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin First Name"}),e.jsx("input",{type:"text",className:"form-control",value:m.owner_first_name,onChange:U=>x(w=>({...w,owner_first_name:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Last Name"}),e.jsx("input",{type:"text",className:"form-control",value:m.owner_last_name,onChange:U=>x(w=>({...w,owner_last_name:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Admin Email"}),e.jsx("input",{type:"email",className:"form-control",value:m.owner_email,onChange:U=>x(w=>({...w,owner_email:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Plan"}),e.jsxs("select",{className:"form-select",value:m.plan_id||"",onChange:U=>x(w=>({...w,plan_id:Number(U.target.value)||""})),children:[e.jsx("option",{value:"",children:"Select Plan"}),u.map(U=>e.jsx("option",{value:U.id,children:U.name},U.id))]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Billing Cycle"}),e.jsxs("select",{className:"form-select",value:m.billing_cycle,onChange:U=>x(w=>({...w,billing_cycle:U.target.value})),children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:m.status,onChange:U=>x(w=>({...w,status:U.target.value})),children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"expired",children:"Expired"})]})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Expire Date"}),e.jsx("input",{type:"date",className:"form-control",value:m.end_date||"",onChange:U=>x(w=>({...w,end_date:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Add-on Count"}),e.jsx("input",{type:"number",min:"0",className:"form-control",value:m.addon_count??0,onChange:U=>x(w=>({...w,addon_count:U.target.value}))})]})]}),e.jsx("div",{className:"d-flex justify-content-end gap-2 mt-3",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save"})})]})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"Edit Billing Profile"}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"modal-form-grid",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Contact Name"}),e.jsx("input",{type:"text",className:"form-control",value:f.contact_name,onChange:U=>j(w=>({...w,contact_name:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Company Name"}),e.jsx("input",{type:"text",className:"form-control",value:f.company_name,onChange:U=>j(w=>({...w,company_name:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:f.email,onChange:U=>j(w=>({...w,email:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsx("input",{type:"text",className:"form-control",value:f.phone,onChange:U=>j(w=>({...w,phone:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Address Line 1"}),e.jsx("input",{type:"text",className:"form-control",value:f.address_line1,onChange:U=>j(w=>({...w,address_line1:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Address Line 2"}),e.jsx("input",{type:"text",className:"form-control",value:f.address_line2,onChange:U=>j(w=>({...w,address_line2:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"City"}),e.jsx("input",{type:"text",className:"form-control",value:f.city,onChange:U=>j(w=>({...w,city:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Postal Code"}),e.jsx("input",{type:"text",className:"form-control",value:f.postal_code,onChange:U=>j(w=>({...w,postal_code:U.target.value}))})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"Country"}),e.jsx("input",{type:"text",className:"form-control",value:f.country,onChange:U=>{const w=U.target.value,Q=Vf(w);j(J=>({...J,country:w,state:Q.length&&!Q.includes(J.state)?"":J.state}))},list:"country-options"})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"State"}),e.jsx("input",{type:"text",className:"form-control",value:f.state,onChange:U=>j(w=>({...w,state:U.target.value})),list:"state-options",disabled:!String(f.country||"").trim()})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{className:"form-label",children:"GSTIN"}),e.jsx("input",{type:"text",className:"form-control",value:f.gstin,onChange:U=>j(w=>({...w,gstin:U.target.value}))})]})]}),e.jsx("div",{className:"d-flex justify-content-end gap-2 mt-3",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Billing Profile"})})]}),e.jsx("datalist",{id:"country-options",children:Ai.map(U=>e.jsx("option",{value:U},U))}),e.jsx("datalist",{id:"state-options",children:Vf(f.country).map(U=>e.jsx("option",{value:U},U))})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("h5",{children:"Settings"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Screenshot Interval:"})," ",pt(h.screenshot_interval_minutes)]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:"Monitoring Mode:"})," ",Ho(h.monitoring_mode)]})]})]})}const jS={loading:!0,error:"",data:null};function bS(){var Ye,oe,ve;const[t,a]=o.useState(jS),[s,n]=o.useState(""),[l,r]=o.useState("org"),[i,u]=o.useState("0"),[c,m]=o.useState("0"),[x,f]=o.useState("0"),[j,N]=o.useState("0"),[v,_]=o.useState({}),[C,y]=o.useState({}),[h,p]=o.useState({}),[b,P]=o.useState(""),[$,E]=o.useState(""),[L,V]=o.useState(1),[U,w]=o.useState({org:{pending:{term:"",page:1},paid:{term:"",page:1},rejected:{term:"",page:1}},dealer:{pending:{term:"",page:1},paid:{term:"",page:1},rejected:{term:"",page:1}}}),Q=10;o.useEffect(()=>{let Z=!0;async function ce(){var xe,Ce,Fe,Ze;n("");try{const ne=await z("/api/saas-admin/referrals");if(!Z)return;a({loading:!1,error:"",data:ne}),u(String(((xe=ne.settings)==null?void 0:xe.commission_rate)??0)),m(String(((Ce=ne.settings)==null?void 0:Ce.dealer_commission_rate)??0)),f(String(((Fe=ne.settings)==null?void 0:Fe.dealer_subscription_amount)??0)),N(String(((Ze=ne.settings)==null?void 0:Ze.dealer_referral_flat_amount)??0))}catch(ne){Z&&a({loading:!1,error:(ne==null?void 0:ne.message)||"Unable to load referral data.",data:null})}}return ce(),()=>{Z=!1}},[]),o.useEffect(()=>{const Z=setTimeout(()=>{E(b.trim()),V(1)},300);return()=>clearTimeout(Z)},[b]);const J=((Ye=t.data)==null?void 0:Ye.org_earnings)||[],me=((oe=t.data)==null?void 0:oe.dealer_earnings)||[],re=((ve=t.data)==null?void 0:ve.dealers)||[],K=o.useMemo(()=>J.map(Z=>({...Z,form:v[Z.id]||{status:Z.status,payout_reference:Z.payout_reference||"",payout_date:Z.payout_date||""}})),[J,v]),O=o.useMemo(()=>me.map(Z=>({...Z,form:h[Z.id]||{status:Z.status,payout_reference:Z.payout_reference||"",payout_date:Z.payout_date||""}})),[me,h]),T=o.useMemo(()=>re.map(Z=>({...Z,form:C[Z.id]||{subscription_status:Z.subscription_status,subscription_start:H(Z.subscription_start),subscription_end:H(Z.subscription_end),subscription_amount:Z.subscription_amount??0}})),[re,C]);function H(Z){if(!Z)return"";const ce=String(Z);return ce.includes("T")?ce.split("T")[0]:ce.includes(" ")?ce.split(" ")[0]:ce}const I=o.useMemo(()=>{if(!$)return T;const Z=$.toLowerCase();return T.filter(ce=>{var xe,Ce,Fe,Ze;return[ce.username,ce.email,ce.referral_code,ce.referred_by,(xe=ce.form)==null?void 0:xe.subscription_status,(Ce=ce.form)==null?void 0:Ce.subscription_start,(Fe=ce.form)==null?void 0:Fe.subscription_end,(Ze=ce.form)==null?void 0:Ze.subscription_amount].some(ne=>String(ne||"").toLowerCase().includes(Z))})},[T,$]),S=Math.max(Math.ceil(I.length/Q),1),k=o.useMemo(()=>I.slice((L-1)*Q,L*Q),[I,L]),M=I.length,A=M?(L-1)*Q+1:0,F=M?Math.min(L*Q,M):0;o.useEffect(()=>{L>S&&V(S)},[L,S]);function te(Z,ce,xe){w(Ce=>({...Ce,[Z]:{...Ce[Z],[ce]:{...Ce[Z][ce],...xe}}}))}function Y(Z){const ce={pending:[],paid:[],rejected:[]};return Z.forEach(xe=>{const Ce=String(xe.status||"pending").toLowerCase();Ce==="paid"?ce.paid.push(xe):Ce==="rejected"?ce.rejected.push(xe):ce.pending.push(xe)}),ce}function ue(Z,ce){if(!ce)return Z;const xe=ce.toLowerCase();return Z.filter(Ce=>[Ce.referrer_org,Ce.referred_org,Ce.referrer_dealer,Ce.referred_dealer,Ce.transfer_id,Ce.base_amount,Ce.commission_rate,Ce.commission_amount,Ce.flat_amount,Ce.status,Ce.payout_reference,Ce.payout_date].some(Fe=>String(Fe||"").toLowerCase().includes(xe)))}function he(Z,ce,xe){const Ce=ue(Z,ce),Fe=Math.max(Math.ceil(Ce.length/Q),1),Ze=Math.min(xe,Fe),ne=(Ze-1)*Q,Ie=Ce.slice(ne,ne+Q);return{filtered:Ce,paged:Ie,totalPages:Fe,currentPage:Ze,startIndex:ne}}const ye=o.useMemo(()=>Y(K),[K]),G=o.useMemo(()=>Y(O),[O]);function Ne(Z,ce,xe){const Ce=U.org[xe],{filtered:Fe,paged:Ze,totalPages:ne,currentPage:Ie,startIndex:Oe}=he(Z,Ce.term,Ce.page);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:ce}),e.jsxs("label",{className:"table-search",htmlFor:`referrals-org-${xe}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`referrals-org-${xe}-search`,type:"text",value:Ce.term,onChange:Me=>te("org",xe,{term:Me.target.value,page:1}),placeholder:"Search"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Referrer"}),e.jsx("th",{children:"Referred Org"}),e.jsx("th",{children:"Transfer"}),e.jsx("th",{children:"Base Amount"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:Ze.length?Ze.map(Me=>e.jsxs("tr",{children:[e.jsx("td",{children:Me.referrer_org||"-"}),e.jsx("td",{children:Me.referred_org||"-"}),e.jsx("td",{children:Me.transfer_id||"-"}),e.jsx("td",{children:Me.base_amount??"-"}),e.jsxs("td",{children:[Me.commission_rate??0,"%"]}),e.jsx("td",{children:Me.commission_amount??"-"}),e.jsx("td",{children:e.jsxs("select",{className:"form-select form-select-sm",value:Me.form.status||"pending",onChange:st=>de(Me.id,"status",st.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"form-control form-control-sm",value:Me.form.payout_reference||"",onChange:st=>de(Me.id,"payout_reference",st.target.value),placeholder:"Ref: 251245"})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"form-control form-control-sm",value:Me.form.payout_date||"",onChange:st=>de(Me.id,"payout_date",st.target.value)})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-outline-light btn-sm",type:"button",onClick:()=>Qe(Me),children:"Update"})})]},Me.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",children:"No referrals found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Fe.length?Oe+1:0," to ",Math.min(Oe+Q,Fe.length)," of"," ",Fe.length," entries"]}),e.jsx(He,{page:Ie,totalPages:ne,onPageChange:Me=>te("org",xe,{page:Me}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function _e(Z,ce,xe){const Ce=U.dealer[xe],{filtered:Fe,paged:Ze,totalPages:ne,currentPage:Ie,startIndex:Oe}=he(Z,Ce.term,Ce.page);return e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h6",{className:"mb-0",children:ce}),e.jsxs("label",{className:"table-search",htmlFor:`referrals-dealer-${xe}-search`,children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:`referrals-dealer-${xe}-search`,type:"text",value:Ce.term,onChange:Me=>te("dealer",xe,{term:Me.target.value,page:1}),placeholder:"Search"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Referrer"}),e.jsx("th",{children:"Referred Org"}),e.jsx("th",{children:"Referred Dealer"}),e.jsx("th",{children:"Transfer"}),e.jsx("th",{children:"Base"}),e.jsx("th",{children:"Rate"}),e.jsx("th",{children:"Commission"}),e.jsx("th",{children:"Flat"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Payout Ref"}),e.jsx("th",{children:"Payout Date"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:Ze.length?Ze.map(Me=>e.jsxs("tr",{children:[e.jsx("td",{children:Me.referrer_dealer||"-"}),e.jsx("td",{children:Me.referred_org||"-"}),e.jsx("td",{children:Me.referred_dealer||"-"}),e.jsx("td",{children:Me.transfer_id||"-"}),e.jsx("td",{children:Me.base_amount??"-"}),e.jsxs("td",{children:[Me.commission_rate??0,"%"]}),e.jsx("td",{children:Me.commission_amount??"-"}),e.jsx("td",{children:Me.flat_amount??"-"}),e.jsx("td",{children:e.jsxs("select",{className:"form-select form-select-sm",value:Me.form.status||"pending",onChange:st=>je(Me.id,"status",st.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"form-control form-control-sm",value:Me.form.payout_reference||"",onChange:st=>je(Me.id,"payout_reference",st.target.value),placeholder:"Ref: 251245"})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"form-control form-control-sm",value:Me.form.payout_date||"",onChange:st=>je(Me.id,"payout_date",st.target.value)})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-outline-light btn-sm",type:"button",onClick:()=>Je(Me),children:"Update"})})]},Me.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"12",children:"No referrals found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",Fe.length?Oe+1:0," to ",Math.min(Oe+Q,Fe.length)," of"," ",Fe.length," entries"]}),e.jsx(He,{page:Ie,totalPages:ne,onPageChange:Me=>te("dealer",xe,{page:Me}),showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})}function de(Z,ce,xe){_(Ce=>({...Ce,[Z]:{...Ce[Z]||{},[ce]:xe}}))}function Re(Z,ce,xe){y(Ce=>({...Ce,[Z]:{...Ce[Z]||{},[ce]:xe}}))}function je(Z,ce,xe){p(Ce=>({...Ce,[Z]:{...Ce[Z]||{},[ce]:xe}}))}async function Ae(Z){Z.preventDefault(),n("");try{const ce=await z("/api/saas-admin/referrals/settings",{method:"POST",body:JSON.stringify({commission_rate:i,dealer_commission_rate:c,dealer_subscription_amount:x,dealer_referral_flat_amount:j})});n("Referral commission updated."),u(String(ce.commission_rate??0)),m(String(ce.dealer_commission_rate??0)),f(String(ce.dealer_subscription_amount??0)),N(String(ce.dealer_referral_flat_amount??0))}catch(ce){n(""),a(xe=>({...xe,error:(ce==null?void 0:ce.message)||"Unable to update commission rate."}))}}async function Qe(Z){n("");try{const ce=Z.form||{};await z(`/api/saas-admin/referrals/earnings/${Z.id}`,{method:"POST",body:JSON.stringify(ce)}),n("Referral payout updated."),_(Ce=>{const Fe={...Ce};return delete Fe[Z.id],Fe});const xe=await z("/api/saas-admin/referrals");a({loading:!1,error:"",data:xe})}catch(ce){n(""),a(xe=>({...xe,error:(ce==null?void 0:ce.message)||"Unable to update payout."}))}}async function qe(Z){n("");try{await z(`/api/saas-admin/referrals/dealers/${Z.id}`,{method:"POST",body:JSON.stringify(Z.form||{})}),n("Dealer subscription updated."),y(xe=>{const Ce={...xe};return delete Ce[Z.id],Ce});const ce=await z("/api/saas-admin/referrals");a({loading:!1,error:"",data:ce})}catch(ce){n(""),a(xe=>({...xe,error:(ce==null?void 0:ce.message)||"Unable to update dealer subscription."}))}}async function Je(Z){n("");try{const ce=Z.form||{};await z(`/api/saas-admin/referrals/dealer-earnings/${Z.id}`,{method:"POST",body:JSON.stringify(ce)}),n("Dealer payout updated."),p(Ce=>{const Fe={...Ce};return delete Fe[Z.id],Fe});const xe=await z("/api/saas-admin/referrals");a({loading:!1,error:"",data:xe})}catch(ce){n(""),a(xe=>({...xe,error:(ce==null?void 0:ce.message)||"Unable to update dealer payout."}))}}return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading referrals..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Referral Program"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsx("h5",{children:"Referral Commission Settings"}),e.jsxs("form",{onSubmit:Ae,className:"referral-settings-grid",children:[e.jsxs("div",{className:"referral-settings-field",children:[e.jsx("label",{className:"form-label",children:"ORG Commission Rate (%)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"form-control",value:i,onChange:Z=>u(Z.target.value)})]}),e.jsxs("div",{className:"referral-settings-field",children:[e.jsx("label",{className:"form-label",children:"Dealer Commission Rate (%)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"form-control",value:c,onChange:Z=>m(Z.target.value)})]}),e.jsxs("div",{className:"referral-settings-field",children:[e.jsx("label",{className:"form-label",children:"Dealer Subscription Amount (Yearly)"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"form-control",value:x,onChange:Z=>f(Z.target.value)})]}),e.jsxs("div",{className:"referral-settings-field",children:[e.jsx("label",{className:"form-label",children:"Dealer Referral Flat Amount"}),e.jsx("input",{type:"number",min:"0",step:"0.01",className:"form-control",value:j,onChange:Z=>N(Z.target.value)})]}),e.jsx("div",{className:"referral-settings-action",children:e.jsx("button",{className:"btn btn-primary w-100",type:"submit",children:"Save"})})]})]}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mb-3",children:[e.jsx("button",{type:"button",className:`btn btn-sm ${l==="org"?"btn-primary":"btn-outline-light"}`,onClick:()=>r("org"),children:"ORG Accounts"}),e.jsx("button",{type:"button",className:`btn btn-sm ${l==="dealer"?"btn-primary":"btn-outline-light"}`,onClick:()=>r("dealer"),children:"Dealer Accounts"})]}),l==="org"?e.jsxs(e.Fragment,{children:[Ne(ye.pending,"Pending Payments","pending"),Ne(ye.paid,"Completed Payments","paid"),Ne(ye.rejected,"Rejected Payments","rejected")]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsx("h5",{children:"Dealer Subscriptions"}),e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-length",children:["Show ",Q," entries"]}),e.jsxs("label",{className:"table-search",htmlFor:"saas-dealer-sub-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-dealer-sub-search",type:"text",value:b,onChange:Z=>P(Z.target.value),placeholder:"Search dealers"})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Dealer"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Referral Code"}),e.jsx("th",{children:"Referred By"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:k.length?k.map(Z=>e.jsxs("tr",{children:[e.jsx("td",{children:Z.username}),e.jsx("td",{children:Z.email||"-"}),e.jsx("td",{children:Z.referral_code||"-"}),e.jsx("td",{children:Z.referred_by||"-"}),e.jsx("td",{children:e.jsxs("select",{className:"form-select form-select-sm",value:Z.form.subscription_status||"pending",onChange:ce=>Re(Z.id,"subscription_status",ce.target.value),children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"expired",children:"Expired"})]})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"form-control form-control-sm",value:Z.form.subscription_start||"",onChange:ce=>Re(Z.id,"subscription_start",ce.target.value)})}),e.jsx("td",{children:e.jsx("input",{type:"date",className:"form-control form-control-sm",value:Z.form.subscription_end||"",onChange:ce=>Re(Z.id,"subscription_end",ce.target.value)})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"form-control form-control-sm",value:Z.form.subscription_amount??0,onChange:ce=>Re(Z.id,"subscription_amount",ce.target.value)})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-outline-light btn-sm",type:"button",onClick:()=>qe(Z),children:"Update"})})]},Z.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",children:"No dealers found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",A," to ",F," of ",M," entries"]}),e.jsx(He,{page:L,totalPages:S,onPageChange:V,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),_e(G.pending,"Pending Payments","pending"),_e(G.paid,"Completed Payments","paid"),_e(G.rejected,"Rejected Payments","rejected")]})]})}const yS={loading:!0,error:"",data:null},vS=Fs;function NS(){var p;const[t,a]=o.useState(yS),[s,n]=o.useState(""),[l,r]=o.useState(""),[i,u]=o.useState("+91"),[c,m]=o.useState(""),[x,f]=o.useState(""),[j,N]=o.useState(""),[v,_]=o.useState("");o.useEffect(()=>{let b=!0;async function P(){var $,E;n("");try{const L=await z("/api/dashboard/profile");if(!b)return;a({loading:!1,error:"",data:L}),r((($=L.user)==null?void 0:$.email)||""),u(L.phone_country||"+91"),m(L.phone_number||"")}catch(L){if((E=L==null?void 0:L.data)!=null&&E.redirect){window.location.href=L.data.redirect;return}b&&a({loading:!1,error:(L==null?void 0:L.message)||"Unable to load profile.",data:null})}}return P(),()=>{b=!1}},[]);async function C(b){b.preventDefault(),n("");try{await z("/api/dashboard/profile/email",{method:"POST",body:JSON.stringify({email:l,phone_country:i,phone_number:c})}),n("Profile updated successfully.")}catch(P){a($=>({...$,error:(P==null?void 0:P.message)||"Unable to update profile."}))}}async function y(b){b.preventDefault(),n("");try{await z("/api/dashboard/profile/password",{method:"POST",body:JSON.stringify({current_password:x,new_password:j,confirm_password:v})}),n("Password updated successfully."),f(""),N(""),_("")}catch(P){a($=>({...$,error:(P==null?void 0:P.message)||"Unable to update password."}))}}if(t.loading)return e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading profile..."})]});const h=((p=t.data)==null?void 0:p.user)||{};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Profile"}),e.jsx("hr",{className:"section-divider"}),s?e.jsx("div",{className:"alert alert-success",children:s}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Account"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Username:"})," ",h.username||"-"]}),e.jsxs("form",{className:"mt-3",onSubmit:C,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:l,onChange:b=>r(b.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Mobile Number"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",value:i,onChange:b=>u(b.target.value),style:{maxWidth:"170px"},children:vS.map(b=>e.jsxs("option",{value:b.code,children:[b.label," ",b.code]},`${b.code}-${b.label}`))}),e.jsx("input",{type:"tel",className:"form-control",value:c,onChange:b=>m(b.target.value),placeholder:"Phone number"})]})]}),e.jsx("button",{className:"btn btn-primary btn-sm",children:"Update Details"})]})]})}),e.jsx("div",{className:"col-12 col-lg-6",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Update Password"}),e.jsxs("form",{onSubmit:y,children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Current Password"}),e.jsx("input",{type:"password",className:"form-control",value:x,onChange:b=>f(b.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsx("input",{type:"password",className:"form-control",value:j,onChange:b=>N(b.target.value),required:!0})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{className:"form-label",children:"Confirm New Password"}),e.jsx("input",{type:"password",className:"form-control",value:v,onChange:b=>_(b.target.value),required:!0})]}),e.jsx("button",{className:"btn btn-warning btn-sm",children:"Update Password"})]})]})})]})]})}const _S={grace_days:30,archive_days:60,hard_delete_days:0};function SS(){const[t,a]=o.useState(!0),[s,n]=o.useState(!1),[l,r]=o.useState(""),[i,u]=o.useState(""),[c,m]=o.useState(""),[x,f]=o.useState(_S);o.useEffect(()=>{let N=!0;async function v(){a(!0),r("");try{const _=await z("/api/saas-admin/settings/retention-policy");if(!N)return;f({grace_days:Number(_.grace_days??30),archive_days:Number(_.archive_days??60),hard_delete_days:Number(_.hard_delete_days??0)}),m(_.updated_at||"")}catch(_){N&&r((_==null?void 0:_.message)||"Unable to load retention policy.")}finally{N&&a(!1)}}return v(),()=>{N=!1}},[]);async function j(){n(!0),r(""),u("");try{const N={grace_days:Number(x.grace_days||0),archive_days:Number(x.archive_days||0),hard_delete_days:Number(x.hard_delete_days||0)},v=await z("/api/saas-admin/settings/retention-policy",{method:"PUT",body:JSON.stringify(N)});m(v.updated_at||new Date().toISOString()),u("Retention policy saved.")}catch(N){r((N==null?void 0:N.message)||"Unable to save retention policy.")}finally{n(!1)}}return e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-0",children:"Retention Policy"}),e.jsx("div",{className:"text-secondary small",children:"Applies to all products and organizations."})]}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:j,disabled:s||t,children:s?"Saving...":"Save"})]}),t?e.jsx("div",{className:"text-secondary mt-2",children:"Loading..."}):null,l?e.jsx("div",{className:"alert alert-danger mt-2",children:l}):null,i?e.jsx("div",{className:"alert alert-success mt-2",children:i}):null,c?e.jsxs("div",{className:"text-secondary small mt-2",children:["Last updated: ",c]}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Grace Days"}),e.jsx("input",{type:"number",min:"0",value:x.grace_days,onChange:N=>f(v=>({...v,grace_days:N.target.value}))}),e.jsx("div",{className:"text-secondary small",children:"After plan expiry, organization is read-only until this ends."})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Archive Days"}),e.jsx("input",{type:"number",min:"0",value:x.archive_days,onChange:N=>f(v=>({...v,archive_days:N.target.value}))}),e.jsx("div",{className:"text-secondary small",children:"After grace period, organization is archived and cannot log in."})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"modal-form-field",children:[e.jsx("label",{children:"Hard Delete Days"}),e.jsx("input",{type:"number",min:"0",value:x.hard_delete_days,onChange:N=>f(v=>({...v,hard_delete_days:N.target.value}))}),e.jsx("div",{className:"text-secondary small",children:"Optional permanent deletion after archive. 0 means never delete."})]})})]})]})}const wS={loading:!0,error:"",folders:[],basePrefix:"",storageMode:"local",items:[],isTruncated:!1,nextToken:null,currentPrefix:""},CS=[{value:"all",label:"All"},{value:"images",label:"Images"},{value:"documents",label:"Documents"}];function kS(t){if(!t)return"0 B";const a=["B","KB","MB","GB","TB"];let s=t,n=0;for(;s>=1024&&n<a.length-1;)s/=1024,n+=1;return`${s.toFixed(s>=10||n===0?0:1)} ${a[n]}`}function Hc({scope:t,embedded:a=!1,hideTabs:s=!1,initialCategory:n="screenshots",showTabs:l=!1}){const[r,i]=o.useState(wS),[u,c]=o.useState(""),[m,x]=o.useState(""),[f,j]=o.useState(""),[N,v]=o.useState("all"),[_,C]=o.useState([]),[y,h]=o.useState(null),[p,b]=o.useState(new Set),[P,$]=o.useState({open:!1,message:"",onConfirm:null}),[E,L]=o.useState(""),[V,U]=o.useState(""),[w,Q]=o.useState(null),[J,me]=o.useState([{key:"screenshots",label:"Screenshots"},{key:"ai_media_library",label:"AI Media Library"},{key:"payments",label:"Payments"}]),[re,K]=o.useState(n),O=t==="saas",T=re!=="screenshots";o.useEffect(()=>{let G=!0;async function Ne(){i(_e=>({..._e,loading:!0,error:""}));try{const _e=new URLSearchParams;re&&_e.set("category",re),O&&V&&_e.set("org_id",V);const de=await z(`/api/storage/media/folders?${_e.toString()}`);if(!G)return;i(Re=>({...Re,loading:!1,error:"",folders:de.folders||[],basePrefix:de.base_prefix||"",storageMode:de.storage_mode||"object"})),de.categories&&Array.isArray(de.categories)&&me(de.categories),x(de.base_prefix||""),C([]),h(null),b(new Set)}catch(_e){if(!G)return;i(de=>({...de,loading:!1,error:(_e==null?void 0:_e.message)||"Unable to load folders."}))}}return Ne(),()=>{G=!1}},[O,V,re]),o.useEffect(()=>{let G=!0;async function Ne(){if(r.storageMode==="object"){i(_e=>({..._e,error:""}));try{const _e=new URLSearchParams;m&&_e.set("folder",m),f&&_e.set("q",f),N&&_e.set("type",N),_e.set("limit","25"),y&&_e.set("continuation_token",y),re&&_e.set("category",re),O&&V&&_e.set("org_id",V);const de=await z(`/api/storage/media/objects?${_e.toString()}`);if(!G)return;i(Re=>({...Re,items:de.items||[],isTruncated:!!de.is_truncated,nextToken:de.next_token||null,currentPrefix:de.current_prefix||m})),b(new Set)}catch(_e){if(!G)return;i(de=>({...de,error:(_e==null?void 0:_e.message)||"Unable to load objects."}))}}}return(m||r.basePrefix)&&Ne(),()=>{G=!1}},[m,f,N,y,O,V,re,r.storageMode,r.basePrefix]);const H=o.useMemo(()=>{if(!u)return r.folders;const G=u.toLowerCase();return r.folders.filter(Ne=>{const _e=String(Ne.name||"").toLowerCase(),de=String(Ne.prefix||"").toLowerCase();return _e.includes(G)||de.includes(G)})},[u,r.folders]),I=G=>{b(Ne=>{const _e=new Set(Ne);return _e.has(G)?_e.delete(G):_e.add(G),_e})},S=()=>{b(new Set(r.items.map(G=>G.key)))},k=()=>{b(new Set)},M=async G=>{try{await navigator.clipboard.writeText(G),L("Copied.")}catch{L("Copy failed.")}},A=async G=>{try{const Ne=new URLSearchParams;Ne.set("key",G),re&&Ne.set("category",re),O&&V&&Ne.set("org_id",V);const _e=await z(`/api/storage/media/signed-url?${Ne.toString()}`);_e!=null&&_e.url&&window.open(_e.url,"_blank","noopener")}catch(Ne){L((Ne==null?void 0:Ne.message)||"Unable to open file.")}},F=async G=>{try{const Ne=new URLSearchParams;Ne.set("key",G),re&&Ne.set("category",re),O&&V&&Ne.set("org_id",V);const _e=await z(`/api/storage/media/signed-url?${Ne.toString()}`);_e!=null&&_e.url&&await M(_e.url)}catch(Ne){L((Ne==null?void 0:Ne.message)||"Unable to copy URL.")}},te=G=>{$({open:!0,message:`Delete ${G.length} file(s)? This cannot be undone.`,onConfirm:()=>Y(G)})},Y=async G=>{$({open:!1,message:"",onConfirm:null});try{G.length===1?await z("/api/storage/media/object",{method:"DELETE",body:JSON.stringify({key:G[0],org_id:O&&V?V:void 0,category:re})}):await z("/api/storage/media/bulk-delete",{method:"POST",body:JSON.stringify({keys:G,org_id:O&&V?V:void 0,category:re})}),L("Deleted successfully."),b(new Set),h(null)}catch(Ne){L((Ne==null?void 0:Ne.message)||"Delete failed.")}},ue=()=>{r.nextToken&&(C(G=>[...G,y]),h(r.nextToken))},he=()=>{C(G=>{if(!G.length)return G;const Ne=[...G],_e=Ne.pop();return h(_e||null),Ne})},ye=l&&!s&&!a;return e.jsxs("div",{className:`${a?"":"page-shell"} media-library`,children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Media Library"}),e.jsx("p",{className:"text-secondary mb-0",children:"Browse files stored in object storage."})]}),E?e.jsx("div",{className:"alert alert-info mb-0",children:E}):null]}),r.storageMode!=="object"?e.jsx("div",{className:"alert alert-warning mt-3",children:"Switch to Object Storage to use Media Library."}):null,r.error?e.jsx("div",{className:"alert alert-danger mt-3",children:r.error}):null,ye?e.jsx("div",{className:"d-flex flex-wrap gap-2 mt-3",children:J.map(G=>e.jsx("button",{type:"button",className:`btn btn-sm ${re===G.key?"btn-primary":"btn-outline-light"}`,onClick:()=>{K(G.key),x(""),h(null),C([])},children:G.label},G.key))}):null,e.jsxs("div",{className:`row g-3 mt-2 ${a?"mt-3":""}`,children:[e.jsx("div",{className:"col-12 col-lg-2",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h6",{className:"mb-0",children:"Folders"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>c(""),children:"Clear"})]}),e.jsx("input",{type:"text",className:"form-control mb-2",placeholder:"Search folders",value:u,onChange:G=>c(G.target.value)}),e.jsx("div",{className:"list-group media-library-folders",children:J.map(G=>{const Ne=w===G.key,_e=re===G.key;return e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:`list-group-item list-group-item-action d-flex align-items-center justify-content-between media-library-folder__category ${_e?"active":""} ${Ne?"is-open":""}`,onClick:()=>{K(G.key),x(""),h(null),C([]),Q(de=>de===G.key?null:G.key)},children:[e.jsx("span",{children:G.label}),e.jsx("span",{className:"media-library-folder__icon",children:Ne?"-":"+"})]}),Ne?e.jsxs(e.Fragment,{children:[e.jsx("button",{type:"button",className:`list-group-item list-group-item-action media-library-folder__item ${m===r.basePrefix?"active":""}`,onClick:()=>{x(r.basePrefix),h(null),C([])},children:"All"}),H.filter(de=>{const Re=String(de.name||"").toLowerCase(),je=/^[0-9]+$/.test(Re),Ae=/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/.test(Re);return je||Ae}).map(de=>e.jsx("button",{type:"button",className:`list-group-item list-group-item-action media-library-folder__item ${m===de.prefix?"active":""}`,onClick:()=>{x(de.prefix),h(null),C([])},children:de.name},de.prefix))]}):null]},G.key)})})]})}),e.jsx("div",{className:"col-12 col-lg-10",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex flex-wrap gap-2 align-items-end mb-2",children:[e.jsxs("div",{className:"flex-grow-1",style:{minWidth:"240px"},children:[e.jsx("label",{className:"form-label",children:"Search files"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search by filename or key",value:f,onChange:G=>j(G.target.value)})]}),e.jsxs("div",{style:{minWidth:"120px"},children:[e.jsx("label",{className:"form-label",children:"Type"}),e.jsx("select",{className:"form-select",value:N,onChange:G=>v(G.target.value),children:CS.map(G=>e.jsx("option",{value:G.value,children:G.label},G.value))})]}),O?e.jsxs("div",{style:{minWidth:"140px"},children:[e.jsx("label",{className:"form-label",children:"Org ID"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Org ID",value:V,onChange:G=>U(G.target.value)})]}):null,e.jsxs("div",{style:{minWidth:"180px"},children:[e.jsx("label",{className:"form-label",children:"Actions"}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:S,children:"Select All"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:k,children:"Clear"})]})]})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"40px"}}),e.jsx("th",{children:"Full Key"}),e.jsx("th",{style:{width:"70px"},children:"Size"}),e.jsx("th",{style:{minWidth:"140px",whiteSpace:"nowrap"},children:"Content Type"}),e.jsx("th",{style:{minWidth:"180px",whiteSpace:"nowrap"},children:"Last Modified"}),e.jsx("th",{style:{minWidth:"200px"},children:"Actions"})]})}),e.jsx("tbody",{children:r.items.length?r.items.map(G=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:p.has(G.key),onChange:()=>I(G.key)})}),e.jsx("td",{className:"text-secondary small",children:G.key}),e.jsx("td",{children:kS(G.size)}),e.jsx("td",{children:G.content_type_guess||"-"}),e.jsx("td",{children:G.last_modified||"-"}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2 flex-nowrap",children:[T?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>A(G.key),disabled:r.storageMode!=="object",children:"View"}):null,e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>M(G.key),disabled:r.storageMode!=="object",children:"Copy Key"}),T?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>F(G.key),disabled:r.storageMode!=="object",children:"Copy URL"}):null,e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>te([G.key]),disabled:r.storageMode!=="object",children:"Delete"})]})})]},G.key)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center text-secondary",children:"No files found."})})})]})}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",disabled:!_.length,onClick:he,children:"Prev"}),e.jsxs("div",{className:"text-secondary small",children:[r.items.length," items"]}),e.jsx("button",{type:"button",className:"btn btn-outline-light",disabled:!r.isTruncated,onClick:ue,children:"Next"})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-danger",disabled:!p.size||r.storageMode!=="object",onClick:()=>te(Array.from(p)),children:"Delete Selected"})})]})})]}),P.open?e.jsx("div",{className:"modal-overlay",onClick:()=>$({open:!1,message:"",onConfirm:null}),children:e.jsxs("div",{className:"modal-panel",onClick:G=>G.stopPropagation(),children:[e.jsx("h5",{children:"Confirm"}),e.jsx("div",{className:"text-secondary mb-3",children:P.message}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>$({open:!1,message:"",onConfirm:null}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:()=>P.onConfirm&&P.onConfirm(),children:"Delete"})]})]})}):null]})}const PS={loading:!0,error:"",saving:!1,storage_mode:"local",endpoint_url:"",bucket_name:"",access_key_id:"",secret_access_key:"",region_name:"",base_path:"",updated_at:"",has_secret_access_key:!1};function TS(){const[t,a]=o.useState(PS),[s,n]=o.useState(""),[l,r]=o.useState(""),[i,u]=o.useState(""),[c,m]=o.useState(null),[x,f]=o.useState(!1),[j,N]=o.useState({open:!1,message:"",resolve:null});o.useEffect(()=>{let b=!0;return(async()=>{try{const $=await z("/api/saas-admin/settings/media-storage");if(!b)return;a(E=>({...E,loading:!1,error:"",storage_mode:$.storage_mode||"local",endpoint_url:$.endpoint_url||"",bucket_name:$.bucket_name||"",access_key_id:$.access_key_id||"",region_name:$.region_name||"",base_path:$.base_path||"",updated_at:$.updated_at||"",has_secret_access_key:!!$.has_secret_access_key}))}catch($){if(!b)return;a(E=>({...E,loading:!1,error:($==null?void 0:$.message)||"Unable to load storage settings."}))}})(),()=>{b=!1}},[]);const v=b=>P=>{const $=P.target.value;a(E=>({...E,[b]:$}))},_=async()=>{n(""),r(""),a(b=>({...b,saving:!0,error:""}));try{const b={storage_mode:t.storage_mode,endpoint_url:t.endpoint_url,bucket_name:t.bucket_name,access_key_id:t.access_key_id,secret_access_key:t.secret_access_key,region_name:t.region_name,base_path:t.base_path},P=await z("/api/saas-admin/settings/media-storage",{method:"PUT",body:JSON.stringify(b)});a($=>({...$,saving:!1,error:"",secret_access_key:"",updated_at:P.updated_at||$.updated_at,has_secret_access_key:!!P.has_secret_access_key})),n("Storage settings saved.")}catch(b){a(P=>({...P,saving:!1,error:(b==null?void 0:b.message)||"Unable to save."}))}},C=b=>new Promise(P=>{N({open:!0,message:b,resolve:P})}),y=b=>{N(P=>(P.resolve&&P.resolve(b),{open:!1,message:"",resolve:null}))};o.useEffect(()=>{if(!i)return;let b=!0;const P=async()=>{try{const E=await z(`/api/saas-admin/settings/media-storage/pull-local/status/${i}`);if(!b)return;m(L=>L&&!E.total_files&&L.total_files?{...E,total_files:L.total_files}:E),(E.status==="completed"||E.status==="failed")&&u("")}catch(E){if(!b)return;m(L=>({...L||{},status:"failed",error_message:(E==null?void 0:E.message)||"Unable to load status."})),u("")}};P();const $=setInterval(P,1500);return()=>{b=!1,clearInterval($)}},[i]);const h=async()=>{if(n(""),r(""),t.storage_mode!=="object"){r("Switch to Online Object Storage before pulling local files.");return}try{const b=await z("/api/saas-admin/settings/media-storage/pull-local/preview",{method:"POST",body:JSON.stringify({})});if(!b.total){r("No local files found to pull.");return}let P=!1;if(b.partial&&!await C(`Validated only ${b.checked} files out of ${b.total}. Continue with pull?`))return;if(b.existing){if(!await C(`Found ${b.existing} files already in object storage. Pull again and overwrite?`))return;P=!0}const $=await C("Delete local media files after successful pull?"),E=await z("/api/saas-admin/settings/media-storage/pull-local/start",{method:"POST",body:JSON.stringify({overwrite:P,delete_local:$})});m({status:"pending",total_files:b.total||0,existing_files:b.existing||0,copied_files:0,skipped_files:0,file_type_counts:{},current_path:""}),f(!0),u(E.job_id||"")}catch(b){r((b==null?void 0:b.message)||"Unable to pull local files.")}},p=t.storage_mode==="object";return e.jsxs("div",{className:"page-shell",children:[e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"d-flex align-items-start justify-content-between gap-3 flex-wrap",children:e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Media Storage"}),e.jsx("p",{className:"text-secondary mb-0",children:"Global storage mode for all products and organizations."}),t.updated_at?e.jsxs("div",{className:"text-secondary small mt-2",children:["Last updated: ",t.updated_at]}):null]})}),t.error?e.jsx("div",{className:"alert alert-danger mt-3",children:t.error}):null,s?e.jsx("div",{className:"alert alert-success mt-3",children:s}):null,l?e.jsx("div",{className:"alert alert-info mt-3",children:l}):null,e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Storage Mode"}),e.jsxs("select",{className:"form-select",value:t.storage_mode,onChange:v("storage_mode"),children:[e.jsx("option",{value:"local",children:"Local (server disk)"}),e.jsx("option",{value:"object",children:"Online Object Storage (Backblaze/S3)"})]}),e.jsx("div",{className:"text-secondary small mt-1",children:"Local stores screenshots inside the server. Object storage pushes files to S3-compatible buckets."})]}),p?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Endpoint URL"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"https://s3.us-west-004.backblazeb2.com",value:t.endpoint_url,onChange:v("endpoint_url")}),e.jsx("div",{className:"text-secondary small mt-1",children:"Backblaze B2 or other S3 endpoint."})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Bucket Name"}),e.jsx("input",{type:"text",className:"form-control",value:t.bucket_name,onChange:v("bucket_name")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Access Key ID"}),e.jsx("input",{type:"text",className:"form-control",value:t.access_key_id,onChange:v("access_key_id")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Secret Access Key"}),e.jsx("input",{type:"password",className:"form-control",placeholder:t.has_secret_access_key?"Stored (leave blank to keep)":"",value:t.secret_access_key,onChange:v("secret_access_key")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Region"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"us-west-004",value:t.region_name,onChange:v("region_name")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Base Path (Optional prefix inside the bucket)"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"screenshots/",value:t.base_path,onChange:v("base_path")})]})]}):null,e.jsxs("div",{className:"col-12 col-md-6 col-xl-3 d-flex align-items-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-success",onClick:_,disabled:t.saving,children:t.saving?"Saving...":"Save Data"}),e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:h,disabled:t.saving,children:"Pull Local Media"})]})]})]}),x&&c?e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-3 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:"Pulling Local Media"}),e.jsx("div",{className:"text-secondary",children:c.status==="failed"?"Failed to pull files.":c.status==="completed"?"Pull completed.":"Transfer in progress..."}),c.finished_at?e.jsxs("div",{className:"text-secondary small mt-1",children:["Completed at: ",c.finished_at]}):null]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>f(!1),children:"Close"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("strong",{children:(c.copied_files||0)+(c.skipped_files||0)})," /"," ",e.jsx("strong",{children:c.total_files||0})," files processed"]}),e.jsx("div",{className:"progress mb-2",style:{height:"8px"},children:e.jsx("div",{className:"progress-bar bg-success",style:{width:c.total_files?`${Math.min(100,Math.round(((c.copied_files||0)+(c.skipped_files||0))/c.total_files*100))}%`:"0%"}})}),e.jsxs("div",{className:"text-secondary small",children:["Current: ",c.current_path||"-"]}),e.jsxs("div",{className:"text-secondary small mt-1",children:["Uploaded: ",c.copied_files||0," | Skipped: ",c.skipped_files||0]}),c.status==="completed"?e.jsxs("div",{className:"text-secondary small mt-2",children:[Object.keys(c.file_type_counts||{}).length?Object.entries(c.file_type_counts).map(([b,P])=>e.jsxs("span",{className:"me-2",children:[b.toUpperCase()," ",P," files"]},b)):null,c.copied_files?`Total ${c.copied_files} media updated`:null]}):null,c.error_message?e.jsx("div",{className:"alert alert-danger mt-2",children:c.error_message}):null]})]}):null,e.jsx("div",{className:"mt-4",children:e.jsx(Hc,{scope:"saas",embedded:!0,hideTabs:!0,initialCategory:"screenshots",showTabs:!1})}),j.open?e.jsx("div",{className:"modal-overlay",onClick:()=>y(!1),children:e.jsxs("div",{className:"modal-panel",onClick:b=>b.stopPropagation(),children:[e.jsx("h5",{children:"Confirm"}),e.jsx("div",{className:"text-secondary mb-3",children:j.message}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>y(!1),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-success",onClick:()=>y(!0),children:"OK"})]})]})}):null]})}const ES={loading:!0,error:"",data:null};function It(t){return t==null||t===""?"-":t}function AS(){var re,K,O,T,H,I,S,k,M,A,F,te,Y,ue,he,ye,G,Ne,_e;const[t,a]=o.useState(ES),[s,n]=o.useState(""),[l,r]=o.useState(""),[i,u]=o.useState(1),[c,m]=o.useState(""),[x,f]=o.useState(""),[j,N]=o.useState(1),[v,_]=o.useState({open:!1,row:null}),[C,y]=o.useState(""),[h,p]=o.useState(""),b=o.useRef(null),P=o.useRef(null),$=o.useRef(null),E=o.useRef(null),L=10;o.useEffect(()=>{let de=!0;async function Re(){try{const je=await z("/api/saas-admin/billing-history");de&&a({loading:!1,error:"",data:je})}catch(je){de&&a({loading:!1,error:(je==null?void 0:je.message)||"Unable to load billing history.",data:null})}}return Re(),()=>{de=!1}},[]),o.useEffect(()=>{const de=setTimeout(()=>{r(s.trim()),u(1)},300);return()=>clearTimeout(de)},[s]),o.useEffect(()=>{const de=setTimeout(()=>{f(c.trim()),N(1)},300);return()=>clearTimeout(de)},[c]);const V=t.data||{},U=V.transfers||[],w=V.subscriptions||[],Q=V.available_months||[];o.useEffect(()=>{if(!Q.length){y(""),p("");return}y(de=>de||Q[0]),p(de=>de||Q[Q.length-1])},[Q]),o.useEffect(()=>{if(!window.flatpickr)return;const de=Q.map(je=>`${je}-01`),Re={wrap:!0,altInput:!0,altFormat:"M Y",dateFormat:"Y-m-d",altInputClass:"date-input flatpickr-input",enable:de,allowInput:!1,disableMobile:!0};b.current&&!$.current&&($.current=window.flatpickr(b.current,{...Re,onChange:(je,Ae)=>{y(Ae?Ae.slice(0,7):"")}})),P.current&&!E.current&&(E.current=window.flatpickr(P.current,{...Re,onChange:(je,Ae)=>{p(Ae?Ae.slice(0,7):"")}})),$.current&&($.current.set("enable",de),C?$.current.setDate(`${C}-01`,!1):$.current.clear()),E.current&&(E.current.set("enable",de),h?E.current.setDate(`${h}-01`,!1):E.current.clear())},[Q,C,h]),o.useEffect(()=>()=>{$.current&&$.current.destroy(),E.current&&E.current.destroy()},[]);const J=o.useMemo(()=>{const Re=((Je,Ye)=>{if(!Ye)return Je;const oe=Ye.toLowerCase();return Je.filter(ve=>[ve.organization,ve.owner_name,ve.owner_email,ve.product,ve.request_type,ve.billing_cycle,ve.plan,ve.amount,ve.currency,ve.status,ve.paid_on,ve.reference_no,ve.created_at,ve.updated_at].some(Z=>String(Z||"").toLowerCase().includes(oe)))})(U,l),je=Math.max(Math.ceil(Re.length/L),1),Ae=Math.min(i,je),Qe=(Ae-1)*L,qe=Re.slice(Qe,Qe+L);return{filtered:Re,paged:qe,totalPages:je,currentPage:Ae,startIndex:Qe}},[U,l,i]),me=o.useMemo(()=>{const Re=((Je,Ye)=>{if(!Ye)return Je;const oe=Ye.toLowerCase();return Je.filter(ve=>[ve.organization,ve.product,ve.plan,ve.status,ve.billing_cycle,ve.start_date,ve.end_date,ve.created_at,ve.user_name,ve.user_email].some(Z=>String(Z||"").toLowerCase().includes(oe)))})(w,x),je=Math.max(Math.ceil(Re.length/L),1),Ae=Math.min(j,je),Qe=(Ae-1)*L,qe=Re.slice(Qe,Qe+L);return{filtered:Re,paged:qe,totalPages:je,currentPage:Ae,startIndex:Qe}},[w,x,j]);return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading billing history..."})]}):t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"page-title",children:"Billing"}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Billing Activity"}),e.jsxs("label",{className:"table-search",htmlFor:"saas-billing-transfer-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-billing-transfer-search",type:"text",value:s,onChange:de=>n(de.target.value),placeholder:"Search billing activity"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Owner"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Paid On"}),e.jsx("th",{children:"GST Bill"}),e.jsx("th",{children:"View"})]})}),e.jsx("tbody",{children:J.paged.length?J.paged.map(de=>e.jsxs("tr",{children:[e.jsx("td",{children:de.organization||"-"}),e.jsx("td",{children:de.owner_name||"-"}),e.jsx("td",{children:de.owner_email||"-"}),e.jsx("td",{children:de.product||"-"}),e.jsx("td",{children:de.plan||"-"}),e.jsx("td",{children:de.request_type||"-"}),e.jsx("td",{children:de.billing_cycle||"-"}),e.jsx("td",{children:de.currency?`${de.currency} ${It(de.amount)}`:It(de.amount)}),e.jsx("td",{children:de.status||"-"}),e.jsx("td",{children:de.paid_on||"-"}),e.jsx("td",{children:de.invoice_available&&de.invoice_url?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:de.invoice_url,target:"_blank",rel:"noreferrer",children:"Download"}):"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>_({open:!0,row:de}),children:"View"})})]},de.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"12",children:"No billing activity found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",J.filtered.length?J.startIndex+1:0," to"," ",Math.min(J.startIndex+L,J.filtered.length)," of"," ",J.filtered.length," entries"]}),e.jsx(He,{page:J.currentPage,totalPages:J.totalPages,onPageChange:u,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("h5",{className:"mb-0",children:"Subscription History"}),e.jsxs("label",{className:"table-search",htmlFor:"saas-billing-sub-search",children:[e.jsx("span",{children:"Search:"}),e.jsx("input",{id:"saas-billing-sub-search",type:"text",value:c,onChange:de=>m(de.target.value),placeholder:"Search subscription history"})]})]}),e.jsx("div",{className:"table-responsive mt-2",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Organization"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Plan"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Cycle"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"End"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Email"})]})}),e.jsx("tbody",{children:me.paged.length?me.paged.map(de=>e.jsxs("tr",{children:[e.jsx("td",{children:de.organization||"-"}),e.jsx("td",{children:de.product||"-"}),e.jsx("td",{children:de.plan||"-"}),e.jsx("td",{children:de.status||"-"}),e.jsx("td",{children:de.billing_cycle||"-"}),e.jsx("td",{children:de.start_date||"-"}),e.jsx("td",{children:de.end_date||"-"}),e.jsx("td",{children:de.created_at||"-"}),e.jsx("td",{children:de.user_name||"-"}),e.jsx("td",{children:de.user_email||"-"})]},de.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"10",children:"No subscription history found."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",me.filtered.length?me.startIndex+1:0," to"," ",Math.min(me.startIndex+L,me.filtered.length)," of"," ",me.filtered.length," entries"]}),e.jsx(He,{page:me.currentPage,totalPages:me.totalPages,onPageChange:N,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]}),e.jsxs("div",{className:"card p-3 mt-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsx("h5",{className:"mb-0",children:"GST Bills (Monthly)"})}),Q.length?e.jsxs("div",{className:"d-flex flex-wrap align-items-end gap-2 mt-3",children:[e.jsxs("label",{className:"gst-date-label",children:[e.jsx("span",{children:"From Month"}),e.jsxs("div",{className:"date-picker-wrap",ref:b,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsxs("label",{className:"gst-date-label",children:[e.jsx("span",{children:"To Month"}),e.jsxs("div",{className:"date-picker-wrap",ref:P,children:[e.jsx("input",{type:"text",className:"date-input","data-input":!0}),e.jsx("button",{type:"button",className:"calendar-trigger",title:"Open calendar","data-toggle":!0,children:e.jsx("i",{className:"bi bi-calendar3"})})]})]}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:!C||!h,onClick:()=>{!C||!h||window.location.assign(`/api/saas-admin/billing-gst-archive?from=${encodeURIComponent(C)}&to=${encodeURIComponent(h)}`)},children:"Download Zip"})]}):e.jsx("div",{className:"text-secondary mt-2",children:"No approved GST bills available yet."})]}),v.open?e.jsx("div",{className:"modal-overlay",onClick:()=>_({open:!1,row:null}),children:e.jsxs("div",{className:"modal-panel",onClick:de=>de.stopPropagation(),children:[e.jsx("h5",{children:"Billing Details"}),e.jsxs("div",{className:"modal-form-grid billing-modal-grid mt-3",children:[e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Organization"}),e.jsx("div",{children:It((re=v.row)==null?void 0:re.organization)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Owner"}),e.jsx("div",{children:It((K=v.row)==null?void 0:K.owner_name)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Email"}),e.jsx("div",{children:It((O=v.row)==null?void 0:O.owner_email)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Product"}),e.jsx("div",{children:It((T=v.row)==null?void 0:T.product)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Plan"}),e.jsx("div",{children:It((H=v.row)==null?void 0:H.plan)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Type"}),e.jsx("div",{children:It((I=v.row)==null?void 0:I.request_type)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Cycle"}),e.jsx("div",{children:It((S=v.row)==null?void 0:S.billing_cycle)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Amount"}),e.jsx("div",{children:(k=v.row)!=null&&k.currency?`${v.row.currency} ${It((M=v.row)==null?void 0:M.amount)}`:It((A=v.row)==null?void 0:A.amount)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Status"}),e.jsx("div",{children:It((F=v.row)==null?void 0:F.status)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Paid On"}),e.jsx("div",{children:It((te=v.row)==null?void 0:te.paid_on)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Reference"}),e.jsx("div",{children:It((Y=v.row)==null?void 0:Y.reference_no)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Created"}),e.jsx("div",{children:It((ue=v.row)==null?void 0:ue.created_at)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Updated"}),e.jsx("div",{children:It((he=v.row)==null?void 0:he.updated_at)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Notes"}),e.jsx("div",{children:It((ye=v.row)==null?void 0:ye.notes)})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"Receipt"}),(G=v.row)!=null&&G.receipt_url?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:v.row.receipt_url,target:"_blank",rel:"noreferrer",children:"View"}):e.jsx("div",{children:"-"})]}),e.jsxs("div",{className:"modal-form-field",children:[e.jsx("span",{className:"text-secondary",children:"GST Bill"}),(Ne=v.row)!=null&&Ne.invoice_available&&((_e=v.row)!=null&&_e.invoice_url)?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:v.row.invoice_url,target:"_blank",rel:"noreferrer",children:"Download"}):e.jsx("div",{children:"-"})]})]}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>_({open:!1,row:null}),children:"Close"})})]})}):null]})}const DS={loading:!0,error:"",items:[],total:0},il=25;function LS(){const[t,a]=o.useState(DS),[s,n]=o.useState(""),[l,r]=o.useState(""),[i,u]=o.useState(""),[c,m]=o.useState([]),[x,f]=o.useState(1);o.useEffect(()=>{let N=!0;async function v(){try{const _=new URLSearchParams;_.set("limit",String(il)),_.set("offset",String((x-1)*il)),s.trim()&&_.set("q",s.trim()),l&&_.set("status",l),i&&_.set("product_id",i);const C=await z(`/api/saas-admin/backup-activity?${_.toString()}`);if(!N)return;a({loading:!1,error:"",items:Array.isArray(C.items)?C.items:[],total:C.total||0})}catch(_){if(!N)return;a({loading:!1,error:(_==null?void 0:_.message)||"Unable to load backup activity.",items:[],total:0})}}return v(),()=>{N=!1}},[s,l,i,x]),o.useEffect(()=>{let N=!0;async function v(){try{const _=await z("/api/saas-admin/overview");if(!N)return;m(Array.isArray(_.products)?_.products:[])}catch{if(!N)return;m([])}}return v(),()=>{N=!1}},[]);const j=Math.max(1,Math.ceil(t.total/il));return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Org Downloads"}),e.jsx("hr",{className:"section-divider"}),e.jsx("div",{className:"card p-3 mb-3",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Search Org"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Organization name",value:s,onChange:N=>n(N.target.value)})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{className:"form-select",value:l,onChange:N=>r(N.target.value),children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"queued",children:"Queued"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"expired",children:"Expired"}),e.jsx("option",{value:"failed",children:"Failed"})]})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Product"}),e.jsxs("select",{className:"form-select",value:i,onChange:N=>u(N.target.value),children:[e.jsx("option",{value:"",children:"All"}),c.map(N=>e.jsx("option",{value:String(N.id),children:N.name},N.id))]})]})]})}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Org"}),e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Admin User"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Generated"}),e.jsx("th",{children:"Expiry"})]})}),e.jsx("tbody",{children:t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"Loading activity..."})}):t.items.length?t.items.map(N=>e.jsxs("tr",{children:[e.jsx("td",{children:N.organization_name||"-"}),e.jsx("td",{children:N.product_name||"-"}),e.jsx("td",{children:N.admin_user||"-"}),e.jsx("td",{children:N.size_bytes?`${(N.size_bytes/(1024*1024)).toFixed(2)} MB`:"-"}),e.jsx("td",{children:N.status||"-"}),e.jsx("td",{children:N.completed_at||N.requested_at||"-"}),e.jsx("td",{children:N.expires_at||"-"})]},N.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No backup activity."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",t.items.length?(x-1)*il+1:0," to"," ",Math.min(x*il,t.total)," of ",t.total," entries"]}),e.jsx(He,{page:x,totalPages:j,onPageChange:f,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})}const RS={loading:!0,error:"",items:[],total:0},ol=10;function MS(){const[t,a]=o.useState(RS),[s,n]=o.useState([]),[l,r]=o.useState(""),[i,u]=o.useState(1);o.useEffect(()=>{let m=!0;async function x(){try{const f=await z("/api/auth/subscriptions");if(!m)return;const j=(f.subscriptions||[]).map(N=>({slug:N.product_slug,name:N.product_name||N.product_slug}));n(j),!l&&j.length&&r(j[0].slug)}catch{if(!m)return;n([])}}return x(),()=>{m=!1}},[]),o.useEffect(()=>{let m=!0;async function x(){if(!l){a(f=>({...f,loading:!1}));return}a(f=>({...f,loading:!0,error:""}));try{const f=new URLSearchParams;f.set("limit",String(ol)),f.set("offset",String((i-1)*ol)),f.set("product_slug",l);const j=await z(`/api/backup/list?${f.toString()}`);if(!m)return;a({loading:!1,error:"",items:Array.isArray(j.items)?j.items:[],total:j.total||0})}catch(f){if(!m)return;a({loading:!1,error:(f==null?void 0:f.message)||"Unable to load backup history.",items:[],total:0})}}return x(),()=>{m=!1}},[l,i]);const c=Math.max(1,Math.ceil(t.total/ol));return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"Backup History"}),e.jsx("hr",{className:"section-divider"}),e.jsx("div",{className:"card p-3 mb-3",children:e.jsx("div",{className:"row g-3 align-items-end",children:e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Product"}),e.jsx("select",{className:"form-select",value:l,onChange:m=>{r(m.target.value),u(1)},children:s.length?s.map(m=>e.jsx("option",{value:m.slug,children:m.name},m.slug)):e.jsx("option",{value:"",children:"No products"})})]})})}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Expires"}),e.jsx("th",{children:"Download"})]})}),e.jsx("tbody",{children:t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"Loading backups..."})}):t.items.length?t.items.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:m.product_name||"-"}),e.jsx("td",{children:m.status||"-"}),e.jsx("td",{children:m.size_bytes?`${(m.size_bytes/(1024*1024)).toFixed(2)} MB`:"-"}),e.jsx("td",{children:m.completed_at||m.requested_at||"-"}),e.jsx("td",{children:m.expires_at||"-"}),e.jsx("td",{children:m.can_download&&m.download_url?e.jsx("a",{className:"btn btn-sm btn-outline-light",href:m.download_url,children:"Download"}):"-"})]},m.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No backups yet."})})})]})}),e.jsxs("div",{className:"table-footer",children:[e.jsxs("div",{className:"table-info",children:["Showing ",t.items.length?(i-1)*ol+1:0," to"," ",Math.min(i*ol,t.total)," of ",t.total," entries"]}),e.jsx(He,{page:i,totalPages:c,onPageChange:u,showPageLinks:!0,showPageLabel:!1,maxPageLinks:7})]})]})]})}const $S={loading:!0,error:"",servers:[]};function US(t){if(!t)return"-";const a=new Date(t);return Number.isNaN(a.getTime())?t:a.toLocaleString()}function OS(){const[t,a]=o.useState($S);return o.useEffect(()=>{let s=!0;async function n(){try{const l=await z("/api/monitoring/servers");if(!s)return;a({loading:!1,error:"",servers:l||[]})}catch(l){if(!s)return;a({loading:!1,error:(l==null?void 0:l.message)||"Unable to load servers.",servers:[]})}}return n(),()=>{s=!1}},[]),t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading servers..."})]}):t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Server Monitoring"}),e.jsx("p",{className:"text-secondary mb-0",children:"Track server health and latest resource usage."})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(et,{to:"/saas-admin/server-monitoring/alerts",className:"btn btn-outline-light btn-sm",children:"Alerts"}),e.jsx(et,{to:"/saas-admin/server-monitoring/settings",className:"btn btn-outline-light btn-sm",children:"Settings"})]})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Region"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Last Seen"}),e.jsx("th",{children:"CPU %"}),e.jsx("th",{children:"RAM %"}),e.jsx("th",{children:"Disk %"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:t.servers.length?t.servers.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:s.role}),e.jsx("td",{children:s.region||"-"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.status==="UP"?"bg-success":"bg-danger"}`,children:s.status})}),e.jsx("td",{children:US(s.last_seen_at)}),e.jsx("td",{children:Math.round(s.cpu_percent||0)}),e.jsx("td",{children:Math.round(s.ram_percent||0)}),e.jsx("td",{children:Math.round(s.disk_percent||0)}),e.jsx("td",{children:e.jsx(et,{to:`/saas-admin/server-monitoring/${s.id}`,className:"btn btn-primary btn-sm",children:"View"})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",children:"No servers configured."})})})]})})]})}const IS={loading:!0,error:"",server:null,metrics:[]},FS=[{key:"1h",label:"1 Hour"},{key:"24h",label:"24 Hours"},{key:"7d",label:"7 Days"}];function zS(t){if(!t)return"-";const a=new Date(t);return Number.isNaN(a.getTime())?t:a.toLocaleString()}function BS(){const{serverId:t}=ps(),[a,s]=o.useState(IS),[n,l]=o.useState("24h");o.useEffect(()=>{let i=!0;async function u(){try{const[c,m]=await Promise.all([z(`/api/monitoring/servers/${t}`),z(`/api/monitoring/servers/${t}/metrics?range=${n}`)]);if(!i)return;s({loading:!1,error:"",server:c,metrics:m||[]})}catch(c){if(!i)return;s({loading:!1,error:(c==null?void 0:c.message)||"Unable to load server details.",server:null,metrics:[]})}}return u(),()=>{i=!1}},[t,n]);const r=o.useMemo(()=>a.metrics.length?a.metrics[a.metrics.length-1]:null,[a.metrics]);return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading server details..."})]}):a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):a.server?e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:a.server.name}),e.jsxs("div",{className:"text-secondary",children:[a.server.role,"  ",a.server.region||"Unknown","  ",a.server.hostname||"-"]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(et,{to:"/saas-admin/server-monitoring",className:"btn btn-outline-light btn-sm",children:"Back"}),e.jsx(et,{to:"/saas-admin/server-monitoring/alerts",className:"btn btn-outline-light btn-sm",children:"Alerts"})]})]}),e.jsxs("div",{className:"row g-3 mt-3",children:[e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-cpu","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"CPU %"}),e.jsx("div",{className:"stat-value",children:r?Math.round(r.cpu_percent||0):0})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-memory","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"RAM %"}),e.jsx("div",{className:"stat-value",children:r?Math.round(r.ram_percent||0):0})]})}),e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 stat-card",children:[e.jsx("div",{className:"stat-icon stat-icon-primary",children:e.jsx("i",{className:"bi bi-hdd","aria-hidden":"true"})}),e.jsx("h6",{className:"mb-1",children:"Disk %"}),e.jsx("div",{className:"stat-value",children:r?Math.round(r.disk_percent||0):0})]})})]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 mt-4 flex-wrap",children:[e.jsxs("h5",{className:"mb-0",children:["Metrics (",n,")"]}),e.jsx("select",{className:"form-select",style:{width:"180px"},value:n,onChange:i=>l(i.target.value),children:FS.map(i=>e.jsx("option",{value:i.key,children:i.label},i.key))})]}),e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Time"}),e.jsx("th",{children:"CPU %"}),e.jsx("th",{children:"RAM %"}),e.jsx("th",{children:"Disk %"}),e.jsx("th",{children:"Load 1"}),e.jsx("th",{children:"Load 5"}),e.jsx("th",{children:"Load 15"})]})}),e.jsx("tbody",{children:a.metrics.length?a.metrics.map(i=>e.jsxs("tr",{children:[e.jsx("td",{children:zS(i.ts_minute)}),e.jsx("td",{children:Math.round(i.cpu_percent||0)}),e.jsx("td",{children:Math.round(i.ram_percent||0)}),e.jsx("td",{children:Math.round(i.disk_percent||0)}),e.jsx("td",{children:Math.round(i.load1||0)}),e.jsx("td",{children:Math.round(i.load5||0)}),e.jsx("td",{children:Math.round(i.load15||0)})]},i.ts_minute)):e.jsx("tr",{children:e.jsx("td",{colSpan:"7",children:"No metrics found."})})})]})})]}):e.jsx("div",{className:"alert alert-warning",children:"Server not found."})}const WS={loading:!0,error:"",saving:!1,enabled:!0,heartbeat_expected_seconds:30,down_after_minutes:3,cpu_threshold:85,ram_threshold:90,disk_threshold:90,breach_minutes:5,email_enabled:!0,alert_emails:"",retention_days_metrics:30};function VS(){const[t,a]=o.useState(WS),[s,n]=o.useState("");o.useEffect(()=>{let i=!0;async function u(){try{const c=await z("/api/monitoring/settings");if(!i)return;a({loading:!1,error:"",saving:!1,enabled:!!c.enabled,heartbeat_expected_seconds:c.heartbeat_expected_seconds??30,down_after_minutes:c.down_after_minutes??3,cpu_threshold:c.cpu_threshold??85,ram_threshold:c.ram_threshold??90,disk_threshold:c.disk_threshold??90,breach_minutes:c.breach_minutes??5,email_enabled:!!c.email_enabled,alert_emails:(c.alert_emails||[]).join(", "),retention_days_metrics:c.retention_days_metrics??30})}catch(c){if(!i)return;a(m=>({...m,loading:!1,error:(c==null?void 0:c.message)||"Unable to load settings."}))}}return u(),()=>{i=!1}},[]);const l=i=>u=>{const c=u.target.type==="checkbox"?u.target.checked:u.target.value;a(m=>({...m,[i]:c}))},r=async()=>{n(""),a(i=>({...i,saving:!0,error:""}));try{const i={enabled:t.enabled,heartbeat_expected_seconds:Number(t.heartbeat_expected_seconds),down_after_minutes:Number(t.down_after_minutes),cpu_threshold:Number(t.cpu_threshold),ram_threshold:Number(t.ram_threshold),disk_threshold:Number(t.disk_threshold),breach_minutes:Number(t.breach_minutes),email_enabled:t.email_enabled,alert_emails:t.alert_emails.split(",").map(c=>c.trim()).filter(Boolean),retention_days_metrics:Number(t.retention_days_metrics)},u=await z("/api/monitoring/settings",{method:"POST",body:JSON.stringify(i)});a(c=>({...c,saving:!1,error:"",alert_emails:(u.alert_emails||[]).join(", ")})),n("Settings saved.")}catch(i){a(u=>({...u,saving:!1,error:(i==null?void 0:i.message)||"Unable to save settings."}))}};return t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading settings..."})]}):e.jsxs("div",{className:"card p-4",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between gap-2 flex-wrap",children:e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Server Monitoring Settings"}),e.jsx("p",{className:"text-secondary mb-0",children:"Thresholds, heartbeat, and notifications."})]})}),t.error?e.jsx("div",{className:"alert alert-danger mt-3",children:t.error}):null,s?e.jsx("div",{className:"alert alert-success mt-3",children:s}):null,e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Heartbeat Expected (seconds)"}),e.jsx("input",{type:"number",className:"form-control",value:t.heartbeat_expected_seconds,onChange:l("heartbeat_expected_seconds")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Down After (minutes)"}),e.jsx("input",{type:"number",className:"form-control",value:t.down_after_minutes,onChange:l("down_after_minutes")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Breach Window (minutes)"}),e.jsx("input",{type:"number",className:"form-control",value:t.breach_minutes,onChange:l("breach_minutes")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"CPU Threshold"}),e.jsx("input",{type:"number",className:"form-control",value:t.cpu_threshold,onChange:l("cpu_threshold")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"RAM Threshold"}),e.jsx("input",{type:"number",className:"form-control",value:t.ram_threshold,onChange:l("ram_threshold")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Disk Threshold"}),e.jsx("input",{type:"number",className:"form-control",value:t.disk_threshold,onChange:l("disk_threshold")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Retention (days)"}),e.jsx("input",{type:"number",className:"form-control",value:t.retention_days_metrics,onChange:l("retention_days_metrics")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Alert Emails"}),e.jsx("input",{type:"text",className:"form-control",placeholder:"ops@company.com, admin@company.com",value:t.alert_emails,onChange:l("alert_emails")})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Email Alerts"}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:t.email_enabled,onChange:l("email_enabled"),id:"monitoring-email"}),e.jsx("label",{className:"form-check-label",htmlFor:"monitoring-email",children:"Send email alerts"})]})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label",children:"Enabled"}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{type:"checkbox",className:"form-check-input",checked:t.enabled,onChange:l("enabled"),id:"monitoring-enabled-bottom"}),e.jsx("label",{className:"form-check-label",htmlFor:"monitoring-enabled-bottom",children:"Monitoring Enabled"})]})]}),e.jsx("div",{className:"col-12 col-md-6 col-xl-3 d-flex align-items-end",children:e.jsx("button",{type:"button",className:"btn btn-success",onClick:r,disabled:t.saving,children:t.saving?"Saving...":"Data Save"})})]})]})}const GS={loading:!0,error:"",alerts:[]};function Gf(t){if(!t)return"-";const a=new Date(t);return Number.isNaN(a.getTime())?t:a.toLocaleString()}function HS(){const[t,a]=o.useState(GS),[s,n]=o.useState("open");return o.useEffect(()=>{let l=!0;async function r(){try{const i=await z(`/api/monitoring/alerts?status=${s}`);if(!l)return;a({loading:!1,error:"",alerts:i||[]})}catch(i){if(!l)return;a({loading:!1,error:(i==null?void 0:i.message)||"Unable to load alerts.",alerts:[]})}}return r(),()=>{l=!1}},[s]),t.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading alerts..."})]}):e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between gap-2 flex-wrap",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"Server Alerts"}),e.jsx("p",{className:"text-secondary mb-0",children:"Active and historical alert events."})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(et,{to:"/saas-admin/server-monitoring",className:"btn btn-outline-light btn-sm",children:"Back"}),e.jsxs("select",{className:"form-select",style:{width:"160px"},value:s,onChange:l=>n(l.target.value),children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]})]})]}),t.error?e.jsx("div",{className:"alert alert-danger mt-3",children:t.error}):null,e.jsx("div",{className:"table-responsive mt-3",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Server"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Severity"}),e.jsx("th",{children:"Started"}),e.jsx("th",{children:"Ended"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:t.alerts.length?t.alerts.map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:l.server_name}),e.jsx("td",{children:l.type}),e.jsx("td",{children:l.severity}),e.jsx("td",{children:Gf(l.started_at)}),e.jsx("td",{children:Gf(l.ended_at)}),e.jsx("td",{children:e.jsx("span",{className:`badge ${l.is_active?"bg-danger":"bg-secondary"}`,children:l.is_active?"Open":"Closed"})})]},l.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",children:"No alerts."})})})]})})]})}const hl=50,Hf={loading:!0,error:"",items:[],folderId:null,rootId:null,pagination:{limit:hl,offset:0,total_folders:0,total_files:0}},QS={loading:!0,error:"",total_gb:0,used_gb:0,remaining_gb:0,bandwidth_total_gb:0,bandwidth_used_gb:0,bandwidth_remaining_gb:0,bandwidth_limited:!1,addon_slots:0},qS={loading:!0,error:"",items:[]},YS={loading:!0,error:"",items:[]};function Qf(t){const a=Number(t||0);if(!a)return"0 B";const s=a/1024;if(s<1024)return`${s.toFixed(1)} KB`;const n=s/1024;return n<1024?`${n.toFixed(1)} MB`:`${(n/1024).toFixed(2)} GB`}function xn(t){return`${Number(t||0).toFixed(0)} GB`}function qf(t){if(!t)return"-";const a=new Date(t);return Number.isNaN(a.getTime())?t:a.toLocaleString()}async function KS(t,a){es()||await fetch("/api/auth/csrf",{credentials:"include"});const s=await fetch(t,{method:"POST",credentials:"include",headers:{"X-CSRFToken":es()},body:a}),n=await s.text();let l=null;if(n)try{l=JSON.parse(n)}catch{l=null}if(!s.ok){const r=(l==null?void 0:l.error)||(l==null?void 0:l.detail)||`Request failed (${s.status})`,i=new Error(r);throw i.status=s.status,i.data=l,i}return l}function JS(t){return!t||!t.length?"Root":t.map(a=>a.name).join(" / ")}function Sa(t,a){var l,r;const s=((l=t==null?void 0:t.data)==null?void 0:l.error)||((r=t==null?void 0:t.data)==null?void 0:r.detail)||(t==null?void 0:t.message);return{permission_denied:"You do not have access to this item.",storage_limit_exceeded:"Storage limit exceeded. Please upgrade your storage.",bandwidth_limit_exceeded:"Bandwidth limit exceeded. Please upgrade your plan.",invalid_folder:"Folder not found.",file_not_found:"File not found.",uploads_disabled:"Uploads are currently disabled.",rate_limited:"Too many requests. Please try again shortly.",storage_unavailable:"Storage is temporarily unavailable.",read_only:"This organization is currently in read-only mode."}[s]||a||"Something went wrong."}function Yf(){var st,Dt;const t=typeof window<"u"&&window.__WZ_READ_ONLY__===!0,a=ps(),s=fs(),n=nn(),[l,r]=o.useState(Hf),[i,u]=o.useState(QS),[c,m]=o.useState(qS),[x,f]=o.useState(!1),[j,N]=o.useState(a.id?Number(a.id):null),[v,_]=o.useState([]),[C,y]=o.useState({}),[h,p]=o.useState(()=>new Set),[b,P]=o.useState(""),[$,E]=o.useState(""),[L,V]=o.useState({loading:!1,error:"",items:[],limit:50}),[U,w]=o.useState([]),[Q,J]=o.useState(""),[me,re]=o.useState(!1),[K,O]=o.useState({open:!1,item:null,type:"",targetId:""}),[T,H]=o.useState(YS),[I,S]=o.useState(a.device_id||""),[k,M]=o.useState(null),A=o.useMemo(()=>JS(v),[v]),F=o.useMemo(()=>{if(!I)return"Root";const W=T.items.find(pe=>pe.device_id===I);return(W==null?void 0:W.device_name)||I},[T.items,I]);o.useEffect(()=>{if(a.id){const W=Number(a.id);Number.isNaN(W)||N(W)}else N(null)},[a.id]),o.useEffect(()=>{let W=!0;async function pe(){try{const fe=await z("/api/storage/org/users");if(!W)return;m({loading:!1,error:"",items:fe.items||[]}),f(!0)}catch(fe){if(!W)return;if((fe==null?void 0:fe.status)===403){m({loading:!1,error:"",items:[]}),f(!1);return}m({loading:!1,error:Sa(fe,"Unable to load users."),items:[]}),f(!1)}}return pe(),()=>{W=!1}},[]),o.useEffect(()=>{let W=!0;async function pe(){try{const fe=new URLSearchParams;j&&fe.set("user_id",String(j));const D=await z(`/api/storage/org/devices?${fe.toString()}`);if(!W)return;H({loading:!1,error:"",items:D.items||[]})}catch(fe){if(!W)return;if((fe==null?void 0:fe.status)===403){H({loading:!1,error:"",items:[]});return}H({loading:!1,error:Sa(fe,"Unable to load devices."),items:[]})}}return pe(),()=>{W=!1}},[j]),o.useEffect(()=>{I||T.items.length&&S(T.items[0].device_id)},[T.items,I]),o.useEffect(()=>{const W=setTimeout(()=>{E(b.trim())},300);return()=>clearTimeout(W)},[b]),o.useEffect(()=>{let W=!0;async function pe(){if(!$){V({loading:!1,error:"",items:[],limit:50});return}V(fe=>({...fe,loading:!0,error:""}));try{const fe=new URLSearchParams;fe.set("q",$),fe.set("limit","50"),j&&fe.set("user_id",String(j));const D=await z(`/api/storage/explorer/search?${fe.toString()}`);if(!W)return;V({loading:!1,error:"",items:D.items||[],limit:D.limit||50})}catch(fe){if(!W)return;V({loading:!1,error:Sa(fe,"Unable to search files."),items:[],limit:50})}}return pe(),()=>{W=!1}},[$,j]),o.useEffect(()=>{let W=!0;async function pe(){try{const fe=await z("/api/storage/explorer/status");if(!W)return;u({loading:!1,error:"",total_gb:fe.total_allowed_storage_gb||0,used_gb:fe.used_storage_gb||0,remaining_gb:fe.remaining_storage_gb||0,bandwidth_total_gb:fe.total_allowed_bandwidth_gb||0,bandwidth_used_gb:fe.used_bandwidth_gb||0,bandwidth_remaining_gb:fe.remaining_bandwidth_gb||0,bandwidth_limited:!!fe.is_bandwidth_limited,addon_slots:Number(fe.addon_slots||0)}),re(!!(fe.total_allowed_storage_gb&&fe.remaining_storage_gb<=0))}catch(fe){if(!W)return;u({loading:!1,error:Sa(fe,"Unable to load storage usage."),total_gb:0,used_gb:0,remaining_gb:0,bandwidth_total_gb:0,bandwidth_used_gb:0,bandwidth_remaining_gb:0,bandwidth_limited:!1,addon_slots:0})}}return pe(),()=>{W=!1}},[j]),o.useEffect(()=>{let W=!0;async function pe(){var fe,D;r(X=>({...X,loading:!0,error:""}));try{const X=new URLSearchParams;X.set("limit",String(hl)),X.set("offset","0"),j&&X.set("user_id",String(j));const q=await z(`/api/storage/explorer/root?${X.toString()}`);if(!W)return;const ie=q.folder_id||null;let Ee=ie;if(I&&((fe=q.items)!=null&&fe.length)){const le=q.items.find(Te=>Te.type==="folder"&&Te.name===I);le!=null&&le.id&&(Ee=le.id)}let tt=q.items||[];Ee&&Ee!==ie&&(tt=(await z(`/api/storage/explorer/folder/${Ee}?${X.toString()}`)).items||[]),M(Ee),r({loading:!1,error:"",items:tt,folderId:Ee,rootId:ie,pagination:q.pagination||{limit:hl,offset:0,total_folders:0,total_files:0}});const B=I?((D=T.items.find(le=>le.device_id===I))==null?void 0:D.device_name)||I:"Root";_(Ee?[{id:Ee,name:B}]:[]),Ee&&(y(le=>({...le,[Ee]:tt.filter(Te=>Te.type==="folder")})),p(new Set([Ee])))}catch(X){if(!W)return;r({...Hf,loading:!1,error:Sa(X,"Unable to load folders.")})}}return pe(),()=>{W=!1}},[j,I,T.items]),o.useEffect(()=>{v.length&&p(W=>{const pe=new Set(W);return v.forEach(fe=>{fe!=null&&fe.id&&pe.add(fe.id)}),pe})},[v]);const te=(((st=l.pagination)==null?void 0:st.total_folders)||0)+(((Dt=l.pagination)==null?void 0:Dt.total_files)||0),Y=l.items.length<te;function ue(W){if(!j)return W;const pe=W.includes("?")?"&":"?";return`${W}${pe}user_id=${j}`}async function he(){l.folderId&&await ye(l.folderId,{reset:!0,pathOverride:v})}async function ye(W,{reset:pe=!1,pathOverride:fe=null,offset:D=0,append:X=!1}={}){var q,ie;if(W){pe&&r(Ee=>({...Ee,loading:!0,error:"",items:X?Ee.items:[]}));try{const Ee=new URLSearchParams;Ee.set("limit",String(hl)),Ee.set("offset",String(D)),j&&Ee.set("user_id",String(j));const tt=await z(`/api/storage/explorer/folder/${W}?${Ee.toString()}`),B=X?[...l.items,...tt.items||[]]:tt.items||[];r({loading:!1,error:"",items:B,folderId:W,rootId:l.rootId,pagination:tt.pagination||l.pagination}),y(le=>({...le,[W]:(tt.items||[]).filter(Te=>Te.type==="folder")})),fe&&_(fe)}catch(Ee){if((((q=Ee==null?void 0:Ee.data)==null?void 0:q.error)||((ie=Ee==null?void 0:Ee.data)==null?void 0:ie.detail))==="invalid_folder"){await G();return}r(B=>({...B,loading:!1,error:Sa(Ee,"Unable to load folder.")}))}}}async function G(){var pe;if(P(""),E(""),V({loading:!1,error:"",items:[],limit:50}),!k)return;const W=I?((pe=T.items.find(fe=>fe.device_id===I))==null?void 0:pe.device_name)||I:"Root";_([{id:k,name:W}]),await ye(k,{reset:!0,pathOverride:[{id:k,name:W}]})}function Ne(W){if(!W||!W.id)return;P(""),E(""),V({loading:!1,error:"",items:[],limit:50});const pe=v.findIndex(D=>D.id===W.id),fe=pe>=0?v.slice(0,pe+1):[...v,{id:W.id,name:W.name}];_(fe),ye(W.id,{reset:!0,pathOverride:fe})}function _e(W,pe){if(!(W!=null&&W.id))return;const fe=v.slice(0,pe+1);_(fe),ye(W.id,{reset:!0,pathOverride:fe})}function de(W){const pe=W.target.value;if(!pe){s("/");return}s(`/user/${pe}`)}async function Re(){const W=window.prompt("Folder name");if(W){J("");try{await z(ue("/api/storage/explorer/folders/create"),{method:"POST",body:JSON.stringify({name:W.trim(),parent_id:l.folderId})}),await he()}catch(pe){J(Sa(pe,"Unable to create folder."))}}}async function je(W){var fe;const pe=window.prompt("Rename",(W==null?void 0:W.name)||"");if(!(!pe||!W)){J("");try{W.type==="folder"?await z(ue(`/api/storage/explorer/folders/${W.id}/rename`),{method:"POST",body:JSON.stringify({name:pe.trim()})}):await z(ue(`/api/storage/explorer/files/${W.id}/rename`),{method:"POST",body:JSON.stringify({name:pe.trim()})}),await he()}catch(D){((fe=D==null?void 0:D.data)==null?void 0:fe.error)==="file_not_found"&&await he(),J(Sa(D,"Unable to rename item."))}}}async function Ae(W){if(!(!W||!await n({title:"Confirm Delete",message:`Delete ${W.type==="folder"?"folder":"file"} "${W.name}"?`,confirmVariant:"danger"}))){J("");try{W.type==="folder"?await z(ue(`/api/storage/explorer/folders/${W.id}/delete`),{method:"DELETE"}):await z(ue(`/api/storage/explorer/files/${W.id}/delete`),{method:"DELETE"}),await he(),await Qe()}catch(fe){J(Sa(fe,"Unable to delete item."))}}}async function Qe(){try{const W=await z("/api/storage/explorer/status");u({loading:!1,error:"",total_gb:W.total_allowed_storage_gb||0,used_gb:W.used_storage_gb||0,remaining_gb:W.remaining_storage_gb||0,bandwidth_total_gb:W.total_allowed_bandwidth_gb||0,bandwidth_used_gb:W.used_bandwidth_gb||0,bandwidth_remaining_gb:W.remaining_bandwidth_gb||0,bandwidth_limited:!!W.is_bandwidth_limited,addon_slots:Number(W.addon_slots||0)}),re(!!(W.total_allowed_storage_gb&&W.remaining_storage_gb<=0))}catch(W){u(pe=>({...pe,loading:!1,error:Sa(W,"Unable to load storage usage.")}))}}async function qe(W){var D;const pe=Array.from(W.target.files||[]);if(W.target.value="",!pe.length)return;const fe=pe.map(X=>({id:`${X.name}-${X.size}-${Date.now()}`,name:X.name,status:"uploading",error:""}));w(X=>[...fe,...X]);for(let X=0;X<pe.length;X+=1){const q=pe[X],ie=fe[X].id,Ee=new FormData;Ee.append("file",q),l.folderId&&Ee.append("folder_id",l.folderId),j&&Ee.append("user_id",String(j));try{await KS("/api/storage/explorer/upload",Ee),w(tt=>tt.map(B=>B.id===ie?{...B,status:"done"}:B)),await he(),await Qe()}catch(tt){const B=(D=tt==null?void 0:tt.data)==null?void 0:D.error;w(le=>le.map(Te=>Te.id===ie?{...Te,status:"error",error:B==="storage_limit_exceeded"?"Storage limit exceeded.":Sa(tt,"Upload failed.")}:Te)),B==="storage_limit_exceeded"&&(J("Storage limit exceeded. Upgrade storage to continue uploading."),re(!0))}}}function Je(W={}){const pe=new URLSearchParams;return W.file_id&&pe.set("file_id",W.file_id),W.folder_id&&pe.set("folder_id",W.folder_id),W.user_id&&pe.set("user_id",W.user_id),W.device_id&&pe.set("device_id",W.device_id),`/api/storage/download/?${pe.toString()}`}function Ye(W){if(!W)return;const pe={file_id:W.id};j&&(pe.user_id=j),window.location.href=Je(pe)}function oe(W){const pe={folder_id:W};j&&(pe.user_id=j),window.location.href=Je(pe)}function ve(){j&&(window.location.href=Je({user_id:j}))}function Z(){I&&(window.location.href=Je({device_id:I}))}function ce(W,pe){O({open:!0,item:W,type:pe,targetId:k||""})}function xe(){const W=[];k&&W.push({id:k,name:F});const pe=new Set(W.map(fe=>fe.id));return Object.values(C).forEach(fe=>{(fe||[]).forEach(D=>{D!=null&&D.id&&!pe.has(D.id)&&(pe.add(D.id),W.push({id:D.id,name:D.name}))})}),W}async function Ce(){if(!K.item||!K.targetId){O({open:!1,item:null,type:"",targetId:""});return}J("");try{K.type==="folder"?await z(ue(`/api/storage/explorer/folders/${K.item.id}/move`),{method:"POST",body:JSON.stringify({parent_id:K.targetId})}):await z(ue(`/api/storage/explorer/files/${K.item.id}/move`),{method:"POST",body:JSON.stringify({folder_id:K.targetId})}),O({open:!1,item:null,type:"",targetId:""}),await he()}catch(W){J(Sa(W,"Unable to move item."))}}async function Fe(){var pe,fe;const W=(((pe=l.pagination)==null?void 0:pe.offset)||0)+(((fe=l.pagination)==null?void 0:fe.limit)||hl);await ye(l.folderId,{offset:W,append:!0,reset:!0,pathOverride:v})}function Ze(W){var D;if(!(W!=null&&W.folder_path)||!W.folder_path.length)return;const pe=W.folder_path.map(X=>({id:X.id,name:X.name})),fe=(D=pe[pe.length-1])==null?void 0:D.id;fe&&(_(pe),P(""),E(""),V({loading:!1,error:"",items:[],limit:50}),ye(fe,{reset:!0,pathOverride:pe}))}function ne(W){p(pe=>{const fe=new Set(pe);return fe.has(W)?fe.delete(W):fe.add(W),fe})}function Ie({nodeId:W,label:pe,depth:fe}){const D=C[W]||[],X=h.has(W);return e.jsxs("div",{style:{marginLeft:fe*12},children:[e.jsxs("div",{className:`storage-tree-item ${v.some(q=>q.id===W)?"active":""}`,children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light storage-tree-toggle",onClick:()=>ne(W),"aria-label":X?"Collapse":"Expand",children:e.jsx("i",{className:`bi ${X?"bi-caret-down":"bi-caret-right"}`,"aria-hidden":"true"})}),e.jsx("button",{type:"button",className:"btn btn-sm btn-link text-start storage-tree-label",onClick:()=>Ne({id:W,name:pe}),children:pe})]}),X&&D.length?e.jsx("div",{children:D.map(q=>e.jsx(Ie,{nodeId:q.id,label:q.name,depth:fe+1},q.id))}):null]})}const Oe=i.total_gb?Math.min(100,Math.round(i.used_gb/i.total_gb*100)):0,Me=o.useMemo(()=>xe(),[C,k,F]);return e.jsxs("div",{className:"container-fluid storage-explorer",children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between flex-wrap gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:"Online Storage"}),e.jsx("div",{className:"text-secondary",children:"Windows-style explorer for your files and folders."})]}),e.jsx("div",{className:"storage-usage-card",children:i.loading?e.jsx("div",{className:"text-secondary",children:"Loading storage..."}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"storage-usage-row",children:[e.jsxs("div",{className:"storage-usage-col",children:[e.jsx("div",{className:"small text-secondary",children:"Storage usage"}),e.jsxs("div",{className:"fw-semibold",children:[xn(i.used_gb)," used / ",xn(i.total_gb)]}),e.jsx("div",{className:"progress storage-usage-bar",children:e.jsx("div",{className:"progress-bar",role:"progressbar",style:{width:`${Oe}%`},"aria-valuenow":Oe,"aria-valuemin":"0","aria-valuemax":"100"})}),e.jsxs("div",{className:"small text-secondary",children:[xn(i.remaining_gb)," remaining"]})]}),i.bandwidth_total_gb||i.bandwidth_limited?e.jsxs("div",{className:"storage-usage-col",children:[e.jsx("div",{className:"small text-secondary",children:"Bandwidth usage"}),e.jsxs("div",{className:"fw-semibold",children:[xn(i.bandwidth_used_gb)," used / ",xn(i.bandwidth_total_gb)]}),e.jsxs("div",{className:"small text-secondary",children:[xn(i.bandwidth_remaining_gb)," remaining"]})]}):null]}),e.jsxs("div",{className:"storage-usage-meta small text-secondary",children:["Add-on slots: ",e.jsx("span",{className:"text-light",children:i.addon_slots||0})]})]})})]}),Q?e.jsx("div",{className:"alert alert-warning mt-3",children:Q}):null,t?e.jsxs("div",{className:"alert alert-info mt-3 d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("div",{children:"Read-only mode enabled. Upgrade your plan to resume uploads and sync."}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>s("/plans"),children:"Upgrade now"})]}):null,me?e.jsxs("div",{className:"alert alert-info mt-3 d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsx("div",{children:"Storage limit reached. Upgrade storage to continue uploading."}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:()=>s("/plans"),children:"Upgrade storage"})]}):null,l.error?e.jsx("div",{className:"alert alert-danger mt-3",children:l.error}):null,c.error?e.jsx("div",{className:"alert alert-danger mt-3",children:c.error}):null,e.jsxs("div",{className:"row g-3 mt-1",children:[e.jsx("div",{className:"col-12 col-lg-3",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h5",{className:"mb-0",children:"Folder Tree"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:G,children:"Root"})]}),x&&c.items.length?e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"View user"}),e.jsxs("select",{className:"form-select",value:j||"",onChange:de,children:[e.jsx("option",{value:"",children:"My Files"}),c.items.map(W=>e.jsx("option",{value:W.user_id,children:W.name||W.email||W.username},W.user_id))]}),e.jsx("div",{className:"d-flex gap-2 flex-wrap mt-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:ve,disabled:!j,children:"Download User Files"})}),e.jsx("label",{className:"form-label mt-3",children:"Device"}),e.jsxs("select",{className:"form-select form-select-sm",value:I,onChange:W=>S(W.target.value),children:[e.jsx("option",{value:"",children:"Select device"}),T.items.map(W=>e.jsx("option",{value:W.device_id,children:W.device_name||W.device_id},W.device_id))]}),e.jsx("div",{className:"d-flex gap-2 flex-wrap mt-2",children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Z,disabled:!I,children:"Download Device Files"})})]}):null,e.jsx("div",{className:"storage-tree",children:k?e.jsx(Ie,{nodeId:k,label:F,depth:0}):e.jsx("div",{className:"text-secondary",children:"Loading tree..."})})]})}),e.jsx("div",{className:"col-12 col-lg-9",children:e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-secondary small",children:"Current folder"}),e.jsx("div",{className:"fw-semibold",children:A})]}),e.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[e.jsxs("label",{className:"btn btn-outline-light btn-sm mb-0",children:[e.jsx("input",{type:"file",multiple:!0,hidden:!0,onChange:qe}),e.jsx("i",{className:"bi bi-upload","aria-hidden":"true"})," Upload"]}),e.jsxs("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>oe(l.folderId||k),disabled:!l.folderId&&!k,children:[e.jsx("i",{className:"bi bi-download","aria-hidden":"true"})," Download Folder"]}),e.jsxs("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Re,children:[e.jsx("i",{className:"bi bi-folder-plus","aria-hidden":"true"})," New Folder"]}),e.jsxs("div",{className:"input-group input-group-sm storage-search",children:[e.jsx("span",{className:"input-group-text",children:e.jsx("i",{className:"bi bi-search","aria-hidden":"true"})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search files",value:b,onChange:W=>P(W.target.value)}),b?e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>P(""),children:"Clear"}):null]})]})]}),e.jsx("div",{className:"storage-breadcrumb mb-3",children:v.map((W,pe)=>e.jsx("button",{type:"button",className:"btn btn-link btn-sm",onClick:()=>_e(W,pe),children:W.name},W.id))}),U.length?e.jsxs("div",{className:"card p-2 mb-3 storage-upload-queue",children:[e.jsx("div",{className:"small text-secondary",children:"Upload queue"}),U.map(W=>e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("div",{className:"text-truncate",children:W.name}),e.jsx("div",{className:`small ${W.status==="error"?"text-danger":"text-secondary"}`,children:W.status==="uploading"?"Uploading...":W.status==="done"?"Done":W.error})]},W.id))]}):null,$?e.jsxs("div",{children:[e.jsxs("div",{className:"text-secondary small mb-2",children:['Search results for "',$,'"']}),L.loading?e.jsx("div",{className:"text-secondary",children:"Searching..."}):L.error?e.jsx("div",{className:"alert alert-danger",children:L.error}):L.items.length?e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"File"}),e.jsx("th",{children:"Path"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:L.items.map(W=>e.jsxs("tr",{children:[e.jsx("td",{children:W.filename}),e.jsx("td",{className:"text-secondary",children:(W.folder_path||[]).map(pe=>pe.name).join(" / ")}),e.jsx("td",{children:Qf(W.size)}),e.jsx("td",{children:qf(W.created_at)}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Ze(W),children:"Open"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Ye({id:W.file_id}),children:"Download"})]})})]},W.file_id))})]})}):e.jsx("div",{className:"text-secondary",children:"No matching files."})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"text-secondary small mb-2",children:["Showing ",l.items.length," of ",te," items"]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:l.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:"Loading..."})}):l.items.length?l.items.map(W=>e.jsxs("tr",{className:"storage-file-row",children:[e.jsx("td",{children:W.type==="folder"?e.jsxs("button",{type:"button",className:"btn btn-link text-start",onClick:()=>Ne(W),children:[e.jsx("i",{className:"bi bi-folder me-2","aria-hidden":"true"}),W.name]}):e.jsxs("div",{children:[e.jsx("i",{className:"bi bi-file-earmark me-2","aria-hidden":"true"}),W.name]})}),e.jsx("td",{children:W.type==="folder"?"Folder":"File"}),e.jsx("td",{children:W.type==="file"?Qf(W.size||W.size_bytes):"-"}),e.jsx("td",{children:qf(W.created_at)}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[W.type==="file"?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>Ye(W),children:"Download"}):e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>oe(W.id),children:"Download"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>je(W),children:"Rename"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>ce(W,W.type),children:"Move"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>Ae(W),children:"Delete"})]})})]},W.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:"No files or folders yet."})})})]})}),Y?e.jsx("div",{className:"d-flex justify-content-center mt-3",children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Fe,children:"Load more"})}):null]})]})})]}),K.open?e.jsx("div",{className:"modal-overlay",onClick:()=>O({open:!1,item:null,type:"",targetId:""}),children:e.jsxs("div",{className:"modal-panel",onClick:W=>W.stopPropagation(),children:[e.jsxs("h5",{children:["Move ",K.type==="folder"?"Folder":"File"]}),e.jsx("div",{className:"text-secondary small mb-3",children:"Select a destination folder."}),e.jsx("select",{className:"form-select",value:K.targetId||"",onChange:W=>O(pe=>({...pe,targetId:W.target.value})),children:Me.map(W=>e.jsx("option",{value:W.id,children:W.name},W.id))}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>O({open:!1,item:null,type:"",targetId:""}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Ce,disabled:!K.targetId,children:"Move"})]})]})}):null]})}const ZS={loading:!0,error:"",items:[]};function XS(){const[t,a]=o.useState(ZS),[s,n]=o.useState({name:"",email:"",password:"",invite:!1}),[l,r]=o.useState(!1),[i,u]=o.useState("");async function c(){a(x=>({...x,loading:!0,error:""}));try{const x=await z("/api/storage/org/users");a({loading:!1,error:"",items:x.items||[]})}catch(x){a({loading:!1,error:(x==null?void 0:x.message)||"Unable to load users.",items:[]})}}o.useEffect(()=>{c()},[]);async function m(x){x.preventDefault(),u(""),r(!0);try{const f={name:s.name.trim(),email:s.email.trim(),password:s.invite?"":s.password,invite:s.invite};await z("/api/storage/org/users/create",{method:"POST",body:JSON.stringify(f)}),n({name:"",email:"",password:"",invite:!1}),await c(),u("User created.")}catch(f){u((f==null?void 0:f.message)||"Unable to create user.")}finally{r(!1)}}return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between mb-3",children:e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:"Organization Users"}),e.jsx("div",{className:"text-secondary",children:"Create and manage storage users under your organization."})]})}),i?e.jsx("div",{className:"alert alert-info",children:i}):null,t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"card p-3 mb-3",children:[e.jsx("h5",{className:"mb-2",children:"Create User"}),e.jsxs("form",{className:"row g-3",onSubmit:m,children:[e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:s.name,onChange:x=>n(f=>({...f,name:x.target.value})),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:s.email,onChange:x=>n(f=>({...f,email:x.target.value})),required:!0})]}),e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label",children:"Password"}),e.jsx("input",{type:"password",className:"form-control",value:s.password,onChange:x=>n(f=>({...f,password:x.target.value})),disabled:s.invite,required:!s.invite}),e.jsx("div",{className:"form-text text-secondary",children:"Leave empty if using invite."})]}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",id:"storage-user-invite",checked:s.invite,onChange:x=>n(f=>({...f,invite:x.target.checked}))}),e.jsx("label",{className:"form-check-label",htmlFor:"storage-user-invite",children:"Send invite (auto-generate password)"})]})}),e.jsx("div",{className:"col-12",children:e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",disabled:l,children:l?"Creating...":"Create User"})})]})]}),e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h5",{className:"mb-0",children:"Users"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:c,children:"Refresh"})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped table-hover align-middle",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Devices"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"Loading..."})}):t.items.length?t.items.map(x=>e.jsxs("tr",{children:[e.jsx("td",{children:x.name||"-"}),e.jsx("td",{children:x.email||"-"}),e.jsx("td",{children:x.role||"org_user"}),e.jsx("td",{children:x.device_count??0}),e.jsx("td",{children:x.is_active===!1?"Inactive":"Active"})]},x.user_id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"5",children:"No users found."})})})]})})]})]})}const ew={loading:!0,error:"",data:null};function js(t){const a=Number(t||0);return a?a>=1024?`${(a/1024).toFixed(1)} TB`:`${a.toFixed(0)} GB`:"0 GB"}function Qo(t){const a=Number(t||0);return Number.isNaN(a)?0:Math.min(100,Math.max(0,a))}function tw({subscriptions:t=[]}){const[a,s]=o.useState(ew),[n,l]=o.useState([]);o.useEffect(()=>{let p=!0;async function b(){try{const P=await z("/api/storage/explorer/status");if(!p)return;s({loading:!1,error:"",data:P})}catch(P){if(!p)return;s({loading:!1,error:(P==null?void 0:P.message)||"Unable to load storage usage.",data:null})}}return b(),()=>{p=!1}},[]),o.useEffect(()=>{let p=!0;async function b(){try{const P=await z("/api/dashboard/summary");if(!p)return;l(P.products||[])}catch{p&&l([])}}return b(),()=>{p=!1}},[]);const r=a.data||{},i=Number(r.total_allowed_storage_gb||0),u=Number(r.used_storage_gb||0),c=Math.max(0,i-u),m=i?Qo(u/i*100):0,x=Number(r.total_allowed_bandwidth_gb||0),f=Number(r.used_bandwidth_gb||0),j=Math.max(0,x-f),N=!!r.is_bandwidth_limited,v=x?Qo(f/x*100):0,_=Number(r.max_users||0),C=Number(r.user_count||0),y=_?Qo(C/_*100):0,h=o.useMemo(()=>[{key:"storage",title:"Storage Usage",meta:`${js(u)} used  ${js(c)} remaining`,percent:m,minLabel:"0 GB",maxLabel:js(i||0),highlight:js(u)},{key:"bandwidth",title:"Bandwidth Usage",meta:N?`${js(f)} used  ${js(j)} remaining`:"Unlimited monthly bandwidth",percent:N?v:0,minLabel:N?"0 GB":"Unlimited",maxLabel:N?js(x||0):"Unlimited",highlight:N?js(f):"Unlimited"},{key:"users",title:"User Usage",meta:_?`${C} of ${_} users`:`${C} users active`,percent:_?y:0,minLabel:"0",maxLabel:_?String(_):"Unlimited",highlight:String(C)}],[u,c,i,m,f,j,x,v,N,_,C,y]);return e.jsxs("div",{className:"container-fluid storage-dashboard",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2 mb-4",children:e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"Storage Overview"}),e.jsx("p",{className:"text-secondary mb-0",children:"Track storage, bandwidth, and user usage for your org."})]})}),a.loading?e.jsx("div",{className:"text-secondary",children:"Loading dashboard..."}):a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):e.jsx("div",{className:"row g-3",children:h.map(p=>e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 storage-meter-card h-100",children:[e.jsxs("div",{className:"storage-meter-card__header",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:p.title}),e.jsx("div",{className:"text-secondary small",children:p.meta})]}),e.jsx("div",{className:"storage-meter-card__badge",children:p.highlight})]}),e.jsxs("div",{className:"storage-meter",children:[e.jsxs("div",{className:"storage-meter__track",children:[e.jsx("div",{className:"storage-meter__fill",style:{width:`${p.percent}%`}}),e.jsx("div",{className:"storage-meter__pointer",style:{left:`${p.percent}%`},children:e.jsx("span",{className:"storage-meter__pointer-arrow"})})]}),e.jsxs("div",{className:"storage-meter__labels",children:[e.jsx("span",{children:p.minLabel}),e.jsx("span",{children:p.maxLabel})]})]})]})},p.key))}),e.jsx(Vd,{products:n,subscriptions:t,isReadOnly:!1})]})}const aw={loading:!0,error:"",conversations:[],selectedId:null,messages:[],loadingMessages:!1,filterStatus:"open",replyText:"",sendingReply:!1,sendingAttachment:!1,orgTimezone:"UTC",confirmCloseOpen:!1},sw=["","","","","","","","","","","",""];function Kf(t,a){if(!t)return"";const s=new Date(t);if(Number.isNaN(s.getTime()))return"";const l=new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:a}).formatToParts(s).reduce((r,i)=>(r[i.type]=i.value,r),{});return`${l.year}-${l.month}-${l.day} ${l.hour}:${l.minute}:${l.second}`}function Jf(t){if(!t)return!1;const a=new Date(t);if(Number.isNaN(a.getTime()))return!1;const s=new Date;return a.getFullYear()===s.getFullYear()&&a.getMonth()===s.getMonth()&&a.getDate()===s.getDate()}function nw(){const[t,a]=o.useState(aw),[s,n]=o.useState("all"),[l,r]=o.useState(!1),[i,u]=o.useState(!1),[c,m]=o.useState({loading:!0,premadeReplies:[],allowVisitorAttachments:!1}),[x,f]=o.useState(()=>window.localStorage.getItem("wz_ai_chatbot_admin_sound")!=="0"),j=o.useRef(null),N=o.useRef(!1),v=o.useRef(new Set),_=o.useRef(!1),C=o.useRef({conversations:null,messages:null}),y=o.useRef(null);o.useEffect(()=>{let S=!0;async function k(){try{const M=new URLSearchParams;M.set("status",t.filterStatus),s!=="all"&&M.set("category",s);const A=await z(`/api/ai-chatbot/inbox/conversations?${M.toString()}`);if(!S)return;a(F=>{var te,Y;return{...F,loading:!1,error:"",conversations:A.conversations||[],selectedId:((Y=(te=A.conversations)==null?void 0:te[0])==null?void 0:Y.id)||null}})}catch(M){S&&a(A=>({...A,loading:!1,error:(M==null?void 0:M.message)||"Unable to load conversations."}))}}return k(),()=>{S=!1}},[t.filterStatus,s]),o.useEffect(()=>{let S=!0;async function k(){try{const M=await z("/api/ai-chatbot/org/chat-settings");if(!S)return;m({loading:!1,premadeReplies:M.premade_replies||[],allowVisitorAttachments:!!M.allow_visitor_attachments})}catch(M){S&&(m(A=>({...A,loading:!1})),a(A=>({...A,error:(M==null?void 0:M.message)||"Unable to load chat settings."})))}}return k(),()=>{S=!1}},[]);async function h(S,{silent:k=!1,retryOnAssign:M=!0}={}){var A;if(!S){a(F=>({...F,messages:[]}));return}k||a(F=>({...F,loadingMessages:!0}));try{const F=await z(`/api/ai-chatbot/inbox/conversations/${S}/messages`);a(te=>({...te,loadingMessages:!1,messages:F.messages||[],orgTimezone:F.org_timezone||te.orgTimezone||"UTC"}))}catch(F){if((F==null?void 0:F.status)===409&&((A=F==null?void 0:F.data)==null?void 0:A.detail)==="conversation_unassigned"&&M){try{return await z(`/api/ai-chatbot/inbox/conversations/${S}/take`,{method:"POST"}),h(S,{silent:k,retryOnAssign:!1})}catch(te){a(Y=>({...Y,loadingMessages:!1,error:(te==null?void 0:te.message)||"Unable to take conversation."}))}return}a(te=>({...te,loadingMessages:!1,error:(F==null?void 0:F.message)||"Unable to load messages."}))}}o.useEffect(()=>{h(t.selectedId)},[t.selectedId]),o.useEffect(()=>(C.current.conversations&&window.clearInterval(C.current.conversations),C.current.conversations=window.setInterval(()=>{P()},5e3),()=>{C.current.conversations&&(window.clearInterval(C.current.conversations),C.current.conversations=null)}),[t.filterStatus,s]),o.useEffect(()=>(C.current.messages&&window.clearInterval(C.current.messages),t.selectedId?(C.current.messages=window.setInterval(()=>{h(t.selectedId,{silent:!0})},4e3),()=>{C.current.messages&&(window.clearInterval(C.current.messages),C.current.messages=null)}):()=>{}),[t.selectedId]);function p(){if(!x)return;const S=window.AudioContext||window.webkitAudioContext;if(S)try{const k=new S,M=k.createGain(),A=k.createOscillator();A.type="sine",A.frequency.value=880,M.gain.value=.25,A.connect(M),M.connect(k.destination),A.start(),M.gain.exponentialRampToValueAtTime(.001,k.currentTime+.6),A.stop(k.currentTime+.6),window.setTimeout(()=>{const F=k.createOscillator(),te=k.createGain();F.type="sine",F.frequency.value=660,te.gain.value=.25,F.connect(te),te.connect(k.destination),F.start(),te.gain.exponentialRampToValueAtTime(.001,k.currentTime+1),F.stop(k.currentTime+1)},150)}catch{}}function b(){if(!x)return;const S=window.AudioContext||window.webkitAudioContext;if(S)try{const k=new S,M=k.createGain(),A=k.createOscillator();A.type="triangle",A.frequency.value=740,M.gain.value=.2,A.connect(M),M.connect(k.destination),A.start(),M.gain.exponentialRampToValueAtTime(.001,k.currentTime+.35),A.stop(k.currentTime+.35)}catch{}}o.useEffect(()=>{const S=t.conversations||[];if(!S.length)return;if(!_.current){S.forEach(M=>{M!=null&&M.id&&v.current.add(M.id)}),_.current=!0;return}const k=S.filter(M=>(M==null?void 0:M.id)&&!v.current.has(M.id));k.length&&(k.forEach(M=>{M!=null&&M.id&&v.current.add(M.id)}),p())},[t.conversations]),o.useEffect(()=>{if(!t.messages.length)return;const S=t.messages[t.messages.length-1];if(!N.current){j.current=S.id,N.current=!0;return}S.id&&S.id!==j.current&&(j.current=S.id,b())},[t.messages]);async function P(){a(S=>({...S,loading:!0,error:""}));try{const S=new URLSearchParams;S.set("status",t.filterStatus),s!=="all"&&S.set("category",s);const k=await z(`/api/ai-chatbot/inbox/conversations?${S.toString()}`);a(M=>{var te;const A=k.conversations||[],F=A.some(Y=>Y.id===M.selectedId);return{...M,loading:!1,conversations:A,selectedId:F?M.selectedId:((te=A[0])==null?void 0:te.id)||null}})}catch(S){a(k=>({...k,loading:!1,error:(S==null?void 0:S.message)||"Unable to load conversations."}))}}const $=t.conversations.find(S=>S.id===t.selectedId);function E(){f(S=>{const k=!S;return window.localStorage.setItem("wz_ai_chatbot_admin_sound",k?"1":"0"),k})}async function L(){if(!(!t.selectedId||!t.replyText.trim()||t.sendingReply)){a(S=>({...S,sendingReply:!0}));try{const k=(await z(`/api/ai-chatbot/inbox/conversations/${t.selectedId}/reply`,{method:"POST",body:JSON.stringify({text:t.replyText.trim()})})).message;a(M=>({...M,sendingReply:!1,replyText:"",messages:k?[...M.messages,k]:M.messages})),await P()}catch(S){a(k=>({...k,sendingReply:!1,error:(S==null?void 0:S.message)||"Unable to send reply."}))}}}function V(S){S.key==="Enter"&&(S.ctrlKey||S.metaKey)&&(S.preventDefault(),L())}async function U(S){var M;const k=(M=S.target.files)==null?void 0:M[0];if(!(!k||!t.selectedId)){a(A=>({...A,sendingAttachment:!0}));try{es()||await fetch("/api/auth/csrf",{credentials:"include"});const A=new FormData;A.append("file",k);const F=await fetch(`/api/ai-chatbot/inbox/conversations/${t.selectedId}/attachment`,{method:"POST",credentials:"include",headers:{"X-CSRFToken":es()},body:A}),te=await F.json();if(!F.ok)throw new Error((te==null?void 0:te.detail)||"Unable to upload attachment.");const Y=te.message;a(ue=>({...ue,sendingAttachment:!1,messages:Y?[...ue.messages,Y]:ue.messages})),await P()}catch(A){a(F=>({...F,sendingAttachment:!1,error:(A==null?void 0:A.message)||"Unable to upload attachment."}))}finally{S.target&&(S.target.value="")}}}function w(S){a(k=>({...k,replyText:`${k.replyText}${S}`})),r(!1)}function Q(){r(S=>!S)}function J(){u(S=>!S)}function me(S){S&&(a(k=>({...k,replyText:k.replyText?`${k.replyText} ${S}`:S})),u(!1))}async function re(){if(c.loading)return;const S=!c.allowVisitorAttachments;m(k=>({...k,allowVisitorAttachments:S}));try{const k=await z("/api/ai-chatbot/org/chat-settings",{method:"PATCH",body:JSON.stringify({allow_visitor_attachments:S})});m(M=>({...M,premadeReplies:k.premade_replies||M.premadeReplies,allowVisitorAttachments:!!k.allow_visitor_attachments}))}catch(k){m(M=>({...M,allowVisitorAttachments:!S})),a(M=>({...M,error:(k==null?void 0:k.message)||"Unable to update chat settings."}))}}async function K(S){if(t.selectedId){if(S==="close"){a(k=>({...k,confirmCloseOpen:!0}));return}try{await z(`/api/ai-chatbot/inbox/conversations/${t.selectedId}/${S}`,{method:"POST"}),await P()}catch(k){a(M=>({...M,error:(k==null?void 0:k.message)||"Unable to update status."}))}}}async function O(){const S=t.selectedId;if(!S){a(k=>({...k,confirmCloseOpen:!1}));return}a(k=>({...k,confirmCloseOpen:!1}));try{await z(`/api/ai-chatbot/inbox/conversations/${S}/close`,{method:"POST"}),await P()}catch(k){a(M=>({...M,error:(k==null?void 0:k.message)||"Unable to update status."}))}}const T=t.conversations.filter(S=>Jf(S.last_message_at||S.created_at)),H=t.conversations.filter(S=>!Jf(S.last_message_at||S.created_at));function I(S){return t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:"Loading..."})}):S.length?S.map(k=>{const M=k.source==="public_page"?"Public Page":"Widget",A=k.source==="public_page"?"bg-info":"bg-secondary",F=k.category?k.category.charAt(0).toUpperCase()+k.category.slice(1):"-",te=k.category==="sales"?"bg-success":k.category==="support"?"bg-primary":"bg-secondary",Y=k.visitor_name||k.visitor_id;return e.jsxs("tr",{className:k.id===t.selectedId?"table-active":"",onClick:()=>a(ue=>({...ue,selectedId:k.id})),style:{cursor:"pointer"},children:[e.jsx("td",{children:e.jsx("div",{className:"ai-chatbot-visitor",children:e.jsx("div",{children:Y})})}),e.jsx("td",{children:k.widget_name}),e.jsx("td",{children:e.jsx("span",{className:`badge ${te}`,children:F})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${A}`,children:M})}),e.jsx("td",{children:e.jsxs("span",{className:`ai-chatbot-presence ai-chatbot-presence--${k.visitor_status||"offline"}`,children:[e.jsx("span",{className:"ai-chatbot-presence__dot"}),e.jsx("span",{children:k.visitor_status||"offline"})]})}),e.jsx("td",{children:e.jsx("span",{className:`ai-chatbot-status ai-chatbot-status--${k.status}`,children:k.status})})]},k.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:"No conversations yet."})})}return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"AI Chatbot Inbox"}),e.jsx("div",{className:"text-secondary",children:"View visitor conversations and messages."})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:E,title:x?"Sound on":"Sound off",children:x?e.jsx("svg",{viewBox:"0 0 24 24",width:"16",height:"16","aria-hidden":"true",children:e.jsx("path",{fill:"currentColor",d:"M3 9v6h4l5 4V5L7 9H3zm13.5 3a4.5 4.5 0 0 0-2.25-3.9v7.8A4.5 4.5 0 0 0 16.5 12zm0-9a1 1 0 0 0-1 1 1 1 0 0 0 .5.87 8.5 8.5 0 0 1 0 14.26 1 1 0 0 0-.5.87 1 1 0 0 0 1 1 1 1 0 0 0 .5-.14 10.5 10.5 0 0 0 0-17.46 1 1 0 0 0-.5-.14z"})}):e.jsxs("svg",{viewBox:"0 0 24 24",width:"16",height:"16","aria-hidden":"true",children:[e.jsx("path",{fill:"currentColor",d:"M3 9v6h4l5 4V5L7 9H3zm13.5 3a4.5 4.5 0 0 0-2.25-3.9v7.8A4.5 4.5 0 0 0 16.5 12z"}),e.jsx("path",{fill:"currentColor",d:"M18.3 5.7a1 1 0 0 0-1.4 0l-10 10a1 1 0 0 0 1.4 1.4l10-10a1 1 0 0 0 0-1.4z"})]})}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:P,children:"Refresh"})]})]}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-lg-4",children:e.jsxs("div",{className:"user-panel h-100",children:[e.jsxs("div",{className:"user-panel-header d-flex align-items-center justify-content-between",children:[e.jsx("div",{className:"user-panel-title",children:"Conversations"}),e.jsxs("span",{className:"text-secondary small",children:[t.conversations.length," total"]})]}),e.jsxs("div",{className:"ai-chatbot-filters",children:[["open","closed","all"].map(S=>e.jsx("button",{type:"button",className:`btn btn-sm ${t.filterStatus===S?"btn-primary":"btn-outline-light"}`,onClick:()=>a(k=>({...k,filterStatus:S})),children:S==="all"?"All":S.charAt(0).toUpperCase()+S.slice(1)},S)),e.jsxs("select",{className:"form-select form-select-sm ai-chatbot-category",value:s,onChange:S=>n(S.target.value),children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"sales",children:"Sales"}),e.jsx("option",{value:"support",children:"Support"})]})]}),e.jsxs("div",{className:"table-responsive",children:[e.jsxs("table",{className:"table table-dark table-hover mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Visitor"}),e.jsx("th",{children:"Widget"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Presence"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:I(T)})]}),e.jsx("div",{className:"section-divider my-2"}),e.jsx("div",{className:"small text-secondary mb-2",children:"Older Conversations"}),e.jsxs("table",{className:"table table-dark table-hover mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Visitor"}),e.jsx("th",{children:"Widget"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Presence"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:I(H)})]})]})]})}),e.jsx("div",{className:"col-lg-8",children:e.jsxs("div",{className:"user-panel h-100",children:[e.jsxs("div",{className:"user-panel-header d-flex align-items-center justify-content-between",children:[e.jsx("div",{className:"user-panel-title",children:$?$.visitor_name||$.visitor_id||"Visitor":"Messages"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{className:"text-secondary small",children:$?$.widget_name:""}),$?e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:`ai-chatbot-presence ai-chatbot-presence--${$.visitor_status||"offline"}`,children:[e.jsx("span",{className:"ai-chatbot-presence__dot"}),e.jsx("span",{children:$.visitor_status||"offline"})]}),e.jsx("span",{className:`badge ${$.category==="sales"?"bg-success":"bg-primary"}`,children:($.category||"support").charAt(0).toUpperCase()+($.category||"support").slice(1)}),e.jsx("span",{className:`badge ${$.source==="public_page"?"bg-info":"bg-secondary"}`,children:$.source==="public_page"?"Public Page":"Widget"})]}):null,$?$.status==="open"?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>K("close"),children:"Close"}):e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>K("reopen"),children:"Reopen"}):null]})]}),e.jsx("div",{className:"ai-chatbot-thread",children:t.loadingMessages?e.jsx("div",{className:"text-secondary",children:"Loading messages..."}):t.messages.length?t.messages.map(S=>{var Y;const k=!!S.attachment_url,M=S.text&&(!k||S.text!==S.attachment_name),A=Kf(S.created_at),F=Kf(S.created_at,t.orgTimezone),te=[A,F&&F!==A?F:""].filter(Boolean).join(" / ");return e.jsxs("div",{className:`ai-chatbot-message ai-chatbot-message--${S.sender_type}`,children:[M?e.jsx("div",{className:"ai-chatbot-message__text",children:S.text}):null,k?(Y=S.attachment_type)!=null&&Y.startsWith("image/")?e.jsx("a",{className:"ai-chatbot-attachment",href:S.attachment_url,target:"_blank",rel:"noreferrer",children:e.jsx("img",{className:"ai-chatbot-attachment__image",src:S.attachment_url,alt:S.attachment_name||"Attachment"})}):e.jsx("a",{className:"ai-chatbot-attachment",href:S.attachment_url,target:"_blank",rel:"noreferrer",children:S.attachment_name||"Download attachment"}):null,e.jsxs("div",{className:"ai-chatbot-message__meta",children:[S.sender_type," - ",te||"-"]})]},S.id)}):e.jsx("div",{className:"text-secondary",children:"Select a conversation to view messages."})}),e.jsxs("div",{className:"ai-chatbot-composer",children:[e.jsxs("div",{className:"ai-chatbot-composer__actions",children:[e.jsx("button",{type:"button",className:"ai-chatbot-action-btn",onClick:()=>{var S;return(S=y.current)==null?void 0:S.click()},disabled:!$||t.sendingAttachment,title:"Attach file",children:e.jsx("i",{className:"bi bi-paperclip","aria-hidden":"true"})}),e.jsx("button",{type:"button",className:`ai-chatbot-action-btn ${l?"is-active":""}`,onClick:Q,title:"Insert emoji",children:e.jsx("i",{className:"bi bi-emoji-smile","aria-hidden":"true"})}),e.jsx("button",{type:"button",className:`ai-chatbot-action-btn ${i?"is-active":""}`,onClick:J,title:"Premade replies",children:e.jsx("i",{className:"bi bi-chat-left-text","aria-hidden":"true"})}),e.jsx("button",{type:"button",className:`ai-chatbot-action-btn ${c.allowVisitorAttachments?"is-active":""}`,onClick:re,disabled:c.loading,title:"Toggle visitor attachments",children:e.jsx("i",{className:"bi bi-cloud-arrow-up","aria-hidden":"true"})}),e.jsx("input",{ref:y,type:"file",className:"ai-chatbot-composer__file",accept:".png,.jpg,.jpeg,.gif,.webp,.pdf,.doc,.docx,.xls,.xlsx,.txt,.csv",onChange:U,disabled:!$||t.sendingAttachment}),l?e.jsx("div",{className:"ai-chatbot-emoji-panel",children:sw.map(S=>e.jsx("button",{type:"button",className:"ai-chatbot-emoji-panel__item",onClick:()=>w(S),children:S},S))}):null,i?e.jsx("div",{className:"ai-chatbot-emoji-panel ai-chatbot-emoji-panel--wide",children:c.premadeReplies.length?c.premadeReplies.map(S=>e.jsx("button",{type:"button",className:"ai-chatbot-emoji-panel__item ai-chatbot-emoji-panel__item--text",onClick:()=>me(S),children:S},S)):e.jsx("span",{className:"ai-chatbot-emoji-panel__empty",children:"No premade replies."})}):null]}),e.jsx("textarea",{className:"form-control ai-chatbot-composer__input",rows:2,placeholder:"Type a reply...",value:t.replyText,onChange:S=>a(k=>({...k,replyText:S.target.value})),onKeyDown:V,disabled:!$}),e.jsx("button",{type:"button",className:"btn btn-primary",disabled:!$||!t.replyText.trim()||t.sendingReply,onClick:L,children:t.sendingReply?"Sending...":"Send"})]})]})})]}),t.confirmCloseOpen?e.jsx("div",{className:"wz-modal__backdrop",children:e.jsxs("div",{className:"wz-modal",children:[e.jsx("div",{className:"wz-modal__title",children:"Close chat?"}),e.jsx("div",{className:"wz-modal__body",children:"Closing this chat will end the live conversation for the visitor. Do you want to close it now?"}),e.jsxs("div",{className:"wz-modal__actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>a(S=>({...S,confirmCloseOpen:!1})),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary btn-sm",onClick:O,children:"Close Chat"})]})]})}):null]})}const lw={loading:!0,error:"",widgets:[]},Zf={id:null,name:"",allowedDomains:"",themePreset:"emerald",themePrimary:"",themeAccent:"",themeBackground:""},rw=[{value:"emerald",label:"Emerald"},{value:"ocean",label:"Ocean"},{value:"violet",label:"Violet"},{value:"amber",label:"Amber"},{value:"graphite",label:"Graphite"},{value:"custom",label:"Custom"}];function iw(t){return!t||!t.length?"All domains":t.join(", ")}function Xf(t){return`<script src="/static/js/ai_chatbot_widget.js" data-widget-key="${t}"><\/script>`}function ep(t,a){return`/api/org/ai-chatbox/qr.${t}?widget_id=${encodeURIComponent(a)}`}function ow(){const[t,a]=o.useState(lw),[s,n]=o.useState(Zf),[l,r]=o.useState(!1),[i,u]=o.useState(""),[c,m]=o.useState(""),x=o.useMemo(()=>{if(!s.id||!s.name)return"";const h=t.widgets.find(p=>p.id===s.id);return h?Xf(h.widget_key):""},[s.id,s.name,t.widgets]),f=o.useMemo(()=>{const h=c.trim().toLowerCase();return h?t.widgets.filter(p=>{var V;const b=p.name||"",P=(p.allowed_domains||[]).join(", "),$=p.is_active?"active":"inactive",E=((V=p.theme)==null?void 0:V.preset)||"emerald",L=p.public_chat_url||"";return[b,P,$,E,L].some(U=>String(U).toLowerCase().includes(h))}):t.widgets},[c,t.widgets]);o.useEffect(()=>{let h=!0;async function p(){a(b=>({...b,loading:!0,error:""}));try{const b=await z("/api/ai-chatbot/widgets");h&&a({loading:!1,error:"",widgets:b.widgets||[]})}catch(b){h&&a({loading:!1,error:(b==null?void 0:b.message)||"Unable to load widgets.",widgets:[]})}}return p(),()=>{h=!1}},[]);async function j(){u(""),a(h=>({...h,loading:!0,error:""}));try{const h=await z("/api/ai-chatbot/widgets");a({loading:!1,error:"",widgets:h.widgets||[]})}catch(h){a({loading:!1,error:(h==null?void 0:h.message)||"Unable to load widgets.",widgets:[]})}}async function N(h){if(h.preventDefault(),!s.name.trim()){a(p=>({...p,error:"Widget name is required."}));return}r(!0),u("");try{const p={name:s.name.trim(),allowed_domains:s.allowedDomains,theme:{preset:s.themePreset,primary:s.themePrimary,accent:s.themeAccent,background:s.themeBackground}};let b=null;return s.id?b=await z(`/api/ai-chatbot/widgets/${s.id}`,{method:"PATCH",body:JSON.stringify(p)}):b=await z("/api/ai-chatbot/widgets",{method:"POST",body:JSON.stringify(p)}),n({id:null,name:"",allowedDomains:"",themePreset:"emerald",themePrimary:"",themeAccent:"",themeBackground:""}),await j(),u(s.id?"Widget updated.":"Widget created."),b}catch(p){a(b=>({...b,error:(p==null?void 0:p.message)||"Unable to save widget."}))}finally{r(!1)}}function v(h){const p=h.theme||{};n({id:h.id,name:h.name||"",allowedDomains:(h.allowed_domains||[]).join(`
`),themePreset:p.preset||"emerald",themePrimary:p.primary||"",themeAccent:p.accent||"",themeBackground:p.background||""}),u("")}async function _(h){u("");try{await z(`/api/ai-chatbot/widgets/${h.id}`,{method:"PATCH",body:JSON.stringify({is_active:!h.is_active})}),await j()}catch(p){a(b=>({...b,error:(p==null?void 0:p.message)||"Unable to update widget."}))}}async function C(h){if(window.confirm("Delete this widget? This cannot be undone.")){u("");try{await z(`/api/ai-chatbot/widgets/${h.id}`,{method:"DELETE"}),await j()}catch(b){a(P=>({...P,error:(b==null?void 0:b.message)||"Unable to delete widget."}))}}}async function y(h){if(h)try{await navigator.clipboard.writeText(h),u("Embed snippet copied.")}catch{a(b=>({...b,error:"Copy failed. Please copy manually."}))}}return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"AI Chatbot Widgets"}),e.jsx("div",{className:"text-secondary",children:"Create widgets and copy the embed snippet."})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:j,children:"Refresh"})]}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,i?e.jsx("div",{className:"alert alert-success",children:i}):null,e.jsxs("div",{className:"user-panel mb-4",children:[e.jsx("div",{className:"user-panel-header",children:e.jsx("div",{className:"user-panel-title",children:s.id?"Edit Widget":"New Widget"})}),e.jsx("form",{onSubmit:N,className:"p-3",children:e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-lg-6",children:[e.jsx("label",{className:"form-label",children:"Widget Name"}),e.jsx("input",{type:"text",className:"form-control",value:s.name,onChange:h=>n(p=>({...p,name:h.target.value})),placeholder:"Support Widget"})]}),e.jsxs("div",{className:"col-lg-6",children:[e.jsx("label",{className:"form-label",children:"Theme Preset"}),e.jsx("select",{className:"form-select",value:s.themePreset,onChange:h=>n(p=>({...p,themePreset:h.target.value})),children:rw.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]}),s.themePreset==="custom"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"col-lg-2",children:[e.jsx("label",{className:"form-label",children:"Primary"}),e.jsx("input",{type:"color",className:"form-control form-control-color",value:s.themePrimary||"#22c55e",onChange:h=>n(p=>({...p,themePrimary:h.target.value}))})]}),e.jsxs("div",{className:"col-lg-2",children:[e.jsx("label",{className:"form-label",children:"Accent"}),e.jsx("input",{type:"color",className:"form-control form-control-color",value:s.themeAccent||"#2563eb",onChange:h=>n(p=>({...p,themeAccent:h.target.value}))})]}),e.jsxs("div",{className:"col-lg-2",children:[e.jsx("label",{className:"form-label",children:"Background"}),e.jsx("input",{type:"color",className:"form-control form-control-color",value:s.themeBackground||"#0f172a",onChange:h=>n(p=>({...p,themeBackground:h.target.value}))})]})]}):null,e.jsxs("div",{className:"col-lg-9",children:[e.jsx("label",{className:"form-label",children:"Allowed Domains (comma or newline)"}),e.jsx("textarea",{className:"form-control",rows:2,value:s.allowedDomains,onChange:h=>n(p=>({...p,allowedDomains:h.target.value})),placeholder:"example.com, app.example.com"})]}),e.jsxs("div",{className:"col-lg-3 d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:l,children:l?"Saving...":s.id?"Update":"Create"}),s.id?e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>n(Zf),children:"Cancel"}):null]})]})})]}),e.jsxs("div",{className:"user-panel",children:[e.jsxs("div",{className:"user-panel-header ai-chatbot-widgets-header",children:[e.jsx("div",{className:"user-panel-title",children:"Widgets"}),e.jsx("div",{className:"ai-chatbot-widgets-search",children:e.jsx("input",{type:"search",className:"form-control form-control-sm",placeholder:"Search widgets...",value:c,onChange:h=>m(h.target.value)})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-striped align-middle mb-0 ai-chatbot-widgets-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Domains"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Theme"}),e.jsx("th",{children:"Public Chat URL"}),e.jsx("th",{children:"Embed Script"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:7,children:"Loading..."})}):f.length?f.map(h=>{var b;const p=Xf(h.widget_key);return e.jsxs("tr",{children:[e.jsx("td",{children:h.name}),e.jsx("td",{children:iw(h.allowed_domains)}),e.jsx("td",{children:h.is_active?"Active":"Inactive"}),e.jsx("td",{children:((b=h.theme)==null?void 0:b.preset)||"emerald"}),e.jsx("td",{children:e.jsx("div",{className:"ai-chatbot-widgets-actions",children:e.jsxs("div",{className:"ai-chatbot-widgets-actions-row",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>y(h.public_chat_url),disabled:!h.public_chat_url,children:"Copy URL"}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:ep("png",h.id),children:"QR PNG"}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:ep("svg",h.id),children:"QR SVG"})]})})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>y(p),children:"Copy"})}),e.jsxs("td",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>v(h),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>_(h),children:h.is_active?"Disable":"Enable"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>C(h),children:"Delete"})]})]},h.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:7,children:t.widgets.length?"No matches found.":"No widgets yet."})})})]})})]}),x?e.jsx("div",{className:"mt-3 text-secondary",children:"Embed snippet ready for copy."}):null]})}const cw={loading:!0,error:"",leads:[],widgets:[],retentionDays:30,toast:""},dw=[{value:7,label:"Last 7 days"},{value:14,label:"Last 14 days"},{value:30,label:"Last 30 days"}];function uw(t){if(!t)return"-";const a=new Date(t);return Number.isNaN(a.getTime())?t:a.toLocaleString()}function tp(t,a=80){const s=String(t||"");return s.length<=a?s||"-":`${s.slice(0,a)}...`}function mw(){const[t,a]=o.useState(cw),[s,n]=o.useState(7),[l,r]=o.useState(""),i=o.useMemo(()=>t.widgets||[],[t.widgets]);o.useEffect(()=>{let x=!0;async function f(){a(j=>({...j,loading:!0,error:""}));try{const[j,N]=await Promise.all([z(`/api/ai-chatbot/leads?days=${s}${l?`&widget_id=${l}`:""}`),z("/api/ai-chatbot/widgets")]);x&&a({loading:!1,error:"",leads:j.leads||[],widgets:N.widgets||[],retentionDays:j.retention_days||30,toast:""})}catch(j){x&&a({loading:!1,error:(j==null?void 0:j.message)||"Unable to load leads.",leads:[],widgets:[],retentionDays:30,toast:""})}}return f(),()=>{x=!1}},[s,l]);function u(x){a(f=>({...f,toast:x})),x&&window.setTimeout(()=>{a(f=>({...f,toast:""}))},2e3)}async function c(x,f){a(j=>({...j,leads:j.leads.map(N=>N.id===x?{...N,status:f}:N)}));try{await z(`/api/ai-chatbot/leads/${x}`,{method:"PATCH",body:JSON.stringify({status:f})}),u("Updated")}catch(j){a(N=>({...N,error:(j==null?void 0:j.message)||"Unable to update status."}))}}async function m(x){if(window.confirm("Delete this lead? This cannot be undone."))try{await z(`/api/ai-chatbot/leads/${x}/delete`,{method:"DELETE"}),a(j=>({...j,leads:j.leads.filter(N=>N.id!==x)})),u("Deleted")}catch(j){a(N=>({...N,error:(j==null?void 0:j.message)||"Unable to delete lead."}))}}return e.jsxs("div",{children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:"AI Chatbot Leads"}),e.jsx("div",{className:"text-secondary",children:"Latest enquiry form submissions from your widget."})]})}),e.jsx("hr",{className:"section-divider"}),e.jsx("div",{className:"wz-alert wz-alert--info",children:e.jsxs("div",{children:["Leads are retained for ",t.retentionDays," days based on your plans Chat History setting. Older leads are auto-deleted."]})}),t.toast?e.jsx("div",{className:"wz-alert wz-alert--success",children:t.toast}):null,e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"table-controls",children:[e.jsxs("div",{className:"table-search",children:[e.jsx("label",{htmlFor:"leads-days",children:"Days"}),e.jsx("select",{id:"leads-days",className:"form-select",value:s,onChange:x=>n(Number(x.target.value)),children:dw.map(x=>e.jsx("option",{value:x.value,children:x.label},x.value))})]}),e.jsxs("div",{className:"table-search",children:[e.jsx("label",{htmlFor:"leads-widget",children:"Widget"}),e.jsxs("select",{id:"leads-widget",className:"form-select",value:l,onChange:x=>r(x.target.value),children:[e.jsx("option",{value:"",children:"All widgets"}),i.map(x=>e.jsx("option",{value:x.id,children:x.name},x.id))]})]})]}),t.loading?e.jsx("div",{className:"text-center py-4",children:"Loading leads..."}):t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-borderless",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Message"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Widget"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:t.leads.length?t.leads.map(x=>e.jsxs("tr",{children:[e.jsx("td",{children:x.name||"-"}),e.jsx("td",{children:x.phone||"-"}),e.jsx("td",{children:x.email||"-"}),e.jsx("td",{title:x.message||"",children:tp(x.message||"")}),e.jsx("td",{children:uw(x.created_at)}),e.jsx("td",{children:x.widget_name||"-"}),e.jsx("td",{children:x.source_url?e.jsx("a",{href:x.source_url,target:"_blank",rel:"noreferrer",children:tp(x.source_url,40)}):"-"}),e.jsx("td",{children:e.jsxs("select",{className:"form-select form-select-sm",value:x.status||"fresh",onChange:f=>c(x.id,f.target.value),children:[e.jsx("option",{value:"fresh",children:"Fresh"}),e.jsx("option",{value:"following",children:"Following"}),e.jsx("option",{value:"completed",children:"Completed"})]})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>m(x.id),children:"Delete"})})]},x.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:9,children:"No leads found."})})})]})})]})]})}function hw(t){if(!t)return{country:"+91",phone:""};const a=t.split(" ");if(a.length>1){const s=a[0],n=a.slice(1).join(" ");if(Fs.some(l=>l.code===s))return{country:s,phone:n}}return{country:"+91",phone:t}}function fw({agent:t,onClose:a,onSuccess:s,onError:n}){const[l,r]=o.useState({name:"",email:"",phone:"",phoneCountry:"+91",agentRole:"support"}),[i,u]=o.useState(!1);o.useEffect(()=>{if(t){const{country:m,phone:x}=hw(t.phone);r({name:t.name||"",email:t.email||"",phone:x||"",phoneCountry:m||"+91",agentRole:t.agent_role||"support"})}},[t]);async function c(m){if(m.preventDefault(),!!t){u(!0);try{const x={name:l.name.trim(),email:l.email.trim(),phone:`${l.phoneCountry} ${l.phone.trim()}`.trim(),agent_role:l.agentRole};await z(`/api/ai-chatbot/org/agents/${t.id}`,{method:"PATCH",body:JSON.stringify(x)}),s()}catch(x){n(x)}finally{u(!1)}}}return t?e.jsx("div",{className:"wz-modal__backdrop",children:e.jsxs("div",{className:"wz-modal wz-agent-modal",children:[e.jsxs("div",{className:"modal-header d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"modal-title",children:"Edit Agent"}),e.jsx("button",{type:"button",className:"btn-close",onClick:a})]}),e.jsx("hr",{className:"section-divider mt-0 mb-3"}),e.jsxs("form",{onSubmit:c,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:l.name,onChange:m=>r(x=>({...x,name:m.target.value})),placeholder:"Agent name"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:l.email,onChange:m=>r(x=>({...x,email:m.target.value})),placeholder:"agent@example.com",required:!0})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Role"}),e.jsxs("select",{className:"form-select",value:l.agentRole,onChange:m=>r(x=>({...x,agentRole:m.target.value})),children:[e.jsx("option",{value:"support",children:"Support"}),e.jsx("option",{value:"sales",children:"Sales"}),e.jsx("option",{value:"both",children:"Both"})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select wz-phone-country-select",value:l.phoneCountry,onChange:m=>r(x=>({...x,phoneCountry:m.target.value})),children:Fs.map(m=>e.jsxs("option",{value:m.code,children:[m.label," ",m.code]},`${m.code}-${m.label}`))}),e.jsx("input",{type:"text",className:"form-control",value:l.phone,onChange:m=>r(x=>({...x,phone:m.target.value})),placeholder:"Phone number"})]})]})]})}),e.jsxs("div",{className:"modal-footer wz-modal__actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:a,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:i,children:i?"Saving...":"Update Agent"})]})]})]})}):null}const pw={loading:!0,error:"",agents:[],toast:"",tempPassword:""},ap={name:"",email:"",phone:"",phoneCountry:"+91",password:"",chatAccess:["support"]};function xw(){var P,$;const[t,a]=o.useState(pw),[s,n]=o.useState(ap),[l,r]=o.useState(!1),[i,u]=o.useState(!1),[c,m]=o.useState({open:!1,agent:null}),[x,f]=o.useState({open:!1,agent:null,newPassword:"",confirmPassword:"",submitting:!1});o.useEffect(()=>{let E=!0;async function L(){a(V=>({...V,loading:!0,error:""}));try{const V=await z("/api/ai-chatbot/org/agents");E&&a(U=>({...U,loading:!1,error:"",agents:V.agents||[]}))}catch(V){E&&a(U=>({...U,loading:!1,error:(V==null?void 0:V.message)||"Unable to load agents."}))}}return L(),()=>{E=!1}},[]);function j(E,L=""){a(V=>({...V,toast:E,tempPassword:L})),E&&window.setTimeout(()=>{a(V=>({...V,toast:"",tempPassword:""}))},2500)}function N(E){m({open:!0,agent:E})}async function v(){a(E=>({...E,loading:!0,error:""}));try{const E=await z("/api/ai-chatbot/org/agents");a(L=>({...L,loading:!1,agents:E.agents||[]}))}catch(E){a(L=>({...L,loading:!1,error:(E==null?void 0:E.message)||"Unable to load agents."}))}}function _(E){const{value:L,checked:V}=E.target;n(U=>{const{chatAccess:w}=U;return V?{...U,chatAccess:[...w,L]}:{...U,chatAccess:w.filter(Q=>Q!==L)}})}async function C(E){if(E.preventDefault(),!s.email.trim()){a(L=>({...L,error:"Email is required."}));return}if(!s.password.trim()){a(L=>({...L,error:"Temp password is required."}));return}if(s.chatAccess.length===0){a(L=>({...L,error:"Select at least one chat access type."}));return}r(!0);try{const L={name:s.name.trim(),email:s.email.trim(),phone:`${s.phoneCountry} ${s.phone.trim()}`.trim(),password:s.password.trim(),chat_access:s.chatAccess},V=await z("/api/ai-chatbot/org/agents",{method:"POST",body:JSON.stringify(L)});n(ap),await v(),j("Agent created.",V.temp_password||""),u(!1)}catch(L){a(V=>({...V,error:(L==null?void 0:L.message)||"Unable to create agent."}))}finally{r(!1)}}async function y(E){try{await z(`/api/ai-chatbot/org/agents/${E.id}`,{method:"PATCH",body:JSON.stringify({is_active:!E.is_active})}),await v(),j(E.is_active?"Agent disabled.":"Agent enabled.")}catch(L){a(V=>({...V,error:(L==null?void 0:L.message)||"Unable to update agent."}))}}async function h(E){if(window.confirm("Delete this agent? This cannot be undone."))try{await z(`/api/ai-chatbot/org/agents/${E.id}`,{method:"DELETE"}),a(V=>({...V,agents:V.agents.filter(U=>U.id!==E.id)})),j("Agent deleted.")}catch(V){a(U=>({...U,error:(V==null?void 0:V.message)||"Unable to delete agent."}))}}function p(E){f({open:!0,agent:E,newPassword:"",confirmPassword:"",submitting:!1})}async function b(E){if(E.preventDefault(),!!x.agent){if(!x.newPassword.trim()){a(L=>({...L,error:"New password is required."}));return}if(x.newPassword!==x.confirmPassword){a(L=>({...L,error:"New passwords do not match."}));return}f(L=>({...L,submitting:!0}));try{await z(`/api/ai-chatbot/org/agents/${x.agent.id}/password`,{method:"POST",body:JSON.stringify({new_password:x.newPassword,confirm_password:x.confirmPassword})}),j("Password updated."),f({open:!1,agent:null,newPassword:"",confirmPassword:"",submitting:!1})}catch(L){a(V=>({...V,error:(L==null?void 0:L.message)||"Unable to update password."})),f(V=>({...V,submitting:!1}))}}}return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between flex-wrap gap-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"page-title",children:"AI Chatbot Agents"}),e.jsx("div",{className:"text-secondary",children:"Add and manage support agents for AI Chatbot inbox."})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:v,children:"Refresh"})]}),e.jsx("hr",{className:"section-divider"}),e.jsx("div",{className:"alert alert-info",children:"Deleting agent will not delete conversations; it only blocks login."}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,t.toast?e.jsxs("div",{className:"alert alert-success",children:[t.toast,t.tempPassword?e.jsxs("div",{className:"mt-2",children:["Temp password: ",e.jsx("strong",{children:t.tempPassword})]}):null]}):null,e.jsx("div",{className:"d-flex justify-content-end mb-3",children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>u(!0),children:"Add Agent"})}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h5",{className:"mb-3",children:"Agents"}),t.loading?e.jsx("div",{className:"text-center py-4",children:"Loading agents..."}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-borderless",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Chat Access"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:t.agents.length?t.agents.map(E=>{var L;return e.jsxs("tr",{children:[e.jsx("td",{children:E.name||"-"}),e.jsx("td",{children:E.email||"-"}),e.jsx("td",{children:E.phone||"-"}),e.jsx("td",{children:((L=E.chat_access)==null?void 0:L.join(", "))||"sales, support"}),e.jsx("td",{children:e.jsx("span",{className:`badge ${E.is_active?"bg-success":"bg-secondary"}`,children:E.is_active?"Active":"Disabled"})}),e.jsxs("td",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",onClick:()=>N(E),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>y(E),children:E.is_active?"Disable":"Enable"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>h(E),children:"Delete"}),e.jsx("button",{type:"button",className:"btn btn-outline-success btn-sm",onClick:()=>p(E),children:"Password Change"})]})]},E.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:"No agents yet."})})})]})})]}),i?e.jsx("div",{className:"wz-modal__backdrop",children:e.jsxs("div",{className:"wz-modal wz-agent-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Add Agent"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>u("")})]}),e.jsx("hr",{className:"section-divider mt-0 mb-3"}),e.jsxs("form",{onSubmit:C,children:[e.jsx("div",{className:"modal-body",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Name"}),e.jsx("input",{type:"text",className:"form-control",value:s.name,onChange:E=>n(L=>({...L,name:E.target.value})),placeholder:"Agent name"})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Email"}),e.jsx("input",{type:"email",className:"form-control",value:s.email,onChange:E=>n(L=>({...L,email:E.target.value})),placeholder:"agent@example.com",required:!0})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label",children:"Chat Access"}),e.jsxs("div",{className:"d-flex gap-3",children:[e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",value:"sales",id:"access-sales-new",checked:s.chatAccess.includes("sales"),onChange:_}),e.jsx("label",{className:"form-check-label",htmlFor:"access-sales-new",children:"Sales"})]}),e.jsxs("div",{className:"form-check",children:[e.jsx("input",{className:"form-check-input",type:"checkbox",value:"support",id:"access-support-new",checked:s.chatAccess.includes("support"),onChange:_}),e.jsx("label",{className:"form-check-label",htmlFor:"access-support-new",children:"Support"})]})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Phone"}),e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",value:s.phoneCountry,onChange:E=>n(L=>({...L,phoneCountry:E.target.value})),style:{maxWidth:"110px"},children:Fs.map(E=>e.jsxs("option",{value:E.code,children:[E.label," ",E.code]},`${E.code}-${E.label}`))}),e.jsx("input",{type:"text",className:"form-control",value:s.phone,onChange:E=>n(L=>({...L,phone:E.target.value})),placeholder:"Phone number"})]})]}),e.jsxs("div",{className:"col-md-6",children:[e.jsx("label",{className:"form-label",children:"Temp Password"}),e.jsxs("div",{className:"input-group",children:[e.jsx("input",{type:"text",className:"form-control",value:s.password,onChange:E=>n(L=>({...L,password:E.target.value})),placeholder:"Temp@12345",required:!0}),e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>n(E=>({...E,password:`Temp@${Math.random().toString(36).slice(2,8)}`})),style:{minWidth:"130px"},children:"Auto-generate"})]})]})]})}),e.jsxs("div",{className:"modal-footer wz-modal__actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>u(!1),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:l,children:l?"Saving...":"Create Agent"})]})]})]})}):null,c.open?e.jsx(fw,{agent:c.agent,onClose:()=>m({open:!1,agent:null}),onSuccess:async()=>{m({open:!1,agent:null}),await v(),j("Agent updated.")},onError:E=>a(L=>({...L,error:(E==null?void 0:E.message)||"Unable to update agent."}))}):null,x.open?e.jsx("div",{className:"wz-modal__backdrop",children:e.jsxs("div",{className:"wz-modal wz-agent-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Change Password"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>f(E=>({...E,open:!1}))})]}),e.jsxs("form",{onSubmit:b,children:[e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"mb-2 text-secondary",children:["Agent: ",((P=x.agent)==null?void 0:P.name)||(($=x.agent)==null?void 0:$.email)||"-"]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsx("input",{type:"password",className:"form-control",value:x.newPassword,onChange:E=>f(L=>({...L,newPassword:E.target.value})),required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Confirm New Password"}),e.jsx("input",{type:"password",className:"form-control",value:x.confirmPassword,onChange:E=>f(L=>({...L,confirmPassword:E.target.value})),required:!0})]})]}),e.jsxs("div",{className:"modal-footer wz-modal__actions",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:()=>f(E=>({...E,open:!1})),children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:x.submitting,children:x.submitting?"Saving...":"Update Password"})]})]})]})}):null]})}const gw={loading:!0,error:"",data:null};function jw({subscriptions:t=[]}){const[a,s]=o.useState(gw),[n,l]=o.useState([]);o.useEffect(()=>{let m=!0;async function x(){try{const f=await z("/api/ai-chatbot/dashboard/summary");if(!m)return;s({loading:!1,error:"",data:f})}catch(f){m&&s({loading:!1,error:(f==null?void 0:f.message)||"Unable to load AI Chatbot dashboard.",data:null})}}return x(),()=>{m=!1}},[]),o.useEffect(()=>{let m=!0;async function x(){try{const f=await z("/api/dashboard/summary");if(!m)return;l(f.products||[])}catch{m&&l([])}}return x(),()=>{m=!1}},[]);const r=a.data||{},i=r.billing_preview||{},u=r.ai_usage_percent??0,c=Math.max(0,Math.min(100,u));return a.loading?e.jsxs("div",{className:"card p-4 text-center",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{className:"mb-0",children:"Loading AI Chatbot dashboard..."})]}):a.error?e.jsx("div",{className:"alert alert-danger",children:a.error}):e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"page-title",children:"AI Chatbot Dashboard"}),e.jsx("hr",{className:"section-divider"}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 text-center h-100",children:[e.jsx("div",{className:"stat-icon",style:{color:"#4dabff"},children:e.jsx("i",{className:"bi bi-people","aria-hidden":"true"})}),e.jsx("h5",{children:"Agents Total"}),e.jsx("div",{className:"stat-value",style:{color:"#4dabff"},children:r.agents_total??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 text-center h-100",children:[e.jsx("div",{className:"stat-icon",style:{color:"#3ef58a"},children:e.jsx("i",{className:"bi bi-check2-circle","aria-hidden":"true"})}),e.jsx("h5",{children:"Agents Included"}),e.jsx("div",{className:"stat-value",style:{color:"#3ef58a"},children:r.agents_included??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 text-center h-100",children:[e.jsx("div",{className:"stat-icon",style:{color:"#ffdd57"},children:e.jsx("i",{className:"bi bi-plus-circle","aria-hidden":"true"})}),e.jsx("h5",{children:"Extra Agents"}),e.jsx("div",{className:"stat-value",style:{color:"#ffdd57"},children:r.agents_extra??0})]})}),e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 text-center h-100",children:[e.jsx("div",{className:"stat-icon",style:{color:"#ff6b6b"},children:e.jsx("i",{className:"bi bi-robot","aria-hidden":"true"})}),e.jsx("h5",{children:"AI Replies Used"}),e.jsx("div",{className:"stat-value",style:{color:"#ff6b6b"},children:r.ai_replies_used_this_month??0})]})})]}),e.jsxs("div",{className:"row g-3 mt-2",children:[e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 ai-chatbot-summary-card",children:[e.jsx("h5",{children:"AI Usage Limit"}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Monthly Limit"}),e.jsx("strong",{children:r.ai_replies_limit??0})]}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Usage"}),e.jsxs("strong",{children:[u,"% this month"]})]}),e.jsx("div",{className:"ai-chatbot-usage-bar",children:e.jsx("span",{style:{width:`${c}%`}})})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 ai-chatbot-summary-card",children:[e.jsx("h5",{children:"Subscription"}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Plan"}),e.jsx("strong",{children:r.plan_name||"-"})]}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Billing Cycle"}),e.jsx("strong",{children:r.billing_cycle||"-"})]}),e.jsx("div",{className:"ai-chatbot-summary-note",children:"Manage plan settings from Billing when available."})]})}),e.jsx("div",{className:"col-12 col-lg-4",children:e.jsxs("div",{className:"card p-3 h-100 ai-chatbot-summary-card",children:[e.jsx("h5",{children:"Billing Preview"}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Base Amount"}),e.jsxs("strong",{children:["INR ",i.base_amount??0]})]}),e.jsxs("div",{className:"ai-chatbot-summary-row",children:[e.jsx("span",{children:"Add-on Amount"}),e.jsxs("strong",{children:["INR ",i.addon_amount??0]})]}),e.jsxs("div",{className:"ai-chatbot-summary-row ai-chatbot-summary-row--total",children:[e.jsx("span",{children:"Total Amount"}),e.jsxs("strong",{children:["INR ",i.total_amount??0]})]})]})})]}),e.jsxs("div",{className:"card p-4 mt-4",children:[e.jsx("h4",{children:"Quick Actions"}),e.jsxs("div",{className:"d-flex gap-2 flex-wrap mt-2",children:[e.jsx(et,{to:"/ai-chatbot/inbox",className:"btn btn-outline-light btn-sm",children:"Open Inbox"}),e.jsx(et,{to:"/ai-chatbot/widgets",className:"btn btn-outline-light btn-sm",children:"Manage Widgets"}),e.jsx(et,{to:"/ai-chatbot/leads",className:"btn btn-outline-light btn-sm",children:"View Leads"})]})]}),e.jsx(Vd,{products:n,subscriptions:t,isReadOnly:!1})]})}const bw={loading:!0,error:"",conversations:[],retentionDays:30,filterStatus:"all",selected:null,messages:[],loadingMessages:!1,orgTimezone:"UTC"};function sp(t,a){if(!t)return"";const s=new Date(t);if(Number.isNaN(s.getTime()))return"";const l=new Intl.DateTimeFormat("en-GB",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:a}).formatToParts(s).reduce((r,i)=>(r[i.type]=i.value,r),{});return`${l.year}-${l.month}-${l.day} ${l.hour}:${l.minute}:${l.second}`}function yw(){const[t,a]=o.useState(bw);o.useEffect(()=>{let i=!0;async function u(){a(c=>({...c,loading:!0,error:""}));try{const c=new URLSearchParams;c.set("status",t.filterStatus);const m=await z(`/api/ai-chatbot/history?${c.toString()}`);if(!i)return;a(x=>({...x,loading:!1,error:"",conversations:m.conversations||[],retentionDays:m.retention_days??x.retentionDays}))}catch(c){i&&a(m=>({...m,loading:!1,error:(c==null?void 0:c.message)||"Unable to load chat history."}))}}return u(),()=>{i=!1}},[t.filterStatus]);async function s(){a(i=>({...i,loading:!0,error:""}));try{const i=new URLSearchParams;i.set("status",t.filterStatus);const u=await z(`/api/ai-chatbot/history?${i.toString()}`);a(c=>({...c,loading:!1,error:"",conversations:u.conversations||[],retentionDays:u.retention_days??c.retentionDays}))}catch(i){a(u=>({...u,loading:!1,error:(i==null?void 0:i.message)||"Unable to load chat history."}))}}async function n(i){if(i){a(u=>({...u,loadingMessages:!0,selected:i,messages:[]}));try{const u=await z(`/api/ai-chatbot/history/${i.id}/messages`);a(c=>({...c,loadingMessages:!1,messages:u.messages||[],orgTimezone:u.org_timezone||c.orgTimezone||"UTC"}))}catch(u){a(c=>({...c,loadingMessages:!1,error:(u==null?void 0:u.message)||"Unable to load conversation."}))}}}function l(){a(i=>({...i,selected:null,messages:[],loadingMessages:!1}))}async function r(i){var c;if(!(!i||!window.confirm("Delete this chat history? This will remove the conversation for all users.")))try{await z(`/api/ai-chatbot/history/${i.id}`,{method:"DELETE"}),await s(),((c=t.selected)==null?void 0:c.id)===i.id&&l()}catch(m){a(x=>({...x,error:(m==null?void 0:m.message)||"Unable to delete chat history."}))}}return e.jsxs("div",{className:"container-fluid",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"AI Chatbot History"}),e.jsx("div",{className:"text-secondary",children:"Review past conversations and manage history."})]}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:s,children:"Refresh"})]}),e.jsxs("div",{className:"alert alert-info retention-text",children:["Chat history is stored for up to ",t.retentionDays," days as per your plan. Older chats are deleted automatically."]}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,e.jsx("div",{className:"d-flex align-items-center gap-2 mb-2",children:["all","open","closed"].map(i=>e.jsx("button",{type:"button",className:`btn btn-sm ${t.filterStatus===i?"btn-primary":"btn-outline-light"}`,onClick:()=>a(u=>({...u,filterStatus:i})),children:i==="all"?"All":i.charAt(0).toUpperCase()+i.slice(1)},i))}),e.jsx("div",{className:"card p-3",children:e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Visitor"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Widget"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Last Message"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Action"})]})}),e.jsx("tbody",{children:t.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:11,children:"Loading..."})}):t.conversations.length?t.conversations.map(i=>e.jsxs("tr",{children:[e.jsx("td",{children:i.visitor_id}),e.jsx("td",{children:i.visitor_name||"-"}),e.jsx("td",{children:i.visitor_email||"-"}),e.jsx("td",{children:i.visitor_phone||"-"}),e.jsx("td",{children:i.widget_name||"-"}),e.jsx("td",{children:i.category||"-"}),e.jsx("td",{children:i.source||"-"}),e.jsx("td",{children:i.status}),e.jsx("td",{children:i.last_message||"-"}),e.jsx("td",{children:i.last_message_at?i.last_message_at.slice(0,19).replace("T"," "):"-"}),e.jsxs("td",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>n(i),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>r(i),children:"Delete"})]})]},i.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:11,children:"No chat history found."})})})]})})}),t.selected?e.jsx("div",{className:"modal d-block",tabIndex:"-1",role:"dialog",children:e.jsx("div",{className:"modal-dialog modal-lg",role:"document",children:e.jsxs("div",{className:"modal-content wz-history-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Conversation"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsxs("div",{className:"modal-body wz-history-modal__body",children:[e.jsxs("div",{className:"text-secondary mb-2",children:[t.selected.visitor_name||t.selected.visitor_id," - ",t.selected.visitor_phone||"-"]}),e.jsx("div",{className:"card p-2",style:{maxHeight:"360px",overflowY:"auto"},children:t.loadingMessages?e.jsx("div",{className:"text-center py-3",children:"Loading messages..."}):t.messages.length?t.messages.map(i=>{const u=sp(i.created_at),c=sp(i.created_at,t.orgTimezone),m=[u,c&&c!==u?c:""].filter(Boolean).join(" / ");return e.jsxs("div",{className:`ai-chatbot-message ai-chatbot-message--${i.sender_type}`,children:[e.jsx("div",{className:"ai-chatbot-message__text",children:i.text}),e.jsxs("div",{className:"ai-chatbot-message__meta",children:[i.sender_type," - ",m||"-"]})]},i.id)}):e.jsx("div",{className:"text-secondary",children:"No messages."})})]}),e.jsx("div",{className:"modal-footer",children:e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:l,children:"Close"})})]})})}):null]})}const vw={loading:!0,saving:!1,error:"",success:"",premadeRepliesText:"",allowVisitorAttachments:!1},Nw={loading:!0,error:"",items:[],usageBytes:0,limitBytes:null},_w={loading:!0,error:"",items:[],remaining:50,limit:50};function wr(t){const a=Number(t||0);if(!a)return"0 MB";const s=a/(1024*1024);return s<1024?`${s.toFixed(1)} MB`:`${(s/1024).toFixed(2)} GB`}function np(t){return t?String(t).replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):"-"}async function lp(t,a){es()||await fetch("/api/auth/csrf",{credentials:"include"});const s=await fetch(t,{method:"POST",credentials:"include",headers:{"X-CSRFToken":es()},body:a}),n=await s.text();let l=null;if(n)try{l=JSON.parse(n)}catch{l=null}if(!s.ok){const r=(l==null?void 0:l.detail)||(l==null?void 0:l.error)||`Request failed (${s.status})`,i=new Error(r);throw i.status=s.status,i.data=l,i}return l}function Sw(){const[t,a]=o.useState(vw),[s,n]=o.useState(Nw),[l,r]=o.useState(_w),[i,u]=o.useState(""),[c,m]=o.useState(!1),[x,f]=o.useState(""),[j,N]=o.useState(""),[v,_]=o.useState(!1),[C,y]=o.useState({open:!1,pages:[],total:0,allowed:0,selected:[]}),[h,p]=o.useState(""),[b,P]=o.useState(""),[$,E]=o.useState(!1),[L,V]=o.useState(""),[U,w]=o.useState(""),Q=75,J=250,me=10,re=10,[K,O]=o.useState(!1),[T,H]=o.useState(null),[I,S]=o.useState(null),[k,M]=o.useState(""),[A,F]=o.useState(""),[te,Y]=o.useState({open:!1,id:null}),[ue,he]=o.useState({open:!1,question:"",answer:""}),[ye,G]=o.useState(""),[Ne,_e]=o.useState(1),[de,Re]=o.useState(""),[je,Ae]=o.useState(1),Qe=["home","about","services","pricing","contact","faq","policies"],qe=nn();function Je(B){return B==null?"":String(B).toLowerCase()}function Ye(B,le){const Te=[],Se=Math.max(1,B-2),Le=Math.min(le,B+2);for(let lt=Se;lt<=Le;lt+=1)Te.push(lt);return Te}function oe(B,le){if(!B.length||!le)return[];const Te={};B.forEach(Le=>{const lt=Le.type||"other";Te[lt]||(Te[lt]=[]),Te[lt].push(Le.url)});const Se=[];return Qe.forEach(Le=>{(Te[Le]||[]).forEach(Ut=>{Se.length<le&&!Se.includes(Ut)&&Se.push(Ut)})}),Se}function ve(B){const le=(B==null?void 0:B.data)||{};return(le==null?void 0:le.status)!=="failed"?null:{title:{INVALID_URL:"Invalid URL",WEBSITE_NOT_REACHABLE:"Website not reachable",ACCESS_BLOCKED:"Website Access Restricted",JS_RENDER_REQUIRED:"Website needs JavaScript",LOGIN_REQUIRED:"Login required",NO_READABLE_CONTENT:"No readable content"}[le.error_code]||"Website import failed",reason:le.reason||"Unable to import website content.",suggestion:le.suggestion||"Try another URL or upload a Word file.",infoNote:le.info_note||"",errorCode:le.error_code||""}}async function Z(){try{const B=await z("/api/ai-chatbot/org/chat-settings");a(le=>({...le,loading:!1,error:"",premadeRepliesText:(B.premade_replies||[]).join(`
`),allowVisitorAttachments:!!B.allow_visitor_attachments}))}catch(B){a(le=>({...le,loading:!1,error:(B==null?void 0:B.message)||"Unable to load chat settings."}))}}async function ce(){try{const B=await z("/api/ai-chatbot/media-library");n({loading:!1,error:"",items:B.items||[],usageBytes:B.usage_bytes||0,limitBytes:B.limit_bytes??null})}catch(B){n(le=>({...le,loading:!1,error:(B==null?void 0:B.message)||"Unable to load media library."}))}}async function xe(){try{const B=await z("/api/ai-chatbot/faqs");r({loading:!1,error:"",items:B.items||[],remaining:B.remaining??0,limit:B.limit??50})}catch(B){r(le=>({...le,loading:!1,error:(B==null?void 0:B.message)||"Unable to load FAQs."}))}}o.useEffect(()=>{let B=!0;async function le(){await Promise.all([Z(),ce(),xe()])}return B&&le(),()=>{B=!1}},[]);async function Ce(){if(!t.saving){a(B=>({...B,saving:!0,success:"",error:""}));try{const B=await z("/api/ai-chatbot/org/chat-settings",{method:"PATCH",body:JSON.stringify({premade_replies:t.premadeRepliesText,allow_visitor_attachments:t.allowVisitorAttachments})});a(le=>({...le,saving:!1,success:"Settings updated.",premadeRepliesText:(B.premade_replies||[]).join(`
`),allowVisitorAttachments:!!B.allow_visitor_attachments}))}catch(B){a(le=>({...le,saving:!1,error:(B==null?void 0:B.message)||"Unable to save chat settings."}))}}}async function Fe(B){var Te;const le=(Te=B.target.files)==null?void 0:Te[0];if(B.target.value="",!(!le||c)){if(le.size&&le.size>2*1024*1024){n(Se=>({...Se,error:"File too large. Maximum upload size is 2MB."}));return}m(!0),n(Se=>({...Se,error:""}));try{const Se=new FormData;Se.append("file",le),i.trim()&&Se.append("name",i.trim()),await lp("/api/ai-chatbot/media-library",Se),u(""),await ce()}catch(Se){n(Le=>({...Le,error:(Se==null?void 0:Se.message)||"Unable to upload document."}))}finally{m(!1)}}}async function Ze(){var B,le,Te;if(!(!x.trim()||v)){_(!0),n(Se=>({...Se,error:""}));try{const Se=await z("/api/ai-chatbot/media-library/website-import",{method:"POST",body:JSON.stringify({source_url:x.trim(),name:j.trim()})});f(""),N(""),(Se==null?void 0:Se.status)==="warning"&&((Se==null?void 0:Se.code)==="LIMITED_CONTENT"||(Se==null?void 0:Se.code)==="ONLY_HOMEPAGE_IMPORTED")?F(`${Se.message} ${Se.suggestion}`):F(""),await ce()}catch(Se){if((Se==null?void 0:Se.status)===409&&((B=Se==null?void 0:Se.data)==null?void 0:B.detail)==="website_page_limit_exceeded"){const Le=Se.data.pages||[],lt=Number(Se.data.allowed_pages||0),Ut=oe(Le,lt);y({open:!0,pages:Le,total:Number(Se.data.total_pages_found||Le.length||0),allowed:lt,selected:Ut}),Se.data.item&&await ce()}else{const Le=ve(Se);if(((le=Se==null?void 0:Se.data)==null?void 0:le.status)==="blocked"){n(lt=>({...lt,error:"Already submitted"}));return}n(lt=>({...lt,error:Le||(Se==null?void 0:Se.message)||"Unable to import website content."})),(Te=Se==null?void 0:Se.data)!=null&&Te.item&&await ce()}}finally{_(!1)}}}async function ne(){var B;if(!(!C.selected.length||v)){_(!0),n(le=>({...le,error:""}));try{const le=await z("/api/ai-chatbot/media-library/website-import",{method:"POST",body:JSON.stringify({source_url:x.trim(),name:j.trim(),selected_pages:C.selected})});f(""),N(""),y({open:!1,pages:[],total:0,allowed:0,selected:[]}),(le==null?void 0:le.status)==="warning"&&((le==null?void 0:le.code)==="LIMITED_CONTENT"||(le==null?void 0:le.code)==="ONLY_HOMEPAGE_IMPORTED")?F(`${le.message} ${le.suggestion}`):F(""),await ce()}catch(le){const Te=ve(le);n(Se=>({...Se,error:Te||(le==null?void 0:le.message)||"Unable to import selected pages."})),(B=le==null?void 0:le.data)!=null&&B.item&&await ce()}finally{_(!1)}}}function Ie(B){y(le=>{const Te=new Set(le.selected);return Te.has(B)?Te.delete(B):(le.allowed===0||Te.size<le.allowed)&&Te.add(B),{...le,selected:Array.from(Te)}})}async function Oe(){if(!(!b.trim()||$)){E(!0),n(B=>({...B,error:""}));try{await z("/api/ai-chatbot/media-library",{method:"POST",body:JSON.stringify({type:"extra_text",name:h.trim(),content:b.trim()})}),p(""),P(""),await ce()}catch(B){n(le=>({...le,error:(B==null?void 0:B.message)||"Unable to save extra text."}))}finally{E(!1)}}}async function Me(B){n(le=>({...le,error:""}));try{await z("/api/ai-chatbot/media-library/delete",{method:"POST",body:JSON.stringify({ids:[B]})}),M(""),await ce()}catch(le){n(Te=>({...Te,error:(le==null?void 0:le.message)||"Unable to delete media."}))}}async function st(B,le){if(!(!le||I)){S(B.id),n(Te=>({...Te,error:""}));try{const Te=new FormData;Te.append("file",le),await lp(`/api/ai-chatbot/media-library/${B.id}/reupload`,Te),M(""),await ce()}catch(Te){n(Se=>({...Se,error:(Te==null?void 0:Te.message)||"Unable to re-upload file."}))}finally{S(null)}}}async function Dt(){if(!(!L.trim()||!U.trim()||K||T)){O(!0),r(B=>({...B,error:""}));try{await z("/api/ai-chatbot/faqs",{method:"POST",body:JSON.stringify({question:L.trim(),answer:U.trim()})}),V(""),w(""),await xe()}catch(B){r(le=>({...le,error:(B==null?void 0:B.message)||"Unable to add FAQ."}))}finally{O(!1)}}}async function W(){if(!(!T||!T.question.trim()||!T.answer.trim()||!await qe({title:"Confirm Save",message:"Are you sure you want to save the changes to this FAQ?",confirmVariant:"primary"}))){r(le=>({...le,error:""}));try{await z(`/api/ai-chatbot/faqs/${T.id}`,{method:"PATCH",body:JSON.stringify({question:T.question.trim(),answer:T.answer.trim()})}),H(null),await xe()}catch(le){r(Te=>({...Te,error:(le==null?void 0:le.message)||"Unable to update FAQ."}))}}}async function pe(B){if(await qe({title:"Confirm Deletion",message:"Are you sure you want to delete this FAQ?",confirmVariant:"danger"})){r(Te=>({...Te,error:""}));try{await z(`/api/ai-chatbot/faqs/${B}`,{method:"DELETE"}),await xe()}catch(Te){r(Se=>({...Se,error:(Te==null?void 0:Te.message)||"Unable to delete FAQ."}))}}}o.useEffect(()=>{_e(1)},[ye]),o.useEffect(()=>{Ae(1)},[de]);const fe=o.useMemo(()=>{const B=ye.trim().toLowerCase();return B?s.items.filter(le=>[le.name,le.type,le.source_url,le.text_content].map(Je).join(" ").includes(B)):s.items},[s.items,ye]),D=Math.max(1,Math.ceil(fe.length/me)),X=o.useMemo(()=>{const B=(Ne-1)*me;return fe.slice(B,B+me)},[fe,Ne]);o.useEffect(()=>{Ne>D&&_e(D)},[Ne,D]);const q=o.useMemo(()=>{const B=de.trim().toLowerCase();return B?l.items.filter(le=>[le.question,le.answer].map(Je).join(" ").includes(B)):l.items},[l.items,de]),ie=Math.max(1,Math.ceil(q.length/re)),Ee=o.useMemo(()=>{const B=(je-1)*re;return q.slice(B,B+re)},[q,je]);o.useEffect(()=>{je>ie&&Ae(ie)},[je,ie]);const tt=o.useMemo(()=>s.limitBytes?`${wr(s.usageBytes)} / ${wr(s.limitBytes)}`:`${wr(s.usageBytes)} used (Unlimited)`,[s.usageBytes,s.limitBytes]);return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between mb-3",children:e.jsxs("div",{children:[e.jsx("h2",{className:"mb-1",children:"AI Chatbot Settings"}),e.jsx("div",{className:"text-secondary",children:"Manage chat behavior and AI training data."})]})}),t.error?e.jsx("div",{className:"alert alert-danger",children:t.error}):null,t.success?e.jsx("div",{className:"alert alert-success",children:t.success}):null,e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx("div",{className:"col-12 col-lg-3",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Premade Replies Option for Chat Agent"}),e.jsx("textarea",{className:"form-control",rows:6,placeholder:"Enter one reply per line.",value:t.premadeRepliesText,onChange:B=>a(le=>({...le,premadeRepliesText:B.target.value})),disabled:t.loading||t.saving}),e.jsx("div",{className:"form-text",children:"Each line becomes a quick reply in the inbox."})]}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn btn-primary",onClick:Ce,disabled:t.loading||t.saving,children:t.saving?"Saving...":"Save Settings"})})]})}),e.jsx("div",{className:"col-12 col-lg-9",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsx("h5",{className:"mb-0",children:"AI Media Library"}),e.jsx("div",{style:{minWidth:"220px"},children:e.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Search media",value:ye,onChange:B=>G(B.target.value)})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Size"}),e.jsx("th",{children:"Updated"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:s.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:"Loading..."})}):X.length?X.map(B=>{const le=B.type==="word_website_data",Te=le&&!B.file_url,Se=B.updated_at||B.created_at;return e.jsxs("tr",{children:[e.jsx("td",{children:B.name||"-"}),e.jsxs("td",{children:[np(B.type),Te?e.jsx("div",{className:"small text-warning",children:"Website data pending upload"}):null]}),e.jsx("td",{className:"text-break",children:B.source_url||B.text_content||"-"}),e.jsx("td",{children:wr(B.file_size)}),e.jsx("td",{children:Se?new Date(Se).toLocaleString():"-"}),e.jsx("td",{children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[B.file_url?e.jsx("a",{className:"btn btn-outline-light btn-sm",href:B.file_url,target:"_blank",rel:"noreferrer",children:"Download"}):null,le?e.jsxs("label",{className:"btn btn-outline-light btn-sm mb-0",onClick:()=>{Te&&M("Please upload the main website content as a Word file. Include About, Services, Pricing, and Support pages.")},children:[I===B.id?"Re-uploading...":"Re-upload",e.jsx("input",{type:"file",accept:".docx",onChange:Le=>{var Ut;const lt=(Ut=Le.target.files)==null?void 0:Ut[0];Le.target.value="",lt&&st(B,lt)},disabled:I===B.id,hidden:!0})]}):null,e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>Y({open:!0,id:B.id}),children:"Delete"})]})})]},B.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:6,children:ye?"No matching media found.":"No training data yet."})})})]})}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mt-3",children:[e.jsxs("div",{className:"text-secondary small",children:["Showing ",X.length," of ",fe.length]}),e.jsx("nav",{"aria-label":"Media pagination",children:e.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[e.jsx("li",{className:`page-item ${Ne===1?"disabled":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>_e(B=>Math.max(1,B-1)),disabled:Ne===1,children:"Prev"})}),Ye(Ne,D).map(B=>e.jsx("li",{className:`page-item ${B===Ne?"active":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>_e(B),children:B})},B)),e.jsx("li",{className:`page-item ${Ne===D?"disabled":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>_e(B=>Math.min(D,B+1)),disabled:Ne===D,children:"Next"})})]})})]})]})})]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"mb-1",children:"AI Training"}),e.jsx("div",{className:"text-secondary",children:"Manage documents, website data, extra text, and FAQs."})]}),e.jsxs("div",{className:"text-secondary",children:["Storage: ",tt]})]}),s.error?e.jsx("div",{className:"alert alert-danger",children:typeof s.error=="string"?s.error:e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fw-semibold",children:s.error.title}),e.jsx("div",{className:"small mt-1",children:s.error.reason}),s.error.errorCode==="ACCESS_BLOCKED"?e.jsxs("div",{className:"small mt-2",children:["Next steps:",e.jsx("div",{children:" Open the website in a browser"}),e.jsx("div",{children:" Copy important pages (About, Services, Pricing, Support)"}),e.jsx("div",{children:" Paste into a Word document"}),e.jsx("div",{children:" Upload the Word file in AI Media Library"})]}):e.jsxs("div",{className:"small mt-1",children:["Next: ",s.error.suggestion]}),s.error.infoNote?e.jsx("div",{className:"small mt-2 text-info",children:s.error.infoNote}):null]})}):null,A?e.jsx("div",{className:"alert alert-warning",children:A}):null,te.open?e.jsx("div",{className:"modal-overlay",onClick:()=>Y({open:!1,id:null}),children:e.jsxs("div",{className:"modal-panel",onClick:B=>B.stopPropagation(),children:[e.jsx("h5",{children:"Delete Media"}),e.jsx("div",{className:"text-secondary small mb-3",children:"Are you sure you want to delete this data?"}),e.jsxs("div",{className:"d-flex justify-content-end gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>Y({open:!1,id:null}),children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:async()=>{const B=te.id;Y({open:!1,id:null}),B&&await Me(B)},children:"Delete"})]})]})}):null,ue.open?e.jsx("div",{className:"modal-overlay",onClick:()=>he({open:!1,question:"",answer:""}),children:e.jsxs("div",{className:"modal-panel",onClick:B=>B.stopPropagation(),children:[e.jsx("h5",{children:"FAQ Details"}),e.jsx("div",{className:"text-secondary small mb-2",children:"Question"}),e.jsx("div",{className:"mb-3",children:ue.question||"-"}),e.jsx("div",{className:"text-secondary small mb-2",children:"Answer"}),e.jsx("div",{className:"mb-3",children:ue.answer||"-"}),e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>he({open:!1,question:"",answer:""}),children:"Close"})})]})}):null,k?e.jsx("div",{className:"alert alert-info",children:k}):null,l.error?e.jsx("div",{className:"alert alert-danger",children:l.error}):null,e.jsxs("div",{className:"row g-3 mb-4",children:[e.jsx("div",{className:"col-12 col-xl-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Upload Document"}),e.jsx("div",{className:"text-secondary mb-3",children:"PDF, Word, or Text files only. Max 2MB."}),e.jsx("label",{className:"form-label",children:"Name (optional)"}),e.jsx("input",{type:"text",className:"form-control mb-2",value:i,onChange:B=>u(B.target.value),placeholder:"Quarterly report",disabled:c}),e.jsx("input",{type:"file",className:"form-control",accept:".pdf,.doc,.docx,.txt",onChange:Fe,disabled:c}),e.jsx("div",{className:"form-text",children:"Files are stored in your AI Media Library."})]})}),e.jsx("div",{className:"col-12 col-xl-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Website URL"}),e.jsx("div",{className:"text-secondary mb-3",children:"Fetch and convert website data into Word."}),e.jsx("label",{className:"form-label",children:"Title (optional)"}),e.jsx("input",{type:"text",className:"form-control mb-2",value:j,onChange:B=>N(B.target.value),placeholder:"Help Center",disabled:v}),e.jsx("label",{className:"form-label",children:"Website URL"}),e.jsx("input",{type:"url",className:"form-control mb-3",value:x,onChange:B=>f(B.target.value),placeholder:"https://example.com/docs",disabled:v||s.items.some(B=>B.type==="word_website_data")}),e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:Ze,disabled:v||!x.trim()||s.items.some(B=>B.type==="word_website_data"),children:v?"Importing...":"Import Website"}),s.items.some(B=>B.type==="word_website_data")?e.jsx("div",{className:"form-text mt-2",children:"Already submitted. Delete the existing website data from the table to resubmit."}):null]})}),e.jsx("div",{className:"col-12 col-xl-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("h5",{children:"Extra Text"}),e.jsx("div",{className:"text-secondary mb-3",children:"Add notes or summaries directly."}),e.jsx("label",{className:"form-label",children:"Title (optional)"}),e.jsx("input",{type:"text",className:"form-control mb-2",value:h,onChange:B=>p(B.target.value),placeholder:"Support notes",disabled:$}),e.jsx("label",{className:"form-label",children:"Content"}),e.jsx("textarea",{className:"form-control mb-3",rows:4,value:b,onChange:B=>P(B.target.value),placeholder:"Paste text to train the assistant.",disabled:$}),e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:Oe,disabled:$||!b.trim(),children:$?"Saving...":"Save Text"})]})})]}),e.jsxs("div",{className:"card p-3",children:[e.jsx("div",{className:"d-flex align-items-center justify-content-between mb-3",children:e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:"FAQs"}),e.jsxs("div",{className:"text-secondary",children:[l.remaining," of ",l.limit," remaining"]})]})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-3",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("label",{className:"form-label mb-0",children:"Question"}),e.jsxs("div",{className:"text-secondary small",children:["(",L.length,"/",Q,")"]})]}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Question",value:L,onChange:B=>V(B.target.value.slice(0,Q)),disabled:K,maxLength:Q})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between",children:[e.jsx("label",{className:"form-label mb-0",children:"Answer"}),e.jsxs("div",{className:"text-secondary small",children:["(",U.length,"/",J,")"]})]}),e.jsx("textarea",{className:"form-control",placeholder:"Answer",value:U,onChange:B=>w(B.target.value.slice(0,J)),disabled:K,rows:5,maxLength:J})]}),e.jsx("div",{className:"col-6",children:e.jsx("button",{type:"button",className:"btn btn-outline-light",onClick:T?W:Dt,disabled:K||!L.trim()||!U.trim(),children:K?"Saving...":T?"Save FAQ":"Add FAQ"})}),T?e.jsx("div",{className:"col-6 text-end",children:e.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>{H(null),V(""),w("")},children:"Cancel"})}):null]})}),e.jsxs("div",{className:"col-9",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsxs("div",{className:"text-secondary small",children:["Showing ",Ee.length," of ",q.length]}),e.jsx("div",{style:{minWidth:"220px"},children:e.jsx("input",{type:"text",className:"form-control form-control-sm",placeholder:"Search FAQs",value:de,onChange:B=>Re(B.target.value)})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-hover align-middle mb-0 faq-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"faq-col-question",children:"Question"}),e.jsx("th",{className:"faq-col-answer",children:"Answer"}),e.jsx("th",{className:"faq-col-actions",children:"Actions"})]})}),e.jsx("tbody",{children:l.loading?e.jsx("tr",{children:e.jsx("td",{colSpan:3,children:"Loading..."})}):Ee.length?Ee.map(B=>e.jsxs("tr",{children:[e.jsx("td",{children:B.question}),e.jsx("td",{children:B.answer}),e.jsx("td",{className:"faq-col-actions",children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>he({open:!0,question:B.question,answer:B.answer}),children:"View"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>{H({id:B.id}),V(B.question),w(B.answer)},children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>pe(B.id),children:"Delete"})]})})]},B.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,children:de?"No matching FAQs found.":"No FAQs yet."})})})]})}),e.jsx("div",{className:"d-flex justify-content-end mt-3",children:e.jsx("nav",{"aria-label":"FAQ pagination",children:e.jsxs("ul",{className:"pagination pagination-sm mb-0",children:[e.jsx("li",{className:`page-item ${je===1?"disabled":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>Ae(B=>Math.max(1,B-1)),disabled:je===1,children:"Prev"})}),Ye(je,ie).map(B=>e.jsx("li",{className:`page-item ${B===je?"active":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>Ae(B),children:B})},B)),e.jsx("li",{className:`page-item ${je===ie?"disabled":""}`,children:e.jsx("button",{type:"button",className:"page-link",onClick:()=>Ae(B=>Math.min(ie,B+1)),disabled:je===ie,children:"Next"})})]})})})]})]})]}),C.open?e.jsx("div",{className:"modal-overlay",onClick:()=>y({open:!1,pages:[],total:0,allowed:0,selected:[]}),children:e.jsxs("div",{className:"modal-panel",onClick:B=>B.stopPropagation(),children:[e.jsx("h5",{children:"Select Pages to Import"}),e.jsxs("div",{className:"text-secondary small mb-2",children:[C.total," pages detected. Your plan allows ",C.allowed," pages."]}),e.jsxs("div",{className:"text-secondary small mb-3",children:["Selected ",C.selected.length," / ",C.allowed]}),e.jsx("div",{className:"table-responsive",style:{maxHeight:"320px",overflowY:"auto"},children:e.jsxs("table",{className:"table table-dark table-hover mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Page"}),e.jsx("th",{children:"Type"})]})}),e.jsx("tbody",{children:C.pages.map(B=>{const le=C.selected.includes(B.url),Te=!le&&C.allowed>0&&C.selected.length>=C.allowed;return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:le,disabled:Te,onChange:()=>Ie(B.url)})}),e.jsx("td",{className:"text-break",children:B.url}),e.jsx("td",{children:np(B.type)})]},B.url)})})]})}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>y({open:!1,pages:[],total:0,allowed:0,selected:[]}),disabled:v,children:"Cancel"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:ne,disabled:v||!C.selected.length||C.allowed>0&&C.selected.length>C.allowed,children:v?"Importing...":"Import Selected Pages"})]})]})}):null]})}class ww extends o.Component{constructor(a){super(a),this.state={hasError:!1,error:null,info:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,s){this.setState({info:s}),console.error("UI crash:",a,s)}render(){var a;if(this.state.hasError){const s=((a=this.state.error)==null?void 0:a.message)||"Unexpected error.";return e.jsxs("div",{className:"card p-4",children:[e.jsx("h4",{className:"mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-secondary mb-2",children:s}),e.jsx("p",{className:"text-secondary mb-0",children:"Please refresh the page. If this continues, contact support."})]})}return this.props.children}}const Cr={loading:!0,authenticated:!1,user:null,profile:null,archived:!1,allowAppUsage:!0,allowGamingOttUsage:!0,themePrimary:"",themeSecondary:"",freePlanPopup:!1,freePlanExpiry:"",dealer:null,dealerOnboarding:null,onboarding:{enabled:!1,state:"active"},readOnly:!1,subscriptions:[]},Cw="wz_brand_theme_override",rp="wz_brand_theme",kw="wz_brand_theme_prev";function Pw(t){if(typeof document>"u")return;const a=document.documentElement,s=["--color-primary","--color-primary-hover","--color-accent","--color-highlight","--color-accent-rgb","--color-primary-rgb"];if(!t||!t.primary){s.forEach(c=>a.style.removeProperty(c));return}const n=t.primary,l=t.secondary||n,r=c=>{const m=String(c||"").replace("#","").trim();if(m.length===3){const x=parseInt(m[0]+m[0],16),f=parseInt(m[1]+m[1],16),j=parseInt(m[2]+m[2],16);return`${x}, ${f}, ${j}`}if(m.length===6){const x=parseInt(m.slice(0,2),16),f=parseInt(m.slice(2,4),16),j=parseInt(m.slice(4,6),16);return`${x}, ${f}, ${j}`}return""};a.style.setProperty("--color-primary",n),a.style.setProperty("--color-primary-hover",n),a.style.setProperty("--color-accent",l),a.style.setProperty("--color-highlight",l);const i=r(n),u=r(l);i&&a.style.setProperty("--color-primary-rgb",i),u&&a.style.setProperty("--color-accent-rgb",u)}const Tw=[{label:"Dashboard",path:"/",icon:"bi-speedometer2",productOnly:"storage"},{label:"Files",path:"/files",icon:"bi-cloud",productOnly:"storage"},{label:"Users",path:"/users",icon:"bi-people",productOnly:"storage",adminOnly:!0},{label:"Dashboard",path:"/",icon:"bi-speedometer2"},{label:"Inbox",path:"/inbox",icon:"bi-chat-dots",productOnly:"ai-chatbot",allowAgent:!0},{label:"Widgets",path:"/widgets",icon:"bi-code-slash",productOnly:"ai-chatbot",adminOnly:!0},{label:"Leads",path:"/leads",icon:"bi-person-lines-fill",productOnly:"ai-chatbot",adminOnly:!0},{label:"Agents",path:"/agents",icon:"bi-people",productOnly:"ai-chatbot",adminOnly:!0},{label:"History",path:"/history",icon:"bi-clock-history",productOnly:"ai-chatbot",adminOnly:!0},{label:"Chat Settings",path:"/chat-settings",icon:"bi-gear",productOnly:"ai-chatbot",adminOnly:!0},{label:"Live Activity",path:"/activity",icon:"bi-activity",productOnly:"monitor"},{label:"Work Activity Log",path:"/work-activity",icon:"bi-clock-history",productOnly:"monitor"},{label:"App Usage",path:"/app-usage",icon:"bi-bar-chart-line",requiresAppUsage:!0,productOnly:"monitor"},{label:"Gaming / OTT Usage",path:"/gaming-ott",icon:"bi-tv",requiresGamingOttUsage:!0,productOnly:"monitor"},{label:"Screenshots",path:"/screenshots",icon:"bi-camera",productOnly:"monitor"},{label:"Employees",path:"/employees",icon:"bi-people",productOnly:"monitor"},{label:"Company Settings",path:"/company",icon:"bi-building",adminOnly:!0,productOnly:"monitor"},{label:"Privacy Settings",path:"/privacy",icon:"bi-shield-lock",adminOnly:!0,productOnly:"monitor"},{label:"Billing",path:"/billing",icon:"bi-credit-card",adminOnly:!0},{label:"Plans",path:"/plans",icon:"bi-clipboard-check",adminOnly:!0},{label:"Profile",path:"/profile",icon:"bi-person",adminOnly:!0},{label:"SaaS Admin",path:"/saas-admin",icon:"bi-grid-1x2",saasAdminOnly:!0}],Ew=[{key:"overview",label:"Overview",path:"/saas-admin",icon:"bi-grid-1x2"},{key:"observability",label:"Observability",path:"/saas-admin/observability",icon:"bi-bar-chart"},{key:"products",label:"Products",path:"/saas-admin",hash:"#products",icon:"bi-boxes"},{key:"organizations",label:"Organizations",path:"/saas-admin/organizations",icon:"bi-building"},{key:"server-monitoring",label:"Server Monitoring",path:"/saas-admin/server-monitoring",icon:"bi-cpu"},{key:"referrals",label:"Referrals",path:"/saas-admin/referrals",icon:"bi-people"},{key:"profile",label:"Profile",path:"/saas-admin/profile",icon:"bi-person"},{key:"dj-admin",label:"Back to DJ Admin",path:"/admin/",icon:"bi-arrow-left",external:!0}],Aw=[{label:"Dashboard",path:"/dealer-dashboard",icon:"bi-speedometer2"},{label:"Referrals",path:"/dealer-referrals",icon:"bi-people"},{label:"Payouts",path:"/dealer-payouts",icon:"bi-cash-coin"},{label:"Billing",path:"/dealer-billing",icon:"bi-credit-card"},{label:"Plan",path:"/dealer-plan",icon:"bi-clipboard-check"},{label:"Profile",path:"/dealer-profile",icon:"bi-person"}];function qo({state:t,productPrefix:a,productSlug:s}){var Qe,qe,Je,Ye,oe,ve,Z,ce,xe,Ce,Fe,Ze;const n=ba(),l=fs(),[r,i]=o.useState(""),[u,c]=o.useState(!1),[m,x]=o.useState(!1),[f,j]=o.useState(()=>typeof window>"u"?"dark":window.localStorage.getItem("wz_theme")==="light"?"light":"dark"),N=!!((Qe=t.user)!=null&&Qe.is_superuser),v=N||((qe=t.profile)==null?void 0:qe.role)==="superadmin"||((Je=t.profile)==null?void 0:Je.role)==="super_admin",_=((Ye=t.profile)==null?void 0:Ye.role)==="hr_view",C=((oe=t.profile)==null?void 0:oe.role)==="superadmin"||((ve=t.profile)==null?void 0:ve.role)==="company_admin"||N||_,y=((Z=t.profile)==null?void 0:Z.role)==="dealer",h=((ce=t.profile)==null?void 0:ce.role)==="ai_chatbot_agent",p=(t.subscriptions||[]).find(ne=>ne.product_slug==="ai-chatbot"&&(ne.status||"").toLowerCase()==="trialing"),b=p!=null&&p.trial_end?new Date(p.trial_end).toLocaleDateString():"",P=t.allowAppUsage!==!1,$=t.allowGamingOttUsage!==!1,E=t.themePrimary,L=t.themeSecondary,V=t.onboarding||{enabled:!1,state:"active"},U=n.pathname.startsWith("/saas-admin"),w=s==="monitor",Q=s==="ai-chatbot"?"AI Chatbot":s==="monitor"?"Monitor":s==="storage"?"Online Storage":s==="saas-admin"?"SaaS Admin":"Work Zilla",J=n.pathname.startsWith("/saas-admin/products")||n.hash==="#products",me=n.pathname.startsWith("/saas-admin/organizations"),re=n.pathname.startsWith("/saas-admin/retention-policy"),K=n.pathname.startsWith("/saas-admin/storage"),O=n.pathname.startsWith("/saas-admin/backup-activity"),T=n.pathname.startsWith("/saas-admin/server-monitoring"),H=n.pathname.startsWith("/saas-admin/referrals"),I=n.pathname.startsWith("/saas-admin/profile"),S=n.pathname.startsWith("/saas-admin/observability"),k=n.pathname.startsWith("/saas-admin/billing"),M=n.pathname==="/saas-admin"&&!J&&!me&&!re&&!K&&!O&&!T&&!H&&!I&&!S&&!k,A=a||"",F=ne=>A?ne==="/"?A:`${A}${ne.startsWith("/")?ne:`/${ne}`}`:ne,te=A&&n.pathname.startsWith(A)?{...n,pathname:n.pathname.slice(A.length)||"/"}:n;function Y(ne,Ie){return Ie.some(Oe=>ne===Oe?!0:ne.startsWith(`${Oe}/`))}function ue(ne){if(!y)return null;const Ie=t.dealerOnboarding||"active";return Ie==="active"?null:Ie==="pending_payment"?Y(ne,["/dealer-billing"])?null:"/dealer-billing":Ie==="needs_payment"&&Y(ne,["/dealer-plan","/dealer-bank-transfer"])?null:"/dealer-plan"}function he(ne){return y?ue(ne):V.enabled?V.state==="needs_plan"?Y(ne,["/plans"])?null:"/plans":V.state==="needs_payment"?Y(ne,["/bank-transfer","/plans"])?null:"/bank-transfer":V.state==="pending_payment"?Y(ne,["/billing"])?null:"/billing":null:null}o.useEffect(()=>{typeof document<"u"&&(document.documentElement.dataset.theme=f,document.documentElement.style.colorScheme=f),typeof window<"u"&&(window.localStorage.setItem("wz_theme",f),window.__WZ_PRODUCT_SLUG__=s)},[f,s]),o.useEffect(()=>{const ne={primary:E,secondary:L},Ie=typeof window<"u"?window.localStorage.getItem(Cw):null;let Oe=ne;if(Ie)if(Ie==="default")Oe=null;else try{Oe=JSON.parse(Ie)}catch{Oe=ne}if(Oe&&Oe.primary){const Me=JSON.stringify(Oe),st=typeof window<"u"?window.localStorage.getItem(rp):null;st&&st!==Me&&typeof window<"u"&&window.localStorage.setItem(kw,st),typeof window<"u"&&window.localStorage.setItem(rp,Me)}Pw(Oe)},[E,L]),o.useEffect(()=>{c(!!(t.freePlanPopup&&t.freePlanExpiry))},[t.freePlanPopup,t.freePlanExpiry]),o.useEffect(()=>{const ne=he(n.pathname);ne&&ne!==n.pathname&&l(ne,{replace:!0})},[n.pathname,l,V.enabled,V.state,t.dealerOnboarding,y]);const ye=y?((xe=t.user)==null?void 0:xe.first_name)||((Ce=t.user)==null?void 0:Ce.username):(Ze=(Fe=t.profile)==null?void 0:Fe.organization)==null?void 0:Ze.name,G=_&&ye?`${ye} (HR)`:ye,Ne=Tw.filter(ne=>ne.superuserOnly?N:s==="storage"&&ne.path==="/"&&ne.label==="Dashboard"&&!ne.productOnly||ne.productOnly&&ne.productOnly!==s?!1:ne.saasAdminOnly?v:ne.adminOnly?C:!(ne.allowAgent&&!C&&!h)).filter(ne=>ne.hidden?!1:_?!new Set(["/employees","/company","/privacy","/billing","/plans","/profile"]).has(ne.path):!0),_e=Aw.filter(ne=>{const Ie=t.dealerOnboarding||"active";return Ie==="pending_payment"?ne.path==="/dealer-billing":Ie==="needs_payment"?ne.path==="/dealer-plan":!0}),de=A,Re=ne=>de?ne==="/"?de:`${de}${ne.startsWith("/")?ne:`/${ne}`}`:ne;function je(){m&&x(!1)}const Ae=v?"/saas-admin/billing":"/billing";return e.jsxs("div",{className:`app-shell ${U?"saas-admin":""} ${m?"sidebar-collapsed":""}`,children:[e.jsxs("aside",{className:"sidebar",children:[e.jsxs("div",{className:"brand",children:[e.jsx("span",{children:"Work Zilla"}),e.jsx("span",{children:Q})]}),e.jsxs("button",{type:"button",className:"sidebar-toggle",onClick:()=>x(ne=>!ne),"aria-label":m?"Expand sidebar":"Collapse sidebar",children:[e.jsx("i",{className:`bi ${m?"bi-chevron-right":"bi-chevron-left"}`,"aria-hidden":"true"}),e.jsx("span",{className:"visually-hidden",children:m?"Expand sidebar":"Collapse sidebar"})]}),e.jsx("div",{className:"org",children:G||"Organization"}),e.jsxs("nav",{className:"nav",children:[y?_e.map(ne=>e.jsxs(Lo,{to:Re(ne.path),end:ne.path==="/dealer-dashboard",title:ne.label,onClick:je,className:({isActive:Ie})=>`nav-link ${Ie?"active":""}`,children:[ne.icon?e.jsx("i",{className:`bi ${ne.icon} nav-icon`,"aria-hidden":"true"}):null,e.jsx("span",{children:ne.label})]},ne.path)):U?Ew.map(ne=>{const Ie=ne.hash?`${ne.path}${ne.hash}`:ne.path;let Oe=!1;return ne.key==="overview"?Oe=M:ne.key==="observability"?Oe=S:ne.key==="products"?Oe=J:ne.key==="organizations"?Oe=me:ne.key==="server-monitoring"?Oe=T:ne.key==="retention-policy"?Oe=re:ne.key==="billing"?Oe=k:ne.key==="referrals"?Oe=H:ne.key==="profile"&&(Oe=I),ne.external?e.jsxs("a",{href:ne.path,className:"nav-link",title:ne.label,onClick:je,children:[ne.icon?e.jsx("i",{className:`bi ${ne.icon} nav-icon`,"aria-hidden":"true"}):null,e.jsx("span",{children:ne.label})]},ne.key):e.jsxs(Lo,{to:Re(Ie),title:ne.label,onClick:je,className:()=>`nav-link ${Oe?"active":""}`,children:[ne.icon?e.jsx("i",{className:`bi ${ne.icon} nav-icon`,"aria-hidden":"true"}):null,e.jsx("span",{children:ne.label})]},ne.key)}):Ne.map(ne=>e.jsxs(Lo,{to:Re(ne.path),end:ne.path==="/",onClick:Ie=>{if(je(),ne.requiresAppUsage&&!P){Ie.preventDefault(),i("Upgrade to next plan to access App Usage.");return}ne.requiresGamingOttUsage&&!$&&(Ie.preventDefault(),i("Upgrade to next plan to access Gaming / OTT Usage."))},title:ne.label,className:({isActive:Ie})=>`nav-link ${Ie?"active":""} ${ne.requiresAppUsage&&!P||ne.requiresGamingOttUsage&&!$?"disabled":""}`,"aria-disabled":ne.requiresAppUsage&&!P||ne.requiresGamingOttUsage&&!$?"true":"false",children:[ne.icon?e.jsx("i",{className:`bi ${ne.icon} nav-icon`,"aria-hidden":"true"}):null,e.jsx("span",{children:ne.label})]},ne.path)),e.jsxs("a",{className:"nav-link",href:"/auth/logout/",onClick:je,title:"Logout",children:[e.jsx("i",{className:"bi bi-box-arrow-right nav-icon","aria-hidden":"true"}),e.jsx("span",{children:"Logout"})]}),e.jsxs("div",{className:"theme-toggle theme-toggle-inline",children:[e.jsxs("button",{type:"button",className:`theme-btn theme-btn-light ${f==="light"?"active":""}`,onClick:()=>j("light"),children:[e.jsx("i",{className:"bi bi-sun","aria-hidden":"true"}),e.jsx("span",{children:"Light"})]}),e.jsxs("button",{type:"button",className:`theme-btn theme-btn-dark ${f==="dark"?"active":""}`,onClick:()=>j("dark"),children:[e.jsx("i",{className:"bi bi-moon-stars","aria-hidden":"true"}),e.jsx("span",{children:"Dark"})]})]})]})]}),e.jsxs("main",{className:"main",children:[t.archived?e.jsxs("div",{className:"alert alert-danger d-flex align-items-center justify-content-between",children:[e.jsx("div",{children:"Account archived. Renew to restore access."}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:`/app${Ae}`,children:"Renew Now"})]}):null,s==="ai-chatbot"&&p?e.jsxs("div",{className:"alert alert-warning d-flex align-items-center justify-content-between",children:[e.jsxs("div",{children:["Trial ends on ",e.jsx("strong",{children:b||"soon"}),". Upgrade to keep access."]}),e.jsx("a",{className:"btn btn-outline-light btn-sm",href:"/pricing/",children:"Upgrade"})]}):null,r?e.jsxs("div",{className:"alert alert-warning alert-dismissible fade show",children:[r,e.jsx("button",{type:"button",className:"btn-close",onClick:()=>i("")})]}):null,e.jsxs(iN,{location:te,children:[e.jsx(Ue,{path:"/",element:y?e.jsx($e,{to:F("/dealer-dashboard"),replace:!0}):v?e.jsx($e,{to:F("/saas-admin"),replace:!0}):s==="storage"?e.jsx(tw,{subscriptions:t.subscriptions}):s==="ai-chatbot"?e.jsx(jw,{subscriptions:t.subscriptions}):e.jsx(SN,{productSlug:s,subscriptions:t.subscriptions})}),e.jsx(Ue,{path:"/files",element:s==="storage"?e.jsx(Yf,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/users",element:s==="storage"&&C?e.jsx(XS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/activity",element:w?e.jsx($N,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/work-activity",element:w?e.jsx(ON,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/app-usage",element:w&&P?e.jsx(BN,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/app-urls",element:w?e.jsx(HN,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/gaming-ott",element:w&&$?e.jsx(YN,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/employees",element:w&&!_?e.jsx(CN,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/employees/add",element:w&&!_?e.jsx(Uf,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/employees/:employeeId",element:w&&!_?e.jsx(PN,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/employees/:employeeId/edit",element:w&&!_?e.jsx(Uf,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/screenshots",element:w?e.jsx(AN,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/company",element:w&&C&&!_?e.jsx(a_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/privacy",element:w&&C&&!_?e.jsx(n_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/company/edit",element:w&&C&&!_?e.jsx(r_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/billing",element:C&&!_?e.jsx(j_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/plans",element:C&&!_?e.jsx(D_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/profile",element:C&&!_?e.jsx($_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/org-admin/media-library",element:C&&!_?e.jsx(Hc,{scope:"org"}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/inbox",element:s==="ai-chatbot"&&(C||h)?e.jsx(nw,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/widgets",element:s==="ai-chatbot"&&C?e.jsx(ow,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/leads",element:s==="ai-chatbot"&&C?e.jsx(mw,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/agents",element:s==="ai-chatbot"&&C?e.jsx(xw,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/history",element:s==="ai-chatbot"&&C?e.jsx(yw,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/chat-settings",element:s==="ai-chatbot"&&C?e.jsx(Sw,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/dealer-dashboard",element:y?e.jsx(I_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/dealer-referrals",element:y?e.jsx(z_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/dealer-payouts",element:y?e.jsx(aS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/dealer-billing",element:y?e.jsx(J_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/dealer-plan",element:y?e.jsx(Y_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/dealer-profile",element:y?e.jsx(Q_,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/dealer-bank-transfer/:transferId",element:y?e.jsx(nS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin",element:v?e.jsx(rS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/organizations",element:v?e.jsx(uS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/observability",element:v?e.jsx(Rg,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/retention-policy",element:v?e.jsx(SS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/storage",element:v?e.jsx(TS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/media-library",element:v?e.jsx(Hc,{scope:"saas"}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/backup-activity",element:v?e.jsx(LS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/server-monitoring",element:v?e.jsx(OS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/server-monitoring/settings",element:v?e.jsx(VS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/server-monitoring/alerts",element:v?e.jsx(HS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/server-monitoring/:serverId",element:v?e.jsx(BS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/backup-history",element:C?e.jsx(MS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/user/:id",element:s==="storage"&&C?e.jsx(Yf,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/billing",element:v?e.jsx(AS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/organizations/:orgId",element:v?e.jsx(gS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/dealers/:dealerId",element:v?e.jsx(hS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/referrals",element:v?e.jsx(bS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/profile",element:v?e.jsx(NS,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/products/:slug",element:v?e.jsx(Bf,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/saas-admin/products/:slug/retention-policy",element:v?e.jsx(Bf,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/bank-transfer",element:C?e.jsx(Ff,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"/bank-transfer/:transferId",element:C?e.jsx(Ff,{}):e.jsx($e,{to:F("/"),replace:!0})}),e.jsx(Ue,{path:"*",element:e.jsx($e,{to:F("/"),replace:!0})})]})]}),u?e.jsx("div",{className:"modal-overlay",onClick:()=>c(!1),children:e.jsxs("div",{className:"modal-panel",onClick:ne=>ne.stopPropagation(),children:[e.jsx("h5",{children:"Free Plan Will Expire"}),e.jsxs("div",{className:"text-secondary mb-2",children:["Your free plan will expire on ",e.jsx("strong",{children:t.freePlanExpiry}),". Please choose a paid plan to continue without interruption."]}),e.jsxs("div",{className:"d-flex justify-content-end gap-2 mt-3",children:[e.jsx(et,{className:"btn btn-primary",to:F("/plans"),children:"View Plans"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>c(!1),children:"Later"})]})]})}):null]})}function Dw(){const[t,a]=o.useState(Cr),[s,n]=o.useState({email:"",password:""}),[l,r]=o.useState(""),[i,u]=o.useState(!1),c=o.useCallback(h=>{typeof window<"u"&&(window.__WZ_READ_ONLY__=!!h.read_only,window.__WZ_ARCHIVED__=!!h.archived),a({loading:!1,authenticated:!!h.authenticated,user:h.user||null,profile:h.profile||null,archived:!!h.archived,dealer:h.dealer||null,dealerOnboarding:h.dealer_onboarding||null,allowAppUsage:h.allow_app_usage!==!1,allowGamingOttUsage:h.allow_gaming_ott_usage!==!1,themePrimary:h.theme_primary||"",themeSecondary:h.theme_secondary||"",freePlanPopup:!!h.free_plan_popup,freePlanExpiry:h.free_plan_expiry||"",onboarding:h.onboarding||{enabled:!1,state:"active"},readOnly:!!h.read_only,subscriptions:[]})},[]),m=o.useCallback(async()=>{const h=await fetch("/api/auth/subscriptions",{credentials:"include"});if(!h.ok){a(b=>({...b,subscriptions:[]}));return}const p=await h.json();a(b=>({...b,subscriptions:p.subscriptions||[]}))},[]),x=o.useCallback(async()=>{const h=await fetch("/api/auth/me",{credentials:"include"});if(h.status===401){a({...Cr,loading:!1});return}if(!h.ok){a({...Cr,loading:!1});return}const p=await h.json();c(p),await m()},[c,m]);o.useEffect(()=>{let h=!0;async function p(){try{await x()}catch{h&&a({...Cr,loading:!1})}}return p(),()=>{h=!1}},[x]);async function f(h){if(h.preventDefault(),!s.email||!s.password){r("Email and password are required.");return}r(""),u(!0);try{await fetch("/api/auth/csrf",{credentials:"include"});const p=await fetch("/api/auth/login",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s.email,password:s.password})});if(!p.ok){let b="Login failed. Check credentials and try again.";try{const P=await p.json();P!=null&&P.error&&(b=P.error)}catch{}r(b);return}await x()}catch{r("Login failed. Check credentials and try again.")}finally{u(!1)}}const j=[{prefix:"/monitor",slug:"monitor",label:"Monitor"},{prefix:"/ai-chatbot",slug:"ai-chatbot",label:"AI Chatbot"},{prefix:"/storage",slug:"storage",label:"Online Storage"},{prefix:"/ai-chat-widget",slug:"ai-chat-widget",label:"AI Chat Widget"},{prefix:"/digital-card",slug:"digital-card",label:"Digital Card"}];function N(h){return j.find(p=>h===p.prefix||h.startsWith(`${p.prefix}/`))||null}function v(h){return(t.subscriptions||[]).find(b=>b.product_slug===h)||null}function _(h){const p=v(h);if(!p)return"none";const b=(p.status||"").toLowerCase();if(b==="trialing"){const P=p.trial_end?new Date(p.trial_end):null;return P&&P.getTime()>=Date.now()?"active":"trial_ended"}return b}function C({label:h,status:p,productSlug:b,planIsFree:P}){const $=p==="pending",E=p==="rejected",L=p==="expired",V=p==="trial_ended",U=!!(P&&(L||V)),w=$?"Awaiting Admin Approval":E?"Subscription Rejected":V?"Trial Ended":L?"Subscription Expired":"Subscription Required",Q=$?"Your payment is under review. You will get access once approved.":E?"Your payment was rejected. Please renew to activate access.":V?"Trial ended. Please upgrade your plan.":L?"Your subscription has expired. Please renew to continue.":"You need an active plan to open this dashboard.",J=$?"View My Account":U?"View Plans":E||L||V?"Renew Plan":"View Pricing",me=$?"/my-account/":U?`/pricing/?product=${b||"monitor"}`:E||L?`/my-account/billing/renew/start/?product=${b||"monitor"}`:"/pricing/";return e.jsx("div",{className:"page-center",children:e.jsxs("div",{className:"panel",children:[e.jsxs("h1",{children:[h," Dashboard"]}),e.jsx("p",{children:w}),e.jsx("div",{className:"text-secondary",children:Q}),e.jsx("div",{className:"button-row",children:e.jsx("a",{className:"app-btn app-btn-primary",href:me,children:J})})]})})}function y(){var w,Q,J,me;const h=ba(),p=h.pathname.startsWith("/saas-admin"),b=!!((w=t.user)!=null&&w.is_superuser||(Q=t.user)!=null&&Q.is_staff||((J=t.profile)==null?void 0:J.role)==="superadmin"||((me=t.profile)==null?void 0:me.role)==="super_admin"),P=b?"/saas-admin/billing":"/billing";if(p)return b?e.jsx(qo,{state:t,productPrefix:"",productSlug:"saas-admin"}):e.jsx($e,{to:"/",replace:!0});if(t.archived&&h.pathname!==P)return e.jsx($e,{to:P,replace:!0});const $=N(h.pathname),E=$?$.slug:"monitor",L=$?$.prefix:"",V=v(E),U=_(E);return U!=="active"?E==="storage"&&(U==="trial_ended"||U==="expired")?e.jsx(qo,{state:t,productPrefix:L,productSlug:E}):e.jsx(C,{label:($==null?void 0:$.label)||"Monitor",status:U,productSlug:E,planIsFree:V==null?void 0:V.plan_is_free}):e.jsx(qo,{state:t,productPrefix:L,productSlug:E})}return e.jsx(Ag,{children:e.jsx(pN,{basename:"/app",children:t.loading?e.jsx("div",{className:"page-center",children:e.jsxs("div",{className:"panel",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading dashboard..."})]})}):t.authenticated?e.jsx(ww,{children:e.jsx(y,{})}):e.jsx("div",{className:"page-center",children:e.jsxs("div",{className:"panel",children:[e.jsx("h1",{children:"Welcome to Work Zilla Monitor"}),e.jsx("p",{children:"Please log in to access the dashboard."}),l?e.jsx("div",{className:"alert alert-danger",role:"alert",children:l}):null,e.jsxs("form",{onSubmit:f,className:"d-grid gap-2",children:[e.jsx("input",{type:"email",className:"form-control",placeholder:"Email",value:s.email,onChange:h=>n(p=>({...p,email:h.target.value}))}),e.jsx("input",{type:"password",className:"form-control",placeholder:"Password",value:s.password,onChange:h=>n(p=>({...p,password:h.target.value}))}),e.jsx("button",{className:"app-btn app-btn-primary",type:"submit",disabled:i,children:i?"Signing in...":"Login"})]}),e.jsx("div",{className:"button-row",children:e.jsx("a",{className:"app-btn app-btn-secondary",href:"/auth/signup/",children:"Create Account"})})]})})})})}Yo.createRoot(document.getElementById("root")).render(e.jsx(gp.StrictMode,{children:e.jsx(Ag,{children:e.jsx(Dw,{})})}));
