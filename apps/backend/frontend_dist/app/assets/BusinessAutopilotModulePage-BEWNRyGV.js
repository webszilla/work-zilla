import{b as Fe,j as e,r as g,a as Pe,T as jt}from"./index-Lru_Ml1A.js";const Re=["India","United States","United Arab Emirates","United Kingdom","Singapore","Australia","Canada"],vt=Array.from(new Set(Fe.map(l=>String((l==null?void 0:l.label)||"").trim()).filter(Boolean))).sort((l,h)=>{const i=Re.indexOf(l),N=Re.indexOf(h);return i!==-1||N!==-1?i===-1?1:N===-1?-1:i-N:l.localeCompare(h)}),$e=Array.from(new Set(Fe.map(l=>String((l==null?void 0:l.code)||"").trim()).filter(Boolean))).sort((l,h)=>l==="+91"?-1:h==="+91"?1:l.localeCompare(h,void 0,{numeric:!0}));function St(l){const h=String(l||"").trim();if(!h)return"";const i=Fe.filter(k=>String((k==null?void 0:k.code)||"").trim()===h).map(k=>String((k==null?void 0:k.label)||"").trim()).filter(Boolean);if(!i.length)return"";const N=Array.from(new Set(i));return N.find(k=>Re.includes(k))||N[0]}function kt(l){const h=String(l||"").trim();if(!h)return"";const i=St(h);return i?`${i} ${h}`:h}const _e=$e.map(l=>({value:l,label:kt(l)})),Ct={India:["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Goa","Gujarat","Haryana","Himachal Pradesh","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal","Andaman and Nicobar Islands","Chandigarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Jammu and Kashmir","Ladakh","Lakshadweep","Puducherry"],"United States":["Alabama","Alaska","Arizona","Arkansas","California","Colorado","Connecticut","Delaware","Florida","Georgia","Hawaii","Idaho","Illinois","Indiana","Iowa","Kansas","Kentucky","Louisiana","Maine","Maryland","Massachusetts","Michigan","Minnesota","Mississippi","Missouri","Montana","Nebraska","Nevada","New Hampshire","New Jersey","New Mexico","New York","North Carolina","North Dakota","Ohio","Oklahoma","Oregon","Pennsylvania","Rhode Island","South Carolina","South Dakota","Tennessee","Texas","Utah","Vermont","Virginia","Washington","West Virginia","Wisconsin","Wyoming"],Canada:["Alberta","British Columbia","Manitoba","New Brunswick","Newfoundland and Labrador","Nova Scotia","Ontario","Prince Edward Island","Quebec","Saskatchewan","Northwest Territories","Nunavut","Yukon"],Australia:["New South Wales","Victoria","Queensland","Western Australia","South Australia","Tasmania","Australian Capital Territory","Northern Territory"],"United Arab Emirates":["Abu Dhabi","Ajman","Dubai","Fujairah","Ras Al Khaimah","Sharjah","Umm Al Quwain"],"United Kingdom":["England","Scotland","Wales","Northern Ireland"],Singapore:["Central Region","East Region","North Region","North-East Region","West Region"],Malaysia:["Johor","Kedah","Kelantan","Malacca","Negeri Sembilan","Pahang","Penang","Perak","Perlis","Sabah","Sarawak","Selangor","Terengganu","Kuala Lumpur","Labuan","Putrajaya"],"Saudi Arabia":["Riyadh","Makkah","Madinah","Eastern Province","Asir","Tabuk","Qassim","Hail","Jazan","Najran","Al Bahah","Al Jawf","Northern Borders"],"South Africa":["Eastern Cape","Free State","Gauteng","KwaZulu-Natal","Limpopo","Mpumalanga","Northern Cape","North West","Western Cape"],Germany:["Baden-Wurttemberg","Bavaria","Berlin","Brandenburg","Bremen","Hamburg","Hesse","Lower Saxony","Mecklenburg-Vorpommern","North Rhine-Westphalia","Rhineland-Palatinate","Saarland","Saxony","Saxony-Anhalt","Schleswig-Holstein","Thuringia"]};function Tt(l){const h=String(l||"").trim();return Ct[h]||[]}const We="wz_business_autopilot_projects_module",Ye="wz_business_autopilot_crm_module",Je="wz_business_autopilot_hr_module",Et="wz_business_autopilot_ticketing_module",Dt="wz_business_autopilot_stocks_module",Ee="wz_business_autopilot_accounts_module",At=5,qe={crm:{title:"CRM",subtitle:"Manage leads, deals, and customer follow-ups.",stats:[{label:"Open Leads",value:"24"},{label:"Pipeline Value",value:"INR 8.4L"},{label:"Follow-ups Today",value:"11"}],sections:["Lead pipeline board","Deal stage tracking","Activity timeline","Contact import/export"]},hrm:{title:"HR",subtitle:"Handle employees, attendance, and payroll workflows.",stats:[{label:"Employees",value:"42"},{label:"Attendance Today",value:"89%"},{label:"Pending Leaves",value:"6"}],sections:["Employee directory","Attendance and shifts","Leave approvals","Payroll run setup"]},projects:{title:"Project Management",subtitle:"Track project milestones, tasks, and team delivery."},accounts:{title:"Accounts",subtitle:"Control billing, expenses, GST, and accounting reports.",stats:[{label:"Invoices This Month",value:"126"},{label:"Receivables",value:"INR 3.2L"},{label:"GST Status",value:"Ready"}],sections:["Invoice and billing","Expense tracking","GST reports","Vendor and purchase entries"]},ticketing:{title:"Ticketing System",subtitle:"Track support tickets, priorities, SLA, and team resolution workflows.",stats:[{label:"Open Tickets",value:"18"},{label:"Pending Today",value:"7"},{label:"Avg Resolution",value:"4h 20m"}],sections:["Ticket queue and status board","Priority and SLA tracking","Agent assignment and ownership","Customer issue comments and history"]},stocks:{title:"Stocks Management",subtitle:"Manage inventory levels, stock movement, reorder alerts, and warehouses.",stats:[{label:"Items In Stock",value:"428"},{label:"Low Stock Alerts",value:"12"},{label:"Warehouses",value:"3"}],sections:["Inventory items master","Stock in / stock out entries","Low-stock reorder alerts","Warehouse-wise quantity tracking"]}},be={leads:{label:"Leads",itemLabel:"Lead",icon:"bi-person-plus",columns:[{key:"name",label:"Lead Name"},{key:"company",label:"Company"},{key:"phone",label:"Phone"},{key:"stage",label:"Stage"},{key:"status",label:"Status"}],fields:[{key:"name",label:"Lead Name",placeholder:"Enter lead name"},{key:"company",label:"Company",placeholder:"Company / Business name"},{key:"phoneCountryCode",label:"Country Code",type:"select",options:$e,defaultValue:"+91"},{key:"phone",label:"Phone",placeholder:"Mobile number"},{key:"stage",label:"Stage",type:"select",options:["New","Qualified","Proposal"],defaultValue:"New"},{key:"status",label:"Status",type:"select",options:["Open","Closed","Converted"],defaultValue:"Open"}]},contacts:{label:"Contacts",itemLabel:"Contact",icon:"bi-person-lines-fill",columns:[{key:"name",label:"Name"},{key:"company",label:"Company"},{key:"email",label:"Email"},{key:"phone",label:"Phone"},{key:"tag",label:"Tag"}],fields:[{key:"name",label:"Name",placeholder:"Contact name"},{key:"company",label:"Company",placeholder:"Company name"},{key:"email",label:"Email",placeholder:"contact@example.com"},{key:"phoneCountryCode",label:"Country Code",type:"select",options:$e,defaultValue:"+91"},{key:"phone",label:"Phone",placeholder:"Phone number"},{key:"tag",label:"Tag",type:"select",options:["Customer","Prospect","Vendor"],defaultValue:"Customer"}]},deals:{label:"Deals",itemLabel:"Deal",icon:"bi-currency-rupee",columns:[{key:"dealName",label:"Deal Name"},{key:"company",label:"Company"},{key:"stage",label:"Stage"},{key:"amount",label:"Amount"},{key:"status",label:"Status"}],fields:[{key:"dealName",label:"Deal Name",placeholder:"ERP rollout annual contract"},{key:"company",label:"Company",placeholder:"Customer company"},{key:"stage",label:"Stage",type:"select",options:["Discovery","Proposal","Negotiation"],defaultValue:"Discovery"},{key:"amount",label:"Amount",placeholder:"INR amount"},{key:"status",label:"Status",type:"select",options:["Open","Won","Lost"],defaultValue:"Open"}]},followUps:{label:"Follow-ups",itemLabel:"Follow-up",icon:"bi-telephone-forward",columns:[{key:"subject",label:"Subject"},{key:"relatedTo",label:"Related To"},{key:"dueDate",label:"Due Date"},{key:"owner",label:"Owner"},{key:"status",label:"Status"}],fields:[{key:"subject",label:"Subject",placeholder:"Demo callback / pricing follow-up"},{key:"relatedTo",label:"Related To",placeholder:"Lead / Contact / Deal name"},{key:"dueDate",label:"Due Date",type:"date"},{key:"owner",label:"Owner",placeholder:"Sales owner"},{key:"status",label:"Status",type:"select",options:["Pending","Done","Missed"],defaultValue:"Pending"}]},activities:{label:"Activities",itemLabel:"Activity",icon:"bi-clock-history",columns:[{key:"activityType",label:"Activity Type"},{key:"relatedTo",label:"Related To"},{key:"date",label:"Date"},{key:"owner",label:"Owner"},{key:"notes",label:"Notes"}],fields:[{key:"activityType",label:"Activity Type",placeholder:"Call / Meeting / Demo / Email"},{key:"relatedTo",label:"Related To",placeholder:"Lead / Deal / Contact"},{key:"date",label:"Date",placeholder:"YYYY-MM-DD"},{key:"owner",label:"Owner",placeholder:"User name"},{key:"notes",label:"Notes",placeholder:"Short activity notes"}]},meetings:{label:"Meetings",itemLabel:"Meeting",icon:"bi-calendar-event",columns:[{key:"title",label:"Meeting Title"},{key:"relatedTo",label:"Related To"},{key:"meetingDate",label:"Date"},{key:"meetingTime",label:"Time"},{key:"owner",label:"Owner"},{key:"reminderSummary",label:"Reminder"},{key:"status",label:"Status"}],fields:[{key:"title",label:"Meeting Title",placeholder:"Client demo / Follow-up call"},{key:"relatedTo",label:"Related To",placeholder:"Lead / Contact / Deal / Company"},{key:"meetingDate",label:"Meeting Date",type:"date"},{key:"meetingTime",label:"Meeting Time",type:"time"},{key:"owner",label:"Owner",placeholder:"Sales owner / Team member"},{key:"meetingMode",label:"Meeting Mode",type:"select",options:["Online","Offline","Phone"],defaultValue:"Online"},{key:"reminderChannel",label:"Reminder Channel",type:"select",options:["App Alert","Email","SMS","WhatsApp"],defaultValue:"App Alert"},{key:"reminderMinutes",label:"Reminder Before (Minutes)",type:"select",options:["5","10","15","30","60","120","1440"],defaultValue:"15"},{key:"status",label:"Status",type:"select",options:["Scheduled","Completed","Rescheduled","Cancelled"],defaultValue:"Scheduled"}]}},Pt={leads:[{id:"crm_l1",name:"Ravi Kumar",company:"Ultra HD Prints",phoneCountryCode:"+91",phone:"9876543210",stage:"Qualified",status:"Open"},{id:"crm_l2",name:"Priya N",company:"North India Jewels",phoneCountryCode:"+91",phone:"9123456780",stage:"Proposal",status:"Open"}],contacts:[{id:"crm_c1",name:"Ravi Kumar",company:"Ultra HD Prints",email:"ravi@uhdprints.example",phoneCountryCode:"+91",phone:"9876543210",tag:"Customer"},{id:"crm_c2",name:"Priya N",company:"North India Jewels",email:"priya@nij.example",phoneCountryCode:"+91",phone:"9123456780",tag:"Prospect"}],deals:[{id:"crm_d1",dealName:"POS Billing Setup",company:"Ultra HD Prints",stage:"Negotiation",amount:"85000",status:"Open"},{id:"crm_d2",dealName:"WhatsApp Campaign Suite",company:"North India Jewels",stage:"Proposal",amount:"42000",status:"Open"}],followUps:[{id:"crm_f1",subject:"Demo callback",relatedTo:"Ultra HD Prints",dueDate:"2026-02-25",owner:"GP Prakash",status:"Pending"},{id:"crm_f2",subject:"Pricing confirmation",relatedTo:"North India Jewels",dueDate:"2026-02-25",owner:"GP Prakash",status:"Pending"}],activities:[{id:"crm_a1",activityType:"Call",relatedTo:"Ultra HD Prints",date:"2026-02-24",owner:"GP Prakash",notes:"Discussed rollout scope"},{id:"crm_a2",activityType:"Email",relatedTo:"North India Jewels",date:"2026-02-24",owner:"GP Prakash",notes:"Sent proposal PDF"}],meetings:[{id:"crm_m1",title:"Ultra HD Prints Demo",relatedTo:"Ultra HD Prints",meetingDate:"2026-02-26",meetingTime:"11:00",owner:"GP Prakash",meetingMode:"Online",reminderChannel:"WhatsApp",reminderMinutes:"30",status:"Scheduled",reminderSummary:"WhatsApp • 30 min before"},{id:"crm_m2",title:"North India Jewels Pricing Call",relatedTo:"North India Jewels",meetingDate:"2026-02-27",meetingTime:"16:30",owner:"GP Prakash",meetingMode:"Phone",reminderChannel:"App Alert",reminderMinutes:"15",status:"Scheduled",reminderSummary:"App Alert • 15 min before"}]},ve={projects:{label:"Projects",itemLabel:"Project",columns:[{key:"name",label:"Project Name"},{key:"owner",label:"Owner"},{key:"status",label:"Status"}],fields:[{key:"name",label:"Project Name",placeholder:"Enter project name"},{key:"owner",label:"Owner",placeholder:"Enter owner name"},{key:"status",label:"Status",placeholder:"Active / Planned / Hold"}]},tasks:{label:"Tasks",itemLabel:"Task",columns:[{key:"title",label:"Task"},{key:"assignee",label:"Assign To"},{key:"startDate",label:"Start Date"},{key:"dueDate",label:"Due Date"}],fields:[{key:"title",label:"Task",placeholder:"Enter task title"},{key:"assignee",label:"Assign To",placeholder:"Search user name"},{key:"startDate",label:"Start Date",type:"date"},{key:"dueDate",label:"Due Date",type:"date"}]},milestones:{label:"Milestones",itemLabel:"Milestone",columns:[{key:"title",label:"Milestone"},{key:"project",label:"Project"},{key:"targetDate",label:"Target Date"}],fields:[{key:"title",label:"Milestone",placeholder:"Enter milestone title"},{key:"project",label:"Project",placeholder:"Enter project name"},{key:"targetDate",label:"Target Date",placeholder:"YYYY-MM-DD"}]},team:{label:"Team",itemLabel:"Team Member",columns:[{key:"name",label:"Name"},{key:"role",label:"Role"},{key:"project",label:"Project"}],fields:[{key:"name",label:"Name",placeholder:"Enter member name"},{key:"role",label:"Role",placeholder:"Enter role"},{key:"project",label:"Project",placeholder:"Enter project name"}]}},It={projects:[{id:"p1",name:"ERP Rollout",owner:"Guru",status:"Active"},{id:"p2",name:"HR Automation",owner:"Nithya",status:"Planned"}],tasks:[{id:"t1",title:"Finalize sprint board",assignee:"Guru",startDate:"2026-02-16",dueDate:"2026-02-20"},{id:"t2",title:"Client approval review",assignee:"Arun",startDate:"2026-02-18",dueDate:"2026-02-22"}],milestones:[{id:"m1",title:"Phase 1 Go-Live",project:"ERP Rollout",targetDate:"2026-03-10"},{id:"m2",title:"Payroll Cutover",project:"HR Automation",targetDate:"2026-03-25"}],team:[{id:"u1",name:"Guru",role:"Project Manager",project:"ERP Rollout"},{id:"u2",name:"Nithya",role:"Business Analyst",project:"HR Automation"}]},Se={employees:{label:"Employees",itemLabel:"Employee",columns:[{key:"name",label:"Name"},{key:"department",label:"Department"},{key:"designation",label:"Designation"}],fields:[{key:"name",label:"Name",placeholder:"Enter employee name"},{key:"department",label:"Department",placeholder:"HR / Sales / Engineering"},{key:"designation",label:"Designation",placeholder:"Executive / Manager"}]},attendance:{label:"Attendance",itemLabel:"Attendance Entry",columns:[{key:"employee",label:"Employee"},{key:"date",label:"Date"},{key:"inTime",label:"In Time"},{key:"outTime",label:"Out Time"},{key:"workedHours",label:"Worked"},{key:"status",label:"Status"}],fields:[{key:"employee",label:"Employee",placeholder:"Enter employee name"},{key:"date",label:"Date",type:"date"},{key:"entryMode",label:"Entry Side",type:"select",options:["HR Side","User Side"],defaultValue:"HR Side"},{key:"inTime",label:"In Time",type:"time"},{key:"outTime",label:"Out Time",type:"time"},{key:"status",label:"Status",type:"select",options:["Present","Half Day","Leave","Permission"],defaultValue:"Present"},{key:"permissionHours",label:"Permission Hours",placeholder:"e.g. 2",conditionalOn:{key:"status",value:"Permission"}},{key:"notes",label:"Notes",placeholder:"Optional notes",optional:!0}]},leaves:{label:"Leaves",itemLabel:"Leave Request",columns:[{key:"employee",label:"Employee"},{key:"leaveType",label:"Leave Type"},{key:"status",label:"Status"}],fields:[{key:"employee",label:"Employee",placeholder:"Enter employee name"},{key:"leaveType",label:"Leave Type",placeholder:"Sick / Casual / Paid"},{key:"status",label:"Status",placeholder:"Pending / Approved / Rejected"}]},payroll:{label:"Payroll",itemLabel:"Payroll Entry",columns:[{key:"employee",label:"Employee"},{key:"month",label:"Month"},{key:"salary",label:"Net Salary"}],fields:[{key:"employee",label:"Employee",placeholder:"Enter employee name"},{key:"month",label:"Month",placeholder:"YYYY-MM"},{key:"salary",label:"Net Salary",placeholder:"INR amount"}]}},Ke={employees:[{id:"e1",name:"Guru",department:"Engineering",designation:"Project Lead"},{id:"e2",name:"Nithya",department:"HR",designation:"HR Executive"}],attendance:[{id:"a1",employee:"Guru",date:"2026-02-19",entryMode:"HR Side",inTime:"09:10",outTime:"18:05",workedHours:"8h 55m",status:"Present",notes:""},{id:"a2",employee:"Nithya",date:"2026-02-19",entryMode:"User Side",inTime:"09:25",outTime:"17:48",workedHours:"8h 23m",status:"Present",notes:""}],leaves:[{id:"l1",employee:"Arun",leaveType:"Sick",status:"Pending"},{id:"l2",employee:"Kiran",leaveType:"Casual",status:"Approved"}],payroll:[{id:"pr1",employee:"Guru",month:"2026-02",salary:"INR 85,000"},{id:"pr2",employee:"Nithya",month:"2026-02",salary:"INR 42,000"}]},Mt={mainCategories:{label:"Main Category",itemLabel:"Main Category",columns:[{key:"name",label:"Category Name"},{key:"department",label:"Department"},{key:"sla",label:"SLA"}],fields:[{key:"name",label:"Category Name",placeholder:"Technical Support / Billing"},{key:"department",label:"Department",placeholder:"Support / Accounts / Sales"},{key:"sla",label:"SLA",placeholder:"4h / 8h / 24h"}]},subCategories:{label:"Sub Category",itemLabel:"Sub Category",columns:[{key:"name",label:"Sub Category"},{key:"mainCategory",label:"Main Category"},{key:"priority",label:"Default Priority"}],fields:[{key:"name",label:"Sub Category",placeholder:"Login Issue / Refund / Installation"},{key:"mainCategory",label:"Main Category",placeholder:"Technical Support"},{key:"priority",label:"Default Priority",placeholder:"Low / Medium / High"}]},tickets:{label:"Tickets",itemLabel:"Ticket",columns:[{key:"ticketNo",label:"Ticket No"},{key:"subject",label:"Subject"},{key:"category",label:"Category"},{key:"status",label:"Status"}],fields:[{key:"ticketNo",label:"Ticket No",placeholder:"TK-1001"},{key:"subject",label:"Subject",placeholder:"Customer login issue"},{key:"category",label:"Category",placeholder:"Technical Support / Login Issue"},{key:"status",label:"Status",placeholder:"Open / In Progress / Closed"}]}},Lt={mainCategories:[{id:"tm1",name:"Technical Support",department:"Support",sla:"4h"},{id:"tm2",name:"Billing",department:"Accounts",sla:"8h"}],subCategories:[{id:"ts1",name:"Login Issue",mainCategory:"Technical Support",priority:"High"},{id:"ts2",name:"Refund Request",mainCategory:"Billing",priority:"Medium"}],tickets:[{id:"tt1",ticketNo:"TK-1001",subject:"Customer login issue",category:"Technical Support / Login Issue",status:"Open"},{id:"tt2",ticketNo:"TK-1002",subject:"Refund follow-up",category:"Billing / Refund Request",status:"In Progress"}]},Ot={items:{label:"Stock Items",itemLabel:"Stock Item",columns:[{key:"itemName",label:"Item Name"},{key:"sku",label:"SKU"},{key:"category",label:"Category"},{key:"qty",label:"Qty"}],fields:[{key:"itemName",label:"Item Name",placeholder:"Dell Laptop 14"},{key:"sku",label:"SKU",placeholder:"DL-14-001"},{key:"category",label:"Category",placeholder:"Electronics / Laptops"},{key:"qty",label:"Qty",placeholder:"25"}]},mainCategories:{label:"Main Category",itemLabel:"Main Category",columns:[{key:"name",label:"Category Name"},{key:"code",label:"Code"},{key:"warehouse",label:"Warehouse"}],fields:[{key:"name",label:"Category Name",placeholder:"Electronics / Stationery / Spares"},{key:"code",label:"Code",placeholder:"ELEC / STAT / SPR"},{key:"warehouse",label:"Warehouse",placeholder:"Main Warehouse"}]},subCategories:{label:"Sub Category",itemLabel:"Sub Category",columns:[{key:"name",label:"Sub Category"},{key:"mainCategory",label:"Main Category"},{key:"reorderLevel",label:"Reorder Level"}],fields:[{key:"name",label:"Sub Category",placeholder:"Laptops / Keyboards / Toners"},{key:"mainCategory",label:"Main Category",placeholder:"Electronics"},{key:"reorderLevel",label:"Reorder Level",placeholder:"10 / 25 / 50"}]}},Rt={mainCategories:[{id:"sm1",name:"Electronics",code:"ELEC",warehouse:"Main Warehouse"},{id:"sm2",name:"Office Supplies",code:"OFF",warehouse:"Store Room"}],subCategories:[{id:"ss1",name:"Laptops",mainCategory:"Electronics",reorderLevel:"5"},{id:"ss2",name:"Printers",mainCategory:"Electronics",reorderLevel:"3"}],items:[{id:"si1",itemName:"Dell Latitude 5440",sku:"DL5440",category:"Electronics / Laptops",qty:"12"},{id:"si2",itemName:"HP LaserJet Pro",sku:"HPLJPRO",category:"Electronics / Printers",qty:"4"}]},De=["Active","Inactive"],ze=["Draft","Sent","Approved","Rejected","Converted"],Qe=["Draft","Sent","Partially Paid","Paid","Overdue","Cancelled"],$t={customers:[{id:"cust_1",name:"Ultra HD Prints",gstin:"33ABCDE1234F1Z5",phone:"9876543210",email:"accounts@ultrahdprints.example",billingAddress:"No 17, 2nd Cross Street, Venkateswara Nagar"}],itemMasters:[{id:"itm_1",name:"POS Billing Setup",sku:"POS-SETUP",unit:"Nos",defaultRate:"24999",taxPercent:"18"},{id:"itm_2",name:"Thermal Printer",sku:"THERMAL-PRN",unit:"Nos",defaultRate:"15000",taxPercent:"18"}],gstTemplates:[{id:"gst_1",name:"India GST 18% (Intra State)",taxScope:"Intra State",cgst:"9",sgst:"9",igst:"0",cess:"0",status:"Active",notes:"Default GST for local billing"},{id:"gst_2",name:"India GST 18% (Inter State)",taxScope:"Inter State",cgst:"0",sgst:"0",igst:"18",cess:"0",status:"Active",notes:"Use for interstate billing"}],billingTemplates:[{id:"bt_1",name:"Default GST Invoice Template",docType:"Invoice",gstTemplateId:"gst_1",prefix:"INV",themeColor:"#22c55e",footerNote:"Thank you for your business.",termsText:"Payment due within 7 days.",status:"Active"},{id:"bt_2",name:"Estimate Proposal Template",docType:"Estimate",gstTemplateId:"gst_1",prefix:"EST",themeColor:"#3b82f6",footerNote:"Estimate validity: 15 days.",termsText:"Subject to stock availability.",status:"Active"}],estimates:[{id:"est_1",docNo:"EST-1001",customerName:"Ultra HD Prints",customerGstin:"33ABCDE1234F1Z5",issueDate:"2026-02-20",dueDate:"2026-02-27",status:"Sent",gstTemplateId:"gst_1",billingTemplateId:"bt_2",salesperson:"Guru",billingAddress:"No 17, 2nd Cross Street, Venkateswara Nagar",notes:"Quote includes installation support.",termsText:"Advance 50% before order confirmation.",items:[{id:"eli_1",description:"Thermal Printer",qty:"2",rate:"15000",taxPercent:"18"},{id:"eli_2",description:"Barcode Scanner",qty:"4",rate:"3500",taxPercent:"18"}]}],invoices:[{id:"inv_1",docNo:"INV-1001",customerName:"Ultra HD Prints",customerGstin:"33ABCDE1234F1Z5",issueDate:"2026-02-24",dueDate:"2026-03-03",status:"Draft",gstTemplateId:"gst_1",billingTemplateId:"bt_1",salesperson:"Guru",billingAddress:"No 17, 2nd Cross Street, Venkateswara Nagar",notes:"Thanks for your business.",termsText:"Due on receipt.",items:[{id:"ili_1",description:"POS Billing Setup",qty:"1",rate:"24999",taxPercent:"18"}]}]};function ce(l){const h=Number(l||0);return Number.isFinite(h)?h:0}function ye(l){return`INR ${ce(l).toLocaleString("en-IN",{maximumFractionDigits:2})}`}function we(l){return ce(l==null?void 0:l.cgst)+ce(l==null?void 0:l.sgst)+ce(l==null?void 0:l.igst)+ce(l==null?void 0:l.cess)}function xe(){return{id:`line_${Date.now()}_${Math.random().toString(36).slice(2,7)}`,itemMasterId:"",description:"",qty:"1",rate:"",taxPercent:""}}function he(l="invoice"){const h=l==="estimate"?"EST":"INV",i=new Date().toISOString().slice(0,10);return{id:"",docNo:`${h}-${Date.now().toString().slice(-6)}`,customerName:"",customerGstin:"",issueDate:i,dueDate:i,status:"Draft",gstTemplateId:"",billingTemplateId:"",salesperson:"",billingAddress:"",notes:"",termsText:"",items:[xe()]}}function Ae(l,h){const i=(h||[]).find($=>$.id===l.gstTemplateId),N=i?we(i):0,M=Array.isArray(l==null?void 0:l.items)?l.items:[];let k=0,W=0;return M.forEach($=>{const P=ce($.qty),Y=ce($.rate),ee=P*Y,C=ce($.taxPercent||N);k+=ee,W+=ee*(C/100)}),{subtotal:k,taxTotal:W,grandTotal:k+W}}function ne(l){return l.reduce((h,i)=>(h[i.key]=i.defaultValue??"",h),{})}function _t(l){return l&&typeof l=="object"&&Object.keys(ve).every(h=>Array.isArray(l[h]))}function wt(l){return l&&typeof l=="object"&&Object.keys(Se).every(h=>Array.isArray(l[h]))}function Ft(l){return l&&typeof l=="object"&&Object.keys(be).every(h=>Array.isArray(l[h]))}function Gt(l,h){return l&&typeof l=="object"&&Object.keys(h).every(i=>Array.isArray(l[i]))}function Le(l){return l&&typeof l=="object"&&Array.isArray(l.customers)&&Array.isArray(l.itemMasters)&&Array.isArray(l.gstTemplates)&&Array.isArray(l.billingTemplates)&&Array.isArray(l.estimates)&&Array.isArray(l.invoices)}function ue(l){const h=String(l||"").trim();if(!h)return"-";const i=h.match(/^(\d{1,2}):(\d{2})$/);if(!i)return h;let N=Number(i[1]);const M=i[2];if(!Number.isFinite(N))return h;const k=N>=12?"PM":"AM";return N=N%12||12,`${N}:${M} ${k}`}function Ze(){return new Date().toISOString().slice(0,10)}function Xe(){const l=new Date,h=String(l.getHours()).padStart(2,"0"),i=String(l.getMinutes()).padStart(2,"0");return`${h}:${i}`}function Oe(l,h){const i=String(l||"").trim(),N=String(h||"").trim(),M=ee=>{const C=ee.match(/^(\d{1,2}):(\d{2})$/);if(!C)return null;const L=Number(C[1]),R=Number(C[2]);return!Number.isFinite(L)||!Number.isFinite(R)?null:L*60+R},k=M(i),W=M(N);if(k===null||W===null||W<k)return"";const $=W-k,P=Math.floor($/60),Y=$%60;return!P&&!Y?"0h 0m":`${P}h ${Y}m`}function oe({title:l,badgeLabel:h="",rows:i=[],columns:N=[],renderCells:M,renderActions:k,noRowsText:W="No rows found.",searchPlaceholder:$="Search",searchBy:P,pageSize:Y=At,withoutOuterCard:ee=!1,headerBottom:C=null,enableExport:L=!1,exportFileName:R="table-data",exportCellValue:F}){const[q,x]=g.useState(""),[v,G]=g.useState(1),O=g.useMemo(()=>{const s=String(q||"").trim().toLowerCase();return s?i.filter(c=>(typeof P=="function"?String(P(c)||""):Object.values(c||{}).join(" ")).toLowerCase().includes(s)):i},[i,P,q]),U=O.length,H=Math.max(1,Math.ceil(U/Y)),X=Math.min(v,H),z=(X-1)*Y,te=O.slice(z,z+Y),le=U?z+1:0,ae=U?z+te.length:0;g.useEffect(()=>{G(1)},[q,i.length]),g.useEffect(()=>{v>H&&G(H)},[v,H]);function r(s,c){if(typeof F=="function")return String(F(s,c)??"");const j=s==null?void 0:s[c.key];if(j==null)return"";if(typeof j=="object")try{return JSON.stringify(j)}catch{return String(j)}return String(j)}function o(){const s=N.map(V=>String(V.label||V.key||"")),c=V=>{const p=String(V??"");return/[",\n]/.test(p)?`"${p.replace(/"/g,'""')}"`:p},j=[s.map(c).join(","),...O.map(V=>N.map(p=>c(r(V,p))).join(","))],m=new Blob([`\uFEFF${j.join(`
`)}`],{type:"text/csv;charset=utf-8;"}),D=URL.createObjectURL(m),I=document.createElement("a");I.href=D,I.download=`${R}.csv`,document.body.appendChild(I),I.click(),I.remove(),URL.revokeObjectURL(D)}function S(){const s=window.open("","_blank","noopener,noreferrer,width=1000,height=700");if(!s)return;const c=D=>String(D??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),j=N.map(D=>`<th>${c(D.label||D.key||"")}</th>`).join(""),m=O.length?O.map(D=>`<tr>${N.map(V=>`<td>${c(r(D,V))}</td>`).join("")}</tr>`).join(""):`<tr><td colspan="${N.length}">No rows found.</td></tr>`;s.document.write(`
      <!doctype html>
      <html>
        <head>
          <title>${c(l)} - Export</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 24px; color: #111; }
            h2 { margin: 0 0 12px 0; font-size: 20px; }
            p { margin: 0 0 12px 0; color: #555; font-size: 12px; }
            table { width: 100%; border-collapse: collapse; }
            th, td { border: 1px solid #ccc; padding: 8px; text-align: left; font-size: 12px; vertical-align: top; }
            th { background: #f1f1f1; }
          </style>
        </head>
        <body>
          <h2>${c(l)}</h2>
          <p>Exported ${c(new Date().toLocaleString())}</p>
          <table>
            <thead><tr>${j}</tr></thead>
            <tbody>${m}</tbody>
          </table>
        </body>
      </html>
    `),s.document.close(),s.focus(),s.print()}const T=e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-end gap-2",children:[h?e.jsx("span",{className:"badge bg-secondary",children:h}):null,L?e.jsxs(e.Fragment,{children:[e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-success",onClick:o,children:[e.jsx("i",{className:"bi bi-file-earmark-excel me-1","aria-hidden":"true"}),"Excel"]}),e.jsxs("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:S,children:[e.jsx("i",{className:"bi bi-file-earmark-pdf me-1","aria-hidden":"true"}),"PDF"]})]}):null,e.jsxs("label",{className:"table-search mb-0",children:[e.jsx("i",{className:"bi bi-search","aria-hidden":"true"}),e.jsx("input",{type:"search",placeholder:$,value:q,onChange:s=>x(s.target.value)})]})]});return e.jsxs("div",{className:ee?"":"card p-3",children:[e.jsxs("div",{className:`d-flex flex-wrap align-items-center justify-content-between gap-2 ${C?"mb-2":"mb-3"}`,children:[e.jsx("h6",{className:"mb-0",children:l}),C?null:T]}),C?e.jsxs("div",{className:"d-flex flex-wrap align-items-start justify-content-between gap-2 mb-3",children:[e.jsx("div",{className:"flex-grow-1",style:{minWidth:"320px"},children:C}),T]}):null,e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-borderless align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[N.map(s=>e.jsx("th",{children:s.label},s.key||s.label)),k?e.jsx("th",{className:"text-end",children:"Action"}):null]})}),e.jsx("tbody",{children:te.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:N.length+(k?1:0),className:"text-secondary",children:W})}):te.map((s,c)=>e.jsxs("tr",{children:[M(s).map((j,m)=>e.jsx("td",{style:{backgroundColor:c%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:j},`${s.id||"row"}-${m}`)),k?e.jsx("td",{className:"text-end",style:{backgroundColor:c%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:k(s)}):null]},s.id||s.key||JSON.stringify(s)))})]})}),e.jsxs("div",{className:"table-footer mt-2",children:[e.jsxs("div",{className:"table-info",children:["Showing ",le," to ",ae," of ",U," entries"]}),e.jsx(jt,{page:X,totalPages:H,onPageChange:G,showPageLinks:!0,showPageLabel:!1,maxPageLinks:5})]})]})}function Ut(){const l=["leads","contacts","deals","followUps","meetings","activities"],[h,i]=g.useState(Pt),[N,M]=g.useState(l[0]),[k,W]=g.useState(()=>{const r=new Date;return new Date(r.getFullYear(),r.getMonth(),1)}),[$,P]=g.useState(null),[Y,ee]=g.useState("all"),[C,L]=g.useState("all"),[R,F]=g.useState(()=>Object.fromEntries(Object.entries(be).map(([r,o])=>[r,ne(o.fields)]))),[q,x]=g.useState(()=>Object.fromEntries(Object.keys(be).map(r=>[r,""])));g.useEffect(()=>{try{const r=window.localStorage.getItem(Ye);if(!r)return;const o=JSON.parse(r);Ft(o)&&i(o)}catch{}},[]),g.useEffect(()=>{window.localStorage.setItem(Ye,JSON.stringify(h))},[h]),g.useEffect(()=>{N!=="meetings"&&P(null)},[N]);const v=g.useMemo(()=>{const r=h.leads||[],o=h.deals||[],S=h.followUps||[],T=r.filter(m=>!["closed","converted"].includes(String(m.status||"").toLowerCase())).length,s=o.filter(m=>!["won","lost","closed"].includes(String(m.status||"").toLowerCase())).reduce((m,D)=>m+ce(D.amount),0),c=new Date().toISOString().slice(0,10),j=S.filter(m=>String(m.dueDate||"")===c&&String(m.status||"").toLowerCase()!=="done").length;return[{label:"Open Leads",value:String(T),icon:"bi-person-plus"},{label:"Pipeline Value",value:`INR ${s.toLocaleString("en-IN")}`,icon:"bi-graph-up-arrow"},{label:"Follow-ups Today",value:String(j),icon:"bi-telephone-forward"}]},[h]);function G(r,o,S){F(T=>({...T,[r]:{...T[r],[o]:S}}))}function O(r){x(o=>({...o,[r]:""})),F(o=>({...o,[r]:ne(be[r].fields)}))}function U(r,o){x(T=>({...T,[r]:o.id}));const S={};be[r].fields.forEach(T=>{S[T.key]=o[T.key]??T.defaultValue??""}),F(T=>({...T,[r]:S}))}function H(r,o){i(S=>({...S,[r]:(S[r]||[]).filter(T=>T.id!==o)})),q[r]===o&&O(r)}function X(r,o){o.preventDefault();const S=be[r],T=R[r]||{};if(S.fields.some(m=>!String(T[m.key]||"").trim()))return;const c={};S.fields.forEach(m=>{c[m.key]=String(T[m.key]||"").trim()}),r==="meetings"&&(c.reminderSummary=`${c.reminderChannel} • ${c.reminderMinutes} min before`);const j=q[r];i(m=>{const D=m[r]||[];return j?{...m,[r]:D.map(I=>I.id===j?{...I,...c}:I)}:{...m,[r]:[{id:`${r}_${Date.now()}`,...c},...D]}}),O(r)}const z=g.useMemo(()=>{const r=h.meetings||[],o=new Date(k.getFullYear(),k.getMonth(),1),S=new Date(k.getFullYear(),k.getMonth()+1,0),T=(o.getDay()+6)%7,s=new Date(o);s.setDate(o.getDate()-T);const c=[];for(let j=0;j<42;j+=1){const m=new Date(s);m.setDate(s.getDate()+j);const D=m.toISOString().slice(0,10);c.push({isoDate:D,day:m.getDate(),inMonth:m>=o&&m<=S,meetings:r.filter(I=>String(I.meetingDate||"")===D).sort((I,V)=>String(I.meetingTime||"").localeCompare(String(V.meetingTime||"")))})}return{monthLabel:o.toLocaleString("en-US",{month:"long",year:"numeric"}),cells:c}},[k,h.meetings]);function te(r){W(o=>new Date(o.getFullYear(),o.getMonth()+r,1))}function le(r){P(r)}function ae(){P(null)}return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"CRM"}),e.jsx("p",{className:"text-secondary mb-3",children:"Manage leads, contacts, deals, follow-ups, and activity timeline in one page."}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:l.map(r=>{const o=be[r],S=Array.isArray(h[r])?h[r].length:0;return e.jsxs("button",{type:"button",className:`btn btn-sm ${N===r?"btn-success":"btn-outline-light"}`,onClick:()=>M(r),children:[o.label," (",S,")"]},`crm-tab-${r}`)})})]}),N==="leads"?e.jsx("div",{className:"row g-3",children:v.map(r=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsx("div",{className:"stat-icon stat-icon-primary mb-2",children:e.jsx("i",{className:`bi ${r.icon}`,"aria-hidden":"true"})}),e.jsx("div",{className:"text-secondary small",children:r.label}),e.jsx("h5",{className:"mb-0 mt-1",children:r.value})]})},r.label))}):null,l.filter(r=>r===N).map(r=>{const o=be[r],S=h[r]||[],T=[{key:"all",label:"All"},{key:"open",label:"Open"},{key:"closed",label:"Closed"},{key:"converted",label:"Converted"}],s=[{key:"all",label:"All"},{key:"scheduled",label:"Scheduled"},{key:"completed",label:"Completed"},{key:"rescheduled",label:"Rescheduled"},{key:"cancelled",label:"Cancelled"}],c=r==="leads"?S.filter(p=>Y==="all"?!0:String(p.status||"").trim().toLowerCase()===Y):r==="meetings"?S.filter(p=>C==="all"?!0:String(p.status||"").trim().toLowerCase()===C):S,j=r==="leads"?T.reduce((p,E)=>(p[E.key]=E.key==="all"?S.length:S.filter(Q=>String(Q.status||"").trim().toLowerCase()===E.key).length,p),{}):{},m=r==="meetings"?s.reduce((p,E)=>(p[E.key]=E.key==="all"?S.length:S.filter(Q=>String(Q.status||"").trim().toLowerCase()===E.key).length,p),{}):{},D=R[r]||{},I=q[r]||"",V=o.fields.some(p=>p.key==="phoneCountryCode");return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:I?`Edit ${o.itemLabel}`:`Create ${o.itemLabel}`}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:p=>X(r,p),children:[e.jsx("div",{className:"row g-3",children:o.fields.map(p=>e.jsxs(g.Fragment,{children:[V&&p.key==="phoneCountryCode"?null:e.jsxs("div",{className:"col-12 col-md-6 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:p.label}),V&&p.key==="phone"?e.jsxs("div",{className:"input-group",children:[e.jsx("select",{className:"form-select",style:{maxWidth:"220px"},value:D.phoneCountryCode||"+91",onChange:E=>G(r,"phoneCountryCode",E.target.value),children:_e.map(E=>e.jsx("option",{value:E.value,children:E.label},`contact-phone-code-${E.value}`))}),e.jsx("input",{type:"text",className:"form-control",placeholder:p.placeholder,value:D.phone||"",onChange:E=>G(r,"phone",E.target.value)})]}):p.type==="select"?e.jsxs("select",{className:"form-select",value:D[p.key]||p.defaultValue||"",onChange:E=>G(r,p.key,E.target.value),children:[e.jsxs("option",{value:"",children:["Select ",p.label]}),(p.options||[]).map(E=>e.jsx("option",{value:E,children:E},E))]}):p.type==="date"||p.type==="time"?e.jsx("input",{type:p.type,className:"form-control",value:D[p.key]||"",onChange:E=>G(r,p.key,E.target.value)}):e.jsx("input",{type:"text",className:"form-control",placeholder:p.placeholder,value:D[p.key]||"",onChange:E=>G(r,p.key,E.target.value)})]},`${r}-${p.key}`),(r==="leads"||r==="deals"||r==="followUps"||r==="meetings")&&p.key==="status"?e.jsx("div",{className:"col-12 col-md-6 col-xl-4 d-flex align-items-end",children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:I?"Update":"Create"}),I?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>O(r),children:"Cancel"}):null]})}):null,r==="contacts"&&p.key==="tag"?e.jsx("div",{className:"col-12 col-md-6 col-xl-4 d-flex align-items-end",children:e.jsxs("div",{className:"d-flex gap-2 flex-wrap",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:I?"Update":"Create"}),I?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>O(r),children:"Cancel"}):null]})}):null]},`${r}-${p.key}`))}),r!=="leads"&&r!=="contacts"&&r!=="deals"&&r!=="followUps"&&r!=="meetings"?e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:I?"Update":"Create"}),I?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>O(r),children:"Cancel"}):null]}):null]})]}),e.jsx(oe,{title:`${o.label} List`,badgeLabel:`${c.length} items`,rows:c,columns:o.columns,withoutOuterCard:!0,searchPlaceholder:`Search ${o.label.toLowerCase()}`,noRowsText:`No ${o.label.toLowerCase()} yet.`,enableExport:!0,exportFileName:`crm-${o.label.toLowerCase().replace(/\s+/g,"-")}`,headerBottom:r==="leads"?e.jsxs("div",{className:"d-flex flex-column gap-2",children:[e.jsx("div",{className:"d-flex flex-wrap gap-2",children:T.map(p=>e.jsxs("button",{type:"button",className:`btn btn-sm ${Y===p.key?"btn-success":"btn-outline-light"}`,onClick:()=>ee(p.key),children:[p.label," (",j[p.key]||0,")"]},`lead-status-tab-${p.key}`))}),e.jsx("div",{className:"small text-secondary",children:"Closed and converted leads older than 180 days will be automatically deleted."})]}):r==="meetings"?e.jsx("div",{className:"d-flex flex-wrap gap-2",children:s.map(p=>e.jsxs("button",{type:"button",className:`btn btn-sm ${C===p.key?"btn-success":"btn-outline-light"}`,onClick:()=>L(p.key),children:[p.label," (",m[p.key]||0,")"]},`meeting-status-tab-${p.key}`))}):null,searchBy:p=>o.columns.map(E=>p[E.key]||"").join(" "),exportCellValue:(p,E)=>{if(E.key==="phone"){const Q=String(p.phone||"").trim();return Q?`${String(p.phoneCountryCode||"+91").trim()} ${Q}`:""}return r==="meetings"&&E.key==="meetingTime"?ue(p[E.key]):E.key==="reminderSummary"?p.reminderSummary||`${p.reminderChannel||""} ${p.reminderMinutes?`• ${p.reminderMinutes} min before`:""}`.trim():p[E.key]||""},renderCells:p=>o.columns.map(E=>{if(E.key==="phone"){const Q=String(p.phone||"").trim();return Q?`${String(p.phoneCountryCode||"+91").trim()} ${Q}`:"-"}return r==="meetings"&&E.key==="meetingTime"?ue(p[E.key]):p[E.key]||"-"}),renderActions:p=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>U(r,p),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>H(r,p.id),children:"Delete"})]})}),r==="meetings"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"mb-1",children:"Meeting Schedule Calendar"}),e.jsx("div",{className:"small text-secondary",children:"Click a meeting label to view reminder and schedule details."})]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:()=>te(-1),children:e.jsx("i",{className:"bi bi-chevron-left","aria-hidden":"true"})}),e.jsx("div",{className:"small fw-semibold px-2",children:z.monthLabel}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:()=>te(1),children:e.jsx("i",{className:"bi bi-chevron-right","aria-hidden":"true"})})]})]}),e.jsxs("div",{className:"mb-2",style:{display:"grid",gridTemplateColumns:"repeat(7, minmax(0, 1fr))",gap:"8px"},children:[["Mon","Tue","Wed","Thu","Fri","Sat","Sun"].map(p=>e.jsx("div",{className:"small text-secondary text-center fw-semibold py-1",children:p},p)),z.cells.map(p=>e.jsxs("div",{style:{minHeight:"84px",border:"1px solid rgba(255,255,255,0.08)",borderRadius:"10px",padding:"8px",backgroundColor:p.inMonth?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.01)",opacity:p.inMonth?1:.55},children:[e.jsx("div",{className:"small fw-semibold mb-1",children:p.day}),e.jsxs("div",{className:"d-flex flex-column gap-1",children:[p.meetings.slice(0,3).map(E=>e.jsxs("button",{type:"button",className:"btn btn-success btn-sm text-start",style:{fontSize:"0.7rem",lineHeight:1.2,padding:"3px 6px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:`${ue(E.meetingTime)} ${E.title||""}`,onClick:()=>le(E),children:[ue(E.meetingTime)," ",E.title||"Meeting"]},E.id)),p.meetings.length>3?e.jsxs("div",{className:"small text-secondary",children:["+",p.meetings.length-3," more"]}):null]})]},p.isoDate))]})]}):null]},r)}),$?e.jsx("div",{role:"dialog","aria-modal":"true",className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.65)",zIndex:1050,padding:"1rem"},onClick:ae,children:e.jsxs("div",{className:"card p-3",style:{width:"min(560px, 100%)"},onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-3 mb-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:$.title||"Meeting"}),e.jsx("div",{className:"small text-secondary",children:$.relatedTo||"-"})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:ae,children:e.jsx("i",{className:"bi bi-x-lg","aria-hidden":"true"})})]}),e.jsxs("div",{className:"row g-3 small",children:[e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Date"}),e.jsx("div",{className:"fw-semibold",children:$.meetingDate||"-"})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Time"}),e.jsx("div",{className:"fw-semibold",children:ue($.meetingTime)})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Owner"}),e.jsx("div",{className:"fw-semibold",children:$.owner||"-"})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Meeting Mode"}),e.jsx("div",{className:"fw-semibold",children:$.meetingMode||"-"})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Reminder"}),e.jsx("div",{className:"fw-semibold",children:$.reminderSummary||`${$.reminderChannel||"-"} • ${$.reminderMinutes||"-"} min before`})]}),e.jsxs("div",{className:"col-6",children:[e.jsx("div",{className:"text-secondary",children:"Status"}),e.jsx("div",{className:"fw-semibold",children:$.status||"-"})]})]})]})}):null]})}function Ht(){const[l,h]=g.useState("projects"),[i,N]=g.useState(It),[M,k]=g.useState(ne(ve.projects.fields)),[W,$]=g.useState("");g.useEffect(()=>{try{const x=window.localStorage.getItem(We);if(!x)return;const v=JSON.parse(x);_t(v)&&N(v)}catch{}},[]),g.useEffect(()=>{window.localStorage.setItem(We,JSON.stringify(i))},[i]),g.useEffect(()=>{$(""),k(ne(ve[l].fields))},[l]);const P=ve[l],Y=i[l]||[],ee=g.useMemo(()=>{const x=(i.projects||[]).filter(O=>O.status.toLowerCase()==="active").length,v=(i.tasks||[]).length,G=(i.tasks||[]).filter(O=>{const U=Date.parse(O.dueDate);return Number.isFinite(U)&&U<Date.now()}).length;return[{label:"Active Projects",value:String(x),icon:"bi-diagram-3"},{label:"Tasks",value:String(v),icon:"bi-list-check"},{label:"Overdue Tasks",value:String(G),icon:"bi-exclamation-triangle"}]},[i]);function C(x,v){k(G=>{const O={...G,[x]:v};return l==="attendance"&&x==="status"&&v!=="Permission"&&(O.permissionHours=""),O})}function L(x){$(x.id);const v={};P.fields.forEach(G=>{v[G.key]=x[G.key]||G.defaultValue||""}),k(v)}function R(){$(""),k(ne(P.fields))}function F(x){N(v=>({...v,[l]:(v[l]||[]).filter(G=>G.id!==x)})),W===x&&R()}function q(x){if(x.preventDefault(),P.fields.filter(U=>{const H=U.conditionalOn;return H?String(M[H.key]||"").trim()===String(H.value||"").trim():!0}).some(U=>!String(M[U.key]||"").trim()))return;const O={};P.fields.forEach(U=>{O[U.key]=String(M[U.key]).trim()}),l==="attendance"&&O.status!=="Permission"&&(O.permissionHours=""),N(U=>{const H=U[l]||[];return W?{...U,[l]:H.map(X=>X.id===W?{...X,...O}:X)}:{...U,[l]:[{id:`${l}_${Date.now()}`,...O},...H]}}),R()}return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"Project Management"}),e.jsx("p",{className:"text-secondary mb-3",children:"Track project milestones, tasks, and team delivery."}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:Object.entries(ve).map(([x,v])=>e.jsx("button",{type:"button",className:`btn btn-sm ${l===x?"btn-success":"btn-outline-light"}`,onClick:()=>h(x),children:v.label},x))})]}),e.jsx("div",{className:"row g-3",children:ee.map(x=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsx("div",{className:"stat-icon stat-icon-primary mb-2",children:e.jsx("i",{className:`bi ${x.icon||"bi-grid"}`,"aria-hidden":"true"})}),e.jsx("div",{className:"text-secondary small",children:x.label}),e.jsx("h5",{className:"mb-0 mt-1",children:x.value})]})},x.label))}),e.jsx(oe,{title:P.label,badgeLabel:`${Y.length} items`,rows:Y,columns:P.columns,withoutOuterCard:l==="projects",searchPlaceholder:`Search ${P.label.toLowerCase()}`,noRowsText:`No ${P.label.toLowerCase()} yet.`,searchBy:x=>P.columns.map(v=>x[v.key]||"").join(" "),renderCells:x=>P.columns.map(v=>x[v.key]||"-"),renderActions:x=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>L(x),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>F(x.id),children:"Delete"})]})}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:W?`Edit ${P.itemLabel}`:`Create ${P.itemLabel}`}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:q,children:[e.jsx("div",{className:"row g-3",children:P.fields.map(x=>(()=>{const v=x.conditionalOn;return!v||String(M[v.key]||"").trim()===String(v.value||"").trim()?e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:x.label}),x.type==="select"?e.jsxs("select",{className:"form-select",value:M[x.key]||x.defaultValue||"",onChange:O=>C(x.key,O.target.value),children:[e.jsxs("option",{value:"",children:["Select ",x.label]}),(x.options||[]).map(O=>e.jsx("option",{value:O,children:O},O))]}):e.jsx("input",{type:x.type||"text",className:"form-control",placeholder:x.placeholder,value:M[x.key]||"",onChange:O=>C(x.key,O.target.value)})]},x.key):null})())}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:W?"Update":"Create"}),W?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:R,children:"Cancel"}):null]})]})]})]})}function Bt(){const[l,h]=g.useState("employees"),[i,N]=g.useState(Ke),[M,k]=g.useState(ne(Se.employees.fields)),[W,$]=g.useState(""),[P,Y]=g.useState(""),[ee,C]=g.useState(!1),[L,R]=g.useState({open:!1,employee:"",date:"",source:"User Side",outTime:"",completedTasks:"",taskNotes:"",mode:"edit"});g.useEffect(()=>{try{const s=window.localStorage.getItem(Je);if(!s)return;const c=JSON.parse(s);wt(c)&&N(c)}catch{}},[]),g.useEffect(()=>{const s=()=>{const c=String(window.location.hash||"").replace(/^#/,"").trim().toLowerCase();c==="attendance"?h("attendance"):(c==="employees"||c==="leaves"||c==="payroll")&&h(c)};return s(),window.addEventListener("hashchange",s),()=>{window.removeEventListener("hashchange",s)}},[]),g.useEffect(()=>{window.localStorage.setItem(Je,JSON.stringify(i))},[i]),g.useEffect(()=>{$("");const s=ne(Se[l].fields);l==="attendance"&&(s.date=Ze()),k(s)},[l]);const F=Se[l],q=i[l]||[],x=Ze(),v=g.useMemo(()=>Array.from(new Set((i.employees||[]).map(s=>String(s.name||"").trim()).filter(Boolean))),[i.employees]),G=g.useMemo(()=>{if(l!=="attendance")return[];const s=String(M.employee||"").trim().toLowerCase();return(s?v.filter(j=>j.toLowerCase().includes(s)):v).slice(0,8)},[l,v,M.employee]);g.useEffect(()=>{P&&v.includes(P)||Y(v[0]||"")},[v,P]);const O=g.useMemo(()=>{const s=(i.employees||[]).length,c=(i.attendance||[]).filter(m=>String(m.status||"").toLowerCase().includes("present")).length,j=(i.leaves||[]).filter(m=>String(m.status||"").toLowerCase()==="pending").length;return[{label:"Employees",value:String(s),icon:"bi-people"},{label:"Attendance Today",value:String(c),icon:"bi-calendar-check"},{label:"Pending Leaves",value:String(j),icon:"bi-hourglass-split"}]},[i]);function U(s,c){k(j=>{const m={...j,[s]:c};return l==="attendance"&&s==="status"&&c!=="Permission"&&(m.permissionHours=""),l==="attendance"&&s==="entryMode"&&c==="User Side"&&(m.inTime="",m.outTime=""),m})}function H(s){$(s.id);const c={};F.fields.forEach(j=>{c[j.key]=s[j.key]||j.defaultValue||""}),k(c)}function X(){$(""),k(ne(F.fields))}function z(s){N(c=>({...c,[l]:(c[l]||[]).filter(j=>j.id!==s)})),W===s&&X()}function te(s){if(s.preventDefault(),F.fields.filter(D=>{const I=D.conditionalOn;return I?String(M[I.key]||"").trim()===String(I.value||"").trim():!0}).some(D=>!D.optional&&!String(M[D.key]||"").trim()))return;const m={};F.fields.forEach(D=>{m[D.key]=String(M[D.key]).trim()}),l==="attendance"&&(m.date=m.date||x,m.entryMode=m.entryMode||"HR Side",m.status!=="Permission"&&(m.permissionHours=""),m.workedHours=Oe(m.inTime,m.outTime),m.completedTasks=String(m.completedTasks||"").trim(),m.taskNotes=String(m.taskNotes||"").trim()),N(D=>{const I=D[l]||[];return W?{...D,[l]:I.map(V=>V.id===W?{...V,...m}:V)}:{...D,[l]:[{id:`${l}_${Date.now()}`,...m},...I]}}),X()}function le({employee:s,date:c=x,patch:j={}}){const m=String(s||"").trim(),D=String(c||x).trim()||x;m&&N(I=>{const V=I.attendance||[],p=V.findIndex(pe=>String(pe.employee||"").trim()===m&&String(pe.date||"").trim()===D),Q={...p>=0?V[p]:{id:`attendance_${Date.now()}`,employee:m,date:D,entryMode:"User Side",inTime:"",outTime:"",workedHours:"",status:"Present",permissionHours:"",notes:"",completedTasks:"",taskNotes:""},...j};return Q.workedHours=Oe(Q.inTime,Q.outTime),Q.status!=="Permission"&&(Q.permissionHours=""),p>=0?{...I,attendance:V.map((pe,d)=>d===p?Q:pe)}:{...I,attendance:[Q,...V]}})}function ae(s,c,j="User Side"){const m=String(c||"").trim();if(!m)return;const D=Xe();if(s==="out"){const I=(i.attendance||[]).find(V=>String(V.employee||"").trim()===m&&String(V.date||"").trim()===x);R({open:!0,employee:m,date:x,source:j,outTime:D,completedTasks:String((I==null?void 0:I.completedTasks)||"").trim(),taskNotes:String((I==null?void 0:I.taskNotes)||"").trim(),mode:"punchOut"});return}le({employee:m,date:x,patch:s==="in"?{entryMode:j,inTime:D,status:"Present"}:{entryMode:j,outTime:D,status:"Present"}})}function r(s){R({open:!0,employee:String((s==null?void 0:s.employee)||"").trim(),date:String((s==null?void 0:s.date)||x).trim()||x,source:String((s==null?void 0:s.entryMode)||"HR Side").trim()||"HR Side",outTime:String((s==null?void 0:s.outTime)||"").trim(),completedTasks:String((s==null?void 0:s.completedTasks)||"").trim(),taskNotes:String((s==null?void 0:s.taskNotes)||"").trim(),mode:"edit"})}function o(){R(s=>({...s,open:!1}))}function S(s){s.preventDefault();const c=String(L.employee||"").trim(),j=String(L.date||x).trim()||x;if(!c)return;const m={completedTasks:String(L.completedTasks||"").trim(),taskNotes:String(L.taskNotes||"").trim()};L.mode==="punchOut"&&(m.entryMode=L.source||"User Side",m.outTime=L.outTime||Xe(),m.status="Present"),le({employee:c,date:j,patch:m}),o()}const T=g.useMemo(()=>(i.attendance||[]).find(s=>String(s.employee||"").trim()===String(P||"").trim()&&String(s.date||"").trim()===x)||null,[i.attendance,P,x]);return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"HR"}),e.jsx("p",{className:"text-secondary mb-3",children:"Handle employees, attendance, leave approvals, and payroll."}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:Object.entries(Se).map(([s,c])=>e.jsx("button",{type:"button",className:`btn btn-sm ${l===s?"btn-success":"btn-outline-light"}`,onClick:()=>h(s),children:c.label},s))})]}),l==="employees"?e.jsx("div",{className:"row g-3",children:O.map(s=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsx("div",{className:"stat-icon stat-icon-primary mb-2",children:e.jsx("i",{className:`bi ${s.icon||"bi-bar-chart"}`,"aria-hidden":"true"})}),e.jsx("div",{className:"text-secondary small",children:s.label}),e.jsx("h5",{className:"mb-0 mt-1",children:s.value})]})},s.label))}):null,e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:W?`Edit ${F.itemLabel}`:`Create ${F.itemLabel}`}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:te,children:[e.jsx("div",{className:"row g-3",children:F.fields.map(s=>(()=>{const c=s.conditionalOn;return!c||String(M[c.key]||"").trim()===String(c.value||"").trim()?e.jsxs("div",{className:"col-12 col-md-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:s.label}),l==="attendance"&&s.key==="employee"?e.jsxs("div",{className:"position-relative",children:[e.jsx("input",{type:"text",className:"form-control",autoComplete:"off",placeholder:s.placeholder,value:M[s.key]||"",onFocus:()=>C(!0),onBlur:()=>window.setTimeout(()=>C(!1),120),onChange:m=>{U(s.key,m.target.value),C(!0)}}),ee&&G.length?e.jsx("div",{className:"position-absolute start-0 end-0 mt-1 border rounded shadow-sm",style:{zIndex:30,background:"#081528",borderColor:"rgba(255,255,255,0.16)",maxHeight:"220px",overflowY:"auto"},children:G.map(m=>e.jsx("button",{type:"button",className:"w-100 text-start border-0 bg-transparent px-3 py-2",style:{color:"#e9eef8"},onMouseDown:D=>{D.preventDefault(),U(s.key,m),C(!1)},children:m},`attendance-emp-suggest-${m}`))}):null]}):s.type==="select"?e.jsxs("select",{className:"form-select",value:M[s.key]||s.defaultValue||"",onChange:m=>U(s.key,m.target.value),children:[e.jsxs("option",{value:"",children:["Select ",s.label]}),(s.options||[]).map(m=>e.jsx("option",{value:m,children:m},m))]}):e.jsx("input",{type:s.type||"text",className:"form-control",placeholder:s.placeholder,value:M[s.key]||"",onChange:m=>U(s.key,m.target.value)})]},s.key):null})())}),l==="attendance"?e.jsxs("div",{className:"d-flex flex-wrap align-items-center gap-2",children:[e.jsx("span",{className:"small text-secondary",children:"User Login Attendance:"}),e.jsx("button",{type:"button",className:"btn btn-outline-success btn-sm",disabled:!String(M.employee||"").trim(),onClick:()=>ae("in",M.employee,"User Side"),children:"Attendance In"}),e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm",disabled:!String(M.employee||"").trim(),onClick:()=>ae("out",M.employee,"User Side"),children:"Attendance Out"}),e.jsx("span",{className:"small text-secondary",children:"Selected employee + today date record will update."})]}):null,e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:W?"Update":"Create"}),W?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:X,children:"Cancel"}):null]})]})]}),l==="attendance"?e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-2",children:[e.jsx("h6",{className:"mb-0",children:"My Attendance (HR)"}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("label",{className:"small text-secondary mb-0",children:"Employee"}),e.jsxs("select",{className:"form-select form-select-sm",style:{minWidth:"180px"},value:P,onChange:s=>Y(s.target.value),children:[e.jsx("option",{value:"",children:"Select Employee"}),v.map(s=>e.jsx("option",{value:s,children:s},`my-attendance-${s}`))]})]})]}),e.jsxs("div",{className:"row g-3 align-items-end",children:[e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("div",{className:"small text-secondary",children:"Date"}),e.jsx("div",{className:"fw-semibold",children:x})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("div",{className:"small text-secondary",children:"In Time"}),e.jsx("div",{className:"fw-semibold",children:ue(T==null?void 0:T.inTime)})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("div",{className:"small text-secondary",children:"Out Time"}),e.jsx("div",{className:"fw-semibold",children:ue(T==null?void 0:T.outTime)})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("div",{className:"small text-secondary",children:"Worked"}),e.jsx("div",{className:"fw-semibold",children:(T==null?void 0:T.workedHours)||"-"})]}),e.jsxs("div",{className:"col-12 col-md-2",children:[e.jsx("div",{className:"small text-secondary",children:"Status"}),e.jsx("div",{className:"fw-semibold",children:(T==null?void 0:T.status)==="Permission"&&(T!=null&&T.permissionHours)?`Permission (${T.permissionHours} hrs)`:(T==null?void 0:T.status)||"-"})]}),e.jsx("div",{className:"col-12 col-md-2",children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline-success btn-sm w-100",disabled:!P,onClick:()=>ae("in",P,"HR Self"),children:"In"}),e.jsx("button",{type:"button",className:"btn btn-outline-info btn-sm w-100",disabled:!P,onClick:()=>ae("out",P,"HR Self"),children:"Out"})]})})]})]}):null,e.jsx(oe,{title:F.label,badgeLabel:`${q.length} items`,rows:q,columns:F.columns,searchPlaceholder:`Search ${F.label.toLowerCase()}`,noRowsText:`No ${F.label.toLowerCase()} yet.`,searchBy:s=>F.columns.map(c=>s[c.key]||"").join(" "),renderCells:s=>F.columns.map(c=>{if(l==="attendance"&&(c.key==="inTime"||c.key==="outTime"))return ue(s[c.key]);if(l==="attendance"&&c.key==="workedHours")return s.workedHours||Oe(s.inTime,s.outTime)||"-";if(l==="attendance"&&c.key==="status"){const j=String(s.status||"").trim();return j==="Permission"&&String(s.permissionHours||"").trim()?`Permission (${String(s.permissionHours).trim()} hrs)`:s.entryMode?`${j||"-"}${s.entryMode?` (${s.entryMode})`:""}`:j||"-"}return s[c.key]||"-"}),renderActions:s=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[l==="attendance"?e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-warning",onClick:()=>r(s),children:"Task"}):null,e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>H(s),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>z(s.id),children:"Delete"})]})}),l==="attendance"&&L.open?e.jsx("div",{role:"dialog","aria-modal":"true",className:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.65)",zIndex:1050,padding:"1rem"},onClick:o,children:e.jsxs("div",{className:"card p-3",style:{width:"min(700px, 100%)"},onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between gap-3 mb-2",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"mb-1",children:L.mode==="punchOut"?"Attendance Out - Completed Tasks":"Completed Work Tasks"}),e.jsxs("div",{className:"small text-secondary",children:[L.employee||"-"," • ",L.date||x,L.mode==="punchOut"&&L.outTime?` • Out Time ${ue(L.outTime)}`:""]})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:o,children:e.jsx("i",{className:"bi bi-x-lg","aria-hidden":"true"})})]}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:S,children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Completed Work Task List"}),e.jsx("textarea",{className:"form-control",rows:5,placeholder:"Enter completed tasks (one line per task / summary details)",value:L.completedTasks,onChange:s=>R(c=>({...c,completedTasks:s.target.value}))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Notes (Optional)"}),e.jsx("textarea",{className:"form-control",rows:3,placeholder:"Blockers / pending follow-up / handover notes",value:L.taskNotes,onChange:s=>R(c=>({...c,taskNotes:s.target.value}))})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:L.mode==="punchOut"?"Save & Attendance Out":"Save Task Details"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:o,children:"Cancel"})]})]})]})}):null]})}function et({heading:l,subtitle:h,tabConfig:i,defaultData:N,storageKey:M,statsBuilder:k,statIcons:W=[]}){const P=Object.keys(i)[0],Y=!!(i!=null&&i.mainCategories&&(i!=null&&i.subCategories)),ee=Y&&(P==="mainCategories"||P==="subCategories")?"categories":P,[C,L]=g.useState(ee),[R,F]=g.useState(N),[q,x]=g.useState(ne(i[P].fields)),[v,G]=g.useState(""),[O,U]=g.useState(()=>Y?{mainCategories:ne(i.mainCategories.fields),subCategories:ne(i.subCategories.fields)}:{mainCategories:{},subCategories:{}}),[H,X]=g.useState({mainCategories:"",subCategories:""}),[z,te]=g.useState(""),[le,ae]=g.useState([]);g.useEffect(()=>{try{const d=window.localStorage.getItem(M);if(!d)return;const u=JSON.parse(d);Gt(u,i)&&F(u)}catch{}},[M,i]),g.useEffect(()=>{window.localStorage.setItem(M,JSON.stringify(R))},[R,M]),g.useEffect(()=>{let d=!0;return Object.values(i).some(A=>Array.isArray(A==null?void 0:A.fields)&&A.fields.some(J=>J.key==="department"))?((async()=>{try{const A=await Pe("/api/business-autopilot/departments");if(!d)return;const K=(Array.isArray(A==null?void 0:A.departments)?A.departments:[]).map(B=>String((B==null?void 0:B.name)||"").trim()).filter(Boolean);ae(Array.from(new Set(K)))}catch{d&&ae([])}})(),()=>{d=!1}):()=>{d=!1}},[i]),g.useEffect(()=>{G(""),C!=="categories"&&x(ne(i[C].fields))},[C,i]);const r=g.useMemo(()=>Y?[...Object.entries(i).filter(([u])=>u!=="mainCategories"&&u!=="subCategories").map(([u,A])=>({key:u,label:A.label})),{key:"categories",label:"Category"}]:Object.entries(i).map(([u,A])=>({key:u,label:A.label})),[Y,i]),o=C==="categories"?null:i[C],S=C==="categories"?[]:R[C]||[],T=g.useMemo(()=>k(R),[R,k]),s=g.useMemo(()=>{if(C!=="tasks")return[];const d=[...(R.team||[]).map(u=>u==null?void 0:u.name),...(R.tasks||[]).map(u=>u==null?void 0:u.assignee),...(R.projects||[]).map(u=>u==null?void 0:u.owner),...(Ke.employees||[]).map(u=>u==null?void 0:u.name)].map(u=>String(u||"").trim()).filter(Boolean);return Array.from(new Set(d)).sort((u,A)=>u.localeCompare(A))},[C,R]);function c(d,u){x(A=>({...A,[d]:u}))}function j(d){G(d.id);const u={};o.fields.forEach(A=>{u[A.key]=d[A.key]||""}),x(u)}function m(){G(""),x(ne(o.fields))}function D(d){F(u=>({...u,[C]:(u[C]||[]).filter(A=>A.id!==d)})),v===d&&m()}function I(d){if(d.preventDefault(),o.fields.some(J=>!String(q[J.key]||"").trim()))return;const A={};o.fields.forEach(J=>{A[J.key]=String(q[J.key]).trim()}),F(J=>{const K=J[C]||[];return v?{...J,[C]:K.map(B=>B.id===v?{...B,...A}:B)}:{...J,[C]:[{id:`${C}_${Date.now()}`,...A},...K]}}),m()}function V(d,u,A){U(J=>({...J,[d]:{...J[d]||{},[u]:A}}))}function p(d,u){const A=i[d];if(!A)return;const J={};A.fields.forEach(K=>{J[K.key]=u[K.key]||""}),X(K=>({...K,[d]:u.id||""})),U(K=>({...K,[d]:J}))}function E(d){const u=i[d];u&&(X(A=>({...A,[d]:""})),U(A=>({...A,[d]:ne(u.fields)})))}function Q(d,u){F(A=>({...A,[d]:(A[d]||[]).filter(J=>J.id!==u)})),H[d]===u&&E(d)}function pe(d,u){d.preventDefault();const A=i[u];if(!A)return;const J=O[u]||{};if(A.fields.some(re=>!String(J[re.key]||"").trim()))return;const B={};A.fields.forEach(re=>{B[re.key]=String(J[re.key]||"").trim()});const me=H[u];F(re=>{const fe=re[u]||[];return me?(te(""),{...re,[u]:fe.map(Ne=>Ne.id===me?{...Ne,...B}:Ne)}):fe.length>=100?(te(`${A.label}: Maximum 100 entries are allowed.`),re):(te(""),{...re,[u]:[{id:`${u}_${Date.now()}`,...B},...fe]})}),E(u)}return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:l}),e.jsx("p",{className:"text-secondary mb-3",children:h}),e.jsx("div",{className:"d-flex flex-wrap gap-2",children:r.map(({key:d,label:u})=>e.jsx("button",{type:"button",className:`btn btn-sm ${C===d?"btn-success":"btn-outline-light"}`,onClick:()=>L(d),children:u},d))})]}),C!=="categories"?e.jsx("div",{className:"row g-3",children:T.map((d,u)=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsx("div",{className:"stat-icon stat-icon-primary mb-2",children:e.jsx("i",{className:`bi ${W[u]||"bi-grid"}`,"aria-hidden":"true"})}),e.jsx("div",{className:"text-secondary small",children:d.label}),e.jsx("h5",{className:"mb-0 mt-1",children:d.value})]})},d.label))}):null,C==="categories"?e.jsxs("div",{children:[e.jsx("h5",{className:"mb-2",children:"Category"}),e.jsx("p",{className:"text-secondary small mb-2",children:"Maximum 100 entries are allowed for Main Category and Sub Category."}),z?e.jsx("div",{className:"alert alert-warning py-2 mb-3",children:z}):null,e.jsx("div",{className:"row g-3",children:["mainCategories","subCategories"].map(d=>{const u=i[d],A=R[d]||[],J=O[d]||{},K=H[d];return e.jsx("div",{className:"col-12 col-xl-6",children:e.jsxs("div",{className:"border rounded p-3 h-100 d-flex flex-column gap-3",children:[e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:K?`Edit ${u.itemLabel}`:`Create ${u.itemLabel}`}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:B=>pe(B,d),children:[e.jsx("div",{className:"row g-3",children:u.fields.map(B=>e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:B.label}),e.jsx("input",{type:B.type||"text",className:"form-control",placeholder:B.placeholder,value:J[B.key]||"",onChange:me=>V(d,B.key,me.target.value)})]},`${d}-${B.key}`))}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:K?"Update":"Create"}),K?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>E(d),children:"Cancel"}):null]})]})]}),e.jsx(oe,{title:`${u.label} List`,badgeLabel:`${A.length} items`,rows:A,columns:u.columns,withoutOuterCard:!0,pageSize:5,searchPlaceholder:`Search ${u.label.toLowerCase()}`,noRowsText:`No ${u.label.toLowerCase()} added yet.`,searchBy:B=>u.columns.map(me=>B[me.key]||"").join(" "),renderCells:B=>u.columns.map(me=>B[me.key]||"-"),renderActions:B=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>p(d,B),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>Q(d,B.id),children:"Delete"})]})})]})},`category-panel-${d}`)})})]}):null,C!=="categories"&&C!=="tickets"?e.jsx(oe,{title:`${o.label} List`,badgeLabel:`${S.length} items`,rows:S,columns:o.columns,withoutOuterCard:C==="mainCategories"||C==="items",searchPlaceholder:`Search ${o.label.toLowerCase()}`,noRowsText:`No ${o.label.toLowerCase()} added yet.`,searchBy:d=>o.columns.map(u=>d[u.key]||"").join(" "),renderCells:d=>o.columns.map(u=>d[u.key]||"-"),renderActions:d=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>j(d),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>D(d.id),children:"Delete"})]})}):null,C!=="categories"?e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:v?`Edit ${o.itemLabel}`:`Create ${o.itemLabel}`}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:I,children:[e.jsx("div",{className:"row g-3",children:o.fields.map(d=>e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:d.label}),d.key==="department"&&le.length?e.jsxs("select",{className:"form-select",value:q[d.key]||"",onChange:u=>c(d.key,u.target.value),children:[e.jsx("option",{value:"",children:"Select Department"}),le.map(u=>e.jsx("option",{value:u,children:u},u)),q[d.key]&&!le.includes(q[d.key])?e.jsx("option",{value:q[d.key],children:q[d.key]}):null]}):C==="tasks"&&d.key==="assignee"?e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"text",className:"form-control",list:"project-task-assign-to-list",placeholder:d.placeholder,value:q[d.key]||"",onChange:u=>c(d.key,u.target.value)}),e.jsx("datalist",{id:"project-task-assign-to-list",children:s.map(u=>e.jsx("option",{value:u},`task-assign-${u}`))})]}):e.jsx("input",{type:d.type||"text",className:"form-control",placeholder:d.placeholder,value:q[d.key]||"",onChange:u=>c(d.key,u.target.value)})]},d.key))}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:v?"Update":"Create"}),v?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:m,children:"Cancel"}):null]})]})]}):null,C==="tickets"?e.jsx(oe,{title:`${o.label} List`,badgeLabel:`${S.length} items`,rows:S,columns:o.columns,withoutOuterCard:!0,pageSize:15,searchPlaceholder:`Search ${o.label.toLowerCase()}`,noRowsText:`No ${o.label.toLowerCase()} added yet.`,searchBy:d=>o.columns.map(u=>d[u.key]||"").join(" "),renderCells:d=>o.columns.map(u=>d[u.key]||"-"),renderActions:d=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>j(d),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>D(d.id),children:"Delete"})]})}):null]})}function Vt(){const l=g.useMemo(()=>h=>{const i=(h.tickets||[]).filter(k=>String(k.status||"").toLowerCase()!=="closed").length,N=(h.tickets||[]).filter(k=>String(k.status||"").toLowerCase().includes("progress")||String(k.status||"").toLowerCase()==="open").length,M=(h.mainCategories||[]).length+(h.subCategories||[]).length;return[{label:"Open Tickets",value:String(i)},{label:"Pending Today",value:String(N)},{label:"Categories",value:String(M)}]},[]);return e.jsx(et,{heading:"Ticketing System",subtitle:"Create main/sub categories and manage tickets with create, edit, and delete actions.",tabConfig:Mt,defaultData:Lt,storageKey:Et,statsBuilder:l,statIcons:["bi-life-preserver","bi-hourglass-split","bi-tags"]})}function Wt(){const l=g.useMemo(()=>h=>{const i=(h.items||[]).length,N=(h.items||[]).filter(k=>Number(k.qty||0)>0&&Number(k.qty||0)<=5).length,M=(h.mainCategories||[]).length+(h.subCategories||[]).length;return[{label:"Stock Items",value:String(i)},{label:"Low Stock Alerts",value:String(N)},{label:"Categories",value:String(M)}]},[]);return e.jsx(et,{heading:"Stocks Management",subtitle:"Create main/sub categories and manage stock items with create, edit, and delete actions.",tabConfig:Ot,defaultData:Rt,storageKey:Dt,statsBuilder:l,statIcons:["bi-box-seam","bi-exclamation-triangle","bi-diagram-3"]})}function Yt(){const[l,h]=g.useState("overview"),[i,N]=g.useState($t),[M,k]=g.useState(!0),[W,$]=g.useState("Loading..."),[P,Y]=g.useState(""),ee=g.useRef(!1),C=g.useRef(null),[L,R]=g.useState({id:"",name:"",taxScope:"Intra State",cgst:"",sgst:"",igst:"",cess:"",status:"Active",notes:""}),[F,q]=g.useState(""),[x,v]=g.useState({id:"",name:"",docType:"Invoice",gstTemplateId:"",prefix:"",themeColor:"#22c55e",footerNote:"",termsText:"",status:"Active"}),[G,O]=g.useState(""),[U,H]=g.useState(he("estimate")),[X,z]=g.useState(he("invoice")),[te,le]=g.useState(""),[ae,r]=g.useState(""),[o,S]=g.useState({id:"",companyName:"",clientName:"",name:"",gstin:"",phoneCountryCode:"+91",phone:"",additionalPhones:[],email:"",additionalEmails:[],billingAddress:"",shippingAddress:"",country:"India",state:"",city:"",pincode:""}),[T,s]=g.useState(""),[c,j]=g.useState({id:"",name:"",sku:"",unit:"Nos",defaultRate:"",taxPercent:""}),[m,D]=g.useState(""),[I,V]=g.useState([]);g.useEffect(()=>{let t=!0;return(async()=>{k(!0),Y("");try{const a=await Pe("/api/business-autopilot/accounts/workspace");if(!t)return;const n=a==null?void 0:a.data;if(Le(n))N(n),window.localStorage.setItem(Ee,JSON.stringify(n)),$("Synced from server");else try{const b=window.localStorage.getItem(Ee);if(b){const y=JSON.parse(b);Le(y)&&(N(y),$("Loaded local cache"))}}catch{}}catch(a){if(!t)return;try{const n=window.localStorage.getItem(Ee);if(n){const b=JSON.parse(n);Le(b)&&(N(b),$("Loaded local cache"))}}catch{}Y((a==null?void 0:a.message)||"Unable to sync accounts workspace.")}finally{t&&(ee.current=!0,k(!1))}})(),()=>{t=!1}},[]),g.useEffect(()=>{if(window.localStorage.setItem(Ee,JSON.stringify(i)),!!ee.current)return C.current&&window.clearTimeout(C.current),$("Saving..."),C.current=window.setTimeout(async()=>{try{await Pe("/api/business-autopilot/accounts/workspace",{method:"PUT",body:JSON.stringify({data:i})}),Y(""),$("Saved to server")}catch(t){Y((t==null?void 0:t.message)||"Server save failed"),$("Save failed")}},450),()=>{C.current&&window.clearTimeout(C.current)}},[i]),g.useEffect(()=>{let t=!0;return(async()=>{try{const a=await Pe("/api/business-autopilot/users");if(!t)return;V(Array.isArray(a==null?void 0:a.users)?a.users:[])}catch{t&&V([])}})(),()=>{t=!1}},[]);const p=g.useMemo(()=>(i.gstTemplates||[]).filter(t=>String(t.status||"").toLowerCase()==="active"),[i.gstTemplates]),E=g.useMemo(()=>{const t=i.invoices||[],a=i.estimates||[],n=i.gstTemplates||[],b=t.filter(y=>!["paid","cancelled"].includes(String(y.status||"").toLowerCase())).reduce((y,w)=>y+Ae(w,n).grandTotal,0);return[{label:"Invoices",value:String(t.length),icon:"bi-receipt-cutoff"},{label:"Estimates",value:String(a.length),icon:"bi-file-earmark-text"},{label:"Receivables",value:ye(b),icon:"bi-cash-coin"},{label:"GST Templates",value:String(n.length),icon:"bi-file-earmark-ruled"}]},[i]),Q=i.customers||[],pe=i.itemMasters||[],d=Tt(String(o.country||"India"));function u(t={}){const a=String(t.phone||"").trim(),n=String(t.email||"").trim(),b=Array.isArray(t.phoneList)?t.phoneList:[],y=Array.isArray(t.emailList)?t.emailList:[];return{id:t.id||"",companyName:t.companyName||t.name||"",clientName:t.clientName||"",name:t.name||t.companyName||t.clientName||"",gstin:t.gstin||"",phoneCountryCode:t.phoneCountryCode||"+91",phone:t.phone||"",additionalPhones:b.length?b.slice(1).map(w=>({countryCode:w.countryCode||"+91",number:w.number||""})):a?[]:[],email:t.email||"",additionalEmails:y.length?y.slice(1).map(w=>w||""):n?[]:[],billingAddress:t.billingAddress||"",shippingAddress:t.shippingAddress||"",country:t.country||"India",state:t.state||"",city:t.city||"",pincode:t.pincode||""}}function A(t={}){const a=[];return String(t.phone||"").trim()&&a.push(`${t.phoneCountryCode||"+91"} ${t.phone}`.trim()),Array.isArray(t.phoneList)&&t.phoneList.forEach((n,b)=>{b!==0&&String((n==null?void 0:n.number)||"").trim()&&a.push(`${n.countryCode||"+91"} ${n.number}`.trim())}),!a.length&&Array.isArray(t.additionalPhones)&&t.additionalPhones.forEach(n=>{String((n==null?void 0:n.number)||"").trim()&&a.push(`${n.countryCode||"+91"} ${n.number}`.trim())}),a.filter(Boolean)}function J(t={}){const a=[];return String(t.email||"").trim()&&a.push(String(t.email).trim()),Array.isArray(t.emailList)&&t.emailList.forEach((n,b)=>{b!==0&&String(n||"").trim()&&a.push(String(n).trim())}),!a.length&&Array.isArray(t.additionalEmails)&&t.additionalEmails.forEach(n=>{String(n||"").trim()&&a.push(String(n).trim())}),a.filter(Boolean)}function K(){q(""),R({id:"",name:"",taxScope:"Intra State",cgst:"",sgst:"",igst:"",cess:"",status:"Active",notes:""})}function B(){var t;O(""),v({id:"",name:"",docType:"Invoice",gstTemplateId:((t=p[0])==null?void 0:t.id)||"",prefix:"",themeColor:"#22c55e",footerNote:"",termsText:"",status:"Active"})}function me(t){if(t.preventDefault(),!L.name.trim())return;const a={...L,name:L.name.trim(),notes:L.notes.trim()};N(n=>{const b=n.gstTemplates||[];return F?{...n,gstTemplates:b.map(y=>y.id===F?{...y,...a}:y)}:{...n,gstTemplates:[{...a,id:`gst_${Date.now()}`},...b]}}),K()}function re(t){q(t.id),R({...t}),h("gst")}function fe(t){N(a=>({...a,gstTemplates:(a.gstTemplates||[]).filter(n=>n.id!==t),billingTemplates:(a.billingTemplates||[]).map(n=>n.gstTemplateId===t?{...n,gstTemplateId:""}:n),estimates:(a.estimates||[]).map(n=>n.gstTemplateId===t?{...n,gstTemplateId:""}:n),invoices:(a.invoices||[]).map(n=>n.gstTemplateId===t?{...n,gstTemplateId:""}:n)})),F===t&&K()}function Ne(t,a){N(n=>({...n,gstTemplates:(n.gstTemplates||[]).map(b=>b.id===t?{...b,status:a}:b)}))}function tt(t){if(t.preventDefault(),!x.name.trim())return;const a={...x,name:x.name.trim(),footerNote:x.footerNote.trim(),termsText:x.termsText.trim()};N(n=>{const b=n.billingTemplates||[];return G?{...n,billingTemplates:b.map(y=>y.id===G?{...y,...a}:y)}:{...n,billingTemplates:[{...a,id:`bt_${Date.now()}`},...b]}}),B()}function at(t){O(t.id),v({...t}),h("templates")}function st(t){N(a=>({...a,billingTemplates:(a.billingTemplates||[]).filter(n=>n.id!==t),estimates:(a.estimates||[]).map(n=>n.billingTemplateId===t?{...n,billingTemplateId:""}:n),invoices:(a.invoices||[]).map(n=>n.billingTemplateId===t?{...n,billingTemplateId:""}:n)})),G===t&&B()}function lt(t,a){N(n=>({...n,billingTemplates:(n.billingTemplates||[]).map(b=>b.id===t?{...b,status:a}:b)}))}function Ie(){s(""),S({id:"",companyName:"",clientName:"",name:"",gstin:"",phoneCountryCode:"+91",phone:"",additionalPhones:[],email:"",additionalEmails:[],billingAddress:"",shippingAddress:"",country:"India",state:"",city:"",pincode:""})}function nt(t){t.preventDefault();const a=String(o.companyName||o.name||"").trim();if(!a)return;const n=String(o.clientName||"").trim(),b=String(o.phone||"").trim(),y=String(o.email||"").trim(),w=(o.additionalPhones||[]).map(se=>({countryCode:String(se.countryCode||"+91").trim()||"+91",number:String(se.number||"").trim()})).filter(se=>se.number),_=(o.additionalEmails||[]).map(se=>String(se||"").trim()).filter(Boolean),ie={...o,companyName:a,clientName:n,name:a,gstin:String(o.gstin||"").trim(),phoneCountryCode:String(o.phoneCountryCode||"+91").trim()||"+91",phone:b,email:y,additionalPhones:w,additionalEmails:_,phoneList:[...b?[{countryCode:String(o.phoneCountryCode||"+91").trim()||"+91",number:b}]:[],...w],emailList:[y,..._].filter(Boolean),billingAddress:String(o.billingAddress||"").trim(),shippingAddress:String(o.shippingAddress||"").trim(),country:String(o.country||"").trim(),state:String(o.state||"").trim(),city:String(o.city||"").trim(),pincode:String(o.pincode||"").trim()};N(se=>{const Te=se.customers||[];return T?{...se,customers:Te.map(je=>je.id===T?{...je,...ie}:je)}:{...se,customers:[{...ie,id:`cust_${Date.now()}`},...Te]}}),Ie()}function it(t){s(t.id),S(u(t)),h("customers")}function rt(t){N(a=>({...a,customers:(a.customers||[]).filter(n=>n.id!==t)})),T===t&&Ie()}function Me(){D(""),j({id:"",name:"",sku:"",unit:"Nos",defaultRate:"",taxPercent:""})}function ot(t){if(t.preventDefault(),!String(c.name||"").trim())return;const a={...c,name:String(c.name||"").trim(),sku:String(c.sku||"").trim(),unit:String(c.unit||"").trim(),defaultRate:String(c.defaultRate||"").trim(),taxPercent:String(c.taxPercent||"").trim()};N(n=>{const b=n.itemMasters||[];return m?{...n,itemMasters:b.map(y=>y.id===m?{...y,...a}:y)}:{...n,itemMasters:[{...a,id:`itm_${Date.now()}`},...b]}}),Me()}function ct(t){D(t.id),j({...t}),h("items")}function mt(t){N(a=>({...a,itemMasters:(a.itemMasters||[]).filter(n=>n.id!==t)})),m===t&&Me()}function dt(t,a){const n=(i.customers||[]).find(y=>y.id===a);if(!n)return;(t==="estimate"?H:z)(y=>({...y,customerName:n.companyName||n.name||n.clientName||"",customerGstin:n.gstin||"",billingAddress:n.billingAddress||""}))}function ut(t,a,n){const b=(i.itemMasters||[]).find(w=>w.id===n);if(!b)return;(t==="estimate"?H:z)(w=>({...w,items:(w.items||[]).map(_=>_.id===a?{..._,itemMasterId:b.id,description:b.name||_.description,rate:String(b.defaultRate||_.rate||""),taxPercent:String(b.taxPercent||_.taxPercent||"")}:_)}))}function pt(t,a){const n=`/api/business-autopilot/accounts/documents/${t}/${encodeURIComponent(a)}/print`;window.open(n,"_blank","noopener,noreferrer")}function Ge(t,a,n){if(t==="estimate"){H(b=>({...b,[a]:n}));return}z(b=>({...b,[a]:n}))}function ht(t){if(t==="estimate"){H(a=>({...a,items:[...a.items||[],xe()]}));return}z(a=>({...a,items:[...a.items||[],xe()]}))}function ke(t,a,n,b){(t==="estimate"?H:z)(w=>({...w,items:(w.items||[]).map(_=>_.id===a?{..._,[n]:b}:_)}))}function bt(t,a){(t==="estimate"?H:z)(b=>{const y=(b.items||[]).filter(w=>w.id!==a);return{...b,items:y.length?y:[xe()]}})}function Ue(t,a){a.preventDefault();const n=t==="estimate"?U:X;if(!String(n.customerName||"").trim())return;const b={...n,customerName:String(n.customerName||"").trim(),customerGstin:String(n.customerGstin||"").trim(),billingAddress:String(n.billingAddress||"").trim(),salesperson:String(n.salesperson||"").trim(),notes:String(n.notes||"").trim(),termsText:String(n.termsText||"").trim(),items:(n.items||[]).map(_=>({..._,itemMasterId:_.itemMasterId||"",description:String(_.description||"").trim(),qty:String(_.qty||"").trim(),rate:String(_.rate||"").trim(),taxPercent:String(_.taxPercent||"").trim()})).filter(_=>_.description||_.qty||_.rate)};b.items.length||(b.items=[xe()]);const y=t==="estimate"?"estimates":"invoices",w=t==="estimate"?te:ae;N(_=>{const ie=_[y]||[];return w?{..._,[y]:ie.map(se=>se.id===w?{...se,...b}:se)}:{..._,[y]:[{...b,id:`${t}_${Date.now()}`},...ie]}}),t==="estimate"?(le(""),H(he("estimate"))):(r(""),z(he("invoice")))}function gt(t,a){const n={...a,items:(a.items&&a.items.length?a.items:[xe()]).map(b=>({id:b.id||xe().id,itemMasterId:b.itemMasterId||"",description:b.description||"",qty:String(b.qty??""),rate:String(b.rate??""),taxPercent:String(b.taxPercent??"")}))};if(t==="estimate"){le(a.id),H(n),h("estimates");return}r(a.id),z(n),h("invoices")}function xt(t,a){const n=t==="estimate"?"estimates":"invoices";N(b=>({...b,[n]:(b[n]||[]).filter(y=>y.id!==a)})),t==="estimate"&&te===a&&(le(""),H(he("estimate"))),t==="invoice"&&ae===a&&(r(""),z(he("invoice")))}function yt(t,a,n){const b=t==="estimate"?"estimates":"invoices";N(y=>({...y,[b]:(y[b]||[]).map(w=>w.id===a?{...w,status:n}:w)}))}function He(t){var a;return((a=(i.gstTemplates||[]).find(n=>n.id===t))==null?void 0:a.name)||"-"}const ft=g.useMemo(()=>Ae(U,i.gstTemplates||[]),[U,i.gstTemplates]),Nt=g.useMemo(()=>Ae(X,i.gstTemplates||[]),[X,i.gstTemplates]);function Be({kind:t,form:a,setField:n,totals:b,onSave:y,onCancelEdit:w,editingId:_}){var Ve;const ie=t==="estimate"?"Estimate":"Invoice",se=(i.billingTemplates||[]).filter(f=>String(f.docType||"").toLowerCase()===ie.toLowerCase()),Te=((Ve=(i.customers||[]).find(f=>(f.companyName||f.name)===a.customerName))==null?void 0:Ve.id)||"",je=(I||[]).filter(f=>!!(f!=null&&f.name)).map(f=>f.name);return e.jsxs("div",{children:[e.jsx("div",{className:"d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3",children:e.jsx("h6",{className:"mb-0",children:_?`Edit ${ie}`:`Create ${ie}`})}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:y,children:[e.jsx("div",{className:"border rounded p-3",children:e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Client / Company Name"}),e.jsxs("select",{className:"form-select mb-2",value:Te,onChange:f=>dt(t,f.target.value),children:[e.jsx("option",{value:"",children:"Select Client / Company"}),Q.map(f=>e.jsxs("option",{value:f.id,children:[f.companyName||f.name,f.clientName?` (${f.clientName})`:""]},f.id))]}),e.jsx("input",{className:"form-control",list:`${t}-client-company-list`,value:a.customerName||"",onChange:f=>{const de=f.target.value;n("customerName",de);const ge=(i.customers||[]).find(Z=>`${Z.companyName||Z.name||""}${Z.clientName?` (${Z.clientName})`:""}`===de||(Z.companyName||Z.name||"")===de);ge&&(n("customerName",ge.companyName||ge.name||""),n("customerGstin",ge.gstin||""),n("billingAddress",ge.billingAddress||""))},placeholder:"Search client / company"}),e.jsx("datalist",{id:`${t}-client-company-list`,children:Q.map(f=>e.jsx("option",{value:`${f.companyName||f.name||""}${f.clientName?` (${f.clientName})`:""}`},`${t}-${f.id}`))})]}),e.jsxs("div",{className:"col-12 col-xl-3",children:[e.jsxs("label",{className:"form-label small text-secondary mb-1",children:[ie," No"]}),e.jsx("input",{className:"form-control",value:a.docNo||"",onChange:f=>n("docNo",f.target.value),placeholder:t==="estimate"?"EST-1001":"INV-1001"})]}),e.jsxs("div",{className:"col-12 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Sales Person"}),e.jsxs("select",{className:"form-select",value:a.salesperson||"",onChange:f=>n("salesperson",f.target.value),children:[e.jsx("option",{value:"",children:"Select Sales Person"}),je.map(f=>e.jsx("option",{value:f,children:f},`${t}-sales-${f}`))]})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Issue Date"}),e.jsx("input",{type:"date",className:"form-control",value:a.issueDate||"",onChange:f=>n("issueDate",f.target.value)})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Due Date"}),e.jsx("input",{type:"date",className:"form-control",value:a.dueDate||"",onChange:f=>n("dueDate",f.target.value)})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"GST Template"}),e.jsxs("select",{className:"form-select",value:a.gstTemplateId||"",onChange:f=>n("gstTemplateId",f.target.value),children:[e.jsx("option",{value:"",children:"Select GST Template"}),(i.gstTemplates||[]).map(f=>e.jsxs("option",{value:f.id,children:[f.name," (",we(f),"%)"]},f.id))]})]}),e.jsxs("div",{className:"col-12 col-md-6 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Billing Template"}),e.jsxs("select",{className:"form-select",value:a.billingTemplateId||"",onChange:f=>n("billingTemplateId",f.target.value),children:[e.jsx("option",{value:"",children:"Select Billing Template"}),se.map(f=>e.jsx("option",{value:f.id,children:f.name},f.id))]})]})]})}),e.jsxs("div",{className:"card p-3 border",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h6",{className:"mb-0",children:"Item Table"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:()=>ht(t),children:"Add Row"})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-dark table-borderless align-middle mb-0",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{minWidth:220},children:"Item Details"}),e.jsx("th",{style:{width:110},children:"Qty"}),e.jsx("th",{style:{width:140},children:"Rate"}),e.jsx("th",{style:{width:130},children:"Tax %"}),e.jsx("th",{style:{width:160},children:"Amount"}),e.jsx("th",{className:"text-end",style:{width:100},children:"Action"})]})}),e.jsx("tbody",{children:(a.items||[]).map((f,de)=>{const ge=ce(f.qty)*ce(f.rate);return e.jsxs("tr",{children:[e.jsxs("td",{style:{backgroundColor:de%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:[e.jsxs("select",{className:"form-select mb-2",value:f.itemMasterId||"",onChange:Z=>ut(t,f.id,Z.target.value),children:[e.jsx("option",{value:"",children:"Select Item Master"}),pe.map(Z=>e.jsxs("option",{value:Z.id,children:[Z.name," (",Z.sku||"-",")"]},Z.id))]}),e.jsx("input",{className:"form-control",value:f.description||"",onChange:Z=>ke(t,f.id,"description",Z.target.value),placeholder:"Type or click to select an item"})]}),e.jsx("td",{style:{backgroundColor:de%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:e.jsx("input",{className:"form-control",value:f.qty||"",onChange:Z=>ke(t,f.id,"qty",Z.target.value),placeholder:"1"})}),e.jsx("td",{style:{backgroundColor:de%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:e.jsx("input",{className:"form-control",value:f.rate||"",onChange:Z=>ke(t,f.id,"rate",Z.target.value),placeholder:"0.00"})}),e.jsx("td",{style:{backgroundColor:de%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:e.jsx("input",{className:"form-control",value:f.taxPercent||"",onChange:Z=>ke(t,f.id,"taxPercent",Z.target.value),placeholder:"Auto"})}),e.jsx("td",{className:"fw-semibold",style:{backgroundColor:de%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:ye(ge)}),e.jsx("td",{className:"text-end",style:{backgroundColor:de%2===0?"rgba(255,255,255,0.02)":"rgba(255,255,255,0.06)"},children:e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>bt(t,f.id),children:"Delete"})})]},f.id)})})]})})]}),e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-xl-7",children:e.jsxs("div",{className:"card p-3 h-100 border",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Customer Notes"}),e.jsx("textarea",{className:"form-control mb-3",rows:"3",value:a.notes||"",onChange:f=>n("notes",f.target.value),placeholder:"Notes visible on document"}),e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Terms & Conditions"}),e.jsx("textarea",{className:"form-control",rows:"3",value:a.termsText||"",onChange:f=>n("termsText",f.target.value),placeholder:"Terms and conditions"})]})}),e.jsx("div",{className:"col-12 col-xl-5",children:e.jsxs("div",{className:"card p-3 h-100 border",children:[e.jsx("h6",{className:"mb-3",children:"Summary"}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-secondary",children:"Sub Total"}),e.jsx("strong",{children:ye(b.subtotal)})]}),e.jsxs("div",{className:"d-flex justify-content-between mb-2",children:[e.jsx("span",{className:"text-secondary",children:"GST / Tax"}),e.jsx("strong",{children:ye(b.taxTotal)})]}),e.jsxs("div",{className:"d-flex justify-content-between pt-2 border-top",children:[e.jsx("span",{className:"fw-semibold",children:"Total"}),e.jsx("strong",{children:ye(b.grandTotal)})]})]})})]}),e.jsxs("div",{className:"d-flex flex-wrap gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:_?`Update ${ie}`:`Create ${ie}`}),_?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:w,children:"Cancel Edit"}):null]})]})]})}function Ce({kind:t,rows:a,statusOptions:n}){const b=i.gstTemplates||[];return e.jsx(oe,{title:t==="estimate"?"Estimate List":"Invoice List",badgeLabel:`${a.length} items`,rows:a,withoutOuterCard:l==="overview",columns:[{key:"docNo",label:t==="estimate"?"Estimate No":"Invoice No"},{key:"customerName",label:"Customer"},{key:"issueDate",label:"Date"},{key:"dueDate",label:"Due Date"},{key:"total",label:"Total"},{key:"gstTemplateId",label:"GST Template"},{key:"status",label:"Status"}],searchPlaceholder:`Search ${t}s`,noRowsText:"No records yet.",searchBy:y=>[y.docNo,y.customerName,y.status,y.issueDate,y.dueDate].join(" "),renderCells:y=>{const w=Ae(y,b);return[e.jsx("span",{className:"fw-semibold",children:y.docNo||"-"}),y.customerName||"-",y.issueDate||"-",y.dueDate||"-",ye(w.grandTotal),He(y.gstTemplateId),e.jsx("select",{className:"form-select form-select-sm",value:y.status||n[0],onChange:_=>yt(t,y.id,_.target.value),children:n.map(_=>e.jsx("option",{value:_,children:_},_))})]},renderActions:y=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-light",onClick:()=>pt(t,y.id),children:"Print / PDF"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>gt(t,y),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>xt(t,y.id),children:"Delete"})]})})}return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[M?e.jsx("div",{className:"card p-3 text-secondary",children:"Loading accounts workspace..."}):null,e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:"Accounts"}),e.jsx("p",{className:"text-secondary mb-3",children:"Complete billing workflow with GST templates, billing templates, estimates, invoices, and status updates."}),P?e.jsx("div",{className:"d-flex flex-wrap align-items-center gap-2 mb-2",children:e.jsx("span",{className:"small text-danger",children:P})}):null,e.jsx("div",{className:"d-flex flex-wrap gap-2",children:[{key:"overview",label:"Overview"},{key:"invoices",label:"Invoices"},{key:"estimates",label:"Estimates"},{key:"gst",label:"GST Templates"},{key:"templates",label:"Billing Templates"},{key:"customers",label:"Customers"},{key:"items",label:"Items"}].map(t=>e.jsx("button",{type:"button",className:`btn btn-sm ${l===t.key?"btn-success":"btn-outline-light"}`,onClick:()=>h(t.key),children:t.label},t.key))})]}),e.jsx("div",{className:"row g-3",children:E.map(t=>e.jsx("div",{className:"col-12 col-md-6 col-xl-3",children:e.jsxs("div",{className:"card p-3 h-100 d-flex flex-column align-items-center justify-content-center text-center",children:[e.jsx("div",{className:"stat-icon stat-icon-primary mb-2",children:e.jsx("i",{className:`bi ${t.icon||"bi-grid"}`,"aria-hidden":"true"})}),e.jsx("div",{className:"text-secondary small",children:t.label}),e.jsx("h5",{className:"mb-0 mt-1",children:t.value})]})},t.label))}),l==="overview"?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12 col-xl-6",children:e.jsx(Ce,{kind:"invoice",rows:i.invoices||[],statusOptions:Qe})}),e.jsx("div",{className:"col-12 col-xl-6",children:e.jsx(Ce,{kind:"estimate",rows:i.estimates||[],statusOptions:ze})})]})}):null,l==="gst"?e.jsxs(e.Fragment,{children:[e.jsx(oe,{title:"GST Template List",badgeLabel:`${(i.gstTemplates||[]).length} templates`,rows:i.gstTemplates||[],columns:[{key:"name",label:"Template Name"},{key:"taxScope",label:"Scope"},{key:"cgst",label:"CGST"},{key:"sgst",label:"SGST"},{key:"igst",label:"IGST"},{key:"cess",label:"CESS"},{key:"total",label:"Total"},{key:"status",label:"Status"}],searchPlaceholder:"Search GST templates",noRowsText:"No GST templates yet.",searchBy:t=>[t.name,t.taxScope,t.status,t.notes].join(" "),renderCells:t=>[e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:t.name}),e.jsx("div",{className:"small text-secondary",children:t.notes||"-"})]}),t.taxScope,`${t.cgst}%`,`${t.sgst}%`,`${t.igst}%`,`${t.cess}%`,`${we(t)}%`,e.jsx("select",{className:"form-select form-select-sm",value:t.status||"Active",onChange:a=>Ne(t.id,a.target.value),children:De.map(a=>e.jsx("option",{value:a,children:a},a))})],renderActions:t=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>re(t),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>fe(t.id),children:"Delete"})]})}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:F?"Edit GST Template":"Create GST Template"}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:me,children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Template Name"}),e.jsx("input",{className:"form-control",value:L.name||"",onChange:t=>R(a=>({...a,name:t.target.value})),placeholder:"India GST 18%"})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Scope"}),e.jsxs("select",{className:"form-select",value:L.taxScope||"Intra State",onChange:t=>R(a=>({...a,taxScope:t.target.value})),children:[e.jsx("option",{value:"Intra State",children:"Intra State"}),e.jsx("option",{value:"Inter State",children:"Inter State"}),e.jsx("option",{value:"Export",children:"Export"})]})]}),e.jsxs("div",{className:"col-6 col-md-3 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"CGST %"}),e.jsx("input",{className:"form-control",value:L.cgst||"",onChange:t=>R(a=>({...a,cgst:t.target.value}))})]}),e.jsxs("div",{className:"col-6 col-md-3 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"SGST %"}),e.jsx("input",{className:"form-control",value:L.sgst||"",onChange:t=>R(a=>({...a,sgst:t.target.value}))})]}),e.jsxs("div",{className:"col-6 col-md-3 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"IGST %"}),e.jsx("input",{className:"form-control",value:L.igst||"",onChange:t=>R(a=>({...a,igst:t.target.value}))})]}),e.jsxs("div",{className:"col-6 col-md-3 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"CESS %"}),e.jsx("input",{className:"form-control",value:L.cess||"",onChange:t=>R(a=>({...a,cess:t.target.value}))})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Status"}),e.jsx("select",{className:"form-select",value:L.status||"Active",onChange:t=>R(a=>({...a,status:t.target.value})),children:De.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"col-12",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Notes"}),e.jsx("textarea",{className:"form-control",rows:"2",value:L.notes||"",onChange:t=>R(a=>({...a,notes:t.target.value})),placeholder:"Template notes"})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:F?"Update GST Template":"Create GST Template"}),F?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:K,children:"Cancel"}):null]})]})]})]}):null,l==="customers"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:T?"Edit Customer":"Create Customer"}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:nt,children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Company Name"}),e.jsx("input",{className:"form-control",value:o.companyName||"",onChange:t=>S(a=>({...a,companyName:t.target.value,name:t.target.value})),placeholder:"Company name"})]}),e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Client Name"}),e.jsx("input",{className:"form-control",value:o.clientName||"",onChange:t=>S(a=>({...a,clientName:t.target.value})),placeholder:"Client / Contact person"})]}),e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"GSTIN"}),e.jsx("input",{className:"form-control",value:o.gstin||"",onChange:t=>S(a=>({...a,gstin:t.target.value})),placeholder:"GSTIN"})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Phone Number"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("select",{className:"form-select",style:{maxWidth:"220px"},value:o.phoneCountryCode||"+91",onChange:t=>S(a=>({...a,phoneCountryCode:t.target.value})),children:_e.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("input",{className:"form-control",value:o.phone||"",onChange:t=>S(a=>({...a,phone:t.target.value})),placeholder:"Phone number"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",title:"Add Contact Number",onClick:()=>S(t=>({...t,additionalPhones:[...t.additionalPhones||[],{countryCode:"+91",number:""}]})),children:"+"})]})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Email ID"}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("input",{className:"form-control",value:o.email||"",onChange:t=>S(a=>({...a,email:t.target.value})),placeholder:"Primary email"}),e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",title:"Add Email ID",onClick:()=>S(t=>({...t,additionalEmails:[...t.additionalEmails||[],""]})),children:"+"})]})]}),e.jsx("div",{className:"col-12 col-xl-6",children:(o.additionalEmails||[]).map((t,a)=>e.jsxs("div",{className:"d-flex gap-2 mb-2",children:[e.jsx("input",{className:"form-control",value:t||"",placeholder:"Additional email ID",onChange:n=>S(b=>({...b,additionalEmails:(b.additionalEmails||[]).map((y,w)=>w===a?n.target.value:y)}))}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>S(n=>({...n,additionalEmails:(n.additionalEmails||[]).filter((b,y)=>y!==a)})),children:"x"})]},`email-${a}`))}),e.jsx("div",{className:"col-12",children:(o.additionalPhones||[]).map((t,a)=>e.jsxs("div",{className:"d-flex gap-2 mb-2",children:[e.jsx("select",{className:"form-select",style:{maxWidth:"220px"},value:t.countryCode||"+91",onChange:n=>S(b=>({...b,additionalPhones:(b.additionalPhones||[]).map((y,w)=>w===a?{...y,countryCode:n.target.value}:y)})),children:_e.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))}),e.jsx("input",{className:"form-control",value:t.number||"",placeholder:"Additional contact number",onChange:n=>S(b=>({...b,additionalPhones:(b.additionalPhones||[]).map((y,w)=>w===a?{...y,number:n.target.value}:y)}))}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-sm",onClick:()=>S(n=>({...n,additionalPhones:(n.additionalPhones||[]).filter((b,y)=>y!==a)})),children:"x"})]},`phone-${a}`))}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Billing Address"}),e.jsx("textarea",{className:"form-control",rows:"2",value:o.billingAddress||"",onChange:t=>S(a=>({...a,billingAddress:t.target.value})),placeholder:"Billing address"})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Shipping Address"}),e.jsx("textarea",{className:"form-control",rows:"2",value:o.shippingAddress||"",onChange:t=>S(a=>({...a,shippingAddress:t.target.value})),placeholder:"Shipping address"})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Country"}),e.jsx("select",{className:"form-select",value:o.country||"India",onChange:t=>S(a=>({...a,country:t.target.value,state:""})),children:vt.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"State"}),d.length?e.jsxs("select",{className:"form-select",value:o.state||"",onChange:t=>S(a=>({...a,state:t.target.value})),children:[e.jsx("option",{value:"",children:"Select State"}),d.map(t=>e.jsx("option",{value:t,children:t},t))]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{className:"form-control",list:"baerp-state-options",value:o.state||"",onChange:t=>S(a=>({...a,state:t.target.value})),placeholder:"State / Province / Region"}),e.jsx("datalist",{id:"baerp-state-options",children:d.map(t=>e.jsx("option",{value:t},t))})]})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"City"}),e.jsx("input",{className:"form-control",value:o.city||"",onChange:t=>S(a=>({...a,city:t.target.value})),placeholder:"City"})]}),e.jsxs("div",{className:"col-12 col-md-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Pincode"}),e.jsx("input",{className:"form-control",value:o.pincode||"",onChange:t=>S(a=>({...a,pincode:t.target.value})),placeholder:"Pincode"})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:T?"Update Customer":"Create Customer"}),T?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Ie,children:"Cancel"}):null]})]})]}),e.jsx(oe,{title:"Client List",badgeLabel:`${(i.customers||[]).length} clients`,rows:i.customers||[],columns:[{key:"companyName",label:"Company Name"},{key:"clientName",label:"Client Name"},{key:"gstin",label:"GSTIN"},{key:"phones",label:"Contact Number"},{key:"emails",label:"Email ID"},{key:"location",label:"Location"}],searchPlaceholder:"Search clients",noRowsText:"No clients yet.",searchBy:t=>[t.companyName||t.name,t.clientName,t.gstin,...A(t),...J(t),t.country,t.state,t.city,t.pincode].join(" "),renderCells:t=>[e.jsx("span",{className:"fw-semibold",children:t.companyName||t.name||"-"}),t.clientName||"-",t.gstin||"-",e.jsx("span",{style:{whiteSpace:"normal"},children:A(t).join(", ")||"-"}),e.jsx("span",{style:{whiteSpace:"normal"},children:J(t).join(", ")||"-"}),e.jsx("span",{style:{whiteSpace:"normal"},children:[t.city,t.state,t.country,t.pincode].filter(Boolean).join(", ")||"-"})],renderActions:t=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>it(t),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>rt(t.id),children:"Delete"})]})})]}):null,l==="items"?e.jsxs(e.Fragment,{children:[e.jsx(oe,{title:"Item Master List",badgeLabel:`${(i.itemMasters||[]).length} items`,rows:i.itemMasters||[],columns:[{key:"name",label:"Item Name"},{key:"sku",label:"SKU"},{key:"unit",label:"Unit"},{key:"defaultRate",label:"Default Rate"},{key:"taxPercent",label:"Tax %"}],searchPlaceholder:"Search items",noRowsText:"No item masters yet.",searchBy:t=>[t.name,t.sku,t.unit,t.defaultRate,t.taxPercent].join(" "),renderCells:t=>[e.jsx("span",{className:"fw-semibold",children:t.name||"-"}),t.sku||"-",t.unit||"-",t.defaultRate||"-",t.taxPercent||"-"],renderActions:t=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>ct(t),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>mt(t.id),children:"Delete"})]})}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:m?"Edit Item Master":"Create Item Master"}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:ot,children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Item Name"}),e.jsx("input",{className:"form-control",value:c.name||"",onChange:t=>j(a=>({...a,name:t.target.value})),placeholder:"Item name"})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"SKU"}),e.jsx("input",{className:"form-control",value:c.sku||"",onChange:t=>j(a=>({...a,sku:t.target.value})),placeholder:"SKU"})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Unit"}),e.jsx("input",{className:"form-control",value:c.unit||"",onChange:t=>j(a=>({...a,unit:t.target.value})),placeholder:"Nos"})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Default Rate"}),e.jsx("input",{className:"form-control",value:c.defaultRate||"",onChange:t=>j(a=>({...a,defaultRate:t.target.value})),placeholder:"0.00"})]}),e.jsxs("div",{className:"col-12 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Tax %"}),e.jsx("input",{className:"form-control",value:c.taxPercent||"",onChange:t=>j(a=>({...a,taxPercent:t.target.value})),placeholder:"18"})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:m?"Update Item":"Create Item"}),m?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:Me,children:"Cancel"}):null]})]})]})]}):null,l==="templates"?e.jsxs(e.Fragment,{children:[e.jsx(oe,{title:"Billing Template List",badgeLabel:`${(i.billingTemplates||[]).length} templates`,rows:i.billingTemplates||[],columns:[{key:"name",label:"Template"},{key:"docType",label:"Type"},{key:"gstTemplateId",label:"GST Template"},{key:"prefix",label:"Prefix"},{key:"themeColor",label:"Theme"},{key:"status",label:"Status"}],searchPlaceholder:"Search billing templates",noRowsText:"No billing templates yet.",searchBy:t=>[t.name,t.docType,t.prefix,t.status,t.footerNote].join(" "),renderCells:t=>[e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:t.name}),e.jsx("div",{className:"small text-secondary",children:t.footerNote||"-"})]}),t.docType,He(t.gstTemplateId),t.prefix||"-",e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{style:{width:14,height:14,borderRadius:4,background:t.themeColor||"#22c55e",display:"inline-block"}}),e.jsx("span",{children:t.themeColor||"-"})]}),e.jsx("select",{className:"form-select form-select-sm",value:t.status||"Active",onChange:a=>lt(t.id,a.target.value),children:De.map(a=>e.jsx("option",{value:a,children:a},a))})],renderActions:t=>e.jsxs("div",{className:"d-inline-flex gap-2",children:[e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-info",onClick:()=>at(t),children:"Edit"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-danger",onClick:()=>st(t.id),children:"Delete"})]})}),e.jsxs("div",{className:"card p-3",children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-3",children:[e.jsx("h6",{className:"mb-0",children:G?"Edit Billing Template":"Create Billing Template"}),e.jsx("span",{className:"badge bg-dark border",children:"GST Template option included"})]}),e.jsxs("form",{className:"d-flex flex-column gap-3",onSubmit:tt,children:[e.jsxs("div",{className:"row g-3",children:[e.jsxs("div",{className:"col-12 col-xl-4",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Template Name"}),e.jsx("input",{className:"form-control",value:x.name||"",onChange:t=>v(a=>({...a,name:t.target.value})),placeholder:"Default GST Invoice Template"})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-2",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Document Type"}),e.jsxs("select",{className:"form-select",value:x.docType||"Invoice",onChange:t=>v(a=>({...a,docType:t.target.value})),children:[e.jsx("option",{value:"Invoice",children:"Invoice"}),e.jsx("option",{value:"Estimate",children:"Estimate"})]})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-3",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"GST Template"}),e.jsxs("select",{className:"form-select",value:x.gstTemplateId||"",onChange:t=>v(a=>({...a,gstTemplateId:t.target.value})),children:[e.jsx("option",{value:"",children:"Select GST Template"}),(i.gstTemplates||[]).map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Prefix"}),e.jsx("input",{className:"form-control",value:x.prefix||"",onChange:t=>v(a=>({...a,prefix:t.target.value})),placeholder:"INV"})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Color"}),e.jsx("input",{type:"color",className:"form-control form-control-color w-100",value:x.themeColor||"#22c55e",onChange:t=>v(a=>({...a,themeColor:t.target.value}))})]}),e.jsxs("div",{className:"col-12 col-md-4 col-xl-1",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Status"}),e.jsx("select",{className:"form-select",value:x.status||"Active",onChange:t=>v(a=>({...a,status:t.target.value})),children:De.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Footer Note"}),e.jsx("input",{className:"form-control",value:x.footerNote||"",onChange:t=>v(a=>({...a,footerNote:t.target.value})),placeholder:"Thank you for your business"})]}),e.jsxs("div",{className:"col-12 col-xl-6",children:[e.jsx("label",{className:"form-label small text-secondary mb-1",children:"Terms Text"}),e.jsx("input",{className:"form-control",value:x.termsText||"",onChange:t=>v(a=>({...a,termsText:t.target.value})),placeholder:"Payment terms and conditions"})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx("button",{type:"submit",className:"btn btn-success btn-sm",children:G?"Update Billing Template":"Create Billing Template"}),G?e.jsx("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:B,children:"Cancel"}):null]})]})]})]}):null,l==="estimates"?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{kind:"estimate",rows:i.estimates||[],statusOptions:ze}),e.jsx(Be,{kind:"estimate",form:U,setField:(t,a)=>Ge("estimate",t,a),totals:ft,onSave:t=>Ue("estimate",t),onCancelEdit:()=>{le(""),H(he("estimate"))},editingId:te})]}):null,l==="invoices"?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{kind:"invoice",rows:i.invoices||[],statusOptions:Qe}),e.jsx(Be,{kind:"invoice",form:X,setField:(t,a)=>Ge("invoice",t,a),totals:Nt,onSave:t=>Ue("invoice",t),onCancelEdit:()=>{r(""),z(he("invoice"))},editingId:ae})]}):null]})}function Jt({heading:l,moduleData:h}){return e.jsxs("div",{className:"d-flex flex-column gap-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2",children:l}),e.jsx("p",{className:"text-secondary mb-0",children:h.subtitle})]}),e.jsx("div",{className:"row g-3",children:(h.stats||[]).map(i=>e.jsx("div",{className:"col-12 col-md-4",children:e.jsxs("div",{className:"card p-3 h-100",children:[e.jsx("div",{className:"text-secondary small",children:i.label}),e.jsx("h5",{className:"mb-0 mt-1",children:i.value})]})},i.label))}),e.jsxs("div",{className:"card p-3",children:[e.jsx("h6",{className:"mb-3",children:"Enabled Features"}),e.jsx("div",{className:"d-flex flex-column gap-2",children:(h.sections||[]).map(i=>e.jsxs("div",{className:"d-flex align-items-center justify-content-between border rounded px-2 py-2",children:[e.jsx("span",{children:i}),e.jsx("span",{className:"badge bg-success",children:"Ready"})]},i))})]})]})}function Qt({moduleKey:l="crm",title:h}){const i=qe[l]||qe.crm,N=h||i.title;return l==="crm"?e.jsx(Ut,{}):l==="projects"?e.jsx(Ht,{}):l==="hrm"?e.jsx(Bt,{}):l==="ticketing"?e.jsx(Vt,{}):l==="stocks"?e.jsx(Wt,{}):l==="accounts"?e.jsx(Yt,{}):e.jsx(Jt,{heading:N,moduleData:i})}export{Qt as default};
