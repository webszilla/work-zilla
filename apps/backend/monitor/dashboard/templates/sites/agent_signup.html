{% extends "public/base.html" %}

{% block content %}

<div class="container mt-5" style="max-width:700px">

  <h1 class="section-title text-center">Create Your Dealer Account</h1>

  <p class="text-center text-secondary">
      Referral eligibility starts after yearly subscription activation.
  </p>

  <div class="alert alert-info text-center">
      Dealer Subscription: <b>INR {{ subscription_amount }} / year</b>
  </div>
  {% if messages %}
      {% for message in messages %}
          <div class="alert alert-{{ message.tags }} text-center">
              {{ message }}
          </div>
      {% endfor %}
  {% endif %}

  <div class="card p-4">

      <form method="post">
          {% csrf_token %}

          <div class="mb-3">
              <label class="form-label">Agent Name</label>
              <input type="text" name="agent_name" class="form-control" required>
          </div>

          <div class="mb-3">
              <label class="form-label">Email</label>
              <input type="email" name="email" class="form-control" required>
          </div>

          <div class="mb-3">
              <label class="form-label">Referral Code (optional)</label>
              <input
                type="text"
                name="referral_code"
                class="form-control"
                value="{{ request.GET.ref|default_if_none:'' }}"
                placeholder="Enter referral code"
              >
          </div>

          <div class="mb-3">
              <label class="form-label">Mobile Number</label>
              <div class="input-group">
                <input
                  type="text"
                  name="phone_country"
                  class="form-control"
                  style="max-width: 170px;"
                  list="phone-country-options"
                  value="+91"
                >
                <input type="tel" name="phone_number" class="form-control" placeholder="Phone number">
              </div>
          </div>

          <div class="mb-3">
              <label class="form-label">Password</label>
              <input type="password" name="password" class="form-control" required>
          </div>

          <button class="btn btn-primary w-100">
              Create Dealer Account
          </button>

          <p class="mt-3 text-center text-secondary">
              Already have an account?
              <a href="/auth/login/?next=/app/">Login</a>
          </p>

      </form>
  <datalist id="phone-country-options">
    {% include "partials/phone_country_options.html" %}
  </datalist>

  </div>

</div>

{% if request.user.is_authenticated %}
  <div class="modal-overlay" style="display:flex;position:fixed;inset:0;background:rgba(15,23,42,0.6);align-items:center;justify-content:center;z-index:9999;">
    <div class="modal-panel" style="max-width:520px;background:#0f172a;color:#e5e7eb;border:1px solid rgba(148,163,184,0.2);border-radius:16px;padding:24px;box-shadow:0 20px 60px rgba(0,0,0,0.45);">
      <h5>Logout Required</h5>
      <p class="text-secondary mb-3">
        You are already logged in. Please logout to create a new account.
      </p>
      <div class="d-flex justify-content-end gap-2">
        <a class="btn btn-danger" href="/accounts/logout/?next=/agent-signup/">Logout</a>
        <a class="btn btn-secondary" href="/app/">Back to Dashboard</a>
      </div>
    </div>
  </div>
{% endif %}

{% endblock %}

{% block sidebar %}{% endblock %}

{% block shell_class %}no-sidebar{% endblock %}

