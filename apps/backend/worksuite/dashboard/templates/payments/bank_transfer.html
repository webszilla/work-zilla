{% extends "public/base.html" %}
{% block meta_title %}Work Zilla | Bank Transfer{% endblock %}
{% block meta_description %}Submit bank transfer payment details for approval.{% endblock %}

{% block content %}
<section class="section">
  <div class="site-container">
    <div class="pricing-header">
      <div>
        <h1 class="section-title">Bank Transfer</h1>
        <p class="section-lead">Confirm your plan details and submit payment for approval.</p>
      </div>
    </div>

    {% if messages %}
      {% for message in messages %}
        <div class="alert {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %}">
          {{ message }}
        </div>
      {% endfor %}
    {% endif %}

    <div class="card p-4">
      <div class="checkout-summary">
        <div>
          <h2 class="plan-title">{{ transfer.plan.name }}</h2>
          <p class="text-secondary">Product: {{ transfer.plan.product.name|default:"Work Suite" }}</p>
          <p class="text-secondary">Billing: {{ transfer.billing_cycle|default:"monthly"|title }} Â· Currency: {{ transfer.currency|default:"INR" }}</p>
        </div>
        <div class="plan-price">
          <span>{{ transfer.currency|default:"INR" }} {{ transfer.amount|default:"0" }}</span>
          {% if transfer.request_type == "addon" %}
            <span class="price-suffix-inline">add-on proration</span>
          {% else %}
            <span class="price-suffix-inline">
              {% if transfer.billing_cycle == "yearly" %}/user per year{% else %}/user per month{% endif %}
            </span>
          {% endif %}
        </div>
      </div>

      {% if transfer.addon_count %}
        <p class="text-secondary mt-2 mb-0">Add-ons: {{ transfer.addon_count }}</p>
      {% endif %}

      {% include "public/partials/payment_instructions.html" %}

      <form method="post" class="mt-4" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="row g-3 mb-3">
          <div class="col-12 col-lg-4">
            <div class="form-group mb-0">
              <label>UTR / Reference Number</label>
              <input class="form-control" type="text" name="reference_no" placeholder="Enter UTR / reference" required>
            </div>
          </div>
          <div class="col-12 col-lg-4">
            <div class="form-group mb-0">
              <label>Paid Date</label>
              <input class="form-control" type="date" name="paid_on">
            </div>
          </div>
          <div class="col-12 col-lg-4">
            <div class="form-group mb-0">
              <label>Bank Transfer Proof (Image)</label>
              <input class="form-control" type="file" name="receipt" accept="image/*">
              <div class="form-text">Upload JPG/PNG/WebP. Max 2MB.</div>
            </div>
          </div>
        </div>
        <div class="form-group mb-3">
          <label>Notes (optional)</label>
          <textarea class="form-control" name="notes" rows="3" placeholder="Any additional details"></textarea>
        </div>
        <button class="btn btn-primary" type="submit">Submit payment request</button>
      </form>
    </div>
  </div>
</section>
{% endblock %}
